(self.webpackChunkmaverick=self.webpackChunkmaverick||[]).push([[543],{5782:(e,t,i)=>{var s={"./almaMappings.ts":9458,"./constants.ts":3601,"./feedback.ts":5373,"./i18n.ts":9142,"./languages.ts":9991,"./reCAPTCHA.ts":8861};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=5782},6642:(e,t,i)=>{var s={"./advancedDatePickersController.ts":225,"./advancedSearchController.ts":6964,"./advancedSearchModalController.ts":2923,"./applicationController.ts":1118,"./authenticationController.ts":5642,"./bulkExportController.ts":1500,"./bxRecommenderController.ts":1811,"./chatController.ts":6616,"./citationController.ts":7191,"./courseReservesController.ts":4582,"./customPaginationController.ts":2425,"./datepickerController.ts":8136,"./debugController.ts":131,"./diagnosticsController.ts":6908,"./documentDetailController.ts":9418,"./embeddedWidgetsController.ts":3311,"./facetsController.ts":6710,"./feedbackController.ts":761,"./flowAuthController.ts":5372,"./layoutController.ts":3772,"./leavingSearchScopeModalController.ts":6061,"./libraryCardCheckoutListController.ts":5225,"./libraryCardConfirmActionDialog.ts":3103,"./libraryCardEditPickupLocationController.ts":1750,"./libraryCardFineListController.ts":6853,"./libraryCardMessageListController.ts":8406,"./libraryCardPersonalDetailsController.ts":5227,"./libraryCardReadingHistoryListController.ts":5793,"./libraryCardRequestListController.ts":4460,"./linksController.ts":1349,"./localizationController.ts":9155,"./menuBarController.ts":5012,"./menuController.ts":7197,"./modalInstanceController.ts":7458,"./paginationController.ts":3802,"./pubDateSliderController.ts":3190,"./quickFiltersController.ts":60,"./quickLookController.ts":8024,"./refinePaneController.ts":6581,"./relatedItemsController.ts":5779,"./resultsFeedController.ts":7818,"./savedItemModalController.ts":6551,"./savedItemsController.ts":8883,"./savedSearchBaseController.ts":9662,"./savedSearchController.ts":3007,"./savedSearchModalController.ts":4338,"./searchBoxController.ts":6309,"./searchController.ts":8630,"./topLinksController.ts":9710,"./topicController.ts":4415};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=6642},4635:(e,t,i)=>{var s={"./accessibility.ts":189,"./advancedSearchDirective.ts":514,"./aiDirectives.ts":9029,"./animate.ts":5458,"./assetDirectives.ts":7039,"./authenticationDirective.ts":9444,"./autocompleteDirectives.ts":1883,"./availabilityDirective.ts":8477,"./azSearchDirective.ts":2405,"./backToResultsDirective.ts":12,"./bxRecommenderDirectives.ts":9784,"./carouselDirective.ts":7330,"./chip.ts":6367,"./citationTrailDirectives.ts":4016,"./cloudStorageDirectives.ts":2713,"./courseReservesDirectives.ts":5991,"./customSearchFieldDirective.ts":1751,"./customSectionsDirective.ts":1633,"./daysOldDirective.ts":8116,"./diagnosticsDirective.ts":6452,"./directives.ts":823,"./documentDirectives.ts":7610,"./flow/flowDirectives.ts":6006,"./journalCoverageDirectives.ts":906,"./jsonldDataDirective.ts":5026,"./libraryCardDirectives.ts":3750,"./publicNotes.directive.ts":9160,"./refinementDirectives.ts":9482,"./relatedItemsDirectives.ts":8014,"./researchAssistantDirectives.ts":9616,"./resultsFeedDirectives.ts":9477,"./rtaAvailabilityDirective.ts":6830,"./savedItemsDirectives.ts":6430,"./savedSearchDirectives.ts":6572,"./searchBoxDirective.ts":7447,"./searchScopeDirective.ts":3656,"./secondarySearchDirective.ts":2802,"./shared.ts":4672,"./summonAlertDirective.ts":4737,"./summonAltmetricsDirective.ts":6093,"./svgIcon.ts":3526,"./syndeticsDirectives.ts":2139,"./topicSummary.ts":8420,"./validatorsDirectives.ts":7416,"./widgetDirectives.ts":1715};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=4635},1701:(e,t,i)=>{var s={"./authInterceptor.ts":8570,"./configs/advancedSearch.ts":801,"./configs/autocomplete.ts":6935,"./configs/availability.ts":552,"./configs/chat.ts":8145,"./configs/citation.ts":6402,"./configs/configs.ts":4408,"./configs/detailPage.ts":9669,"./configs/facets.ts":8855,"./configs/flow.ts":7363,"./configs/links.ts":4054,"./configs/quickFilters.ts":1265,"./configs/results.ts":3389,"./configs/toolbar.ts":8372,"./configs/vpnBanner.ts":6409,"./scrolls/courseReserveDetailScroll.ts":5833};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=1701},6897:(e,t,i)=>{var s={"./advancedSearchService.ts":5082,"./aiDocumentService.ts":3053,"./alertService.ts":6582,"./apiService.ts":184,"./appStateService.ts":9796,"./authenticationService.ts":7936,"./autocompleteService.ts":1116,"./availabilityService.ts":2257,"./beaconService.ts":2232,"./bxRecommenderService.ts":5481,"./chatService.ts":7802,"./citationService.ts":407,"./citationTrailService.ts":5681,"./cloudStorageService.ts":9666,"./configService.ts":914,"./courseReserveService.ts":4613,"./customSectionsService.ts":3293,"./dataService.ts":9804,"./dateRangeService.ts":8579,"./datepickerService.ts":7474,"./diagnosticsService.ts":1892,"./dialogService.ts":4508,"./documentDetailService.ts":7616,"./documentQueryService.ts":4401,"./documentService.ts":3215,"./emailService.ts":7576,"./eventService.ts":8568,"./externalPluginsService.ts":4911,"./facetsService.ts":6236,"./feedbackService.ts":3205,"./flowService.ts":5432,"./googleApiService.ts":5187,"./hooksService.ts":5036,"./journalCoverageDetailsService.ts":8635,"./journalTitleService.ts":9397,"./jsonldService.ts":3234,"./linkService.ts":4436,"./localizationService.ts":3095,"./mediaQueryService.ts":5072,"./menuManagerService.ts":1978,"./metricsService.ts":3831,"./microsoftApiService.ts":7496,"./moreFacetsService.ts":3899,"./publicNoteService.ts":8915,"./quickFiltersService.ts":5674,"./quickLookService.ts":2488,"./recaptchaService.ts":9171,"./relatedItemsService.ts":4119,"./researchAssistantService.ts":4201,"./resultsFeedPlugins/bestBetsPlugin.ts":9373,"./resultsFeedPlugins/databaseRecommendationsPlugin.ts":7082,"./resultsFeedPlugins/didYouMeanPlugin.ts":7858,"./resultsFeedPlugins/documentSummariesPlugin.ts":5234,"./resultsFeedPlugins/imagesRollupPlugin.ts":7255,"./resultsFeedPlugins/newsRollupPlugin.ts":5654,"./resultsFeedPlugins/noResultsPlugin.ts":3850,"./resultsFeedPlugins/querySuggestionsPlugin.ts":7394,"./resultsFeedPlugins/referencesRollupPlugin.ts":8823,"./resultsFeedPlugins/searchInfoPlugin.ts":4703,"./resultsFeedService.ts":3010,"./resultsFeedServicePlugins.ts":624,"./rtaAvailabilityService.ts":7902,"./savedItemsService.ts":6243,"./savedSearchService.ts":5473,"./searchScopeService.ts":7384,"./searchService.ts":3964,"./shortenUrlService.ts":6934,"./sierraService.ts":4718,"./storeService.ts":1403,"./summonUserService.ts":4296,"./svgIconService.ts":5341,"./topicService.ts":6585,"./translationService.ts":7137,"./urlService.ts":4587,"./utilitiesService.ts":7640,"./viewStateService.ts":4234};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=6897},8399:function(e,t,i){"use strict";var s;!function(a){function r(e,t,i){var s,a=0,r=[0],n=null;if("UTF8"!==(s=i||"UTF8")&&"UTF16BE"!==s&&"UTF16LE"!==s)throw"encoding must be UTF8, UTF16BE, or UTF16LE";if("HEX"===t){if(0!=e.length%2)throw"srcString of HEX type must be in byte increments";n=l(e),a=n.binLen,r=n.value}else if("TEXT"===t||"ASCII"===t)n=o(e,s),a=n.binLen,r=n.value;else if("B64"===t)n=h(e),a=n.binLen,r=n.value;else{if("BYTES"!==t)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";n=c(e),a=n.binLen,r=n.value}this.getHash=function(e,t,i,s){var n,o=null,l=r.slice(),c=a;if(3===arguments.length?"number"!=typeof i&&(s=i,i=1):2===arguments.length&&(i=1),i!==parseInt(i,10)||1>i)throw"numRounds must a integer >= 1";switch(t){case"HEX":o=d;break;case"B64":o=u;break;case"BYTES":o=p;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"===e)for(n=0;n<i;n+=1)l=x(l,c),c=160;else if("SHA-224"===e)for(n=0;n<i;n+=1)l=M(l,c,e),c=224;else if("SHA-256"===e)for(n=0;n<i;n+=1)l=M(l,c,e),c=256;else if("SHA-384"===e)for(n=0;n<i;n+=1)l=M(l,c,e),c=384;else{if("SHA-512"!==e)throw"Chosen SHA variant is not supported";for(n=0;n<i;n+=1)l=M(l,c,e),c=512}return o(l,m(s))},this.getHMAC=function(e,t,i,n,g){var v,S,f,b,y=[],_=[];switch(v=null,n){case"HEX":n=d;break;case"B64":n=u;break;case"BYTES":n=p;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"===i)S=64,b=160;else if("SHA-224"===i)S=64,b=224;else if("SHA-256"===i)S=64,b=256;else if("SHA-384"===i)S=128,b=384;else{if("SHA-512"!==i)throw"Chosen SHA variant is not supported";S=128,b=512}if("HEX"===t)f=(v=l(e)).binLen,v=v.value;else if("TEXT"===t||"ASCII"===t)f=(v=o(e,s)).binLen,v=v.value;else if("B64"===t)f=(v=h(e)).binLen,v=v.value;else{if("BYTES"!==t)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";f=(v=c(e)).binLen,v=v.value}if(e=8*S,t=S/4-1,S<f/8){for(v="SHA-1"===i?x(v,f):M(v,f,i);v.length<=t;)v.push(0);v[t]&=4294967040}else if(S>f/8){for(;v.length<=t;)v.push(0);v[t]&=4294967040}for(S=0;S<=t;S+=1)y[S]=909522486^v[S],_[S]=1549556828^v[S];return n(i="SHA-1"===i?x(_.concat(x(y.concat(r),e+a)),e+b):M(_.concat(M(y.concat(r),e+a,i)),e+b,i),m(g))}}function n(e,t){this.a=e,this.b=t}function o(e,t){var i,s,a,r,n=[],o=[],l=0;if("UTF8"===t)for(s=0;s<e.length;s+=1)for(o=[],128>(i=e.charCodeAt(s))?o.push(i):2048>i?(o.push(192|i>>>6),o.push(128|63&i)):55296>i||57344<=i?o.push(224|i>>>12,128|i>>>6&63,128|63&i):(s+=1,i=65536+((1023&i)<<10|1023&e.charCodeAt(s)),o.push(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)),a=0;a<o.length;a+=1){for(r=l>>>2;n.length<=r;)n.push(0);n[r]|=o[a]<<24-l%4*8,l+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(s=0;s<e.length;s+=1){for(i=e.charCodeAt(s),"UTF16LE"===t&&(i=(a=255&i)<<8|i>>8),r=l>>>2;n.length<=r;)n.push(0);n[r]|=i<<16-l%4*8,l+=2}return{value:n,binLen:8*l}}function l(e){var t,i,s,a=[],r=e.length;if(0!=r%2)throw"String of HEX type must be in byte increments";for(t=0;t<r;t+=2){if(i=parseInt(e.substr(t,2),16),isNaN(i))throw"String of HEX type contains invalid characters";for(s=t>>>3;a.length<=s;)a.push(0);a[t>>>3]|=i<<24-t%8*4}return{value:a,binLen:4*r}}function c(e){var t,i,s,a=[];for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),s=i>>>2,a.length<=s&&a.push(0),a[s]|=t<<24-i%4*8;return{value:a,binLen:8*e.length}}function h(e){var t,i,s,a,r,n=[],o=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(i=e.indexOf("="),e=e.replace(/\=/g,""),-1!==i&&i<e.length)throw"Invalid '=' found in base-64 string";for(i=0;i<e.length;i+=4){for(r=e.substr(i,4),s=a=0;s<r.length;s+=1)a|=(t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(r[s]))<<18-6*s;for(s=0;s<r.length-1;s+=1){for(t=o>>>2;n.length<=t;)n.push(0);n[t]|=(a>>>16-8*s&255)<<24-o%4*8,o+=1}}return{value:n,binLen:8*o}}function d(e,t){var i,s,a="",r=4*e.length;for(i=0;i<r;i+=1)s=e[i>>>2]>>>8*(3-i%4),a+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(15&s);return t.outputUpper?a.toUpperCase():a}function u(e,t){var i,s,a,r="",n=4*e.length;for(i=0;i<n;i+=3)for(a=i+1>>>2,s=e.length<=a?0:e[a],a=i+2>>>2,a=e.length<=a?0:e[a],a=(e[i>>>2]>>>8*(3-i%4)&255)<<16|(s>>>8*(3-(i+1)%4)&255)<<8|a>>>8*(3-(i+2)%4)&255,s=0;4>s;s+=1)8*i+6*s<=32*e.length?r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-s)&63):r+=t.b64Pad;return r}function p(e){var t,i,s="",a=4*e.length;for(t=0;t<a;t+=1)i=e[t>>>2]>>>8*(3-t%4)&255,s+=String.fromCharCode(i);return s}function m(e){var t={outputUpper:!1,b64Pad:"="};try{e.hasOwnProperty("outputUpper")&&(t.outputUpper=e.outputUpper),e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad)}catch(e){}if("boolean"!=typeof t.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof t.b64Pad)throw"Invalid b64Pad formatting option";return t}function g(e,t){return e<<t|e>>>32-t}function v(e,t){return e>>>t|e<<32-t}function S(e,t){var i;return i=new n(e.a,e.b),32>=t?new n(i.a>>>t|i.b<<32-t&4294967295,i.b>>>t|i.a<<32-t&4294967295):new n(i.b>>>t-32|i.a<<64-t&4294967295,i.a>>>t-32|i.b<<64-t&4294967295)}function f(e,t){return 32>=t?new n(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new n(0,e.a>>>t-32)}function b(e,t,i){return e&t^~e&i}function y(e,t,i){return new n(e.a&t.a^~e.a&i.a,e.b&t.b^~e.b&i.b)}function _(e,t,i){return e&t^e&i^t&i}function E(e,t,i){return new n(e.a&t.a^e.a&i.a^t.a&i.a,e.b&t.b^e.b&i.b^t.b&i.b)}function A(e){return v(e,2)^v(e,13)^v(e,22)}function C(e){var t=S(e,28),i=S(e,34);return e=S(e,39),new n(t.a^i.a^e.a,t.b^i.b^e.b)}function $(e){return v(e,6)^v(e,11)^v(e,25)}function T(e){var t=S(e,14),i=S(e,18);return e=S(e,41),new n(t.a^i.a^e.a,t.b^i.b^e.b)}function I(e){return v(e,7)^v(e,18)^e>>>3}function R(e){var t=S(e,1),i=S(e,8);return e=f(e,7),new n(t.a^i.a^e.a,t.b^i.b^e.b)}function w(e){return v(e,17)^v(e,19)^e>>>10}function L(e){var t=S(e,19),i=S(e,61);return e=f(e,6),new n(t.a^i.a^e.a,t.b^i.b^e.b)}function k(e,t){var i=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(i>>>16)&65535)<<16|65535&i}function D(e,t,i,s){var a=(65535&e)+(65535&t)+(65535&i)+(65535&s);return((e>>>16)+(t>>>16)+(i>>>16)+(s>>>16)+(a>>>16)&65535)<<16|65535&a}function P(e,t,i,s,a){var r=(65535&e)+(65535&t)+(65535&i)+(65535&s)+(65535&a);return((e>>>16)+(t>>>16)+(i>>>16)+(s>>>16)+(a>>>16)+(r>>>16)&65535)<<16|65535&r}function O(e,t){var i,s,a;return i=(65535&e.b)+(65535&t.b),a=(65535&(s=(e.b>>>16)+(t.b>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.a)+(65535&t.a)+(s>>>16),new n((65535&(s=(e.a>>>16)+(t.a>>>16)+(i>>>16)))<<16|65535&i,a)}function F(e,t,i,s){var a,r,o;return a=(65535&e.b)+(65535&t.b)+(65535&i.b)+(65535&s.b),o=(65535&(r=(e.b>>>16)+(t.b>>>16)+(i.b>>>16)+(s.b>>>16)+(a>>>16)))<<16|65535&a,a=(65535&e.a)+(65535&t.a)+(65535&i.a)+(65535&s.a)+(r>>>16),new n((65535&(r=(e.a>>>16)+(t.a>>>16)+(i.a>>>16)+(s.a>>>16)+(a>>>16)))<<16|65535&a,o)}function N(e,t,i,s,a){var r,o,l;return r=(65535&e.b)+(65535&t.b)+(65535&i.b)+(65535&s.b)+(65535&a.b),l=(65535&(o=(e.b>>>16)+(t.b>>>16)+(i.b>>>16)+(s.b>>>16)+(a.b>>>16)+(r>>>16)))<<16|65535&r,r=(65535&e.a)+(65535&t.a)+(65535&i.a)+(65535&s.a)+(65535&a.a)+(o>>>16),new n((65535&(o=(e.a>>>16)+(t.a>>>16)+(i.a>>>16)+(s.a>>>16)+(a.a>>>16)+(r>>>16)))<<16|65535&r,l)}function x(e,t){var i,s,a,r,n,o,l,c,h,d=[],u=[1732584193,4023233417,2562383102,271733878,3285377520];for(i=15+(t+65>>>9<<4);e.length<=i;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[i]=t,h=e.length,l=0;l<h;l+=16){for(i=u[0],s=u[1],a=u[2],r=u[3],n=u[4],c=0;80>c;c+=1)d[c]=16>c?e[c+l]:g(d[c-3]^d[c-8]^d[c-14]^d[c-16],1),o=20>c?P(g(i,5),s&a^~s&r,n,1518500249,d[c]):40>c?P(g(i,5),s^a^r,n,1859775393,d[c]):60>c?P(g(i,5),_(s,a,r),n,2400959708,d[c]):P(g(i,5),s^a^r,n,3395469782,d[c]),n=r,r=a,a=g(s,30),s=i,i=o;u[0]=k(i,u[0]),u[1]=k(s,u[1]),u[2]=k(a,u[2]),u[3]=k(r,u[3]),u[4]=k(n,u[4])}return u}function M(e,t,i){var s,a,r,o,l,c,h,d,u,p,m,g,v,S,f,x,M,U,B,H,q,V,j,G,W,z,Y=[],Q=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(p=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],"SHA-224"===i||"SHA-256"===i)m=64,s=15+(t+65>>>9<<4),S=16,f=1,W=Number,x=k,M=D,U=P,B=I,H=w,q=A,V=$,G=_,j=b,p="SHA-224"===i?p:a;else{if("SHA-384"!==i&&"SHA-512"!==i)throw"Unexpected error in SHA-2 implementation";m=80,s=31+(t+129>>>10<<5),S=32,f=2,x=O,M=F,U=N,B=R,H=L,q=C,V=T,G=E,j=y,Q=[new(W=n)(Q[0],3609767458),new W(Q[1],602891725),new W(Q[2],3964484399),new W(Q[3],2173295548),new W(Q[4],4081628472),new W(Q[5],3053834265),new W(Q[6],2937671579),new W(Q[7],3664609560),new W(Q[8],2734883394),new W(Q[9],1164996542),new W(Q[10],1323610764),new W(Q[11],3590304994),new W(Q[12],4068182383),new W(Q[13],991336113),new W(Q[14],633803317),new W(Q[15],3479774868),new W(Q[16],2666613458),new W(Q[17],944711139),new W(Q[18],2341262773),new W(Q[19],2007800933),new W(Q[20],1495990901),new W(Q[21],1856431235),new W(Q[22],3175218132),new W(Q[23],2198950837),new W(Q[24],3999719339),new W(Q[25],766784016),new W(Q[26],2566594879),new W(Q[27],3203337956),new W(Q[28],1034457026),new W(Q[29],2466948901),new W(Q[30],3758326383),new W(Q[31],168717936),new W(Q[32],1188179964),new W(Q[33],1546045734),new W(Q[34],1522805485),new W(Q[35],2643833823),new W(Q[36],2343527390),new W(Q[37],1014477480),new W(Q[38],1206759142),new W(Q[39],344077627),new W(Q[40],1290863460),new W(Q[41],3158454273),new W(Q[42],3505952657),new W(Q[43],106217008),new W(Q[44],3606008344),new W(Q[45],1432725776),new W(Q[46],1467031594),new W(Q[47],851169720),new W(Q[48],3100823752),new W(Q[49],1363258195),new W(Q[50],3750685593),new W(Q[51],3785050280),new W(Q[52],3318307427),new W(Q[53],3812723403),new W(Q[54],2003034995),new W(Q[55],3602036899),new W(Q[56],1575990012),new W(Q[57],1125592928),new W(Q[58],2716904306),new W(Q[59],442776044),new W(Q[60],593698344),new W(Q[61],3733110249),new W(Q[62],2999351573),new W(Q[63],3815920427),new W(3391569614,3928383900),new W(3515267271,566280711),new W(3940187606,3454069534),new W(4118630271,4000239992),new W(116418474,1914138554),new W(174292421,2731055270),new W(289380356,3203993006),new W(460393269,320620315),new W(685471733,587496836),new W(852142971,1086792851),new W(1017036298,365543100),new W(1126000580,2618297676),new W(1288033470,3409855158),new W(1501505948,4234509866),new W(1607167915,987167468),new W(1816402316,1246189591)],p="SHA-384"===i?[new W(3418070365,p[0]),new W(1654270250,p[1]),new W(2438529370,p[2]),new W(355462360,p[3]),new W(1731405415,p[4]),new W(41048885895,p[5]),new W(3675008525,p[6]),new W(1203062813,p[7])]:[new W(a[0],4089235720),new W(a[1],2227873595),new W(a[2],4271175723),new W(a[3],1595750129),new W(a[4],2917565137),new W(a[5],725511199),new W(a[6],4215389547),new W(a[7],327033209)]}for(;e.length<=s;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[s]=t,z=e.length,g=0;g<z;g+=S){for(t=p[0],s=p[1],a=p[2],r=p[3],o=p[4],l=p[5],c=p[6],h=p[7],v=0;v<m;v+=1)16>v?(u=v*f+g,d=e.length<=u?0:e[u],u=e.length<=u+1?0:e[u+1],Y[v]=new W(d,u)):Y[v]=M(H(Y[v-2]),Y[v-7],B(Y[v-15]),Y[v-16]),d=U(h,V(o),j(o,l,c),Q[v],Y[v]),u=x(q(t),G(t,s,a)),h=c,c=l,l=o,o=x(r,d),r=a,a=s,s=t,t=x(d,u);p[0]=x(t,p[0]),p[1]=x(s,p[1]),p[2]=x(a,p[2]),p[3]=x(r,p[3]),p[4]=x(o,p[4]),p[5]=x(l,p[5]),p[6]=x(c,p[6]),p[7]=x(h,p[7])}if("SHA-224"===i)e=[p[0],p[1],p[2],p[3],p[4],p[5],p[6]];else if("SHA-256"===i)e=p;else if("SHA-384"===i)e=[p[0].a,p[0].b,p[1].a,p[1].b,p[2].a,p[2].b,p[3].a,p[3].b,p[4].a,p[4].b,p[5].a,p[5].b];else{if("SHA-512"!==i)throw"Unexpected error in SHA-2 implementation";e=[p[0].a,p[0].b,p[1].a,p[1].b,p[2].a,p[2].b,p[3].a,p[3].b,p[4].a,p[4].b,p[5].a,p[5].b,p[6].a,p[6].b,p[7].a,p[7].b]}return e}void 0===(s=function(){return r}.call(t,i,t,e))||(e.exports=s)}()},9458:()=>{"use strict";angular.module("summonApp.constants").constant("$almaLanguages",{EN:"en",NL:"nl",FR:"fr",DE:"de",IT:"it",KO:"ko",NB:"nb",NO:"no",ES:"es",SV:"sv",CY:"cy",ZH:"zy",ZA:"zh",SE:"se",NN:"nn",HE:"he",PL:"pl",CA:"ca",PT:"pt",DA:"da",JP:"ja",AR:"ar"})},3601:()=>{"use strict";angular.module("summonApp.constants").constant("$broadcastTypes",{newSearch:"newSearchBroadcast",search:"searchBroadcast",moreFacets:"moreFacetsBroadcast",contentTypes:"contentTypesBroadcast",disciplines:"disciplinesBroadcast",languages:"languagesBroadcast",library:"libraryBroadcast",citationTrail:"citationsBroadcast",other:"otherBroadcast"}).constant("$booleanValues",["AND","OR","NOT"]).constant("$queryModifiers",["AllWords","AnyWords","ExactMatch"]).constant("$identifierQueryModifiers",["ExactMatch","BeginsWith"]).constant("$identifierFields",["CallNumAll","IsbnAll","IssnAll","CODEN","DEWEY","DOI","OCLC","PatentNumber","EAN","EBSCOAN","ERIC","ISMN","LCCN","NAICS","ORCID","PCID","PMID","PQID","PQPubID","SSID","UPC","DUNS","SICI"]).constant("$minLengthForBeginsWithQueries",3).constant("$helpLinks",{savedSearch:"https://knowledge.exlibrisgroup.com/Summon/Product_Documentation/Searching_in_The_Summon_Service/Using_Results/Summon%3A_Saving_Searches",savedItems:"https://knowledge.exlibrisgroup.com/Summon/Product_Documentation/Searching_in_The_Summon_Service/Using_Results/Summon%3A_Saving_Items_(Citations)"}).constant("$filterTextMappings",{topic:{wikipedia:"Wikipedia, the free encyclopedia"},sortOrder:{"PublicationDate|asc":"date (oldest)","PublicationDate|desc":"date (newest)","PublicationDate:asc":"date (oldest)","PublicationDate:desc":"date (newest)","Author|asc":"Author","Title|asc":"Title"},readableOrder:{"PublicationDate|asc":"oldest date","PublicationDate|desc":"newest date","PublicationDate:asc":"oldest date","PublicationDate:desc":"newest date","Author|asc":"Author","Title|asc":"Title"}}).constant("$formats",{music_recording:"music",film:"microfilm",art:"artwork",album:"music_cd",compact_disc:"music_cd",conference_proceeding:"conference",dvd:"video_dvd",interactive_media:"artifact",research_guide:"library_guide",government_document:"government",dissertation:"dissertation_thesis"}).constant("$citationTrailTypes",{CITES:1,CITED_BY:2}).constant("$relatedItemTypes",{REVIEWS:"reviews",CHAPTERS:"chapters"}).constant("$searchTabs",{search:1,citationTrail:2}).constant("$authEvents",{LOGINSUCCESS:"auth-login-success",LOGININPROGRESS:"auth-login-in-progress",LOGINAFTERREDIRECT:"auth-login-after-redirect",LOGINAFTERPOPUP:"auth-login-after-popup",LOGINEXPIRED:"auth-login-expired",LOGINCANCELED:"auth-login-canceled",LOGOUTSUCCESS:"auth-logout-success",LOGOUTAFTERPOPUP:"auth-logout-after-popup",LOGOUTAFTEREXPIRED:"auth-logout-after-expired",LOGOUTAFTERREDIRECT:"auth-logout-after-redirect",LOGOUTINPROGRESS:"auth-logout-in-progress",SILENTLOGOUTINPROGRESS:"auth-logout-in-progress-silent",NOTAUTHENTICATED:"auth-not-authenticated",UNKNOWN:"auth-unknown"}).constant("$facetTypes",{REFINE_PANE:"refinePane",CONTENT_TYPE:"contentType",LANGUAGE:"language",DISCIPLINE:"discipline",LIBRARY:"library",NEW_RECORDS:"newRecords"})},5373:()=>{"use strict";angular.module("summonApp.constants").constant("$feedbackTypes",["Please choose one of the following","General Feedback","Didn't find what I was looking for","Report a problem or bug","Request a new feature","Link didn't work as expected"]).constant("$feedbackUserRoles",["Please choose one of the following","Undergraduate Student","Graduate Student","Researcher","Faculty","Alumni","Other"])},9142:()=>{"use strict";angular.module("summonApp.constants").constant("$translationKeys",{ABOUT_WIDGET_BUILDER:"About Widget Builder",ABSTRACT:"Abstract",ACCESS_TYPE_IN:"Access this %{type} in",ACCESSIBLE_MENU:"Accessible Menu",ADD_A_ROW:"Add a row",ADD_A_ROW_MAX_REACHED:"Adding not possible, maximum fields reached",ADD_FIELD:"Add %{field}",ADD_RESULTS_BEYOND_COLLECTION:"Add results beyond your library's collection",ADDRESS_PRIMARY:"Primary address",ADDRESS_ALT:"Alternate address",ADDRESSES:"Address(es)",ADVANCED:"Advanced",ADVANCED_LINE:"Advanced Line",ADVANCED_LINK_TEXT:"Advanced Link Text",ADVANCED_SEARCH:"Advanced Search",ADVANCED_SEARCH_INPUT_SEARCH_TOGGLE:"click to search",ADVANCED_SEARCH_DIALOG:"Advanced Search Dialog",ADVANCED_SEARCH_CONTAINS:"Contains",ADVANCED_SEARCH_CONTAINS_ALLWORDS:"All words anywhere",ADVANCED_SEARCH_CONTAINS_ANYWORDS:"Any of these words",ADVANCED_SEARCH_CONTAINS_EXACTMATCH:"Exact match",ADVANCED_SEARCH_CONTAINS_BEGINSWITH:"Begins with",ADVANCED_SEARCH_OTHER_FILTERS_LABEL:"Other filters from your last search",ALERT_NAME_DOES_NOT_EXIST:"Alert name does not exist",ALL_LOCATIONS:"All Locations",ALL:"All",AND_MORE:"and more",MORE_OPTIONS:"More Options",MORE_OPTIONS_EDIT_SEARCH_SCOPE:"More options for editing search scope",ALTMETRICS:"Altmetrics",ANY_TYPE:"Any Type",APP_ERROR:"Application Error",APP_ERROR_MSG:"Your search has failed to complete. Please try again.",APP_ERROR_MSG_400:"This search was unable to be fulfilled due to an invalid query.",APP_ERROR_MSG_429:"This search was unable to be fulfilled due to excessive use.",APP_IS_LOADING:"Application is loading.",APP_MESSAGE:"Application Message",APPLY:"Apply",APPLY_TOOLTIP:"Apply selected facets and refresh results",ATTEMPT_TO_SAVE_ITEM:"Attempting to save item.",AUTHOR:"Author",AUTHENTICATION_ERROR_VALIDATE_ERROR:"User could not be validated against external authentication service, please try again.",AUTHENTICATION_ERROR_REFRESH_ERROR:"Session could not be refreshed, please log in again.",AUTHENTICATION_ERROR_UNKNOWN_ERROR:"Unknown authentication error, please log in again.",AUTHENTICATION_ERROR_NOT_AUTHENTICATED:"Not authenticated, maybe your session expired. Please log in again.",AUTHENTICATION_OPTIONS:"Authentication options",AUTHORIZE_GOOGLE:"Give Access to Google Drive",AVAILABILITY:"Availability",AVAILABLE_IN_PRINT:"Available in Print",AVAILABLE_ONLINE:"Available Online",AVAILABLE_RTA_STATUS_AVAILABLE:"Available",AVAILABLE_RTA_STATUS_UNKNOWN:"Unknown",AVAILABLE_RTA_STATUS_NOT_AVAILABLE:"No copies available",BACK:"Back",BACK_TO_BASIC:"Basic search",BACK_TO_SEARCH:"Back to results",BACK_TO_TOP:"Back to top",BARCODE:"Barcode",BARCODES:"Barcode(s)",BEYOND_HOLDINGS:"Beyond Holdings",BIBTEX:"BibTeX",BIRTH_DATE:"Date of birth",BOOK_REVIEWS:"Book Reviews",BOOKMARK_RESULT:"Bookmark results",BOX_WIDTH:"Box width",BULK_EXPORT_DEFAULT_MESSAGE:'Hi,\n\nThe results for the search "{query}" are attached. \n\nPlease contact the library if you need additional help.\n\n Here is the link to your search: {summonUrl}',BULK_EXPORT_ERROR:"An error occurred while exporting results. Please try again.",BULK_EXPORT_EMAIL_SUBJECT:"CDI Batch Search Report",BULK_EXPORT_REPORT_TITLE:"Bulk Export Report",BULK_EXPORT_SUCCESS:"Export is in progress. It may take several minutes for the export to complete and the email to be sent.",BY:"by",CALENDAR_KEY_INSTRUCTION:"Use the left and right arrow keys to select a desired publication date for which to filter the result set. The result set will automatically filter 2 seconds after selection.",CAN_BE_USED_FOR_X:"Can be used for %{feature}",CANCEL:"Cancel",CANCEL_FACET_SELECTIONS:"Cancel without applying changes",CANCEL_HOLD_REQUEST_DATE:"Date to cancel the request",CALL_NUMBER:"Call Number",NO_CALL_NUMBER:"No Call Number",CHANGES:"changes",CHAPTERS:"Chapters",CHAT:"Chat",CHAT_IS_OFFLINE:"Chat is offline",CHAT_WITH_LIBRARIAN:"Chat with a Librarian",CHECK_AVAILABILITY:"Check Availability",CHECK_LIBRARY:"Check Library",CHECK_OUT_DATE:"Check out date",CHECK_SPELLING:"Check your spelling",CHECKED_OUT:"Checked out",CHECKED_OUT_DAYS_LEFT:"%{daysLeft} days left",CHECKED_OUT_EMPTY:"You have no checked out items",CHECKED_OUT_ERROR:"There was an error retrieving your loans: %{error}",CHECKED_OUT_OVERDUE:"Overdue",CHECKED_OUT_RENEW_SELECTED:"Renew %{count} selected loans",CHECKED_OUT_RENEWAL_ERROR:"An error occurred renewing the loan, try again later",CHECKED_OUT_RENEWAL_ERROR_403:"The loan could not be renewed, it might be too soon",CHECKED_OUT_RENEWAL_ERROR_X:"The loan could not be renewed: %{error}",CHECKED_OUT_RENEWAL_SOME_ERROR:"An error occurred renewing %{number} loan(s), try again later",CHECKED_OUT_RENEWAL_SUCCESS:"Loan successfully renewed",CHECKED_OUT_RENEWAL_SUCCESS_ALL:"All loans successfully renewed",CHECKING_AVAILABILITY:"Checking Availability",CHOOSE_CITATION_FORMAT:"Choose a Citation Format",CHOOSE_FEEDBACK_OPTIONS:"Choose one of the feedback options",CHOOSE_FORMAT:"Choose Format",CITACE_COM:"Citace.com",CITATIONS:"Citations",CITATION_ONLINE:"Citation Online",CITATION_PATH_START:"You started here",CITATION_PATH_CURRENT:"You are here",CITATIONS_FAILED_TO_LOAD:"Citations failed to load.",CITATIONS_PROCESSING_ERROR:"Citation processing error.",CITAVI:"Citavi",CITE:"Cite",CITES:"Cites",CITE_THIS_ITEM:"Cite this item",CITED_BY:"Cited by",CLEAR:"Clear",CLEAR_ALL:"Clear all",CLEAR_ALL_ITEMS:"Clear all items?",CLEAR_FILTERS:"Clear Filters",CLEAR_FORM:"Clear Form",CLICK_ICON_TO_SAVE_TO_THIS_FOLDER:"Click the <i class='uxf-icon uxf-bookmark uxf-l'></i> icon next to any search result to add it to this folder.",CLICK_ICON_TO_SAVE_SEARCH:'Click "Save Search" at the top of the search results to add your search to this folder.',CLOSE:"Close",CLOSE_MENU:"Close Menu",CLOSE_WIDGETS:"Close Widgets",CLOUD_STORAGE_API_ERROR:"Received error when contacting",CLOUD_STORAGE_API_ERROR_NETWORK_ERROR:"There was a problem with the network",CLOUD_STORAGE_AUTH_CANCELED:"Authorization process canceled.",CLOUD_STORAGE_AUTH_ERROR:"Auth token error. Please sign in again.",COLLAPSE:"Collapse",COLLECT_AND_ORGANIZE_YOUR_RESEARCH:"Collect & organize your research",CONTACT_LIBRARIAN_LINK:"<a href='%{url}' target='_blank'>Contact a librarian</a> for help",CONTENT_TYPE:"Content Type",CONTENT_TYPE_ADVANCED_SEARCH:"Content Type (in Advanced Search)",CONTRACT_TOPIC_EXPLORER:"Collapse Topic Explorer",CONTRACT_AZ_SEARCH_WIDGET:"Collapse Database Finder",COPIES:"Copies",COPY:"Copy",COPY_THE_CODE:"Copy the code",COURSE_ID:"Course ID",COURSE_RESERVE:"Course Reserve",COURSE_RESERVES:"Course Reserves",COURSE_RESERVES_SEARCH_BOX_PLACEHOLDER:"Search by course code, name or instructor",COVERAGE:"Coverage",COVERAGE_DETAILS:"Coverage Details",COVERAGE_GAP_FROM_TO:"No coverage %{gapRange}",COVERAGE_START_TO_PRESENT:"%{start} to present",COVERAGE_ZERO_START:"No date",CREATE_REFWORKS_ACCOUNT:"Create a RefWorks account and store all your saved items permanently, manage documents and references, and collaborate with other researchers.",CUSTOM_DATES:"Custom Dates",CUSTOM_DATES_BUTTON:"Custom Dates Button",CUSTOM_SECTIONS:"Custom Panel Sections",CUSTOMIZE_THE_WIDGET:"Customize the widget",CUSTOMIZE_DATE_RANGE:"Customize date range",DATABASE:"Database",DATABASE_RECOMMENDATIONS:"Database Recommendations",DATABASE_FINDER:"Database finder",DATABASE_FINDER_ALT_NAMES:"Alternate name(s):",DATABASE_FINDER_MESSAGE:"Search here to find individual databases in our Database A-Z list.",DATABASE_FINDER_NO_RESULTS:"Nothing found for your query.",DATABASE_FINDER_PAGING:"Showing %{start}-%{end} of %{count} database results:",DATABASE_FINDER_BROWSE_LINK:"Or <a href='%{url}' target='_blank'>click here to browse by subject.</a>",DATABASE_PAGER_MAX:"Showing more results not supported. Please rephrase your query.",DATABASE_FINDER_SHOW_NEXT_X:"next %{count}",DATABASE_FINDER_SHOW_PREVIOUS_X:"previous %{count}",DATABASE_FINDER_SUBJECTS:"Subject(s):",DATEFORMAT_Y:"y",DATEFORMAT_M:"m",DATEFORMAT_D:"d",DATE_NEWEST:"Date(newest)",DATE_OLDEST:"Date(oldest)",DATE_PRESET_1Y:"1 year",DATE_PRESET_3Y:"3 years",DATE_PRESET_5Y:"5 years",DATE_PRESET_10Y:"10 years",DAYS_LEFT:"Days left",DELETE:"Delete",DESCRIPTION:"Description",DETAIL_PAGE:"Detail Page",DID_YOU_MEAN:"Did you mean",DISCIPLINE:"Discipline",DISCIPLINE_ADVANCED_SEARCH:"Discipline (in Advanced Search)",DISSERTATIONS:"Dissertations",DONE:"Done",DONE_LOADING_MORE_FACETS:"Done Loading More Facets",DONE_LOADING_RESULTS:"Done Loading Results",DONT_TRACK_HISTORY:"Don't Track My Reading History",DUE_BY:"Due by",DUE_DATE:"Due date",EASYBIB:"EasyBib",EBOOK_FULL_TEXT_ONLINE:"eBook Full Text Online",EDIT:"Edit",EDIT_FIELD:"Edit %{field}",EDITED_BY:"Edited By",EMAIL:"Email",EMAILS:"Email(s)",EMAIL_PROCESSING_ERROR:"Email processing error.",EMAIL_SENT_SUCCESSFULLY:"Email Sent Successfully",EMAIL_THIS_ITEM:"Email this item",END_OF_RESULTS:"You've reached the end of your results!",ENDNOTE:"EndNote",ENTER_VALID_DATE:"Enter a valid date",EXCLUDE:"Exclude",EXCLUDE_X:"Exclude %{what}",EXCLUDED:"Excluded",EXCLUDE_FROM_RESULTS:"Exclude from results",EXCLUDE_THIS_ITEM:"Exclude this item",EXPAND:"Expand",EXPAND_TOPIC_EXPLORER:"Expand Topic Explorer",EXPAND_AZ_SEARCH_WIDGET:"Expand Database Finder",EXPAND_YOUR_RESULTS:"Expand your results",EXPANDED_RESULTS:"Expanded results",EXPORT:"Export",EXPORT_AS_WITH_ELLIPSIS:"Export As...",EXPORT_RESULTS:"Export Results",ONLY_FIRST_1000_RESULTS_EXPORTED:"Only the 1st 1000 results will be exported.",EXPORT_LIMIT_LABEL:"Exports are limited to 1000 results at a time.",EXPORT_AND_EMAIL_AS_CSV_X_RESULTS:"Export & Email | CSV - %{count} results",EXPORT_TO:"Export to",EXPORT_TO_WITH_ELLIPSIS:"Export To ...",FACETS_MENU:"Facets Menu",FACETS_EMPTY:"No results found",FACETS_EXCLUDED:"%{count} excluded (click to move facets to top)",FACETS_INCLUDED:"%{count} included (click to move facets to top)",FEEDBACK:"Feedback",FEEDBACK_PROCESSING_ERROR:"Feedback processing error.",FILTER_FACET_TYPE:"%{filter_facet_type} Filter",FILTER_LIST:"Filter list",FILTER_BY:"Filter by",FINE_AMOUNT:"$%{amount}",FINE_FEE:"Fine/Fee",FINE_ERROR:"There was an error retrieving your fines: %{error}",FINE_NO_RESOURCE:"No resource for this fine",FINES:"Fines & Fees",FINES_EMPTY:"You have no fine or fees",FIXED:"Fixed",FILTERS:"Filters",FLUID:"Fluid",FOR_HELP_CONTACT_LIBRARY:"For additional help, don't hesitate to contact the library.",FORMAT_PREVIEW:"Format preview",FROM_DATE_BEFORE_TO:"'From' date should occur before 'To' date",FROM_SOURCE:"From %{source}",FULL_TEXT_ONLINE:"Full Text Online",FULL_DETAILS_PAGE:"Full Details Page >",GENERATING_SHORTENED:"Generating Shortened URL",GO_TO_SEARCH:"Go back to search",GLANCEABILITY_ORIGINAL_RESEARCH:"Original Research",GLANCEABILITY_PAGES:"%{n} pages",GLANCEABILITY_REVIEW_ARTICLE:"Review Article",GLANCEABILITY_PRIMARY_SOURCE:"Primary Source",GLANCEABILITY_PRE_PRINT:"Preprint",GLANCEABILITY_RETRACTED_PUBLICATIONS:"Retracted Publication",GLANCEABILITY_WITHDRAWN_PUBLICATIONS:"Withdrawn Publication",GLANCEABILITY_RETRACTION_NOTICE:"Retraction Notice",GLANCEABILITY_WITHDRAWAL_NOTICE:"Withdrawal Notice",GLANCEABILITY_PUBLICATION_EXP_CONCERN:"Publication with Expression of Concern",HEADER:"Header",HEADER_COLOR:"Header Color",HOLD_REQUEST_NOTE:"Request note",HOME:"Home",HOW_RATE_SATISFACTION:"How would you rate your level of satisfaction?",IMAGE_RESULTS_FOR:"Image results for",IMAGE_THUMBNAIL:"Image Thumbnail",INCLUDE:"Include",INCLUDE_THIS_ITEM:"Include this item",INCLUDING:"Including",INCLUDING_RESULTS_FOR:"Including results for",INVALID_DATA_NOTICE:"This form contains invalid data or is missing required fields and cannot be submitted at this time. Please make corrections to enable this button.",INSTRUCTOR:"Instructor",IS_REQUIRED:"is required",ISSN_EDIT_IN_OPTIONS:"ISSN must be edited in the options modal",ISSUE:"Issue",ITEM_HAS_BEEN_SAVED:"Item has been saved.",ITEMS_AT_MY_INSTITUTION:"Items at my institution",ITEMS_IN_LIBRARY_CATALOG:"Items in the library catalog (includes mostly print and physical material)",JUST_SEARCH_QUERY:"Just search %{query}",JOURNAL_TITLE:"Journal Title",LANGUAGE:"Language",LANGUAGE_ADVANCED_SEARCH:"Language (in Advanced Search)",LAST_X_DAYS:"Last %{x} days",LAST_12_MONTHS:"Last 12 Months",LAST_3_YEARS:"Last 3 years",LAST_5_YEARS:"Last 5 years",_1_YEAR:"<font class='font-year'>1</font> Year",_3_YEARS:"<font class='font-year'>3</font> Years",_5_YEARS:"<font class='font-year'>5</font> Years",_10_YEARS:"<font class='font-year'>10</font> Years",LEARN_MORE:"Learn more",LESS:"Less",LIBRARY_ACCOUNT:"Library Account",LIBRARY_ADVANCED_SEARCH:"Library Location (in Advanced Search)",LIBRARY_CARD:"Library Card",LIBRARY_CARD_DIALOG_CLOSE:"Library Card Dialog Close",LIBRARY_CARD_SORT_BY:"Library Card Sort By",LIBRARY_CARD_FEATURE:"Library integration",LIBRARY_CARD_FEATURE_DESCRIPTION:"Authenticate with your library system, so you can request items and interact with your account (if enabled by the library)",LIBRARY_CATALOG:"Library Catalog",LIBRARY_NOTES:"Library Notes",LIBRARY_REC:"Library Recommendation",LIBRARY_SEARCH:"Library Search",LIBRARY_THING:"LibraryThing",LINK:"Link",LINK_RESOLVER:"Link Resolver",LIMIT_TO:"Limit to",LINKS_COLOR:"Links Color",LINKS_MENU:"Links Menu",LOAD_MORE:"Load more",LOADING:"loading",LOADING_MORE_FACETS:"Loading more facets",LOADING_PAGE_NUMBER:"Loading page %{number}",LOADING_PUBLIC_NOTES:"Loading Public Notes",LOADING_RESULTS:"Loading Results",LOADING_SYNDETICS_CONTENT:"Loading Syndetics Plus content",LOCATION:"Location",LOCATIONS:"Locations",LOGIN_WITH:"Log in with %{alias}",LOGOUT_OF:"Log out of %{provider}",MANAGE_READING_HISTORY:"Manage My Reading History Via WebPac",MENU:"Menu",MESSAGE:"Message",MESSAGES:"Messages",MESSAGES_EMPTY:"You have no messages",MESSAGES_ERROR:"There was an error retrieving your messages: %{error}",MESSAGES_FROM_LIBRARY:"Message %{pluralChar} from the library:",MINIMIZE_NUMBER_OF_SEARCH_TERMS:"Minimize number of search terms",MODAL_DIALOG:"Modal Dialog",MORE:"More",MORE_ACTIONS:"More actions",MORE_BOOK_REVIEWS:"More Book Reviews",MORE_DETAILS:"More Details",MORE_FACETS_PANE:"More Facets Pane",MOVE_BACKWARDS:"Move backwards",MOVE_FORWARDS:"Move forwards",MOTIVE:"Motive",LOAD_MORE_FACETS:"Load more facets",MUST_BE_MIN_LENGTH:"Must be at least %{minLength} characters",MUST_BE_VALID:"must be valid",MUST_CONTAIN_10_CHARS:"must contain more than 10 characters",NAME:"Name",NEW_SEARCH:"New Search",NEW_SEARCH_MSG:"You have started a new search. All filters, date restrictions, keywords and other elements of your previous searches have been cleared. If you want to include filters in any subsequent searches or limit your results in any way you will need to set them again.",NEWS_RESULTS_FOR:"News results for",NEWSPAPER_ARTICLES:"Newspaper articles",NEXT_PAGE:"Next",NEXT_RESULT:"Next Result",NO:"No",NOTES:"Notes",NO_RATING:"No Rating",NO_RESOURCE_FOUND:"Resource not found in Summon index",NO_RESULTS_FOR_ADV_SEARCH_CHECKBOX_LIST:"Nothing matching '%{query}'",NO_RESULTS_FOR_CURRENT_FILTER:"No results were found for this search with your current filter selections. Try %{linkStart}clearing your filters%{linkEnd} to improve your results",NO_SAVED_ITEMS_NOTICE:"You haven't saved any items yet.",NO_SAVED_SEARCHES_NOTICE:"You haven't saved any searches yet.",NOT_ALL_ARTICLES:"(may not contain all articles)",NOTE_NO_ACCESS_TO_ARTICLE:"<strong>Note:</strong> You do not have access to this article online",NOTE_SELECTED_ARTICLE_NOT_AVAILABLE:"<strong>Note:</strong> The article you selected is not available through these sources",OK:"OK",ONLINE:"online",OPEN_ACCESS:"Open Access",OPEN_ACCESS_FILTER:"Open Access (Filter)",OPEN_ACCESS_INDICATOR:"Open Access (Indicator)",OPEN_ACCESS_ITEMS_ONLY:"Open Access items only",OPEN_IN_NEW_TAB:"Opens in a new tab",OPT_IN:"Opt In",OPT_IN_OR_OUT:"Opt In/Out",OPT_OUT:"Opt Out",OPT_OUT_QUESTION:"Opt out from history, deleting all entries?",OPTIONAL:"Optional",OPTIONS:"Options",OR:"OR",OR_INCLUDE_SOURCES_OUTSIDE_LIBRARY:"Or try %{linkStart}including sources outside of this library's collection%{linkEnd}",OTHER_AVAILABLE_SOURCES:"Other Available Sources",PAGE_NUMBER:"Page %{number}",PAGINATION:"Pagination",PDF:"PDF",PEER_REVIEW:"Peer-Reviewed",PEER_REVIEWED_PUBLICATIONS:"Peer reviewed publications",PERFORM_SEARCH_SEE_RESULTS:"Perform search to preview scope results",PERMANENT_LINK:"Permanent Link",PERMISSION_REQUIRED:"Permission Required",PERMANENT_LINK_COPIED_TO_CLIPBOARD:"Permanent Link copied to clipboard.",PERMANENT_LINK_COPY_ERROR:"Your browser does not support programmatic copying. Please try CTRL+C.",PERSONAL_DETAILS:"Personal Details",PERSONAL_DETAILS_ERROR:"There was an error retrieving your personal details: %{error}",PERSONAL_DETAILS_EMPTY_ERROR:"There was an error retrieving your personal details",PERSONAL_DETAILS_UPDATE_SUCCESS:"Personal Details updated successfully",PERSONAL_DETAILS_UPDATE_ERROR:"There was an error in updating your personal details",PHONES:"Phone Number(s)",PHONE_PRIMARY:"Primary phone",PHONE_ALT:"Alternate phone",PHONE_MOB:"Mobile phone",PHYSICAL_BOOKS_LIBRARY_CATALOG:"Physical Books in Library Catalog",PHYSICAL_COPY:"Physical Copy",PICKUP_LOCATION:"Pickup location",PICKUP_LOCATIONS_EMPTY:"Pickup location alternatives unavailable",PIN:"PIN",PIN_FACETS_TOOLTIP:"Pin this menu in place so selecting multiple facets is easier",PLACEHOLDER_TEXT:"Placeholder Text",PLEASE_RELOAD_TO_TRY_AGAIN:"Please reload to try again.",PLEASE_TRY_AGAIN:"Please try again.",POWERED_BY:"Powered by",PREVIEW:"Preview",PREVIEW_ENV_ERROR:"Preview Site",PREVIEW_ENV_ERROR_MSG:"<strong>Preview is not a production site.</strong><br>If you are seeing this message, the system is currently unavailable due to scheduled maintenance. Please try again later.",PREVIEW_ADVICE:'<strong>Preview is not a production site.</strong><br><a href="https://knowledge.exlibrisgroup.com/Summon/Release_Notes/Summon%3A_Release_Preview_Environment" target="_blank">Click here for details on the Preview environment</a>',PREVIEW_SCOPE_RESULTS:"Preview scope results",PREVIOUS_PAGE:"Previous",PREVIOUS_RESULT:"Previous result",PRINT:"Print",PRINT_CITATION:"Print citation",PROVIDER:"Provider",PROQUEST_REFWORKS:"ProQuest RefWorks",PUB_DATE:"Publication date",PUB_DATE_RANGE:"Publication date range",PUB_DATE_RANGE_FROM:"Publication date range from",PUB_DATE_RANGE_TO:"Publication date range to",PUBLIC_NOTES:"Public Notes",PUBLICATION_TITLE:"Publication Title",PUBLISHER:"Publisher",QUESTION_FROM_CHAT_DIALOG:"Question from Chat Dialog",QUICK_LOOK:"Quick Look",QUICKFILTER_REMOVE_OTHER_X:'To apply, remove facet: "%{facet}"',READ_MORE:"Read more",READING_HISTORY:"Reading History",READING_HISTORY_INACTIVE:"You have opted out from Reading History",READING_HISTORY_DELETE_SELECTED:"Delete %{count} selected entries",READING_HISTORY_DELETION_ERROR:"An error occurred deleting the entry, try again later",READING_HISTORY_DELETION_ERROR_ALL:"An error occurred deleting the entries, try again later",READING_HISTORY_DELETION_SOME_ERROR:"An error occurred deleting %{number} loan(s), try again later",READING_HISTORY_DELETION_SUCCESS:"Entry successfully deleted",READING_HISTORY_DELETION_SUCCESS_ALL:"All selected entries successfully deleted",READING_HISTORY_EMPTY:"You have no reading history yet",READING_HISTORY_ERROR:"There was an error retrieving your reading history: %{error}",READING_HISTORY_OPT_IN_ERROR:"An error occurred in processing request to opt in, try again later",READING_HISTORY_OPT_OUT_ERROR:"An error occurred in processing request to opt out, try again later",READING_HISTORY_OPT_OUT:"Opt out from history",READING_HISTORY_OPT_OUT_SUCCESS:"Successfully opted out from reading history and deleted it",RECOMMENDED_RESEARCH_GUIDES:"Recommended Research Guides",RECORD_DETAILS:"Record Details",REFERENCE_RESULTS_FOR:"Reference results for",REFINE_PANE:"Refine Pane",REFINE_SEARCH:"Refine your search",REFWORKS:"RefWorks",REFWORKS_LOG_IN:"RefWorks Log In",RELATED_ARTICLES:"Related Articles",RELATED_TOPICS:"Related Topics",RELEVANCE:"Relevance",RELOAD_AVAILABILITY:"Reload Availability",REMEMBER_TO_SIGN_OUT:"Remember to sign out if you are on a public computer.",REMOVE:"Remove",REMOVE_EXCLUSION_FILTER:"Remove exclude %{filter} filter",REMOVE_FILTER:"Remove %{filter} filter",REMOVE_THIS_ITEM:"Remove this item",REMOVING_THIS_ITEM:"Removing this item",RENAME:"Rename",RENEW:"Renew",REQUEST:"Request",REQUEST_RTA:"Request item",REQUEST_DATE:"Request date",REQUEST_NOT_ALLOWED:"This item cannot be requested",REQUEST_CHECK_ALLOWED:"Checking if item can be requested...",REQUESTED_ON:"Requested on",REQUESTS:"Requests",REQUESTS_COUNT:"Requests (%{count})",REQUESTS_EMPTY:"You have no requests",REQUESTS_MAY_NOT_BE_UP_TO_DATE:"An item was recently requested, but it is not in this list yet. Please check again in about a minute.",REQUESTS_ERROR:"There was an error retrieving your requests: %{error}",REQUESTS_CANCEL_SELECTED:"Cancel %{count} selected holds",REQUESTS_CANCEL_SUCCESS:"Hold successfully canceled",REQUESTS_CANCEL_ERROR:"An error occurred canceling the hold, try again later",REQUESTS_CANCEL_SOME_ERROR:"An error occurred canceling %{number} hold(s), try again later",REQUESTS_CANCEL_ERROR_404:"The hold could not be found and  might already be canceled.",REQUESTS_CANCEL_SUCCESS_ALL:"All holds successfully canceled",REQUEST_BOOK:"Request book",REQUEST_HOLD_CREATED:"Your request has been created",REQUEST_HOLD_FAILED:"Request failed. %{reason}",REQUEST_HOLD_UPDATED:"Your hold has been updated",REQUEST_ERROR_UNKNOWN:"Unknown error",TO_CONTINUE_ACCESS_THROUGH_YOUR_INSTITUTION:"To continue, access through your institution",REQUIRED:"Required",RESEARCH_ASSISTANT:"Research Assistant",RESEARCH_ASSISTANT_FEATURE:"Research Assistant",RESEARCH_ASSISTANT_FEATURE_DESCRIPTION:"Authenticate in order to access Research Assistant new feature",RESERVE:"Reserve",RESULT_ITEM:"Result Item",RESULTS_COLOR:"Results Color",RESULTS_FOR:"Results for ",RESULTS_IN_POPUP:"Results in Popup",RESULTS_COUNT:"%{count} results",RESULTS_COUNTER:"%{current} of %{total} results",RESULTS_COUNTER_MOBILE:"%{current} of %{total}",RESULTS_COUNT_ABOUT:"About %{count} results",RESULTS_SORTED_BY_LINK:"Sorted by %{linkStart}%{sortValue}%{linkEnd}",REVIEWS:"Reviews",REVIEWS_AND_CHAPTERS:"Reviews and Chapters",REVEAL_FIELD_INSTRUCTIONS:"Add or change %{field}",ROLE:"Role",ROLLUP_IMAGE:"Rollup Image",RSS_FEED_FOR_RESULTS:"RSS 2.0 feed for current search",SAVE:"Save",SAVE_FOR_THIS_VISIT:"Save for this visit only",SAVE_FLOW_ERROR:"The document(s) you have selected failed to save to RefWorks.",SAVE_FLOW_ERROR_AUTH:"Your session has expired, please <em>Log in</em> again.",SAVE_SEARCH:"Save Search",SAVE_SEARCH_DUPLICATED:"This search already exists",SAVE_SEARCH_AND_ITEM:"Save Search and Save Item",SAVE_SEARCH_DESCRIPTION:"Save your search and store them in the cloud, you can retrieve them on any computer where you can log in.",SAVE_THIS_ITEM:"Save this item",SAVE_THIS_SEARCH:"Save current search and filters",SAVED_ITEMS:"Saved Items",SAVED_ITEMS_DIALOG:"Saved Items Dialog",SAVED_SEARCHES:"Saved Searches",SAVED_SEARCHES_DIALOG:"Saved Searches Dialog",SAVED_SEARCHES_LIMIT:"You have reached the Saved Searches limit. Please remove any unused Saved Searches before saving more.",SAVING_THIS_ITEM:"Saving this item",SCHOLARLY_PEER_REVIEW:"Scholarly & Peer-Reviewed",SCHOLARLY_MATERIALS:"Scholarly materials, including peer-reviewed",SCOPUS:"Scopus",SEARCH:"Search",SEARCH_BUTTON_TEXT:"Search Button Text",SEARCH_FIELD:"Search field ",SEARCH_FOR_X_RETURNED_0:"Your search for %{query} returned 0 results",SEARCH_INSTEAD_FOR:"Search instead for",SEARCH_LOGIC:"Search logic ",SEARCH_MODIFIER:"Search modifier ",SEARCH_NAME:"Search name",SEARCH_OPTIONS:"Search Options",SEARCH_QUERY_HELP:"Search Query Help",SEARCH_RESULTS:"Search Results",SEARCH_RESULTS_FORMAT:"Search Results Format",SEARCH_RESULTS_FORMAT_ALT:"As shown on search results",SEARCH_SAVED_FOR_SESSION:"Search saved for this session",SEARCH_SAVED:"Search saved",SEARCH_SCOPE_TITLE:"Collections to search for",SEARCH_VALUE:"Search value ",SEARCH_WITHIN:"Search within",SEARCH_WITHIN_JOURNAL:"Search within journal",SECONDARY_SEARCH_TITLE:"%{secondary} Search",SECONDARY_SEARCH_MESSAGE:"Search here to find records at %{secondary}.",SECONDARY_RESULTS_MESSAGE:"Showing %{max} of %{count} <a href='%{url}' target='_blank'>%{secondary}</a> results:",SECTION:"Section",SEE_ALL_X:"See all (%{x})",SELECT_ALL:"Select all %{count}",SELECT_MULTIPLE_FACETS:"Select multiple facets before refreshing results",SELECT_NONE:"Deselect all",SELECT_PHONE_TYPE:"Select phone type",SELECT_PICKUP_LOCATION:"Select pickup location (required)",SELECT_WIDET_TYPE_NOTICE:"Once youâ€™ve formatted your default search the way you like, click on &quot;Select Widget Type&quot; on the process flow at the top of the page. This will return you to this widget builder page with your formatted search ready for use.",SELECT_WIDGET_TYPE:"Select Widget type",SELECTED:"Selected",SELECTED_COUNT:"%{count} selected",SELECTED_ITEM:"(Selected item)",SEND:"Send",SEND_EMAIL:"Send Email",SEND_EMAIL_TO:"Send email to",SEND_EMAIL_FROM:"From",SEND_ME_COPY_OF_EMAIL:"Send me a copy of this email",SEND_TO:"Send to",SHARE_ACTIONS:"Share",SHARE_MESSAGE_X_X_MESSAGE_URL:'I found "%{message}" via %{url}',SHARE_MESSAGE_X_MESSAGE:'I found "%{message}"',SHARE_WITH_PROVIDER_X:"Share with %{service}",SHOW:"Show",SHOWING_RESULTS_FOR:"Showing results for",SHOW_ONLY:"Show only",SIGN_IN_WITH_CLOUD_STORAGE:"Sign in with the cloud storage provider of your choice",SIGN_IN:"Sign in",SIGN_IN_TO_CONTINUE:"Sign in to continue",SIGN_IN_TO_SAVE_PERMANENTLY:"Sign in to save permanently",SIGN_IN_WITH_X:"Sign in with %{x}",SIGN_OUT:"Sign out",SIGN_OUT_FROM_X:"Sign out from %{x}",SIGN_OUT_FROM_X_CONFIRM:"You have signed out from %{x}. Remember to close your %{x} session if on a shared computer.",SIGN_OUT_OF_X:"Sign out of %{x}",SIGN_UP_FREE:"Sign up (free)",SIGNED_IN_AS:"Signed in as",SIGNED_IN:"Signed in",SIGNED_IN_WITH:"Signed in with %{provider}",STREAMING_VIDEO:"Streaming video",SUBJECTS:"Subjects",SUBJECT_TERMS:"Subject Terms",SUBJECT_KEYWORDS:"Subject Keywords",LEAVE:"Leave",LOGGED_OUT_SUCCESS:"You have logged out successfully",LOGGED_OUT_FORCED:"You are logged out automatically",LOGGED_OUT_FORCED_DUE:'You are logged out automatically because "%{reason}"',LOGGED_OUT_ALREADY:"You are already logged out.",LOG_IN:"Log in",LOG_IN_OUT:"Log in/out",LOG_IN_EXPIRED:"Your session has expired...",LOG_IN_MISSING_PERMISSIONS_GOOGLE_ONLY:"To save your searches or items, give access to Google Drive.",LOG_IN_MISSING_PERMISSIONS:"To save your searches or items, allow access to Google Drive",LOG_IN_SUCCESS:"Logged in successfully",LOG_OUT:"Log out",LOGOUT_SUMMON_OR_PROVIDER:"Log out of Summon only, or log out everywhere for %{provider}",LOGOUT_EVERYWHERE:"Everywhere",LOGOUT_EVERYWHERE_LINK_X:"Log out everywhere for %{provider}",LOGOUT_SUMMON_ONLY:"Summon only",OPTIONS:"Options",SKIP_TO_CONTENT:"Skip to main content",SORT_ALPHA:"Sort Alphabetically",SORT:"Sort",SORT_BY:"Sort by",SORT_BY_ALPHABET:"Alphabetically",SORT_BY_NEWEST_DATE:"Sort by newest date",SORT_BY_OLDEST_DATE:"Sort by oldest date",SORT_BY_RANK:"Sort by Rank",SORT_BY_RELEVANCE:"Sort by relevance",SORT_BY_RESULT_COUNT:"Number of results",SORT_BY_SELECTED:"Included and excluded",SORT_ORDER:"sortOrder",SORT_BY_AUTHOR:"Sort by author",SORT_BY_TITLE:"Sort by title",SOURCE:"Source",SORRY_UNABLE_RETRIEVE_RECOMMENDATIONS:"Sorry we were unable to retrieve recommendations at this time",START_WHATSAPP_CHAT:"Start WhatsApp Chat",STATUS:"Status",SUGGESTED_BY:"suggested by",SUGGESTED_LIBRARIAN:"Suggested Librarian",SUGGESTIONS:"Suggestions",SUGGESTIONS_TO_IMPROVE_SEARCH:"Here are some suggestions to improve your search",SUMMON:"Summon",TAG_LINE:"Tag Line",TAG_LINE_COLOR:"Tag Line Color",TAG_LINE_TEXT:"Tag Line Text",TITLE:"Title",TITLE_COLOR:"Title Color",TITLE_TEXT:"Title Text",TITLE_LINK:"Title Link",DEFAULT_THUMBNAIL_URL:"Default Thumbnail URL",SEARCH_URL:"Search URL",SEARCH_CAROUSEL_WIDTH:"Search Carousel Width",SEARCH_CAROUSEL_RESULT_LIMIT:"The carousel will display the top 10 results from the search",TITLE_FONT_WEIGHT:"Title Font Weight",TITLE_FONT_SIZE:"Title Font Size",DESCRIPTION_FONT_COLOR:"Description Font Color",DESCRIPTION_FONT_WEIGHT:"Description Font Weight",DESCRIPTION_FONT_SIZE:"Description Font Size",IMAGE_HEIGHT:"Image Height",BULLET_SPACING:"Bullet Spacing",TO_DATE:"To date, Format %{formatToDisplay}",FROM_DATE:"From date, Format %{formatToDisplay}",TO_BEGIN_CREATE_BLANK_SEARCH:"To begin, create a blank search, applying any facets or limiters youâ€™d like to be default for your search widget.",TO_PREVIEW_WIDGET:"To preview a widget you must %{linkStart}select a widget type%{linkEnd}",TO_SHOW_CODE_FOR_WIDGET:"To show the code for a widget you must %{linkStart}select a widget type%{linkEnd}",TO_SHOW_OPTIONS_FOR_WIDGET:"To show options for a widget you must %{linkStart}select a widget type%{linkEnd}",TO_CREATE_SEARCH_FOR_WIDGET:"To create a search for a widget you must %{linkStart}select a widget type%{linkEnd}",TOPIC:"topic",TOPIC_SUMMARY:"Topic Summary",TOTAL:"Total $%{total}",TRACK_HISTORY:"Track My Reading History",TRY_ANOTHER_SEARCH:"Don't see what you are looking for? Try one of these searches",TRY_INCLUDE_SOURCE_OUTSIDE_LIBRARY_COLLECTION:"Try %{linkStart}including sources outside of the library's collection%{linkEnd}",TRY_SEARCHING_ALL:"Try %{linkStart}searching All%{linkEnd}",TYPE:"Type",TYPE_OF_FEEDBACK:"Type of feedback",USE_EMAIL_TO_SEND_QUESTION:"Please use the email tab to send us your question.",VIEW_ALL_SELECTED:"View All Selected",VIEW_LESS:"View Less",VIEW_SAVED:"View Saved",VIEW_IN_CLASSIC_CATALOG:"View in classic catalog",VIEW_CITATION_PATH:"View your citation path",VIEW_DELIVERY_OPTIONS:"View Delivery Options",VIEW_IN_EPORTAL:"View in E-Journal Portal",VIEW_SAVED_ITEM_COUNT:"View saved %{count} item",VIEW_SAVED_ITEMS_COUNT:"View saved %{count} items",VIEW_SAVED_SEARCH_COUNT:"View saved %{count} search",VIEW_SAVED_SEARCHES_COUNT:"View saved %{count} searches",VOLUME:"Volume",VOL:"Vol",WHAT_SEARCHING_FOR:"What are you searching for?",WEB_OF_SCIENCE:"Web of Science",WEB_OF_SCIENCE_CITATIONS:"Web of Science Citations",WHY_IS_RESULT_HERE:"Why is this result here?",WIDGET_BUILDER:"Widget Builder",YEAR:"Year",YES:"Yes",YOU_ARE_LEAVING_SCOPE:"You are about to leave",YOUR_EMAIL:"Your Email",YOUR_MESSAGE:"Your Message",YOUR_QUERY_MATCHED_INDEXED_FULL_TEXT:"Your query matched the indexed full text of this document.",ZOTERO:"Zotero",FEWER_SEARCH_OPTIONS:"Fewer search options",MORE_SEARCH_OPTIONS:"More search options",COPIES:"Copies",INCLUDE_MATCHES_IN_FULL_TEXT:"Include matches in Full Text",INCLUDE_MATCHES_IN_FULL_TEXT_NO_RESULTS:"Try %{linkStart}including matches in Full Text%{linkEnd}",COMBINE_INCLUDE_MATCHES_IN_FULL_TEXT_AND_DISABLE_RESULTS_BEYOND_COLLECTION:"Try %{linkStart}searching everything (sources outside the library collection and full text)%{linkEnd}"})},9991:()=>{"use strict";angular.module("summonApp.constants").constant("$summonLanguages",["Afrikaans","Albanian","Amharic","Ancient Greek","Arabic","Aramaic","Armenian","Basque","Belarusian","Bengali","Bosnian","Breton","Bulgarian","Burmese","Catalan","Chinese","Church Slavic","Croatian","Czech","Danish","Dutch","English","Esperanto","Estonian","Finnish","French","Gaelic","Galician","Georgian","German","Greek","Gujarati","Haitian","Hebrew","Hindi","Hungarian","Icelandic","Indonesian","Irish","Italian","Japanese","Javanese","Kannada","Kazakh","Korean","Kurdish","Latin","Latvian","Lithuanian","Macedonian","Malay","Malayalam","Manx","Marathi","Mongolian","Ndonga","Nepali","Norwegian","Norwegian BokmÃ¥l","Occitan","Ojibwa","Old English","Old French","Oriya","Ottoman","Pali","Panjabi","Persian","Polish","Portuguese","Prakrit","Pushto","Quechua","Rajasthani","Romanian","Russian","Sanskrit","Serbian","Sinhala","Slavic","Slovak","Slovenian","Spanish","Swahili","Swedish","Syriac","Tagalog","Tamil","Telugu","Thai","Tibetan","Turkish","Ukrainian","Urdu","Vietnamese","Welsh","Yiddish","Zulu"])},8861:()=>{"use strict";angular.module("summonApp.constants").constant("$reCAPTCHALangs",{"ar-AR":"ar","br-PT":"pt-BR","ca-ES":"ca","cs-CZ":"cs","da-DK":"da","de-DE":"de","en-AU":"en-GB","en-NZ":"en-GB","en-UK":"en-GB",en:"en","es-ES":"es","fa-FA":"fa","fi-FI":"fi","fr-CA":"fr-CA","fr-FR":"fr","gb-CY":"en-GB","gr-GR":"el","he-HE":"iw","is-IS":"is","it-IT":"it",jp:"ja","ko-KO":"ko","mi-NZ":"en-GB","ms-MY":"ms","nl-NL":"nl","no-NO":"no",pl:"pl","pt-PT":"pt","ru-RU":"ru","sv-SE":"sv","th-TH":"th","tu-TU":"tr","za-CN":"zh-TW","zh-CN":"zh-CN"})},225:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a){this.setSelection=this.setSelection.bind(this),this.retrieveSince=this.retrieveSince.bind(this),this.clear=this.clear.bind(this),this.resetValidity=this.resetValidity.bind(this),this.$scope=e,this.dateRange=t,this.translationService=i,this.advancedSearch=a,this.$scope.range=this.dateRange.range,this.$scope.selection=s.clone(this.dateRange.selection),this.$scope.setSelection=this.setSelection,this.$scope.retrieveSince=this.retrieveSince,this.$scope.clear=this.clear,this.$scope.datePresets=this.dateRange.defaultPresets,this.$scope.datePresetLabels=this.dateRange.datePresetLabels,this.$scope.i18n=this.translationService,this.advancedSearch.on("clearDate",(e=>this.clear(null,e))),this.advancedSearch.on("reflectDate",(e=>{this.reflectOnDemand(e)})),this.dateRange.on("setAdvancedSelection",(e=>{this.setSelection(e)}))}setSelection(e){return this.$scope.selection.start=e.start,this.$scope.selection.end=e.end,this.$scope.selection.selectedYears=e.selectedYears,this.advancedSearch.setDateSelection(e)}retrieveSince(e,t){t.preventDefault();const i=this.advancedSearch.scope.newSearchScope||this.advancedSearch.scope.searchScope,s=this.advancedSearch.scope.searchScopeParams,a=(t=!1)=>{if(!t){const t=this.dateRange.retrieveSince(e);t.selectedYears=e,this.setSelection(t),this.resetValidity()}};this.dateRange.checkForSearchScope(i,s,a)||a()}clear(e,t=!1){e&&e.preventDefault();const i=this.advancedSearch.scope.newSearchScope||this.advancedSearch.scope.searchScope,s=this.advancedSearch.scope.searchScopeParams;if(t||!this.dateRange.checkForSearchScope(i,s))return this.setSelection({start:null,end:null,selectedYears:null}),this.resetValidity()}reflectOnDemand(e){let t=null,i=null;const a=s(e.rf).find((e=>0===e.indexOf("PublicationDate"))),r=new Date;if(a){const e=a.split(",")[1].replace(/\-/g,"/");[t,i]=e.split(":").map((function(e){return"*"!==e?new Date(e):null}))}const n=this.dateRange.determinePresetSelectedYears(t,i);this.setSelection({start:t,end:null===i?new Date(r.setHours(0,0,0,0)):i,selectedYears:n})}resetValidity(){if(this.$scope.advancedSearchForm)return this.$scope.advancedSearchForm.facetDatePicker.sliderFrom.$setValidity("parseDate",!0),this.$scope.advancedSearchForm.facetDatePicker.sliderTo.$setValidity("parseDate",!0)}}a.$inject=["$scope","dateRangeService","translationService","advancedSearchService"],angular.module("summonApp.controllers").controller("AdvancedDatepickersCtrl",a)},6964:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){this.$scope=e,this.advancedSearch=t,this.config=i,this.translationService=s,this.appState=a,this.datepicker=r,this.searchScopeService=n,this.$scope.advanced=this.advancedSearch.scope,this.$scope.advanced.config=this.config.data.advancedSearch,this.$scope.advanced.addCustomField=this.advancedSearch.addCustomField,this.$scope.advanced.removeCustomField=this.advancedSearch.removeCustomField,this.$scope.advanced.removeFacets=this.advancedSearch.removeFacets,this.$scope.advanced.selectionsOnChg=this.advancedSearch.selectionsOnChange,this.$scope.advanced.getContentTypes=this.advancedSearch.getContentTypes,this.$scope.advanced.getDisciplines=this.advancedSearch.getDisciplines,this.$scope.advanced.getLanguages=this.advancedSearch.getLanguages,this.$scope.advanced.readableSelectedContentTypes=this.translationService.translations.ANY_TYPE,this.$scope.advanced.readableSelectedDisciplines=this.translationService.translations.ANY_TYPE,this.$scope.advanced.readableSelectedLanguages=this.translationService.translations.ANY_TYPE,this.$scope.advanced.hasMaxCustomRows=this.advancedSearch.hasMaxCustomRows,this.$scope.advanced.syncWithState=this.advancedSearch.syncWithState,this.$scope.advanced.updateSearchScope=this.advancedSearch.updateSearchScope,this.$scope.i18n=this.translationService,this.$scope.$watch("advanced.selectedSummary",(e=>{const t=parseInt($(".clearRefinementsContainer").height());return isNaN(t)?document.documentElement.style.setProperty("--advanced-selected-facets-height","0px"):document.documentElement.style.setProperty("--advanced-selected-facets-height",t+"px")}),!0)}}e.$inject=["$scope","advancedSearchService","configService","translationService","appStateService","datepickerService","searchScopeService"],angular.module("summonApp.controllers").controller("AdvancedSearchCtrl",e)},2923:()=>{"use strict";class e{constructor(e,t,i,s,a){this.clearAdvancedSearchForm=this.clearAdvancedSearchForm.bind(this),this.submitAdvancedSearch=this.submitAdvancedSearch.bind(this),this.$scope=e,this.$uibModalInstance=t,this.advancedSearch=i,this.dialogService=s,this.$location=a,this.$scope.closeAdvancedSearch=this.closeAdvancedSearch,this.$scope.clearAdvancedSearchForm=this.clearAdvancedSearchForm,this.$scope.submitAdvancedSearch=this.submitAdvancedSearch}$onInit(){return this.$scope.searchScopeService.hasSearchScopes&&this.advancedSearch.resetSearchscope(),this.$uibModalInstance.result.then((e=>this.$scope.viewState.subView="")).catch((e=>this.$scope.viewState.subView=""))}clearAdvancedSearchForm(e){return e.preventDefault(),this.advancedSearch.clear(),angular.element("#searchValue0").focus()}submitAdvancedSearch(){this.$scope.viewState.currentView="search",this.$scope.resetNewSearchFlag(),this.dialogService.closeModalDialog(),this.$location.$$path.includes("/search")||this.$location.path("/search"),this.advancedSearch.submit()}}e.$inject=["$scope","$uibModalInstance","advancedSearchService","dialogService","$location"],angular.module("summonApp.controllers").controller("AdvancedSearchModalCtrl",e)},1118:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c,h,d,u,p,m,g,v,S,f,b,y,_,E,A,C,T,I,R,w,L,k,D,P,O,F,N,x,M,U,B,H){var q;this.setWindowTitle=this.setWindowTitle.bind(this),this.setRetainState=this.setRetainState.bind(this),this.initFlow=this.initFlow.bind(this),this.itemSaveCompletionFlow=this.itemSaveCompletionFlow.bind(this),this.initSavedSearch=this.initSavedSearch.bind(this),this.initSavedItems=this.initSavedItems.bind(this),this.initLoadingIndicators=this.initLoadingIndicators.bind(this),this.handleApiEvents=this.handleApiEvents.bind(this),this.handleApiError=this.handleApiError.bind(this),this.rollback=this.rollback.bind(this),this.excludeHoldingsOnly=this.excludeHoldingsOnly.bind(this),this.issueNewSearch=this.issueNewSearch.bind(this),this.searchAll=this.searchAll.bind(this),this.clearRefinements=this.clearRefinements.bind(this),this.getIncludeFTParamOnClear=this.getIncludeFTParamOnClear.bind(this),this.unroll=this.unroll.bind(this),this.fieldSearch=this.fieldSearch.bind(this),this.multipleFieldSearch=this.multipleFieldSearch.bind(this),this.expandQueryWithSubjectTermsCombined=this.expandQueryWithSubjectTermsCombined.bind(this),this.setNewSearchState=this.setNewSearchState.bind(this),this.newSearch=this.newSearch.bind(this),this.disableEnhancedDidYouMean=this.disableEnhancedDidYouMean.bind(this),this.querySuggestion=this.querySuggestion.bind(this),this.clearJournalTitle=this.clearJournalTitle.bind(this),this.openJournalTitle=this.openJournalTitle.bind(this),this.openDetailPage=this.openDetailPage.bind(this),this.toggleQuickLook=this.toggleQuickLook.bind(this),this.toggleJournalCoverageDetails=this.toggleJournalCoverageDetails.bind(this),this.openClickTrackLink=this.openClickTrackLink.bind(this),this.disableQueryExpansion=this.disableQueryExpansion.bind(this),this.sortResults=this.sortResults.bind(this),this.resetNewSearchFlag=this.resetNewSearchFlag.bind(this),this.displayDialog=this.displayDialog.bind(this),this.routeRequest=this.routeRequest.bind(this),this.showLibraryCard=this.showLibraryCard.bind(this),this.switchTab=this.switchTab.bind(this),this.applyFTMatchesAndDisableBeyondHolding=this.applyFTMatchesAndDisableBeyondHolding.bind(this),this.applyIsIncludeFtMatchesNoResults=this.applyIsIncludeFtMatchesNoResults.bind(this),this.isbulkExportAllowed=this.isbulkExportAllowed.bind(this),this.showSearchPagination=this.showSearchPagination.bind(this),this.$scope=e,this.appState=t,this.docDetail=i,this.$route=s,this.$routeParams=a,this.$location=r,this.config=n,this.utilities=o,this.metrics=l,this.events=c,this.facets=h,this.flowService=d,this.advancedSearch=u,this.$timeout=p,this.dialogService=m,this.$q=g,this.urlRewriter=v,this.localizationService=S,this.$window=f,this.$document=U,this.$broadcastTypes=b,this.alertService=y,this.viewStateService=_,this.menuManager=A,this.translationService=C,this.externalPlugins=I,this.journalTitleService=R,this.savedSearch=w,this.savedItems=L,this.cloudStorage=k,this.authenticationService=D,this.sierraService=P,this.mediaQueryService=O,this.searchScopeService=M,this.$authEvents=F,this.$log=N,this.$uibModal=x,this.urlService=B,this.$scope.excludeHoldingsOnly=this.excludeHoldingsOnly,this.$scope.applyFTMatchesAndDisableBeyondHolding=this.applyFTMatchesAndDisableBeyondHolding,this.$scope.applyIsIncludeFtMatchesNoResults=this.applyIsIncludeFtMatchesNoResults,this.$scope.clearRefinements=this.clearRefinements,this.$scope.unroll=this.unroll,this.$scope.fieldSearch=this.fieldSearch,this.$scope.multipleFieldSearch=this.multipleFieldSearch,this.$scope.newSearch=this.newSearch,this.$scope.disableEnhancedDidYouMean=this.disableEnhancedDidYouMean,this.$scope.querySuggestion=this.querySuggestion,this.$scope.clearJournalTitle=this.clearJournalTitle,this.$scope.openJournalTitle=this.openJournalTitle,this.$scope.openDetailPage=this.openDetailPage,this.$scope.toggleQuickLook=this.toggleQuickLook,this.$scope.toggleJournalCoverageDetails=this.toggleJournalCoverageDetails,this.$scope.loadNextQuickLook=this.loadNextQuickLook,this.$scope.openClickTrackLink=this.openClickTrackLink,this.$scope.setWindowTitle=this.setWindowTitle,this.$scope.setRetainState=this.setRetainState,this.$scope.disableQueryExpansion=this.disableQueryExpansion,this.$scope.sortResults=this.sortResults,this.$scope.showLibraryCard=this.showLibraryCard,this.$scope.switchTab=this.switchTab,this.$scope.isbulkExportAllowed=this.isbulkExportAllowed,this.$scope.showSearchPagination=this.showSearchPagination,this.$scope.displayLibraryCardMenu=this.config.data.libraryCard.displayLibraryCard,this.$scope.authenticationService=this.authenticationService,this.$scope.loggedIn=this.authenticationService.scope.loggedInStatusForBanner,this.$scope.loggedInUser=this.authenticationService.scope.usernameForBanner,this.$scope.retainState=!1,this.$scope.okToRollback=!1,this.$scope.error={},this.$scope.currentScreenSize=this.mediaQueryService.current.size,this.$scope.displayDialog=this.displayDialog.bind(this),this.$scope.textDirection=this.localizationService.localization.dir,this.$scope.docDetail=this.docDetail,this.$scope.viewState=this.viewStateService,this.$scope.appState=this.appState,this.$scope.i18n=this.translationService,this.$scope.citationValues=T,this.$scope.issueNewSearch=this.issueNewSearch,this.$scope.searchAll=this.searchAll,this.$scope.resetNewSearchFlag=this.resetNewSearchFlag,this.$scope.newSearchInfo={isNewSearch:!1,firstLoad:!0},this.$scope.closeAllMenuTypeSubMenu=this.menuManager.closeAllMenuTypeSubMenu,this.$scope.closeAllMenuTypeMenu=this.menuManager.closeAllMenuTypeMenu,this.$scope.menu=this.menuManager.menu,this.$scope.subMenu=this.menuManager.subMenu,this.$scope.areAllMenuTypeMenuClosed=this.menuManager.areAllMenuTypeMenuClosed,this.$scope.areAllMenuTypeSubMenuClosed=this.menuManager.areAllMenuTypeSubMenuClosed,this.$scope.isResearchAssistantEnabled=H.isResearchAssistantEnabled,this.$scope.clickTrackLinkForm={action:"/2.0.0/link",linkData:""},this.$scope.advancedEnabled=this.config.data.advancedSearch.enabled,this.$scope.savedSearchEnabled=this.config.data.savedSearchAndItems.searchEnabled,this.$scope.displayAZSearchBlock=this.config.data.widgets.enableAZSearchWidget,this.$scope.displaySecondarySearch=null!=this.config.data.widgets.secondaryClient,this.$scope.isPreviewEnv="preview"===this.config.data.env.value,this.$scope.showPreviewBanner=!0,this.$scope.closePreviewBanner=()=>this.$scope.showPreviewBanner=!1,this.$scope.nonExactResultCount=this.config.data.search.nonExactResultCount,this.$scope.allowDownloadSearchResults=(null===(q=this.config.data.bulkExport)||void 0===q?void 0:q.enabled)||!1,this.$scope.vpnBanner={href:()=>{const e=this.config.data.vpnBanner,t=this.$location.absUrl();return e.bannerUrl?e.bannerUrl:this.utilities.proxify(t,e.proxy,!0)},text:this.translationService.translate(this.config.data.vpnBanner.text),authenticated:this.config.data.vpnBanner.authenticated||this.authenticationService.isLoggedIntoSummonApi(),enabled:this.config.data.vpnBanner.enabled,useSamlAuth:this.authenticationService.scope.useSamlForSearchApiAuth,loginWithSaml:this.authenticationService.loginToSummonWithSaml},this.$scope.rssLink=()=>"/rss?"+$.param(this.$routeParams),this.$scope.enableRssLink=()=>{const e=this.$routeParams.q;return this.config.data.results.showRss&&"*"!==e&&""!==e},this.setWindowTitle(),this.initLoadingIndicators(),this.initFlow(),this.initSavedSearch(),this.initSavedItems(),this.$scope.$on("uib:modal.opening",((e,t)=>document.documentElement.style.setProperty("--scrollbar-width",window.innerWidth-document.documentElement.offsetWidth+"px"))),this.$scope.$on("$routeChangeSuccess",this.routeRequest),this.$scope.$watch("authenticationService.scope.loggedInStatusForBanner",((e,t)=>this.$scope.loggedIn=e)),this.$scope.$watch("authenticationService.scope.usernameForBanner",((e,t)=>this.$scope.loggedInUser=e)),this.authenticationService.scope.useSamlForSearchApiAuth&&!this.config.data.vpnBanner.authenticated&&this.$scope.$watch("authenticationService.scope.auth.saml.loggedIn",((e,t)=>this.$scope.vpnBanner.authenticated=this.authenticationService.isLoggedIntoSummonApi())),this.config.data.authentication.ltiConfigurationExists&&!this.config.data.vpnBanner.authenticated&&this.$scope.$watch("authenticationService.scope.auth.lti.loggedIn",((e,t)=>this.$scope.vpnBanner.authenticated=this.authenticationService.isLoggedIntoSummonApi())),this.$scope.$on("$destroy",(()=>{this.savedSearch.off("getSearches",this.$scope.$id),this.savedItems.off("getSavedItems",this.$scope.$id),this.flowService.off("itemSaveCompletion",this.itemSaveCompletionFlow)})),this.urlRewriter.rewrite()}setWindowTitle(e){return e=e?e+" - ":"",this.$scope.windowTitle=document.title=this.utilities.removeHithighlightTags(e+this.config.data.head.title)}setRetainState(e){return this.$scope.retainState=e}initFlow(){if(this.flowService.on("itemSaveCompletion",this.itemSaveCompletionFlow),this.flowService.configs.enabled)return this.flowService.getProfile()}itemSaveCompletionFlow(e){const t=e.errorMessage||"";if(t)return t.indexOf("access_token_invalid")>-1?(this.flowService.getProfile(),this.$scope.error.message=this.$scope.i18n.translations.SAVE_FLOW_ERROR_AUTH):this.$scope.error.message=this.$scope.i18n.translations.SAVE_FLOW_ERROR,this.displayDialog("error")}initSavedSearch(){return this.savedSearch.on("getSearches",this.$scope.$id,(e=>{if(e instanceof Error)return this.alertService.setAlert("savedSearchError",e.message)}))}initSavedItems(){return this.savedItems.on("getSavedItems",this.$scope.$id,(e=>{if(e instanceof Error)return this.alertService.setAlert("savedItemsError",e.message)}))}initLoadingIndicators(){return this.$scope.$on("apiRequest",((e,t)=>t.types.includes(this.$broadcastTypes.newSearch)||"search"!==this.$scope.viewState.currentView?this.$scope.loadingNewSearchIndicator=!0:!t.types.includes(this.$broadcastTypes.search)||this.$scope.feed.loading||this.$scope.loadingNewSearchIndicator?t.types.includes(this.$broadcastTypes.moreFacets)?this.$scope.loadingFacetIndicator=!0:void 0:this.$scope.loadingSearchIndicator=!0)),this.$scope.$on("apiSuccess",this.handleApiEvents),this.$scope.$on("apiCancel",this.handleApiEvents),this.$scope.$on("apiError",this.handleApiError)}handleApiEvents(e,t){this.$scope.okToRollback||"apiSuccess"!==e.name||(this.$scope.okToRollback=!0);const i="apiCancel"===e.name;if(t.types.includes(this.$broadcastTypes.newSearch)&&(i||(this.$scope.loadingNewSearchIndicator=!1)),t.types.includes(this.$broadcastTypes.search)&&(i&&!this.$scope.loadingNewSearchIndicator||(this.$scope.loadingSearchIndicator=!1),this.$scope.feed.loading&&(this.$scope.feed.loading=!1,i&&!this.$scope.loadingNewSearchIndicator&&(this.$scope.loadingSearchIndicator=!0))),t.types.includes(this.$broadcastTypes.moreFacets)&&(this.$scope.loadingFacetIndicator=!1),s.intersection(t.types,[this.$broadcastTypes.search,this.$broadcastTypes.newSearch]).length)return this.externalPlugins.fire({name:"searchResults"},t)}handleApiError(e,t){var i;const{errorObject:a}=t;if(this.handleApiEvents(e,t),s.intersection([this.$broadcastTypes.newSearch,this.$broadcastTypes.search],t.types).length&&(this.$scope.error.message=(null===(i=a.errors)||void 0===i?void 0:i[0].message)||(()=>{switch(a.httpStatus){case 429:return this.$scope.i18n.translations.APP_ERROR_MSG_429;case 400:return this.$scope.i18n.translations.APP_ERROR_MSG_400;default:return this.$scope.isPreviewEnv?this.$scope.i18n.translations.PREVIEW_ENV_ERROR_MSG:this.$scope.i18n.translations.APP_ERROR_MSG}})()),t.types.includes(this.$broadcastTypes.other)||(t.isPageRequest&&400!==a.httpStatus&&!t.types.includes(this.$broadcastTypes.citationTrail)?this.alertService.setAlert("pageRequestError","Results failed to load."):t.types.includes(this.$broadcastTypes.citationTrail)?this.alertService.setAlert("citationTrailError","Citations failed to load."):t.types.includes(this.$broadcastTypes.moreFacets)?this.alertService.setAlert("facetError","More facets failed to load."):t.types.includes(this.$broadcastTypes.contentTypes)?this.alertService.setAlert("contentTypesError","Content types failed to load."):t.types.includes(this.$broadcastTypes.disciplines)?this.alertService.setAlert("disciplinesError","Disciplines failed to load."):t.types.includes(this.$broadcastTypes.languages)?this.alertService.setAlert("languagesError","Languages failed to load."):this.displayDialog(this.$scope.isPreviewEnv?"previewError":"error")),!t.isPageRequest&&!s.intersection([this.$broadcastTypes.moreFacets,this.$broadcastTypes.citationTrail,this.$broadcastTypes.other],t.types).length)return this.$timeout((()=>this.rollback()),400)}rollback(){if(this.$scope.okToRollback&&s.keys(this.appState.paramsSnapShot).length)return this.appState.rollbackState()}excludeHoldingsOnly(){this.appState.applyStateWithSnapShot((()=>{this.appState.params.ho=!1})),this.events.gaPush("refinements","add","expand results")}applyIsIncludeFtMatchesNoResults(){this.appState.applyStateWithSnapShot((()=>{this.appState.params["include.ft.matches"]=!0}))}applyFTMatchesAndDisableBeyondHolding(){this.appState.applyStateWithSnapShot((()=>{this.appState.params.ho=!1,this.appState.params["include.ft.matches"]=!0})),this.events.gaPush("refinements","add","expand results")}issueNewSearch(){this.$scope.newSearchInfo.isNewSearch=!0,this.journalTitleService.clearJournalTitle(),this.advancedSearch.clear(),this.appState.resetParams(),this.appState.applyStateWithSnapShot()}searchAll(){this.appState.applyStateWithSnapShot((()=>{const{params:e}=this.appState;e.searchscope="",this.searchScopeService.setDefaultScope()}))}clearRefinements(){return this.appState.applyStateWithSnapShot((()=>{const{params:e}=this.appState;e.fvf=[],e.pn=1,e.fvfi=[],e.myinst="",e.ho=!0,e.rf=[],e["include.ft.matches"]=this.getIncludeFTParamOnClear(this.config.data.quickFilters),e.searchscope="",delete e.oaf,delete e["print.books.only"],delete e["ebooks.only"]})),this.events.gaPush("refinements","clear","all")}getIncludeFTParamOnClear(e){let t="";return s(null==e?void 0:e.filters).map((e=>{if("include.ft.matches"===e.facet)return t=e.defaultInclusion?"t":"f"})),t}unroll(e){this.appState.applyStateWithSnapShot((()=>{const t={name:"ContentType"};return e.forEach((e=>this.facets.add(t,e)))}))}fieldSearch(e,t,i=!1){"search"===this.$scope.view&&"research_assistant"!==this.$scope.viewState.currentView||this.$location.path("/search"),this.$scope.viewState.currentView="search",this.$scope.closeAllMenuTypeSubMenu();let s=(i?t.split(i).map((e=>e.trim())):[t]).map((t=>`${e}:"${t}"`)).join(" AND ");return"SubjectTerms"===e&&(s=this.expandQueryWithSubjectTermsCombined(s,t)),this.appState.applyStateWithSnapShot((()=>(this.appState.params.q=s,delete this.appState.params.bookMark))),this.events.gaPush("search","field",this.appState.params.q)}multipleFieldSearch(e,t,i=!1){"search"!==this.$scope.view&&this.$location.path("/search"),this.$scope.viewState.currentView="search",this.$scope.closeAllMenuTypeSubMenu();const s=i?e.split(i).map((e=>e.trim())):[e],a=(i?t.split(i).map((e=>e.trim())):[t]).map(((e,t)=>`${s[t]}:"${e}"`)).join(" AND ");return this.appState.applyStateWithSnapShot((()=>(this.appState.params.q=a,delete this.appState.params.bookMark))),this.events.gaPush("search","field",this.appState.params.q)}expandQueryWithSubjectTermsCombined(e,t){return[e,'SubjectTermsCombined:"'+t+'"'].map((e=>"("+e+")")).join(" OR ")}setNewSearchState(e){this.appState.applyStateWithSnapShot((()=>{const{params:t}=this.appState;return t.q=e,delete t.sort}))}newSearch(e){return this.setNewSearchState(e),this.events.gaPush("search","new",e)}disableEnhancedDidYouMean(){this.appState.applyStateWithSnapShot((()=>this.appState.params.edym="f"))}querySuggestion(e){const t=this.appState.params.q;return this.setNewSearchState(e),this.events.publish("actions","query_suggestion:query",{originalQuery:t,query:e}),this.events.gaPush("search","linked",e)}openJournalTitle(e){const t=s.clone(this.appState.params);return t.jt=this.utilities.removeHithighlightTags(this.utilities.summonEscape(e)),t.q="",delete t.sort,"/#!/search?"+this.urlService.urlParamsStringFor(t)}clearJournalTitle(){return this.appState.params.jt="",this.appState.applyState()}openDetailPage(e){return this.$scope.viewState.currentView="detailsPage",this.setWindowTitle(e.title),((null==e?void 0:e.wos)||(null==e?void 0:e.wos_cited_record_id))&&this.events.trackUsage("wos"),this.$scope.docDetail.setDocument(e)}toggleQuickLook(e){return this.$scope.document=e,((null==e?void 0:e.wos)||(null==e?void 0:e.wos_cited_record_id))&&this.events.trackUsage("wos"),this.dialogService.displayModalDialog(this.$scope,"QuickLookCtrl","quick-look","quickLook/quickLook.html")}toggleJournalCoverageDetails(e,t,i=!0){return this.$scope.document=e,this.$scope.isAlmaClient=t,this.dialogService.displayModalDialog(this.$scope,"journalCoverageDetailsController","journal-coverage-details","journalCoverageDetails.html")}openClickTrackLink(e,t){((null==t?void 0:t.wos)||(null==t?void 0:t.wos_cited_record_id))&&this.events.trackUsage("wos");const i=this.$scope.clickTrackLinkForm,s=(()=>{switch(!1){case!e.match(/link\/dbrecommender\//):return"link/dbrecommender/";case!e.match(/link\/topicrec\//):return"link/topicrec/";default:return"link/"}})(),[a,r]=e.split(s);return i.action=a+s.slice(0,-1)+"?t="+Date.now(),i.linkData=r}disableQueryExpansion(){this.appState.applyStateWithSnapShot((()=>this.appState.params.exp=!1))}sortResults(e,t){this.appState.applyStateWithSnapShot((()=>{const{params:i}=this.appState;return i.pn=1,e&&t?(i.sort=`${e}:${t}`,this.events.gaPush("sort","results",i.sort)):(delete i.sort,this.events.gaPush("sort","results","Relevance"))}))}resetNewSearchFlag(){return this.$scope.newSearchInfo.isNewSearch=!1}displayDialog(e,t){const i="string"==typeof t?angular.element(t):t?t.currentTarget:null;return this.dialogService.displayDialog(e,this.$scope,(()=>this.events.publish("actions",`dialog:${e}`))).then((()=>{if(null!=i)return i.focus()}))}routeRequest(e,t,i){let a;if(!this.urlRewriter.urlHasHashBang())return;const r=this.$location.path(),n=s.keys(this.$routeParams).length;if("advanced"===(null==i?void 0:i.action)){const e="/scope_builder/search"===r;this.$scope.search.toggleAdvanced(e)}switch(this.$scope.newSearchInfo.firstLoad&&(this.$scope.newSearchInfo.firstLoad=!1,this.$routeParams.pn&&(this.$routeParams.pn="1")),!0){case"/"===r:return n?(this.$scope.view="search",this.$scope.viewState.currentView="search",this.$location.path("/search").replace()):(this.setWindowTitle(this.$scope.i18n.translations.HOME),this.$scope.savedSearch&&this.$scope.savedSearch.visible&&(this.$scope.savedSearch.visible=!1),this.$scope.view="home",this.$scope.viewState.currentView="home");case"/widgets"===r:return this.setWindowTitle(this.$scope.i18n.translations.WIDGET_BUILDER),this.$scope.view="widgets",this.setRetainState(!1);case/^\/course_reserves(\/{1}.+)?$/.test(r):return this.setWindowTitle(this.$scope.i18n.translations.COURSE_RESERVES),this.$scope.view="course_reserves",this.setRetainState(!1),this.$scope.courseReservesHasRendered=!0;case"/search"===r:return this.$scope.view="search","home"===this.$scope.viewState.currentView&&(this.$scope.viewState.currentView="search"),"research_assistant"===this.$scope.viewState.currentView&&(this.$scope.viewState.currentView="search"),this.$scope.advancedEnabled&&this.$scope.search.advanced&&(this.setRetainState(!0),this.$scope.search.advanced=!1),this.$scope.docDetail&&(this.$scope.docDetail.visible&&(this.$scope.viewState.currentView="search",this.$scope.docDetail.visible=!1),this.docDetail.scope.doc.id)?(this.setRetainState(!0),void this.docDetail.clearDocument()):(this.$scope.saveditems&&this.$scope.saveditems.visible&&(this.$scope.saveditems.visible=!1),this.$scope.savedSearch&&this.$scope.savedSearch.visible&&(this.$scope.savedSearch.visible=!1),n&&!this.$scope.retainState&&this.appState.applyStateFromUrlParams(this.$routeParams),this.setWindowTitle(this.$scope.i18n.translations.RESULTS_FOR+`"${this.$scope.search.query}"`),this.setRetainState(!1));case"/search/document"===r:if(this.$scope.view="search",n&&(a="id",!s.keys(this.$routeParams).includes("id")))return this.$location.path("/search").replace();if(this.$scope.docDetail&&!this.$scope.docDetail.visible&&n)return this.$scope.viewState.currentView="detailsPage",this.appState.applyStateFromUrlParams(this.$routeParams);break;case"/search/debug"===r:case"/search/document/debug"===r:return this.$scope.view="",this.setRetainState(!0);case"/diagnostics"===r:return this.setWindowTitle("Diagnostics"),this.$scope.view="",this.setRetainState(!1);case"/library_card"===r:return this.setWindowTitle(this.$scope.i18n.translations.LIBRARY_CARD),this.$scope.view="library_card",this.$scope.libraryCardHasRendered=!0,this.setRetainState(!1);case"/research_assistant"===r:return this.$scope.isResearchAssistantEnabled?(this.setWindowTitle(this.$scope.i18n.translations.RESEARCH_ASSISTANT),this.$scope.view="search",this.$scope.viewState.currentView="research_assistant",this.$scope.researchAssistantHasRendered=!0,this.setRetainState(!0)):this.$location.path("/search").replace();case"/scope_builder/search"===r:this.$scope.view="search",this.$scope.viewState.currentView="search",this.$scope.viewState.scopeBuilderMode=!0,n&&!this.$scope.retainState&&this.appState.applyStateFromUrlParams(this.$routeParams),this.setRetainState(!1);break;default:this.$location.path("/")}}showLibraryCard(){return this.resetLibraryCardAlerts(),"/library_card"!==this.$location.path()?this.$location.path("/library_card"):this.$location.path("/")}switchTab(e){return"research_assistant"==e&&"/research_assistant"!==this.$location.path()?this.$location.path("/research_assistant"):this.$location.path("/")}resetLibraryCardAlerts(){return this.alertService.resetAlert("libraryCardError"),this.alertService.resetAlert("libraryCardListLoadError"),this.alertService.resetAlert("libraryCardSuccess")}isbulkExportAllowed(){var e;return(null===(e=this.$scope.feed.items[0])||void 0===e?void 0:e.recordCount)>0&&this.$scope.allowDownloadSearchResults}showSearchPagination(){return this.$scope.feed&&this.$scope.feed.items[0]&&this.$scope.feed.items[0].recordCount>0&&this.$scope.feed.items[0].recordCount>this.config.data.results.pageSize&&this.$scope.selectedTab===this.$scope.searchTabs.search}}a.$inject=["$scope","appStateService","documentDetailService","$route","$routeParams","$location","configService","utilitiesService","metricsService","eventService","facetsService","flowService","advancedSearchService","$timeout","dialogService","$q","urlRewriter","localizationService","$window","$broadcastTypes","alertService","viewStateService","$filter","menuManagerService","translationService","citationValues","externalPluginsService","journalTitleService","savedSearchService","savedItemsService","cloudStorageService","authenticationService","sierraService","mediaQueryService","$authEvents","$log","$uibModal","searchScopeService","$document","urlService","researchAssistantService"],angular.module("summonApp.controllers").controller("ApplicationCtrl",a)},5642:()=>{"use strict";class e{constructor(e,t,i,s,a,r){this.login=this.login.bind(this),this.logInOut=this.logInOut.bind(this),this.logout=this.logout.bind(this),this.openLoginDialog=this.openLoginDialog.bind(this),this.openLogoutDialog=this.openLogoutDialog.bind(this),this.cancel=this.cancel.bind(this),this.$scope=e,this.authentication=t,this.translationService=s,this.$log=a,this.$window=r,this.$scope.authScope=this.authentication.scope,this.$scope.auth=this.authentication.scope.auth,this.formatUrl=this.authentication.formatUrl,this.i18n=this.translationService,this.doRefreshToken=this.authentication.doRefreshToken,this.logoutEverywhere=!1,this.openPopupWindow=this.authentication.openPopupWindow,this.$scope.providers=this.$scope.$resolve.providers}login(e,t,i){return this.authentication.login(e,t,i)}logInOut(e,t,i,s){return this.$scope.auth[t].loggedIn?this.logout(e,t,i,s):this.login(e,t,i)}logout(e,t,i,s){const a=this.authentication.logout(e,t,i,s);if(!s)return this.logoutEverywhere=!0,a.then((e=>{!1===e.data.logout_url?(this.logoutEverywhere=!1,this.cancel()):this.logoutEverywhereUrl=e.data.logout_url})).catch((e=>{this.cancel()}))}openLoginDialog(e,t=this.$window.location.href){return this.authentication.openLoginDialog(e,t)}openLogoutDialog(e,t,i=this.$window.location.href){return this.authentication.openLogoutDialog(e,t,i)}cancel(){return this.authentication.closeLoginDialog(),this.authentication.closeLogoutDialog(),this.logoutEverywhere=!1}}e.$inject=["$scope","authenticationService","configService","translationService","$log","$window"],angular.module("summonApp.controllers").controller("authenticationController",e)},1500:(e,t,i)=>{"use strict";i.r(t);var s=i(7025),a=i.n(s);class r{constructor(e,t,i,s,a,r,n,o,l){this.$scope=e,this.translationService=t,this.$scope.i18n=this.translationService,this.emailService=i,this.recaptcha=s,this.config=a,this.api=r,this.$scope.recaptchaIsValid=!1,this.alerts=n,this.appState=o,this.$window=l,this.export=this.export.bind(this),this.isEmailInvalid=this.isEmailInvalid.bind(this),this.displayBulkExportLimitWarning=this.displayBulkExportLimitWarning.bind(this),this.getDefaultMessage=this.getDefaultMessage.bind(this),this.$scope.export=this.export,this.$scope.displayBulkExportLimitWarning=this.displayBulkExportLimitWarning}isEmailInvalid(e){return this.emailService.isEmailInvalid(this.$scope,e)}displayBulkExportLimitWarning(){var e;return this.$scope.getRecordCount()>1e3&&(null===(e=this.config.data.bulkExport)||void 0===e?void 0:e.enabled)||!1}getDefaultMessage(){const e=this.appState.params.q,t=this.$window.location.href;let i=this.translationService.translations.BULK_EXPORT_DEFAULT_MESSAGE;return i.includes("{query}")&&(i=i.replace("{query}",e)),i.includes("{summonUrl}")&&(i=i.replace("{summonUrl}",t)),i}export(){const e={email:this.$scope.recipient,libhash:this.config.data.bulkExport.libhash,message:this.$scope.message||this.getDefaultMessage(),reportTitle:this.translationService.translations.BULK_EXPORT_REPORT_TITLE,emailSubject:this.translationService.translations.BULK_EXPORT_EMAIL_SUBJECT,captchaValidation:this.recaptcha.get("emailCaptcha")};for(const t in this.appState.params)e[t]=this.appState.params[t];return this.api.bulkExport(e).then((t=>{this.recaptcha.reset(e.captchaValidation),this.$scope.close(),t.data.success?this.alerts.toast("bulkExportSuccess"):this.alerts.toast("bulkExportError")})).catch((t=>{this.recaptcha.reset(e.captchaValidation),this.$scope.close(),this.alerts.toast("bulkExportError")}))}}r.$inject=["$scope","translationService","emailService","recaptchaService","configService","apiService","alertService","appStateService","$window"],a().module("summonApp.controllers").controller("BulkExportCtrl",r)},1811:()=>{"use strict";class e{constructor(e,t,i){this.getResolverLink=this.getResolverLink.bind(this),this.$scope=e,this.bxService=t,this.$scope.ceil=Math.ceil,this.$scope.bxService=this.bxService,this.config=i.data.bxRecommender,this.$scope.getResolverLink=this.getResolverLink,this.$scope.closeBX=this.bxService.close}getResolverLink(e){if(this.config.linkResolver&&e.open_url){const t=this.config.linkResolver.trim().replace(/\?$/,""),i=t.includes("?")?"&":"?";return`${t}${i}${e.open_url}`}return""}}e.$inject=["$scope","bxRecommenderService","configService"],angular.module("summonApp.controllers").controller("BxRecommenderCtrl",e)},6616:()=>{"use strict";class e{constructor(e,t,i,s,a){this.switchView=this.switchView.bind(this),this.email=this.email.bind(this),this.close=this.close.bind(this),this.toggleCollapse=this.toggleCollapse.bind(this),this.$scope=e,this.chat=t,this.alerts=i,this.locale=s,this.translationService=a,this.$scope.chat=this.chatScope=this.chat.scope.chat,this.$scope.chatView="",this.$scope.collapsed=!1,this.$scope.alerts=this.alerts.alerts,this.$scope.isSending=!1,this.chatScope.visible=!1,this.$scope.isRTL=this.locale.localization.isRTL,this.$scope.email=this.email,this.$scope.switchView=this.switchView,this.$scope.toggleCollapse=this.toggleCollapse,this.$scope.closeWidget=this.close}switchView(e){return this.$scope.chatView=e}email(){if(this.alerts.resetAlert("chatEmailError"),!this.$scope.isSending)return this.$scope.isSending=!0,this.chat.email({replyTo:this.$scope.from,message:`Message from: ${this.$scope.from}\n\n${this.$scope.message}`,sendCopy:this.$scope.sendCopy}).then((()=>(this.alerts.pulseAlert("emailNotify",this.translationService.translations.EMAIL_SENT_SUCCESSFULLY),this.$scope.from="",this.$scope.message="",this.$scope.sendCopy=!1)),(()=>this.alerts.setAlert("chatEmailError",this.translationService.translations.EMAIL_PROCESSING_ERROR))).finally((()=>this.$scope.isSending=!1))}close(){return this.$scope.collapsed=!1,this.chatScope.visible=!1}toggleCollapse(){return this.$scope.collapsed=!this.$scope.collapsed}}e.$inject=["$scope","chatService","alertService","localizationService","translationService"],angular.module("summonApp.controllers").controller("ChatCtrl",e)},7191:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){if(this.prepareDocumentsToExport=this.prepareDocumentsToExport.bind(this),this.markBusy=this.markBusy.bind(this),this.markDone=this.markDone.bind(this),this.clearCitation=this.clearCitation.bind(this),this.toggle=this.toggle.bind(this),this.retryCite=this.retryCite.bind(this),this.cite=this.cite.bind(this),this.email=this.email.bind(this),this.emailClear=this.emailClear.bind(this),this.emailSuccess=this.emailSuccess.bind(this),this.emailError=this.emailError.bind(this),this.isFormInvalid=this.isFormInvalid.bind(this),this.print=this.print.bind(this),this.$scope=e,this.citation=t,this.alerts=i,this.translationService=s,this.citationValues=a,this.emailService=n,this.config=r,this.$scope.busy=!1,this.$scope.citations=[],null==this.$scope.view&&(this.$scope.view="cite"),this.$scope.emailHtml=!0,this.$scope.isSending=!1,this.$scope.i18n=this.translationService,this.$scope.isSenderEnabled=this.config.data.citation.enable_sender_email_citation,this.$scope.isSenderRequired=this.$scope.isSenderEnabled&&this.config.data.citation.require_sender_email_citation,this.$scope.isFormInvalid=this.isFormInvalid,this.$scope.recaptchaIsValid=!1,this.citationValues.options={styles:this.citation.styles,style:this.citation.styles.citation[0].name,lastStyle:"summon",format:this.citation.styles.export[0].name,cite:this.cite,retryCite:this.retryCite,email:this.email,retryEmail:this.retryEmail,print:this.print,toggleEmail:this.toggle},this.$scope.citationValues=this.citationValues,this.$scope.normalize=this.citation.normalize,this.$scope.recipient="",this.$scope.message="",this.$scope.sender="",this.$scope.translationParams={},this.$scope.openDetailPage=this.$scope.$parent.openDetailPage,this.$scope.openClickTrackLink=this.$scope.$parent.openClickTrackLink,this.$scope.fieldSearch=this.$scope.$parent.fieldSearch,"SavedItems"===this.$scope.citationSource)this.prepareDocumentsToExport(),this.$scope.$watch("documents",this.prepareDocumentsToExport,!0);else{const e=this.$scope.sidebarExportOptions=angular.copy(this.$scope.citationValues.options.styles.export);this.citation.prepCitationExportOptions(this.$scope.documents,e)}if(this.$scope.$on("$destroy",(()=>(this.alerts.resetAlert("citationError"),this.alerts.resetAlert("citationEmailError")))),this.$scope.$on("recaptchaValidated",((e,t)=>{this.$scope.recaptchaIsValid=t})),this.$scope.isSenderRequired){const e=document.getElementById("sender");null==e||e.setAttribute("required","")}}prepareDocumentsToExport(){const{options:e}=this.citationValues;return this.citation.prepCitationExportOptions(this.$scope.documents,e.styles.export)}markBusy(){return this.$scope.busy=!0}markDone(){return this.$scope.busy=!1}clearCitation(){return this.$scope.citationValues.options.style="summon",this.$scope.citationValues.options.citation=null}toggle(e){const{view:t}=this.$scope;return this.$scope.view=t===e?"email":e}retryCite(){return this.$scope.citationValues.options.style=this.$scope.citationValues.options.lastStyle,this.cite()}cite(){if(this.alerts.resetAlert("citationError"),this.markBusy(),this.$scope.citationValues.options.lastStyle=this.$scope.citationValues.options.style,"summon"===this.$scope.citationValues.options.style)return this.markDone(),this.clearCitation();{const e=e=>(this.markDone(),this.$scope.citations=e),t=()=>(this.alerts.setAlert("citationError","Citation processing error."),this.markDone(),this.clearCitation());return this.citation.cite(this.$scope.documents,this.$scope.citationValues.options.style).then(e,t)}}email(e){if(this.alerts.resetAlert("citationEmailError"),this.$scope.translationParams={},!this.$scope.isSending){this.$scope.isSending=!0;const t={documents:this.$scope.documents,style:this.$scope.citationValues.options.style,recipient:this.$scope.recipient,message:this.$scope.message,emailHtml:this.$scope.emailHtml,sender:this.$scope.sender};return this.citation.email(t).then((()=>{if(this.emailSuccess(),angular.isFunction(e))return e()})).catch((e=>this.emailError(e)))}}emailClear(){this.emailService.clearEmailFields(this.$scope)}emailSuccess(){this.emailService.emailSuccess(this.$scope)}emailError(e){this.emailService.emailError(e,"citationEmailError",this.$scope)}print(){this.emailService.print()}isFormInvalid(){this.emailService.isFormInvalid(this.$scope.emailForm)}isEmailInvalid(e){this.emailService.isEmailInvalid(this.$scope.emailForm,e)}}e.$inject=["$scope","citationService","alertService","translationService","citationValues","configService","emailService"],angular.module("summonApp.controllers").controller("CitationCtrl",e)},4582:()=>{"use strict";class e{constructor(e,t,i,s,a,r){this.goDetailDocs=this.goDetailDocs.bind(this),this.runCourseReserveSearch=this.runCourseReserveSearch.bind(this),this.runNewSearch=this.runNewSearch.bind(this),this.$scope=e,this.courseReserves=t,this.$route=i,this.$location=a,this.$element=r,this.$scope.courseReserves=this.courseReserves.scope,this.$scope.courseReserveDetail=this.courseReserves.detailScope,this.$scope.runCourseReserveSearch=this.runCourseReserveSearch,this.$scope.goDetailDocs=this.goDetailDocs,this.$scope.checkNewSearch=this.courseReserves.checkNewSearch,this.$scope.runNewSearch=this.runNewSearch,this.$scope.inf=1/0,this.$scope.displayResultCounts=!0,"detail"===this.$route.current.action&&this.courseReserves.setDetailed(s.course_id),this.$element.is("#courseReservesView")&&this.runNewSearch()}goDetailDocs(e){return this.$location.path("/course_reserves/"+e)}runCourseReserveSearch(){return this.$location.path("/course_reserves"),this.courseReserves.runSearch()}runNewSearch(){this.courseReserves.runNewSearch();const e=this.$element.find(".search-input");if(e.length)return e.focus()}}e.$inject=["$scope","courseReserveService","$route","$routeParams","$location","$element"],angular.module("summonApp.controllers").controller("CourseReservesCtrl",e)},2425:()=>{"use strict";class e{constructor(e,t){this.$scope=e,this.$scope.i18n=t}}e.$inject=["$scope","translationService"],angular.module("summonApp.controllers").controller("CustomPaginationCtrl",e)},8136:()=>{"use strict";class e{constructor(e,t,i,s,a,r){this.update=this.update.bind(this),this.$scope=e,this.$timeout=t,this.datepickerService=i,this.$locale=s,this.advancedSearchService=a,this.i18n=r,this.$scope.datepicker=this.datepickerService.datepicker,this.$scope.update=this.update,this.$scope.status={},this.$scope.toggleDatepicker=(e,t)=>(e.preventDefault(),e.stopPropagation(),this.$scope.status[t]=!this.$scope.status[t]),this.$scope.dateOptions={formatYear:"yyyy",formatMonth:"MMM",formatDay:"dd",showWeeks:!1,yearRange:12,datepickerMode:"month"};let n=this.$locale.DATETIME_FORMATS.shortDate,o=this.$locale.DATETIME_FORMATS.shortDate.toLowerCase();n.indexOf("yy")>-1&&!n.indexOf("yyy")>-1&&(n=n.replace("yy","y"),o=o.replace("yy","yyyy")),this.$scope.format=n,o=o.split("");for(let e=0;e<o.length;e++)switch(o[e]){case"y":o[e]=this.i18n.translations.DATEFORMAT_Y;break;case"m":o[e]=this.i18n.translations.DATEFORMAT_M;break;case"d":o[e]=this.i18n.translations.DATEFORMAT_D}this.$scope.formatToDisplay=o.join("")}update(e,t){const i="advancedSearch"===e?this.advancedSearchService.scope.newSearchScope||this.advancedSearchService.scope.searchScope:"",s="advancedSearch"===e?this.advancedSearchService.scope.searchScopeParams:null,a="advancedSearch"===e?()=>{this.advancedSearchService.reflectSearchScopeDate()}:null;this.datepickerService.update(e,t,i,s,a),"advancedSearch"===e&&this.advancedSearchService.setDateSelection(t)}}e.$inject=["$scope","$timeout","datepickerService","$locale","advancedSearchService","translationService"],angular.module("summonApp.controllers").controller("datepickerCtrl",e)},131:()=>{"use strict";class e{constructor(e,t){this.apiUpdate=this.apiUpdate.bind(this),this.$scope=e,this.api=t,this.$scope.apiResponse={},this.$scope.showResponse=!1;const i=this.$scope.prevRequest=this.api.previousApiRequest;this.api.on("update",this.apiUpdate),i&&this.api.get(i.method,i.params,{debug:!0}),this.$scope.$on("$destroy",(()=>this.api.off("update",this.apiUpdate)))}apiUpdate(e,t){return t&&(this.$scope.apiResponse=e),this.$scope.showResponse=!0}}e.$inject=["$scope","apiService"],angular.module("summonApp.controllers").controller("DebugCtrl",e)},6908:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.getDiagnostics=this.getDiagnostics.bind(this),this.setDiagnostics=this.setDiagnostics.bind(this),this.$scope=e,this.diagnosticsService=t,this.$routeParams=i,this.$scope.diagnostics||(this.$scope.diagnostics=!1),this.$scope.parentKey||(this.$scope.parentKey=s.isString(this.$routeParams.diagnostic)&&this.$routeParams.diagnostic||""),this.$scope.key||(this.$scope.key=(null!=this.$routeParams.diagnostic&&s.isString(this.$routeParams.diagnostic)?this.$routeParams.diagnostic.replace(/\./g,"-"):void 0)||"Maverick Diagnostics"),this.$scope.getDiagnostics=this.getDiagnostics,this.$scope.loadingDiagnostics=!1,this.$scope.diagnostics||this.getDiagnostics()}getDiagnostics(){return this.$scope.loadingDiagnostics=!0,this.diagnosticsService.get(this.$scope.parentKey).then(this.setDiagnostics)}setDiagnostics(e){return this.$scope.diagnostics?angular.extend(this.$scope.diagnostics,e):this.$scope.diagnostics=e,this.$scope.loadingDiagnostics=!1}}a.$inject=["$scope","diagnosticsService","$routeParams"],angular.module("summonApp.controllers").controller("DiagnosticsCtrl",a)},9418:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o){this.updateShareActionUrls=this.updateShareActionUrls.bind(this),this.backToSearch=this.backToSearch.bind(this),this.displayDialog=this.displayDialog.bind(this),this.displayDialogOld=this.displayDialogOld.bind(this),this.openILLRequestLink=this.openILLRequestLink.bind(this),this.$scope=e,this.docDetail=t,this.translationService=i,this.alerts=s,this.dialog=a,this.utilitiesService=n,this.config=o,this.detailScope=this.$scope.docDetail=this.docDetail.scope,this.detailScope.backToSearch=this.backToSearch,this.detailScope.displayDialog=this.displayDialog,this.detailScope.openILLRequestLink=this.openILLRequestLink,this.detailScope.view=null,this.$window=r,this.i18n=this.translationService,this.updateShareActionUrls(this.detailScope);const l=this.config.data.results;this.$scope.maximumFullTextLinks=l.maximumFullTextLinks,this.$scope.enableAdditionalFullTextLinks=l.enableAdditionalFullTextLinks,this.$scope.displayMultipleFullTextLinks=this.$scope.maximumFullTextLinks>1&&this.$scope.enableAdditionalFullTextLinks,this.useGetForIllReq=this.config.data.document.useGetForIllReq;const c=()=>{this.detailScope.view=null;let{title:e}=this.detailScope.doc;const{subtitle:t}=this.detailScope.doc;return t&&(e+=": "+t),this.$scope.setWindowTitle(e),this.$scope.availabilityDocs=this.detailScope.availabilityDocs,this.updateShareActionUrls(this.detailScope)};this.docDetail.on("new",c),this.$scope.$on("$destroy",(()=>this.docDetail.off("new",c)))}updateShareActionUrls(e){var t;for(var i of e.socialSharingServices){var s,a,r=e.doc.title;(null===(t=e.doc.authors)||void 0===t?void 0:t.length)&&(r+=" - "+e.doc.authors[0].fullname),(r=this.utilitiesService.removeHithighlightTags(r)).length>755&&(r=r.substring(0,750)+"...");var{location:n}=this.$window,o=n.port?":"+n.port:"",l=n.protocol+"//"+n.hostname+o+"/#!/document?id="+e.doc.id,c=this.$window.location.href;null!=i.hrefMobile&&this.$window.bowser.mobile?s=i.hrefMobile:({href:s}=i),a=s.indexOf(!1)?this.i18n.translate(this.i18n.translations.SHARE_MESSAGE_X_MESSAGE,{message:r}):this.i18n.translate(this.i18n.translations.SHARE_MESSAGE_X_X_MESSAGE_URL,{message:r,url:l});var h=e=>encodeURIComponent(e).replace(/%20/g,"+");i.url=s.replace("{TITLE}",h(r)).replace(/{TEXT}/g,h(a)).replace(/{URL}/g,h(l)).replace(/{REDIRECT_URI}/g,h(c))}}backToSearch(){return this.$scope.viewState.currentView="search",this.$scope.setRetainState(!0),this.$scope.setWindowTitle(this.i18n.translations.RESULTS_FOR+`"${this.$scope.search.query}"`),this.docDetail.clearDocument()}displayDialog(e,t){this.alerts.resetAlert("citationError"),this.alerts.resetAlert("citationEmailError");const i=this.$scope;return i.documents=i.docDetail.doc,i.showExportOptions=!0,this.dialog.displayDialog(e,this.$scope,(e=>i.close=e.close)).then((function(){if(null!=t.currentTarget)return t.currentTarget.focus()}))}displayDialogOld(e){return this.detailScope.view===e&&(e=null),this.detailScope.view=e}openILLRequestLink(e,t){if(!this.useGetForIllReq)return e.preventDefault(),this.$scope.openClickTrackLink(t)}}e.$inject=["$scope","documentDetailService","translationService","alertService","dialogService","$window","utilitiesService","configService"],angular.module("summonApp.controllers").controller("DocumentDetailCtrl",e)},3311:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a,r,n,o,l,c){this.refreshExamples=this.refreshExamples.bind(this),this.goToSearch=this.goToSearch.bind(this),this.selectActiveTab=this.selectActiveTab.bind(this),this.getSearchParams=this.getSearchParams.bind(this),this.getBoxParams=this.getBoxParams.bind(this),this.getCarouselParams=this.getCarouselParams.bind(this),this.$scope=e,this.$location=t,this.appState=i,this.apiService=a,this.$window=n,this.embeddedValues=o,this.localization=l,this.$element=c;const{assets:h}=r.data;function d(e,t){const i=document.createElement("script");i.setAttribute("async","true"),i.src=e,i.onload=t,document.body.appendChild(i)}this.logo=h.logoSmall,this.$scope.home=`//${this.$window.location.host}`,this.$scope.apiResponse={},this.$scope.showResponse=!1,this.$scope.getSearchParams=this.getSearchParams,this.$scope.getBoxParams=this.getBoxParams,this.$scope.goToSearch=this.goToSearch,this.$scope.selectActiveTab=this.selectActiveTab,this.embeddedValues.showEmbeddedWidgetsBox=!0,this.$scope.embeddedValues=this.embeddedValues,this.$scope.helpLink="https://knowledge.exlibrisgroup.com/Summon/Product_Documentation/Configuring_The_Summon_Service/Configurations_Outside_of_the_Summon_Administration_Console/Summon%3A_Creating_a_Search_Box%2C_Search_Widget%2C_or_Carousel",void 0===this.appState.params.q&&this.$location.search({q:""}),this.$scope.searchParams||(this.$scope.searchParams=this.embeddedValues.searchParams||(this.embeddedValues.searchParams={id:this.genId(),logo:this.logo,endpoint:this.$scope.home,lang:this.localization.getStandardLocale(),style:{title_color:"#4d4d4d",link_color:"#214e95",header_color:"#fff",results_color:"#fff",width:"fixed"},params:this.appState.params,title:"Summon Widget",searchbutton_text:"Search"})),this.$scope.boxParams||(this.$scope.boxParams=this.embeddedValues.boxParams||(this.embeddedValues.boxParams={id:this.genId(),endpoint:this.$scope.home,style:{tagline:"#000",links:"#000"},params:this.appState.params,tagline_text:"Easily discover the world of library content",searchbutton_text:"Search",advanced_text:"More search options",placeholder_text:"",advanced:!0,suggest:!0,tagline:!0,popup:!0})),this.$scope.carouselParams||(this.$scope.carouselParams=this.embeddedValues.carouselParams||(this.embeddedValues.carouselParams={id:this.genId(),endpoint:this.$scope.home,style:{searchCarouselWidth:"700px",card:{titleFontColor:"inherit",titleFontWeight:"700",titleFontSize:"13px",descriptionFontColor:"inherit",descriptionFontWeight:"400",descriptionFontSize:"12px",imageHeight:"210px"},bulletSpacing:"8px"},webComponentValues:{titleText:this.fetchSearchTitleText(),titleLink:this.createTitleLinkSummonUrl(),defaultThumbnailUrl:`${this.$location.protocol()}:${this.$scope.home}/images/format-large/-generic-grey_64px.png`,searchUrl:this.createSearchUrl()}})),this.$scope.$watch("embeddedValues.activeWidget",(e=>{var t;let i=this;switch(e){case"box":const e=()=>{i.boxExample?i.boxExample.projector.scheduleRender():(i.boxExample=i.$window.summonWidget.box(i.$scope.boxParams,"exampleBoxWidget"),i.boxExample.run())};d(this.$window.boxWidgetScriptSrc,e);break;case"search":const s=()=>{i.searchExample||(i.searchExample=i.$window.summonWidget.search(i.$scope.searchParams,"exampleSearchWidget"),i.searchExample.run())};d(this.$window.searchWidgetScriptSrc,s);break;case"carousel":const a=this.createSearchUrl(),r=this.fetchSearchTitleText(),n=this.createTitleLinkSummonUrl();i.$scope.carouselParams.webComponentValues.searchUrl!==a&&(i.$scope.carouselParams.webComponentValues.searchUrl=a,i.$scope.carouselParams.webComponentValues.titleLink=n),i.$scope.carouselParams.webComponentValues.titleText!==r&&(i.$scope.carouselParams.webComponentValues.titleText=r);const o=()=>{i.carouselExample||(i.carouselExample=i.$window.summonCarouselWidget.carousel(i.$scope.carouselParams,"exampleCarouselWidget"))};(null===(t=i.$window.summonWidget)||void 0===t?void 0:t.carousel)||(d(this.$window.carouselWidgetComponentScriptSrc),d(this.$window.carouselWidgetScriptSrc,o))}})),this.$scope.$watch("searchParams",(()=>this.refreshExamples("search")),!0),this.$scope.$watch("boxParams",(()=>this.refreshExamples("box")),!0),this.$scope.$watch("carouselParams",(()=>this.refreshExamples("carousel")),!0);const u=angular.element(this.$window),p=s.throttle((()=>angular.element(this.$element).find(".embeddedWidgets").css("height",angular.element(this.$window).height()+"px")),25);p(),u.on("resize",p),this.$scope.$on("$destroy",(()=>u.off("resize",p)))}createSearchUrl(){const e=this.appState.params,t=this.apiService.apiParamsFor(e);delete t.screen_res,delete t.__refererURL;let i=$.param(t);return i.length&&(i=`?${i}`),`${this.$location.protocol()}:${this.$scope.home}/api/search${i}`}createTitleLinkSummonUrl(){return`${this.$location.protocol()}:${this.$scope.home}${this.$location.url().replace("widgets","search")}`}fetchSearchTitleText(){return this.$location.search().q||"Search Results"}refreshExamples(e){this.boxExample&&"box"===e&&this.boxExample.projector.scheduleRender(),this.searchExample&&"search"===e&&this.searchExample.projector.scheduleRender(),this.carouselExample&&"carousel"===e&&this.carouselExample.projector.scheduleRender()}goToSearch(e=!1){return this.embeddedValues.showEmbeddedWidgetsBox=!e,this.$location.path("/search")}selectActiveTab(e){this.embeddedValues.activeTab=e,"search"==e&&"carousel"===this.embeddedValues.activeWidget&&this.goToSearch()}getSearchParams(){return JSON.stringify(this.cleanParams(angular.copy(this.$scope.searchParams)))}getBoxParams(){return JSON.stringify(this.cleanParams(angular.copy(this.$scope.boxParams)))}getCarouselParams(){return JSON.stringify(this.cleanParams(angular.copy(this.$scope.carouselParams)))}cleanParams(e){return e.params.pn=1,null!=e.params.q&&delete e.params.q,0===e.params.rf.length&&delete e.params.rf,0===e.params.fvfi.length&&delete e.params.fvfi,0===e.params.fvf.length&&delete e.params.fvf,e}genId(){return"sxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}}a.$inject=["$scope","$location","appStateService","apiService","configService","$window","embeddedWidgetValues","localizationService","$element"],angular.module("summonApp.controllers").controller("EmbeddedWidgetsCtrl",a)},6710:()=>{"use strict";class e{constructor(e,t,i,s,a){this.sortFacet=this.sortFacet.bind(this),this.getFacetClasses=this.getFacetClasses.bind(this),this.moreFacetValues=this.moreFacetValues.bind(this),this.toggleFacetValue=this.toggleFacetValue.bind(this),this.$scope=e,this.facets=t,this.moreFacets=i,this.$element=s,this.$q=a,this.$scope.facets=this.facets.scope,this.$scope.clearFacet=this.facets.clear,this.$scope.toggleCollapsed=this.facets.toggleCollapsed,this.$scope.sortFacet=this.sortFacet,this.$scope.getFacetClasses=this.getFacetClasses,this.$scope.moreFacetValues=this.moreFacetValues,this.$scope.toggleFacetValue=this.toggleFacetValue,this.$scope.triggerId=null}sortFacet(e,t){return this.moreFacetValues(e).finally((()=>(this.facets.sortFacet(e,t),this.$element.find("#facetList"+e.name).scrollTop(0))))}getFacetClasses(e,t){return this.facets.getFacetClasses(e,t)}moreFacetValues(e){return e.moreLoaded?this.$q.resolve(!0):e.showmore?(e.moreFacetsLoading=!0,this.moreFacets.getMoreFacets(e).finally((t=>(e.moreFacetsLoading=!1,e.showSortLoader=!1)))):this.$q.resolve(!1)}toggleFacetValue(...e){const t=e.shift();return null==t||t.preventDefault(),this.$scope.triggerId=document.activeElement.id,this.facets.toggle.apply(this,e)}}e.$inject=["$scope","facetsService","moreFacetsService","$element","$q"],angular.module("summonApp.controllers").controller("FacetsCtrl",e)},761:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.controllers").controller("FeedbackCtrl",["$scope","feedbackService","configService","alertService","translationService",class{constructor(e,t,i,a,r){this.sendFeedback=this.sendFeedback.bind(this),this.success=this.success.bind(this),this.error=this.error.bind(this),this.$scope=e,this.feedback=t,this.alerts=a,this.translationService=r;const n=i.data.feedback;this.$scope.feedback=this.feedback.scope,this.$scope.emailRequired=n.emailRequired,this.$scope.enableFeedbackRoles=n.enableFeedbackRoles,this.$scope.emailPlaceHolder=this.$scope.emailRequired?this.translationService.translations.REQUIRED:this.translationService.translations.OPTIONAL,this.$scope.hide=this.$scope.$hide,this.$scope.feedbackTypes=this.feedback.feedbackTypes(),this.$scope.userRoles=this.feedback.userRoles(),this.$scope.sendFeedback=s.debounce(this.sendFeedback,500,!0),this.$scope.isSending=!1}sendFeedback(){if(this.$scope.enableFeedbackRoles||(this.$scope.feedback.role=""),!this.$scope.isSending&&this.$scope.feedbackForm.$valid)return this.alerts.resetAlert("feedbackError"),this.$scope.isSending=!0,this.feedback.send().then(this.success).catch(this.error)}success(e){return this.$scope.close(),e}error(e){const t=e.status===(null!=(null==e?void 0:e.data)&&422)?e.data:"Feedback processing error.";return this.alerts.setAlert("feedbackError",t),this.$scope.isSending=!1}}])},5372:()=>{"use strict";class e{constructor(e,t,i){this.signOff=this.signOff.bind(this),this.toggleBanner=this.toggleBanner.bind(this),this.getCallbackUrl=this.getCallbackUrl.bind(this),this.getCurrentUrl=this.getCurrentUrl.bind(this),this.sendAuthParams=this.sendAuthParams.bind(this),this.$scope=e,this.$timeout=t,this.flow=i,this.$scope.flowConfigs=this.flow.configs,this.$scope.auth=this.flow.auth,this.$scope.signOff=this.signOff,this.$scope.toggleBanner=this.toggleBanner,this.$scope.getCallbackUrl=this.getCallbackUrl,this.$scope.getCurrentUrl=this.getCurrentUrl,this.$scope.sendAuthParams=this.sendAuthParams}signOff(){return this.$timeout((()=>this.flow.signOff()),5)}toggleBanner(e){return this.flow.configs.banner.enabled=e}getCallbackUrl(){return this.flow.getCallbackUrl()}getCurrentUrl(){return this.flow.getCurrentUrl()}sendAuthParams(){return this.flow.getAuthParams().then((([e,t])=>({ts:e,sig:t}))).catch((e=>{console.error("Error getting auth params:",e)}))}}e.$inject=["$scope","$timeout","flowService"],angular.module("summonApp.controllers").controller("FlowAuthCtrl",e)},3772:()=>{"use strict";class e{constructor(e,t){this.scope=e,this.data=t,this.scope.layout={virgin:!0,modal:!1},this.scope.$watch(["saveditems.visible","search.advanced","docDetail.visible"].join(" || "),(e=>this.scope.layout.modal=e)),this.scope.$watch("feed.items.length",(e=>{if(this.scope.layout.virgin)return e>0?this.scope.layout.virgin=!1:void 0}))}}e.$inject=["$scope","dataService"],angular.module("summonApp.controllers").controller("LayoutCtrl",e)},6061:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){this.$scope=e,this.leave=this.leave.bind(this),this.cancel=this.cancel.bind(this),this.getCurrentScope=this.getCurrentScope.bind(this),this.$uibModalInstance=t,this.dialogService=i,this.searchScopeService=s,this.appState=a,this.$scope.leave=this.leave,this.$scope.cancel=this.cancel,this.$scope.getCurrentScope=this.getCurrentScope,this.$scope.i18n=r,this.advancedSearch=n}$onInit(){return this.$uibModalInstance.result.then((e=>{})).catch((e=>{}))}removeSearchScopeAndUpdateState(){this.appState.applyStateWithSnapShot((()=>{this.searchScopeService.setDefaultScope(),this.appState.params.pn=1}))}getCurrentScope(){var e;return this.searchScopeService.warningMetaData.scopeLabel||(null===(e=this.searchScopeService.currentSearchScope)||void 0===e?void 0:e.label)}executeLeaveCallback(){if(this.searchScopeService.warningMetaData.callBack){const e=!1;this.searchScopeService.warningMetaData.callbackDateParams?this.searchScopeService.warningMetaData.callBack(e,this.searchScopeService.warningMetaData.callbackDateParams):this.searchScopeService.warningMetaData.callBack(e)}}leave(e){this.searchScopeService.warningMetaData.fromAdvanced?(this.advancedSearch.clearSearchScopeFromAdvanced(),this.executeLeaveCallback()):(this.executeLeaveCallback(),this.removeSearchScopeAndUpdateState()),this.searchScopeService.$uibModalInstance.close("close modal"),this.searchScopeService.$uibModalInstance=void 0}cancel(e){if(this.searchScopeService.warningMetaData.callBack){const e=!0;this.searchScopeService.warningMetaData.callBack(e)}this.searchScopeService.$uibModalInstance.close("close modal"),this.searchScopeService.$uibModalInstance=void 0}}e.$inject=["$scope","$uibModalInstance","dialogService","searchScopeService","appStateService","translationService","advancedSearchService"],angular.module("summonApp.controllers").controller("LeavingSearchScopeModalCtrl",e)},5225:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadCheckouts=this.loadCheckouts.bind(this),this.updateSelected=this.updateSelected.bind(this),this.toggle=this.toggle.bind(this),this.renewCheckout=this.renewCheckout.bind(this),this.renewSelectedCheckouts=this.renewSelectedCheckouts.bind(this),this.$scope=e,this.sierraService=t,this.apiService=i,this.$q=r,this.$log=n,this.$filter=o,this.i18n=s,this.isLoading=!1,this.docs=[],this.rawBibIds=[],this.sierraBibRequestDoc=[],this.selectedCount=0,this.allSelected=!1,this.sortOptions=[{sortBy:"dueBy",translation:s.translations.DUE_DATE,dateOrCode:!0},{sortBy:"checkoutDate",translation:s.translations.CHECK_OUT_DATE,dateOrCode:!0},{sortBy:"author",translation:s.translations.AUTHOR,dateOrCode:!1},{sortBy:"title",translation:s.translations.TITLE,dateOrCode:!0}],this.sortOptionSelected={sortBy:"",translation:"",dateOrCode:!1},this.alerts=a,l.$on(c.LOGOUTSUCCESS,(()=>this.docs=[]))}$onInit(){this.loadCheckoutsWhenReady()}$onChanges(e){if(e.reloadTrigger.currentValue)return this.loadCheckoutsWhenReady()}loadCheckoutsWhenReady(){return this.isLoading=!0,this.sierraService.patronInfoLoadedPromise.promise.then((()=>this.loadCheckouts())).catch((e=>this.handleError(e)))}loadCheckouts(e="",t=""){this.listLoadError=!1,this.isLoading=!0,this.sierraService.getCheckouts().then((e=>{this.rawBibIds=s.chain(e.data.entries).map((e=>({itemId:e.item.id,bibId:e.item.bibIds?e.item.bibIds[0]:e.item.id,dueDate:e.dueDate,checkoutId:e.id,outDate:e.outDate,barcode:e.item.barcode,callNumber:e.item.callNumber?e.item.callNumber:""}))).value();const t=this.sierraService.createApiQuery(this.rawBibIds);return t?this.apiService.get("search",t,{avoidUpdateFire:!0}):this.$q.resolve()})).then((e=>{if(e&&e.data){const t=s.map(this.rawBibIds,(t=>{const i=this.sierraService.findDocIfExists(e.data.documents,t.bibId);return t.itemId.includes("@ill")?this.sierraService.getItemByBibId(t.itemId).then((e=>(this.sierraBibRequestDoc=e.data,this.parseDocDetails(t,i,this.sierraBibRequestDoc)))).catch((e=>this.handleError(e))):this.$q.resolve(this.parseDocDetails(t,i))}));return Promise.all(t)}return this.$q.resolve([])})).then((i=>(this.docs=i,0===this.docs.length?this.emptyListMessage=this.i18n.translations.CHECKED_OUT_EMPTY:this.sortList(),e&&(this.success=e,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3)),t&&(this.error=t,this.alerts.pulseAlert("libraryCardError",this.error,1e4)),this.isLoading=!1,this.updateSelected()))).catch((e=>this.handleError(e)))}parseDocDetails(e,t,i){var s,a;t||(t=this.sierraService.createDummyDoc(this.i18n.translations.NO_RESOURCE_FOUND));const r=e.dueDate,n=function(e){const t=new Date,i=new Date(e);return Math.round((i-t)/864e5)}(e.dueDate),o=n<0,l=this.sierraService.getIdFromUrlString(e.checkoutId),{bibId:c}=e,h=e.outDate,d=e.barcode,u=e.callNumber;if(i){const e=(null===(s=i.author)||void 0===s?void 0:s.length)?i.author:void 0,{title:a}=i;return t.full_title=a,t.authors=[{fullname:e}],delete t.missingDocDisplay,{doc:Object.assign(Object.assign({},t),i),dueBy:r,daysLeft:n,checkoutId:l,bibId:c,checkoutDate:h,author:e,title:a,isOverdue:o,barcode:d,callNumber:u}}{const e=(null===(a=t.authors)||void 0===a?void 0:a.length)?t.authors[0].fullname:void 0,{title:i}=t;return{doc:t,dueBy:r,daysLeft:n,checkoutId:l,bibId:c,checkoutDate:h,author:e,title:i,isOverdue:o,barcode:d,callNumber:u}}}handleError(e){this.$log.error(e),this.isLoading=!1,this.listLoadError=!0;const t=e.data&&e.data.message?e.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.CHECKED_OUT_ERROR,{error:t}),this.alerts.setAlert("libraryCardListLoadError",this.error)}sortList(e=this.sortOptions[0]){return this.sortOptionSelected=e,this.docs=e.dateOrCode?this.$filter("orderBy")(this.docs,e.sortBy):this.$filter("localeSort")(this.docs,e.sortBy)}getSortByOption(){return this.sortOptionSelected.translation}updateSelected(){return this.selectedCount=s.filter(this.docs,(e=>e.selected)).length,this.allSelected=this.selectedCount===this.docs.length}toggle(e){return s.each(this.docs,(e=>e.selected=this.allSelected)),this.updateSelected()}renewCheckout(e){return this.success="",this.error="",this.isLoading=!0,s.findIndex(this.docs,(t=>t.checkoutId===e)),this.sierraService.renewCheckout(e).then((e=>(this.$log.debug(" loan succesfully renewed "),this.loadCheckouts(this.i18n.translations.CHECKED_OUT_RENEWAL_SUCCESS)))).catch((e=>{var t;return this.$log.error("error renewing loan ",e),this.isLoading=!1,window.scrollTo(0,0),403===e.status?(null===(t=e.data)||void 0===t?void 0:t.description)?this.error=this.i18n.translate(this.i18n.translations.CHECKED_OUT_RENEWAL_ERROR_X,{error:e.data.description.replace(/WebPAC Error\s?:?\s?/i,"")}):this.error=this.i18n.translations.CHECKED_OUT_RENEWAL_ERROR_403:this.error=this.i18n.translations.CHECKED_OUT_RENEWAL_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4)}))}renewSelectedCheckouts(){this.success="",this.error="",this.isLoading=!0;const e=s.filter(this.docs,(e=>e.selected)),t=s.map(e,(e=>this.sierraService.createAlwaysSuccessPromise(this.sierraService.renewCheckout(e.checkoutId),e.checkoutId)));return this.$q.all(t).then((t=>{this.isLoading=!1;const i=[],a=[];return s.map(t,(e=>"success"===e.status?i.push(e.checkoutId):a.push({checkoutId:e.checkoutId,error:e.original}))),i.length===e.length?this.loadCheckouts(this.i18n.translations.CHECKED_OUT_RENEWAL_SUCCESS_ALL):a.length&&!i.Length?(this.error=this.i18n.translate(this.i18n.translations.CHECKED_OUT_RENEWAL_SOME_ERROR,{number:a.length}),this.alerts.pulseAlert("libraryCardError",this.error,1e4)):!a.length&&i.Length?this.loadCheckouts("",this.i18n.translate(this.i18n.translations.CHECKED_OUT_RENEWAL_SOME_ERROR,{number:a.length})):void 0})).catch((e=>(this.error=this.i18n.translations.CHECKED_OUT_RENEWAL_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}}a.$inject=["$scope","sierraService","apiService","translationService","alertService","$q","$log","$filter","$rootScope","$authEvents"],angular.module("summonApp.controllers").controller("libraryCardCheckoutListController",a)},3103:()=>{"use strict";class e{constructor(e,t){this.$uibModalInstance=e,this.i18n=t}cancel(){return this.$uibModalInstance.dismiss("cancel")}accept(){return this.$uibModalInstance.close("ok")}}e.$inject=["$uibModalInstance","translationService"],angular.module("summonApp.controllers").controller("libraryCardConfirmActionDialogController",e)},1750:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o){this.$uibModalInstance=e,this.rtaAvailabilityService=t,this.sierraService=i,this.configService=s,this.i18n=a,this.alerts=r,this.holdId=n,this.bibId=o,this.pickupLocations=[],this.selectedPickupLocation="",this.isLoading=!1,this.showMode="FORM",this.hasError=!1}$onInit(){return this.isLoading=!0,this.sierraService.getHoldRequestByBibId(this.bibId).then((e=>(this.isLoading=!1,e.data.holdshelf?this.pickupLocations=e.data.holdshelf.locations:(this.showMode="SUMMARY",this.alerts.setAlert("requestHoldError",this.i18n.translations.PICKUP_LOCATIONS_EMPTY)),this.hasError=!1))).catch((e=>(this.showMode="SUMMARY",this.alerts.setAlert("requestHoldError",this.i18n.translate(this.i18n.translations.REQUEST_HOLD_FAILED,{reason:e.data.description})),this.hasError=!0)))}cancel(){return this.$uibModalInstance.dismiss("cancel")}accept(){return this.hasError?this.$uibModalInstance.dismiss("cancel"):this.$uibModalInstance.close("ok")}save(){var e,t;this.isLoading=!0;const i={pickupLocation:null===(t=null===(e=this.selectedPickupLocation)||void 0===e?void 0:e.code)||void 0===t?void 0:t.trim()};return this.sierraService.updateHold(this.holdId,i).then((e=>(this.isLoading=!1,this.showMode="SUMMARY",this.alerts.setAlert("requestHoldSuccess",this.i18n.translations.REQUEST_HOLD_UPDATED),this.hasError=!1))).catch((e=>{this.isLoading=!1,this.showMode="SUMMARY";const t=e.data.description||e.data.msg;return this.alerts.setAlert("requestHoldError",this.i18n.translate(this.i18n.translations.REQUEST_HOLD_FAILED,{reason:t})),this.hasError=!0}))}}e.$inject=["$uibModalInstance","rtaAvailabilityService","sierraService","configService","translationService","alertService","holdId","bibId"],angular.module("summonApp.controllers").controller("libraryCardEditPickupLocationController",e)},6853:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadFines=this.loadFines.bind(this),this.handleError=this.handleError.bind(this),this.updateSelected=this.updateSelected.bind(this),this.toggle=this.toggle.bind(this),this.getSierraFinePage=this.getSierraFinePage.bind(this),this.$scope=e,this.sierraService=t,this.apiService=i,this.$log=r,this.i18n=s,this.isLoading=!1,this.docs=[],this.rawBibIds=[],this.selectedCount=0,this.allSelected=!1,this.alerts=a,this.total=0,this.sierraFinePage=null,n.$on(o.LOGOUTSUCCESS,(()=>this.docs=[]))}$onInit(){this.loadFinesWhenReady(),this.getSierraFinePage()}$onChanges(e){if(e.reloadTrigger.currentValue)return this.loadFinesWhenReady()}loadFinesWhenReady(){return this.isLoading=!0,this.sierraService.patronInfoLoadedPromise.promise.then((()=>this.loadFines())).catch((e=>this.handleError(e)))}loadFines(){return this.isLoading=!0,this.sierraService.getFines().then((e=>{this.rawBibIds=s.map(e.data.entries,(e=>({bibId:e.item?e.item.bibIds[0]:"",requestedOn:e.assessedDate,chargeTypeDisplay:e.chargeType?e.chargeType.display:"",charge:e.itemCharge,processingFee:e.processingFee,billingFee:e.billingFee,paidAmount:e.paidAmount,description:e.description,location:e.location.name})));const t=this.sierraService.createApiQuery(this.rawBibIds,!0);if(t)return this.apiService.get("search",t,{avoidUpdateFire:!0})})).then((e=>e&&e.data?this.docs=s.map(this.rawBibIds,(t=>{let i,s;t.bibId?(i=this.sierraService.findDocIfExists(e.data.documents,t.bibId),i||(i=this.sierraService.createDummyDoc(this.i18n.translations.NO_RESOURCE_FOUND))):(i=this.sierraService.createDummyDoc(t.description||this.i18n.translations.FINE_NO_RESOURCE),s=!0);const{requestedOn:a}=t,{chargeTypeDisplay:r}=t;return{doc:i,requestedOn:a,chargeTypeDisplay:r,amountDue:t.charge+t.processingFee+t.billingFee-t.paidAmount,hideThumbnail:s,location:t.location}})):this.rawBibIds.length?this.docs=s.map(this.rawBibIds,(e=>({doc:this.sierraService.createDummyDoc(e.description||this.i18n.translations.FINE_NO_RESOURCE),hideThumbnail:!0,requestedOn:e.requestedOn,chargeTypeDisplay:e.chargeTypeDisplay,amountDue:e.charge+e.processingFee+e.billingFee-e.paidAmount,location:e.location}))):this.docs=[])).then((()=>(0===this.docs.length?this.emptyListMessage=this.i18n.translations.FINES_EMPTY:this.docs.forEach((e=>this.total+=e.amountDue)),this.isLoading=!1))).catch((e=>this.handleError(e)))}handleError(){this.$log.error(err),this.isLoading=!1;const e=err.data&&err.data.message?err.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.FINE_ERROR,{error:e}),this.alerts.setAlert("libraryCardListLoadError",this.error)}updateSelected(){return this.selectedCount=s.filter(this.docs,(e=>e.selected)).length,this.allSelected=this.selectedCount===this.docs.length}toggle(e){return s.each(this.docs,(e=>e.selected=this.allSelected)),this.updateSelected()}getSierraFinePage(){this.sierraFinePage=this.sierraService.getRedirectLinkToSierraFinePage()}}a.$inject=["$scope","sierraService","apiService","translationService","alertService","$log","$rootScope","$authEvents"],angular.module("summonApp.controllers").controller("libraryCardFineListController",a)},8406:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadMessages=this.loadMessages.bind(this),this.getAlreadyLoadedMessages=this.getAlreadyLoadedMessages.bind(this),this.showMessages=this.showMessages.bind(this),this.$scope=e,this.$log=t,this.sierraService=i,this.i18n=s,this.isLoading=!1,this.messages=[],this.pluralChar="",this.alerts=a,r.$on(n.LOGOUTSUCCESS,(()=>this.messages=[]))}$onInit(){this.loadMessagesWhenReady()}$onChanges(e){if(e.reloadTrigger.currentValue)return this.loadMessagesWhenReady()}loadMessagesWhenReady(){return this.sierraService.isUserInfoNull()?this.loadMessages():this.getAlreadyLoadedMessages()}loadMessages(){return this.isLoading=!0,this.sierraService.patronInfoLoadedPromise.promise.then((()=>(this.getAlreadyLoadedMessages(),this.showMessages(),this.isLoading=!1))).catch((e=>{this.$log.error(e),this.isLoading=!1;const t=e.data&&e.data.message?e.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.MESSAGES_ERROR,{error:t}),this.alerts.setAlert("libraryCardListLoadError",this.error)}))}getAlreadyLoadedMessages(){return this.messages=this.sierraService.getMessages(),this.showMessages()}showMessages(){return 0===this.messages.length?this.emptyListMessage=this.i18n.translations.MESSAGES_EMPTY:this.messages.length>1?this.pluralChar="s":void 0}}e.$inject=["$scope","$log","sierraService","translationService","alertService","$rootScope","$authEvents"],angular.module("summonApp.controllers").controller("libraryCardMessageListController",e)},5227:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a,r,n){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadDetails=this.loadDetails.bind(this),this.waitOrLoadThenInit=this.waitOrLoadThenInit.bind(this),this.initDisplay=this.initDisplay.bind(this),this.showField=this.showField.bind(this),this.setMode=this.setMode.bind(this),this.phoneDescription=this.phoneDescription.bind(this),this.getOption=this.getOption.bind(this),this.addDetailField=this.addDetailField.bind(this),this.removeDetailField=this.removeDetailField.bind(this),this.sanitizeFormFieldToSend=this.sanitizeFormFieldToSend.bind(this),this.submitPersonalDetails=this.submitPersonalDetails.bind(this),this.sendDetails=this.sendDetails.bind(this),this.$scope=e,this.$log=t,this.sierraService=i,this.configService=n,this.i18n=a,this.isLoading=!1,this.details,this.alerts=r,this.phoneTypes=[{code:"t",description:this.i18n.translations.PHONE_PRIMARY},{code:"p",description:this.i18n.translations.PHONE_ALT},{code:"o",description:this.i18n.translations.PHONE_MOB}],this.addressTypes=[{code:"a",description:this.i18n.translations.ADDRESS_PRIMARY},{code:"h",description:this.i18n.translations.ADDRESS_ALT}],this.detailFields=[{label:this.i18n.translations.NAME,key:"username",value:"",type:"text",multiple:!1,read:!0,write:!1},{label:this.i18n.translations.EMAILS,key:"emails",value:"",type:"email",multiple:!0,read:!0,write:!1,desc:""},{label:this.i18n.translations.PHONES,key:"phones",value:{number:"",type:""},type:"tel",multiple:!0,read:!0,write:!1,desc:"",helperDesc:this.i18n.translations.SELECT_PHONE_TYPE,helperOptions:this.phoneTypes},{label:this.i18n.translations.PIN,key:"pin",value:"",type:"text",multiple:!1,read:!1,write:!1,desc:"",hidden:!0,desc:"xxxxxxxx"},{label:this.i18n.translations.ADDRESSES,key:"addresses",value:{lines:["",""],type:""},type:"addr",multiple:!0,read:!0,write:!1,desc:"",helperDesc:this.i18n.translations.TYPE,helperOptions:this.addressTypes},{label:this.i18n.translations.BIRTH_DATE,key:"birthDate",value:"",type:"date",multiple:!1,read:!0,write:!1},{label:this.i18n.translations.BARCODES,key:"barcodes",value:"",type:"text",multiple:!0,read:!0,write:!1}],this.mode="SHOW",this.editableFields=this.configService.data.libraryCard.editablePersonalDetails,this.sierraService.userIdentifierIsMail()&&(this.editableFields=s.filter(this.editableFields,(e=>"EMAILS"!==e.name)))}$onInit(){return this.applyEditableFieldsConfig(),this.loadDetails()}$onChanges(e){if(e.reloadTrigger.currentValue)return this.loadDetails()}applyEditableFieldsConfig(){const e={};return this.editableFields.forEach((t=>e[t.name.toLowerCase()]=!0)),this.detailFields.forEach((t=>t.write=e[t.key]||!1))}loadDetails(){return this.error="",this.sierraService.isUserInfoNull()?this.waitOrLoadThenInit(this.sierraService.patronInfoLoadedPromise.promise):this.initDisplay()}waitOrLoadThenInit(e,t=!1){return this.isLoading=!0,e.then((()=>{if(this.isLoading=!1,this.initDisplay(),t)return this.alerts.pulseAlert("libraryCardSuccess",t,5e3)})).catch((e=>{this.$log.error(e),this.isLoading=!1;const t=e.data&&e.data.message?e.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.PERSONAL_DETAILS_ERROR,{error:t}),this.alerts.setAlert("libraryCardListLoadError",this.error)}))}initDisplay(){return this.details=this.sierraService.getLoadedUserInfo(),this.details?this.detailFields.forEach((e=>{if(e.isValuePresent=!!this.details[e.key],e.multiple){const t=this.details[e.key]||[e.value];return e.values=s.map(t,(e=>({value:e}))),e.value=s.includes(["phones","addresses"],e.key)?t:t.join(", ")}return e.isValuePresent&&(e.value="date"===e.type?new Date(this.details[e.key]+"T00:00:00"):this.details[e.key]),e.values=[{value:e.value}]})):(this.error=this.i18n.translations.PERSONAL_DETAILS_EMPTY_ERROR,this.alerts.setAlert("libraryCardListLoadError",this.error)),this.setMode("SHOW")}showField(e){const t=e.write||e.isValuePresent,i="SHOW"===this.mode&&e.read&&e.isValuePresent;return t||i}setMode(e){return this.mode=e}phoneDescription(e){var t;const i=null===(t=this.getOption(this.phoneTypes,"code",e))||void 0===t?void 0:t.description;return this.i18n.translate(i)}getOption(e,t,i){return s.filter(e,(e=>e[t]===i))[0]}addDetailField(e){const t=this.detailFields[e],i="phones"===t.key?{number:"",type:""}:"addresses"===t.key?{lines:["",""],type:""}:"";return t.values.push({value:i})}removeDetailField(e,t){return this.detailFields[t].values.splice(e,1)}sanitizeFormFieldToSend(e){switch(!1){case"phones"!==e.key:return s.map(e.values,(e=>{var t;return{number:e.value.number,type:(null===(t=e.value.model)||void 0===t?void 0:t.code)||"t"}}));case"addresses"!==e.key:return s.map(e.values,(e=>{var t;return""===e.value.lines[1]&&e.value.lines.pop(),{lines:e.value.lines,type:(null===(t=e.value.model)||void 0===t?void 0:t.code)||"a"}}));default:return s.map(e.values,(e=>e.value))}}submitPersonalDetails(){const e={};return this.detailFields.forEach((t=>{if(t.write&&!t.hidden){if(!t.multiple)return e[t.key]=t.values[0].value;{const i=this.sanitizeFormFieldToSend(t);if(i.length)return e[t.key]=i}}})),this.sendDetails(e)}sendDetails(e){return this.isLoading=!0,this.sierraService.updateUserDetails(e).then((()=>(this.$log.debug(" details successfully updated "),this.success=this.i18n.translations.PERSONAL_DETAILS_UPDATE_SUCCESS,this.waitOrLoadThenInit(this.sierraService.getOrRenewPatronInfo(),this.success),window.scrollTo(0,0)))).catch((e=>(this.$log.error("error updating personal details ",e),this.isLoading=!1,this.error=this.i18n.translations.PERSONAL_DETAILS_UPDATE_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4),window.scrollTo(0,0))))}}a.$inject=["$scope","$log","sierraService","translationService","alertService","configService"],angular.module("summonApp.controllers").controller("libraryCardPersonalDetailsController",a)},5793:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c,h,d){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadReadingHistory=this.loadReadingHistory.bind(this),this.updateSelected=this.updateSelected.bind(this),this.toggle=this.toggle.bind(this),this.deleteEntry=this.deleteEntry.bind(this),this.deleteSelectedReadingHistory=this.deleteSelectedReadingHistory.bind(this),this.deleteAllReadingHistoryEntries=this.deleteAllReadingHistoryEntries.bind(this),this.deleteSomeSelectedEntries=this.deleteSomeSelectedEntries.bind(this),this.$scope=e,this.$document=t,this.sierraService=i,this.apiService=s,this.$q=n,this.$log=o,this.$uibModal=l,this.$filter=c,this.i18n=a,this.isLoading=!1,this.docs=[],this.rawBibIds=[],this.selectedCount=0,this.allSelected=!1,this.sortOptions=[{sortBy:"checkoutDate",translation:a.translations.CHECK_OUT_DATE,dateOrCode:!0},{sortBy:"author",translation:a.translations.AUTHOR,dateOrCode:!1},{sortBy:"title",translation:a.translations.TITLE,dateOrCode:!0}],this.sortOptionSelected={sortBy:"",translation:"",dateOrCode:!1},this.alerts=r,this.readingHistoryActivated,this.emptyListMessage=this.i18n.translations.READING_HISTORY_INACTIVE,this.activationStatusIsEditable=!0,this.webPacOptInLink=this.sierraService.getWebPacReadingHistoryOptInLink(),h.$on(d.LOGOUTSUCCESS,(()=>this.docs=[]))}$onInit(){this.loadReadingHistoryWhenReady()}$onChanges(e){if(e.reloadTrigger.currentValue)return this.loadReadingHistoryWhenReady()}loadReadingHistoryWhenReady(){return this.isLoading=!0,this.sierraService.patronInfoLoadedPromise.promise.then((()=>this.loadReadingHistory())).catch((e=>this.handleError(e)))}loadReadingHistory(e="",t=""){this.readingHistoryActivated=!1,this.listLoadError=!1;const i=this.sierraService.getIdFromUrlString;return this.isLoading=!0,this.sierraService.getReadingHistoryIfActivatedOrInferrable().then((e=>{if(!1!==e.data.readingHistoryActivation){this.readingHistoryActivated=!0,this.activationStatusIsEditable=this.sierraService.activationStatusIsEditable,this.rawBibIds=s.map(e.data.entries,(e=>({bibId:i(e.bib?e.bib:e.item),checkoutId:e.id,outDate:e.outDate})));const t=this.sierraService.createApiQuery(this.rawBibIds);if(t)return this.apiService.get("search",t,{avoidUpdateFire:!0})}})).then((e=>e&&e.data?(this.docs=s.map(this.rawBibIds,(t=>{var s;let a=this.sierraService.findDocIfExists(e.data.documents,t.bibId);a||(a=this.sierraService.createDummyDoc(this.i18n.translations.NO_RESOURCE_FOUND));const r=i(t.checkoutId),{bibId:n}=t,o=t.outDate,l=(null===(s=a.authors)||void 0===s?void 0:s.length)?a.authors[0].fullname:void 0,{title:c}=a;return{doc:a,checkoutId:r,bibId:n,checkoutDate:o,author:l,title:c}})),this.sortList()):this.docs=[])).then((()=>(0===this.docs.length&&this.readingHistoryActivated&&(this.emptyListMessage=this.i18n.translations.READING_HISTORY_EMPTY),e&&(this.success=e,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3)),t&&(this.error=t,this.alerts.pulseAlert("libraryCardError",this.error,1e4)),this.isLoading=!1,this.updateSelected()))).catch((e=>this.handleError(e)))}handleError(e){this.$log.error(e),this.isLoading=!1,this.listLoadError=!0;const t=e.data&&e.data.message?e.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.READING_HISTORY_ERROR,{error:t}),this.alerts.setAlert("libraryCardListLoadError",this.error)}sortList(e=this.sortOptions[0]){return this.sortOptionSelected=e,this.docs=e.dateOrCode?this.$filter("orderBy")(this.docs,e.sortBy):this.$filter("localeSort")(this.docs,e.sortBy)}getSortByOption(){return this.sortOptionSelected.translation}updateSelected(){return this.selectedCount=s.filter(this.docs,(e=>e.selected)).length,this.allSelected=this.selectedCount===this.docs.length}toggle(e){return s.each(this.docs,(e=>e.selected=this.allSelected)),this.updateSelected()}deleteEntry(e){return this.success="",this.error="",this.isLoading=!0,this.sierraService.deleteReadingHistoryEntry(e).then((e=>(this.$log.debug(" reading history entry succesfully deleted "),this.success=this.i18n.translations.READING_HISTORY_DELETION_SUCCESS,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3),this.loadReadingHistory()))).catch((e=>(this.$log.error("error deleting reading history entry ",e),this.isLoading=!1,window.scrollTo(0,0),this.error=this.i18n.translations.READING_HISTORY_DELETION_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}deleteSelectedReadingHistory(){return s.filter(this.docs,(e=>e.selected)).length===this.docs.length?this.deleteAllReadingHistoryEntries():this.deleteSomeSelectedEntries()}deleteAllReadingHistoryEntries(){return this.success="",this.error="",this.isLoading=!0,this.sierraService.deleteAllReadingHistoryEntries().then((e=>this.loadReadingHistory(this.i18n.translations.READING_HISTORY_DELETION_SUCCESS))).catch((e=>(this.$log.error("error deleting all reading history ",e),this.isLoading=!1,window.scrollTo(0,0),this.error=this.i18n.translations.READING_HISTORY_DELETION_ERROR_ALL,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}deleteSomeSelectedEntries(){this.success="",this.error="",this.isLoading=!0;const e=s.filter(this.docs,(e=>e.selected)),t=s.map(e,(e=>this.sierraService.createAlwaysSuccessPromise(this.sierraService.deleteReadingHistoryEntry(e.checkoutId),e.checkoutId)));return this.$q.all(t).then((t=>{this.isLoading=!1;const i=[],a=[];return s.map(t,(e=>"success"===e.status?i.push(e.checkoutId):a.push({checkoutId:e.checkoutId,error:e.original}))),i.length===e.length?this.loadReadingHistory(this.i18n.translations.READING_HISTORY_DELETION_SUCCESS_ALL):a.length&&!i.length?(this.error=this.i18n.translate(this.i18n.translations.READING_HISTORY_DELETION_SOME_ERROR,{number:a.length}),this.alerts.pulseAlert("libraryCardError",this.error,1e4)):!a.length&&i.Length?this.loadReadingHistory("",this.i18n.translate(this.i18n.translations.CHECKED_OUT_RENEWAL_SOME_ERROR,{number:a.length})):void 0})).catch((e=>(this.error=this.i18n.translations.READING_HISTORY_DELETION_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}deleteHistoryAndOptOutIfUserConfirms(){return this.$uibModal.open({templateUrl:"/assets/libraryCard/confirmActionDialog.html",controller:"libraryCardConfirmActionDialogController",controllerAs:"vm",backdrop:!1,keyboard:!0,size:"sm",openedClass:"confirmation-modal-open"}).result.then((()=>this.deleteHistoryAndOptOut())).catch((()=>angular.noop))}deleteHistoryAndOptOut(){return this.isLoading=!0,this.sierraService.deleteReadingHistoryAndOptOut().then((()=>this.loadReadingHistory(this.i18n.translations.READING_HISTORY_OPT_OUT_SUCCESS))).catch((e=>{var t;return this.$log.error(e),this.isLoading=!1,"DELETE"===(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.method)?(this.error=this.i18n.translations.READING_HISTORY_OPT_OUT_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4)):this.loadReadingHistory("",this.i18n.translations.READING_HISTORY_OPT_OUT_ERROR)}))}optOut(){return this.isLoading=!0,this.sierraService.optOutFromReadingHistory().then((()=>this.loadReadingHistory())).catch((e=>(this.$log.error(e),this.isLoading=!1,this.error=this.i18n.translations.READING_HISTORY_OPT_OUT_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}optIn(){return this.isLoading=!0,this.sierraService.optInToReadingHistory().then((()=>this.loadReadingHistory())).catch((e=>(this.$log.error(e),this.isLoading=!1,this.error=this.i18n.translations.READING_HISTORY_OPT_IN_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}}a.$inject=["$scope","$document","sierraService","apiService","translationService","alertService","$q","$log","$uibModal","$filter","$rootScope","$authEvents"],angular.module("summonApp.controllers").controller("libraryCardReadingHistoryListController",a)},4460:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c,h){this.$onInit=this.$onInit.bind(this),this.$onChanges=this.$onChanges.bind(this),this.loadHolds=this.loadHolds.bind(this),this.updateSelected=this.updateSelected.bind(this),this.toggle=this.toggle.bind(this),this.cancelHold=this.cancelHold.bind(this),this.cancelSelectedHolds=this.cancelSelectedHolds.bind(this),this.$scope=e,this.sierraService=t,this.apiService=i,this.$q=r,this.$log=n,this.$uibModal=o,this.$filter=l,this.i18n=s,this.isLoading=!1,this.docs=[],this.rawBibIds=[],this.selectedCount=0,this.allSelected=!1,this.sortOptions=[{sortBy:"doc.full_title",translation:s.translations.TITLE,dateOrCode:!0},{sortBy:"requestDate",translation:s.translations.REQUEST_DATE,dateOrCode:!0},{sortBy:"pickupLocation",translation:s.translations.PICKUP_LOCATION,dateOrCode:!1}],this.sortOptionSelected={sortBy:"",translation:"",dateOrCode:!1},this.alerts=a,this.userInfo=this.sierraService.getLoadedUserInfo(),c.$on(h.LOGOUTSUCCESS,(()=>this.docs=[]))}$onInit(){this.loadHoldsWhenReady()}$onChanges(e){var t,i;if((null===(t=e.reloadTrigger)||void 0===t?void 0:t.currentValue)||(null===(i=e.newRequestMade)||void 0===i?void 0:i.currentValue))return this.loadHoldsWhenReady()}loadHoldsWhenReady(){return this.isLoading=!0,this.sierraService.patronInfoLoadedPromise.promise.then((()=>this.loadHolds())).catch((e=>this.handleError(e)))}loadHolds(){const e=e=>{var t,i,s,a,r,n;const o="i"===e?"item":"bib";return!((null===(s=null===(i=null===(t=this.userInfo)||void 0===t?void 0:t.holdConfig)||void 0===i?void 0:i[o])||void 0===s?void 0:s.useHomePickupLocation)||(null===(n=null===(r=null===(a=this.userInfo)||void 0===a?void 0:a.holdConfig)||void 0===r?void 0:r[o])||void 0===n?void 0:n.useItemPickupLocation))};return this.isLoading=!0,this.sierraService.getHolds().then((e=>{var t;if(null==(null===(t=e.data)||void 0===t?void 0:t.entries))throw{data:{message:"API response empty."}};const i=s.filter(e.data.entries,(e=>"i"===e.recordType)),a=s.map(i,(e=>e.record.id));return a.length>0?this.sierraService.getItemsInfo(a).then((t=>{var a;return null==(null===(a=t.data)||void 0===a?void 0:a.entries)||s.each(i,(e=>{const i=s.find(t.data.entries,(t=>e.record.id===t.id));if(i){const t=s.find(i.varFields,(e=>"v"===e.fieldTag));if(t)return e.volume=t.content}})),this.$q.resolve(e)})).catch((t=>(this.$log.debug("error grabbing item info, ignoring and will continue",t),this.$q.resolve(e)))):this.$q.resolve(e)})).then((t=>{this.sierraService.resetNewRequestTracker(),this.rawBibIds=s.chain(t.data.entries).map((t=>({bibId:t.record.bibIds?t.record.bibIds[0]:t.record.id,recordId:t.record.id,pickupLocation:t.pickupLocation,holdId:t.id,status:t.status.code,requestDate:t.placed,volume:t.volume,record:t.record,locationEditable:e(t.recordType)}))).value(),this.sierraService.previousHoldRequestId&&(0===s.filter(this.rawBibIds,(e=>e.bibId===this.sierraService.previousHoldRequestId)).length?(this.success=this.i18n.translations.REQUESTS_MAY_NOT_BE_UP_TO_DATE,this.alerts.setAlert("libraryCardSuccess",this.success)):this.sierraService.previousHoldRequestId=null);const i=this.sierraService.createApiQuery(this.rawBibIds);if(i)return this.apiService.get("search",i,{avoidUpdateFire:!0})})).then((e=>e&&e.data?this.docs=s.map(this.rawBibIds,(t=>{var i;const{locationEditable:s}=t,a=t.pickupLocation.name,r=this.sierraService.getIdFromUrlString(t.holdId);let n=this.sierraService.findDocIfExists(e.data.documents,t.bibId)||this.sierraService.findDocIfExists(e.data.documents,t.recordId);return n||(n=(null===(i=t.record)||void 0===i?void 0:i.title)?{content_type:t.record.materialType?t.record.materialType.value:"",display_thumbnail:"",full_title:t.record.title,authors:t.record.author?[{fullname:t.record.author}]:void 0,summary:t.record.publishYear}:this.sierraService.createDummyDoc(this.i18n.translations.NO_RESOURCE_FOUND)),t.volume&&!n.missingDocDisplay&&(n=angular.copy(n),n.full_title?n.full_title+=" - "+t.volume:n.title?n.full_title=n.title+" - "+t.volume:n.full_title="Unknown - "+t.volume),{doc:n,pickupLocation:a,locationEditable:s,holdId:r,bibId:t.bibId,requestDate:t.requestDate}})):this.docs=[])).then((()=>(0===this.docs.length&&this.success!==this.i18n.translations.REQUESTS_MAY_NOT_BE_UP_TO_DATE?this.emptyListMessage=this.i18n.translations.REQUESTS_EMPTY:this.sortList(),this.isLoading=!1,this.updateSelected()))).catch((e=>this.handleError(e)))}handleError(e){this.$log.error(e),this.isLoading=!1;const t=e.data&&e.data.message?e.data.message:this.i18n.translations.REQUEST_ERROR_UNKNOWN;return this.error=this.i18n.translate(this.i18n.translations.REQUESTS_ERROR,{error:t}),this.alerts.setAlert("libraryCardListLoadError",this.error)}showEmptyListMessage(){return this.success!==this.i18n.translations.REQUESTS_MAY_NOT_BE_UP_TO_DATE&&!this.isLoading&&!this.docs.length&&!this.error}sortList(e=this.sortOptions[0]){return this.sortOptionSelected=e,this.docs=e.dateOrCode?this.$filter("orderBy")(this.docs,e.sortBy):this.$filter("localeSort")(this.docs,e.sortBy)}getSortByOption(){return this.sortOptionSelected.translation}editPickupLocation(e,t){return this.$uibModal.open({templateUrl:"/assets/libraryCard/editPickupLocationDialog.html",controller:"libraryCardEditPickupLocationController",controllerAs:"vm",resolve:{holdId:()=>e,bibId:()=>t},backdrop:!0,keyboard:!0}).result.then((()=>this.loadHolds()))}updateSelected(){return this.selectedCount=s.filter(this.docs,(e=>e.selected)).length,this.allSelected=this.selectedCount===this.docs.length}toggle(e){return s.each(this.docs,(e=>e.selected=this.allSelected)),this.updateSelected()}cancelHold(e){this.success="",this.error="",this.isLoading=!0;const t=s.findIndex(this.docs,(t=>t.holdId===e));return this.sierraService.deleteHold(e).then((e=>(this.docs.splice(t,1),this.$log.debug(" hold succesfully canceled "),this.success=this.i18n.translations.REQUESTS_CANCEL_SUCCESS,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3),this.updateSelected(),this.isLoading=!1))).catch((e=>{if(this.$log.error("error canceling hold ",e),this.isLoading=!1,404===e.status){this.error=this.i18n.translations.REQUESTS_CANCEL_ERROR_404;const e=this.i18n.translations.PLEASE_RELOAD_TO_TRY_AGAIN;return this.alerts.pulseAlert("libraryCardListLoadError",this.error,1e4,e)}return this.error=this.i18n.translations.REQUESTS_CANCEL_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4)}))}cancelSelectedHolds(){this.success="",this.error="",this.isLoading=!0;const e=s.filter(this.docs,(e=>e.selected)),t=s.map(e,(e=>this.sierraService.createAlwaysSuccessPromise(this.sierraService.deleteHold(e.holdId),e.holdId)));return this.$q.all(t).then((t=>{this.isLoading=!1;const i=[],a=[];if(s.map(t,(e=>"success"===e.status?i.push(e.holdId):a.push({holdId:e.holdId,error:e.original}))),i.length===e.length&&(this.success=this.i18n.translations.REQUESTS_CANCEL_SUCCESS_ALL,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3)),this.docs=s.filter(this.docs,(e=>!i.includes(e.holdId))),0===this.docs.length&&this.success!==this.i18n.translations.REQUESTS_CANCEL_SUCCESS_ALL&&(this.success=this.i18n.translations.REQUESTS_EMPTY,this.alerts.pulseAlert("libraryCardSuccess",this.success,5e3)),a.length)return this.error=this.i18n.translate(this.i18n.translations.REQUESTS_CANCEL_SOME_ERROR,{number:a.length}),this.alerts.pulseAlert("libraryCardError",this.error,1e4)})).catch((e=>(this.error=this.i18n.translations.REQUESTS_CANCEL_ERROR,this.alerts.pulseAlert("libraryCardError",this.error,1e4))))}}a.$inject=["$scope","sierraService","apiService","translationService","alertService","$q","$log","$uibModal","$filter","$rootScope","$authEvents"],angular.module("summonApp.controllers").controller("libraryCardRequestListController",a)},1349:()=>{"use strict";const e={de:"de-de",es:"es-es","es-41":"es-es",fi:"fi-fi",it:"it-it",ar:"ar-ar",jp:"ja"};class t{constructor(t,i,s,a,r,n){this.$scope=t,this.config=i,this.$scope.embeddedValues=r,this.$scope.behaviorClass={},this.$scope.behaviorClass.btn=!!n.asBtn,this.$scope.behaviorClass["btn-link"]=!n.asBtn,this.scopeLinks=this.$scope.links={links:[],flow:this.config.data.flow.enabled,localizedHelpTemplate:`/assets/help/help_${s.id}.html`},a.get(this.scopeLinks.localizedHelpTemplate)||null==e[s.id]||(this.scopeLinks.localizedHelpTemplate=`/assets/help/help_${e[s.id]}.html`),a.get(this.scopeLinks.localizedHelpTemplate)||(this.scopeLinks.localizedHelpTemplate="/assets/help/help_en-us.html");const o=["feedback","help"];for(var l in this.config.data.links){var c,h=this.config.data.links[l];"feedback"===l&&this.scopeLinks.flow&&(c={type:"flow"},this.scopeLinks.links.push(c)),"#"!==h.href&&(c={type:l,href:h.href,label:h.label},o.includes(l)&&(c.click=this.$scope.displayDialog),h.image&&(c.image=h.image),(c.href&&c.label||c.click&&c.label)&&this.scopeLinks.links.push(c))}}}t.$inject=["$scope","configService","$locale","$templateCache","embeddedWidgetValues","$attrs"],angular.module("summonApp.controllers").controller("LinksCtrl",t)},9155:()=>{"use strict";class e{constructor(e,t){this.$scope=e,this.localizationService=t,this.$scope.localization=this.localizationService.localization}}e.$inject=["$scope","localizationService"],angular.module("summonApp.controllers").controller("LocalizationCtrl",e)},5012:()=>{"use strict";class e{constructor(e,t){this.$scope=e,this.chat=t,this.$scope.chat=this.chat.scope.chat}}e.$inject=["$scope","chatService"],angular.module("summonApp.controllers").controller("MenuBarCtrl",e)},7197:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s){this.$onInit=this.$onInit.bind(this),this.handleAppStateChange=this.handleAppStateChange.bind(this),this.processLayoutChange=this.processLayoutChange.bind(this),this.$scope=e,this.mediaQueryService=i,this.appState=s,this.$scope.floating=!1,this.$scope.pinned=!1,this.$scope.content={},this.registerMenu=t.registerMenu,this.appState.on("apply",(()=>this.handleAppStateChange()))}$onInit(){return this.$scope.type=this.$scope.type||"menu",this.$scope.pinned&&this.$scope.floating&&(this.$scope.open=!0,this.$scope.floating=!0),this.registerMenu(this.$scope),this.processLayoutChange(this.mediaQueryService.current),this.mediaQueryService.on("change",((e,t)=>this.processLayoutChange(e,t)))}handleAppStateChange(){if(this.$scope.closeOnAppstateChange&&this.$scope.floating)return this.$scope.closeMenu()}processLayoutChange(e,t){this.$scope.size=e,angular.isArray(this.$scope.floatSize)&&(this.$scope.floating=s.any(this.$scope.floatSize,(t=>t===e.size||"any"===t))),this.$scope.floating&&(this.$scope.floating=!0,this.$scope.open=!0);let i=!1;angular.isArray(this.$scope.openSize)&&(i=s.any(this.$scope.openSize,(t=>t===e.size||"any"===t)));let a=!1;return angular.isArray(this.$scope.closeSize)&&(a=s.any(this.$scope.closeSize,(t=>t===e.size||"any"===t))),a&&!i?this.$scope.closeMenu():i?this.$scope.openMenu():void 0}}a.$inject=["$scope","menuManagerService","mediaQueryService","appStateService"],angular.module("summonApp.controllers").controller("MenuCtrl",a)},7458:()=>{"use strict";class e{constructor(e,t){this.$scope=e,this.$uibModalInstance=t,this.$scope.close=e=>{var t,i;return null==e||e.preventDefault(),this.$uibModalInstance.dismiss("close"),null===(i=(t=this.$scope).closeCallback)||void 0===i?void 0:i.call(t)}}}e.$inject=["$scope","$uibModalInstance"],angular.module("summonApp.controllers").controller("ModalInstanceCtrl",e)},3802:function(){"use strict";var e=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,r){function n(e){try{l(s.next(e))}catch(e){r(e)}}function o(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,o)}l((s=s.apply(e,t||[])).next())}))};class t{constructor(t,i,s,a,r,n,o,l,c,h){this.pageChanged=()=>e(this,void 0,void 0,(function*(){"search"===this.$scope.view?(this.resultsFeedScope.newSearchInfo.isNewSearch=!1,this.resultsFeedScope.viewState.currentView="search",this.resultsFeedScope.deferAutocompleteAbort&&this.resultsFeedScope.deferAutocompleteAbort.resolve(),yield this.resultsFeedService.loadPage(this.$scope.currentPage)):"citation-trail"===this.$scope.view&&this.$scope.selectedTab==this.searchTabs.citationTrail?(this.citationTrail.currentPage=this.$scope.currentPage,yield this.citationTrail.loadPage(this.$scope.currentPage)):"course-reserves"===this.$scope.view?this.courseReserve.get(this.$scope.currentPage):"course-reserves-detail"===this.$scope.view&&this.courseReserve.getDetailDocs(this.$scope.currentPage)})),this.$onInit=this.$onInit.bind(this),this.$scope=t,this.resultsFeedScope=this.$scope.$parent,this.appState=i,this.resultsFeedService=s,this.config=a,this.resultsConfig=this.config.data.results,this.$scope.currentPage=this.appState.params.pn||1,this.$scope.itemsPerPage=this.$scope.itemsPerPage||this.resultsConfig.pageSize,this.$scope.maxItems=this.resultsConfig.pageSize*this.resultsFeedService.maxPages,this.$scope.pageChanged=this.pageChanged.bind(this),this.searchService=r,this.$window=n,this.citationTrail=o,this.searchTabs=c,this.viewState=h,this.courseReserve=l,this.$scope.$watch("itemsCount",(e=>this.$scope.currentMax=e?Math.min(this.$scope.maxItems,e):e))}$onInit(){this.setPaginationSizeOnScreenSize(),this.$window.addEventListener("popstate",this.extractPageFromUrl.bind(this)),this.$window.addEventListener("resize",this.setPaginationSizeOnScreenSize.bind(this)),this.alignPageNumberWithView()}setPaginationSizeOnScreenSize(){this.$window.innerWidth<=1024?this.$scope.maxSize=3:this.$scope.maxSize=4}extractPageFromUrl(){const e=window.location.hash.split("pn=")[1];if(e){const t=e.split("&")[0];t!=this.$scope.currentPage&&(this.$scope.currentPage=+t,"quick-look"!=this.viewState.subView&&this.pageChanged())}}alignPageNumberWithView(){"search"===this.$scope.view?this.$scope.currentPage=+this.appState.params.pn:"citation-trail"===this.$scope.view&&this.$scope.selectedTab==this.searchTabs.citationTrail?this.$scope.currentPage=this.citationTrail.currentPage||1:"course-reserves"===this.$scope.view?this.$scope.currentPage=this.courseReserve.scope.page:"course-reserves-detail"===this.$scope.view&&(this.$scope.currentPage=this.courseReserve.detailScope.pn)}}t.$inject=["$scope","appStateService","resultsFeedService","configService","searchService","$window","citationTrailService","courseReserveService","$searchTabs","viewStateService"],angular.module("summonApp.controllers").controller("PaginationCtrl",t)},3190:()=>{"use strict";class e{constructor(e,t,i,s){this.setSelection=this.setSelection.bind(this),this.retrieveSince=this.retrieveSince.bind(this),this.toggleBtnDatepicker=this.toggleBtnDatepicker.bind(this),this.$scope=e,this.dateRange=t,this.translationService=i,this.searchScopeService=s,this.$scope.range=this.dateRange.range,this.$scope.selection=this.dateRange.selection,this.$scope.setSelection=this.setSelection,this.$scope.retrieveSince=this.retrieveSince,this.$scope.toggleBtnDatepicker=this.toggleBtnDatepicker,this.$scope.datePresets=this.dateRange.defaultPresets,this.$scope.datePresetLabels=this.dateRange.datePresetLabels,this.$scope.i18n=this.translationService,this.$scope.facetDatepicker=this.dateRange.facetDatepicker}setSelection(e){this.dateRange.setSelection({start:e.start,end:e.end}),this.dateRange.applySelection()}retrieveSince(e,t){const i=(t=!1)=>{t||(this.setSelection(this.dateRange.retrieveSince(e)),this.dateRange.applySelection())};t.preventDefault(),this.dateRange.searchScopeDateIsApplied()?this.searchScopeService.clearScopeAsSideEffect("",i):i()}toggleBtnDatepicker(){return this.dateRange.toggleBtnDatepicker()}}e.$inject=["$scope","dateRangeService","translationService","searchScopeService"],angular.module("summonApp.controllers").controller("PubDateSliderCtrl",e)},60:()=>{"use strict";class e{constructor(e,t){this.toggleFilter=this.toggleFilter.bind(this),this.$scope=e,this.quickFilters=t,this.$scope.quickFilters=this.quickFilters.scope,this.$scope.toggleFilter=this.toggleFilter,this.$scope.getFilterClasses=this.quickFilters.getFilterClasses}toggleFilter(e,t){var i;return"checkmark"===(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.className)&&t.preventDefault(),this.quickFilters.toggle(e)}}e.$inject=["$scope","quickFiltersService"],angular.module("summonApp.controllers").controller("QuickFiltersCtrl",e)},8024:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l,c,h,d,u,p,m,g){this.scope=e,this.$timeout=t,this.translationService=i,this.$uibModalInstance=s,this.$uibModal=a,this.quickLookService=r,this.documentService=n,this.configService=o,this.quickLookConfig=this.configService.data.quickLook,this.localizationService=l,this.appState=c,this.feed=h,this.$route=d,this.dialogService=u,this.journalCoverageDetailsService=p,this.citationTrail=m,this.initialize(),this.scope.quickLookLoading=!1,this.scope.i18n=this.translationService,this.scope.closeQuickLook=this.closeQuickLook,this.scope.isPrev=this.isPrev,this.scope.isLast=this.isLast,this.scope.isQuickLookLoading=this.isQuickLookLoading,this.scope.isRTL=this.isRTL,this.scope.getTotalResults=this.getTotalResults,this.scope.getCurrentIndex=this.getCurrentIndex,this.viewState=g,this.setDocumentDependentAttributes(),this.appState.on("apply",(()=>{if(!this.scope.quickLookLoading&&!this.scope.isNavigating)return this.closeQuickLook(null)}))}$onInit(){return this.scope.isNavigating=!1,this.$uibModalInstance.result.then((()=>(this.focusResultIndex(this.scope.index),this.viewState.subView=""))).catch((e=>(console.warn(e),this.focusResultIndex(this.scope.index),this.viewState.subView="")))}initialize(){this.scope.rtaLoaded={loaded:!0},this.scope.detailsExpanded={subjectKeywords:this.quickLookConfig.expandedItems.includes("subject_keywords"),subjects:this.quickLookConfig.expandedItems.includes("subjects"),author_syndetics:this.quickLookConfig.expandedItems.includes("syndetics"),reviews_syndetics:this.quickLookConfig.expandedItems.includes("syndetics"),summary_syndetics:this.quickLookConfig.expandedItems.includes("syndetics"),details:this.quickLookConfig.expandedItems.includes("record_details"),library_notes:this.quickLookConfig.expandedItems.includes("library_notes")},this.scope.syndeticsLoaded={authors:{loaded:!1},reviews:{loaded:!1},summary:{loaded:!1}},this.scope.isRTL=this.localizationService.localization.isRTL,this.scope.allDocumentsSummary=this.quickLookService.getAllDocumentsSummary(this.scope.feed.items),this.scope.totalResults=this.quickLookService.getTotalResults(this.scope.feed.items),null!=this.scope.document.index?this.scope.index=this.getCurrentIndex():this.scope.index=1,this.scope.leaveOpen=!1,this.scope.displayJournalCoverageRanges=this.configService.data.results.displayJournalCoverageRanges}isPrev(){return this.scope.index>1}isLast(){return this.scope.index===this.scope.totalResults}findItemByIndex(e){return this.scope.allDocumentsSummary.find((t=>{var i;return(null===(i=t.document)||void 0===i?void 0:i.index)===e}))}isQuickLookLoading(){return this.scope.quickLookLoading}isRTL(){return this.localizationService.localization.isRTL}getTotalResults(){return this.scope.totalResults}getCurrentIndex(){return this.scope.document.index}focusResultIndex(e){const t=document.querySelector(`[data-aid="result-number-${e}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}clickPrev(){if(this.scope.isNavigating=!0,!this.isPrev()||this.scope.quickLookLoading)return;const e=this.findItemByIndex(this.scope.index-1);e&&!e.hidden?(this.scope.index--,this.scope.document=e.document,this.setDocumentDependentAttributes()):(this.scope.quickLookLoading=!0,this.feed.loadPrev().then((()=>{this.showAfterLoad(!1)})))}clickNext(){if(this.scope.isNavigating=!0,this.isLast()||this.scope.quickLookLoading)return;const e=this.findItemByIndex(this.scope.index+1);e&&!e.hidden?(this.scope.index++,this.scope.document=e.document,this.setDocumentDependentAttributes()):this.getNext()}getNext(){this.scope.quickLookLoading=!0,this.feed.loadNext(!0).then((()=>{this.showAfterLoad(!0)})).catch((e=>{console.error("An error occured while closing quick look -> "+e),this.scope.quickLookLoading=!1}))}showAfterLoad(e,t=1){this.initialize();const i=this.findItemByIndex(e?this.scope.index+1:this.scope.index-1);if(!i){if(t>10)return console.error("Could not find quicklook item after 10 tries"),void(this.scope.quickLookLoading=!1);this.$timeout((()=>{this.showAfterLoad(e,t+1)}),100)}e?this.scope.index++:this.scope.index--,this.scope.document=i.document,this.setDocumentDependentAttributes(),this.scope.quickLookLoading=!1}closeQuickLook(e){return this.scope.quickLookLoading=!1,this.dialogService.closeModalDialog(e),e&&e.stopPropagation(),this.$uibModalInstance.dismiss("closebutton")}setDocumentDependentAttributes(){this.setConfigAttributes(),this.scope.showDocumentGlanceability=this.documentService.showDocumentGlanceability,this.scope.getDocumentGlancebilityIcon=this.documentService.getDocumentGlancebilityIcon,this.scope.displayWarningGlanceability=this.documentService.displayWarningGlanceability,this.scope.getWarningGlanceabilityPublications=this.documentService.getWarningGlanceabilityPublications,this.scope.getWarningGlanceabilityNotices=this.documentService.getWarningGlanceabilityNotices,this.scope.checkGlanceabilityEnablmentFromCustomizer=this.documentService.checkGlanceabilityEnablmentFromCustomizer,this.scope.displaySecondaryPublicationsTypesSeparator=this.documentService.displaySecondaryPublicationsTypesSeparator,this.scope.displaySecondaryNoticeTypesSeparator=this.documentService.displaySecondaryNoticeTypesSeparator,this.scope.document.index=this.scope.document.index||this.scope.index,this.scope.availabilityDocs=[this.scope.document].concat(this.scope.document.peer_documents||[]),this.scope.authors=this.documentService.getAuthors(this.scope.document),this.scope.showVideoLink=this.documentService.showVideoLink(this.scope.document),this.scope.showVideoLink&&(this.scope.videoLink=this.documentService.getVideoLink(this.scope.document)),this.scope.computedVals=this.documentService.getComputedValues(this.scope.document),this.scope.syndeticsIsbn=this.scope.document.isbn,this.scope.showSyndeticsContent=this.quickLookService.showSyndeticsContent(this.scope.document);const e=this.configService.data.results;return this.scope.displayPeerReviewIndicator=e.displayPeerReviewIndicator&&this.scope.document.is_peer_reviewed,this.scope.displayOpenAccessIndicator=e.displayOpenAccessIndicator&&this.scope.document.is_open_access,this.scope.addOpenAccessLink=e.addOpenAccessLink&&this.scope.document.open_access_link,this.scope.document.journalCoverageSummary=this.journalCoverageDetailsService.getJournalCoverageSummary(this.scope.document),this.scope.showJournalCoverage=this.journalCoverageDetailsService.isJournalCoverageAvailable(this.scope.document)&&this.scope.displayJournalCoverageRanges,this.scope.showPublicNotes=this.quickLookService.showPublicNotes(this.scope.document),this.scope.displayCitationTrail=e.displayCitationTrail&&(this.citationTrail.hasCitedBy(this.scope.document)||this.citationTrail.hasCites(this.scope.document))}setConfigAttributes(){const e=this.configService.data.results;return this.scope.displayUnpaywallPDFs=e.displayUnpaywallPDFs,this.scope.displayLinkResolver=e.displayLinkResolver,this.scope.displayPdfQuickLinks=e.displayPdfQuickLinks,this.scope.displayHtmlQuickLinks=e.displayHtmlQuickLinks,this.scope.maximumFullTextLinks=e.maximumFullTextLinks,this.scope.enableAdditionalFullTextLinks=e.enableAdditionalFullTextLinks,this.scope.displayMultipleFullTextLinks=this.scope.maximumFullTextLinks>1&&this.scope.enableAdditionalFullTextLinks,this.scope.altmetrics=this.configService.data.altmetrics,this.scope.showCallNums=this.quickLookService.showCallNums(),this.scope.showDeweys=this.quickLookService.showDeweys(),this.scope.displayLibraryNotes=this.quickLookService.displayLibraryNotes(),this.scope.syndeticsClient=this.quickLookService.syndeticsClient()}}e.$inject=["$scope","$timeout","translationService","$uibModalInstance","$uibModal","quickLookService","documentService","configService","localizationService","appStateService","resultsFeedService","$route","dialogService","journalCoverageDetailsService","citationTrailService","viewStateService"],angular.module("summonApp.controllers").controller("QuickLookCtrl",e)},6581:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l,c,h,d){this.displayRefinePane=this.displayRefinePane.bind(this),this.independentFacetsScrollingEnabled=this.independentFacetsScrollingEnabled.bind(this),this.facetsDisabled=this.facetsDisabled.bind(this),this.getActiveFilters=this.getActiveFilters.bind(this),this.deactivateFilter=this.deactivateFilter.bind(this),this.toggleViewMore=this.toggleViewMore.bind(this),this.createFilterRemovalButtonLabel=this.createFilterRemovalButtonLabel.bind(this),this.$scope=e,this.facetsService=i,this.quickFiltersService=s,this.appState=a,this.i18nService=n,this.feed=o,this.menuManager=l,this.citationTrail=c,this.searchTabs=h,this.$scope.facetsScope=this.facetsService.scope,this.quickFiltersScope=this.quickFiltersService.scope,this.$scope.toggleFacetValue=this.facetsService.toggle,this.$scope.displayRefinePane=this.displayRefinePane,this.$scope.independentFacetsScrollingEnabled=this.independentFacetsScrollingEnabled,this.$scope.facetsDisabled=this.facetsDisabled,this.$scope.deactivateFilter=this.deactivateFilter,this.$scope.toggleViewMore=this.toggleViewMore,this.$scope.createFilterRemovalButtonLabel=this.createFilterRemovalButtonLabel,this.$scope.isFullTextApplied=!1,this.$scope.refinePane={visible:!1,filtersApplied:!1,isRTL:r.localization.isRTL,selectedFacetsViewDisabled:d.data.refinePane.selectedFacetsViewDisabled,independentFacetsScrollingEnabled:d.data.refinePane.independentFacetsScrollingEnabled,initialFiltersShowCount:6};const u=()=>{this.$scope.refinePane.filtersApplied=this.appState.filtersApplied(),this.$scope.refinePane.numberOfFiltersApplied=this.appState.numberOfFiltersApplied(),this.$scope.refinePane.activeFilters=this.getActiveFilters(),this.$scope.refinePane.viewAllSelectedBtn=this.$scope.refinePane.numberOfFiltersApplied>this.$scope.refinePane.initialFiltersShowCount,this.$scope.refinePane.currentFiltersShowLimit=this.$scope.refinePane.viewAllSelectedBtn?this.$scope.refinePane.initialFiltersShowCount:this.$scope.refinePane.numberOfFiltersApplied};this.appState.on("apply",u);const p=()=>{const e=!!t.data.search.documents.length,i=this.$scope.facetsScope.applied||this.quickFiltersScope.applied;if(this.$scope.refinePane.visible=e||i,this.$scope.refinePane.activeFilters=this.getActiveFilters(),this.$scope.refinePane.visible){const e=document.getElementsByClassName("refinePane")[0];e&&(e.scrollTop=0)}};t.on("new",p),this.$scope.$on("$destroy",(()=>(this.appState.off("apply",u),t.off("new",p))))}displayRefinePane(){return this.$scope.refinePane.visible&&(!this.feed.scope.hiddenItems||this.menuManager.menu.facets.open)}independentFacetsScrollingEnabled(){return this.$scope.refinePane.independentFacetsScrollingEnabled||!1}facetsDisabled(){return this.citationTrail.scope.type&&this.$scope.selectedTab===this.searchTabs.citationTrail}getActiveFilters(){return this.quickFiltersScope.activeFilters.concat(this.$scope.facetsScope.activeFilters)}deactivateFilter(e){return e.facetGroup?this.facetsService.removeFilterByFacetName(e.facetGroup,e.value):this.quickFiltersService.toggle(e)}createFilterRemovalButtonLabel(e){return e.negated?this.i18nService.translate(this.i18nService.translations.REMOVE_EXCLUSION_FILTER,{filter:e.label||e.translation}):this.i18nService.translate(this.i18nService.translations.REMOVE_FILTER,{filter:e.label||e.translation})}toggleViewMore(){this.$scope.refinePane.currentFiltersShowLimit=this.$scope.refinePane.viewAllSelectedBtn?this.$scope.refinePane.numberOfFiltersApplied:this.$scope.refinePane.initialFiltersShowCount,this.$scope.refinePane.viewAllSelectedBtn=!this.$scope.refinePane.viewAllSelectedBtn}}e.$inject=["$scope","dataService","facetsService","quickFiltersService","appStateService","localizationService","translationService","resultsFeedService","menuManagerService","citationTrailService","$searchTabs","configService"],angular.module("summonApp.controllers").controller("RefinePaneCtrl",e)},5779:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a){this.toggleRelatedItems=this.toggleRelatedItems.bind(this),this.selectTab=this.selectTab.bind(this),this.getMore=this.getMore.bind(this),this.close=this.close.bind(this),this.focusResult=this.focusResult.bind(this),this.$scope=e,this.$timeout=t,this.relatedItems=i,this.bxRecommender=a,this.$scope.relatedItems=this.relatedItems.scope,s.extend(this.$scope.relatedItems,{indicators:this.relatedItems.indicators,isActive:this.relatedItems.isActive,retry:this.relatedItems.retry,toggleRelatedItems:this.toggleRelatedItems,selectTab:this.selectTab,close:this.close,focusResult:this.focusResult,getMore:this.getMore})}toggleRelatedItems(e,t){return this.relatedItems.currTarget=this.relatedItems.isActive(e)&&this.relatedItems.currTarget?null:t.currentTarget,this.relatedItems.toggleRelatedItems(e),this.bxRecommender.close()}selectTab(e){return this.relatedItems.resetFocus=!0,this.relatedItems.selectType(e)}getMore(){return this.relatedItems.resetFocus=!1,this.relatedItems.getMore()}close(){if(this.relatedItems.reset(),this.relatedItems.currTarget)return this.$timeout((()=>(this.relatedItems.currTarget.focus(),this.relatedItems.currTarget=null)))}focusResult(e){let t;const i=this.$scope.relatedItems[this.$scope.relatedItems.type].docs.length;return e===(this.relatedItems.resetFocus||i<this.relatedItems.pageSize?0:(t=i%this.relatedItems.pageSize)>0?i-t:i-this.relatedItems.pageSize)}}a.$inject=["$scope","$timeout","relatedItemsService","bxRecommenderService"],angular.module("summonApp.controllers").controller("RelatedItemsCtrl",a)},7818:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l){this.retryPageRequest=this.retryPageRequest.bind(this),this.feed=t,this.appState=i,this.alerts=a,this.$window=r,this.$timeout=n,e.feed=this.feed.scope,e.searchScopeService=l;const c=s.data.results;e.displayCitationCounts=c.displayCitationCounts,e.displayResultCounts=c.displayResultCounts,e.displayPermalink=c.displayPermalink,e.retryPageRequest=this.retryPageRequest,this.searchScopeService=l,e.load=this.feed.loadMore,e.templateFor=this.templateFor,e.isDefaultScope=this.isDefaultScope,e.$on("apiError",((e,t)=>{if(t.isPageRequest&&this.appState.params.pn>1)return this.appState.params.pn-=1})),e.trustAsHtml=o.trustAsHtml}templateFor(e){return`/assets/resultsFeed/${e.type}.html`}retryPageRequest(){return this.alerts.resetAlert("pageRequestError")}isDefaultScope(e){return this.searchScopeService.isDefaultScope(e)}}e.$inject=["$scope","resultsFeedService","appStateService","configService","alertService","$window","$timeout","$sce","searchScopeService"],angular.module("summonApp.controllers").controller("ResultsFeedCtrl",e)},6551:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){this.$controller=e,this.$scope=t,this.cloudStorage=i,this.savedSearch=s,this.events=a,this.i18n=r,this.alerts=n,this.$controller("SavedSearchAndItemsBaseCtrl",{$scope:this.$scope,cloudStorage:this.cloudStorage,savedSearch:this.savedSearch,events:this.events,i18n:this.i18n,alerts:this.alerts})}}e.$inject=["$controller","$scope","cloudStorageService","savedSearchService","eventService","translationService","alertService"],angular.module("summonApp.controllers").controller("SavedItemModalCtrl",e)},8883:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l){this.flowAuthChange=this.flowAuthChange.bind(this),this.clear=this.clear.bind(this),this.toggle=this.toggle.bind(this),this.keepalive=this.keepalive.bind(this),this.flowSave=this.flowSave.bind(this),this.defineStrategies=this.defineStrategies.bind(this),this.selectStrategy=this.selectStrategy.bind(this),this.$scope=e,this.savedItems=t,this.$timeout=i,this.events=s,this.flow=a,this.i18n=n,this.$location=o,this.idle=!1,this.idleMessage=!1,this.keepalive_interval=6e4,this.flowConfigs=this.flow.configs,this.$scope.auth=this.flow.auth,this.$scope.saveditems={visible:!1},this.$scope.embeddedValues=r,this.$scope.flashTip=this.i18n.translations.TEMP_FOLDER_NOTICE,this.$scope.regTip=this.i18n.translations.SAVED_ITEMS,this.$scope.tooltipMsg=this.$scope.flashTip,this.strategies=this.defineStrategies(),this.selectStrategy("summon"),this.$scope.$watch("idle",(e=>{if(this.idle=e,e)return this.clear()})),this.$scope.$watch("idleMessage",(e=>{if(this.idleMessage=e,e)return this.savedItems.showIdleMessage()})),this.flow.on("authChange",this.flowAuthChange),this.$timeout(this.keepalive,this.keepalive_interval),this.$scope.$on("$destroy",(()=>this.flow.off("authChange",this.flowAuthChange)))}flowAuthChange(){return this.strategy=this.flow.auth.user.authenticated?this.selectStrategy("flow"):this.selectStrategy("summon")}clear(){if(this.savedItems.clear(),!this.idle)return this.events.publish("actions","saved_items:clear")}toggle(){return"/search"!==this.$location.path&&this.$location.path("/search"),"savedItems"===this.$scope.viewState.currentView?(this.$scope.setWindowTitle(this.i18n.translations.RESULTS_FOR+`"${this.$scope.search.query}"`),this.$scope.saveditems.visible=!1,this.$scope.viewState.currentView="search",this.events.publish("actions","saved_items:close")):(this.$scope.setWindowTitle(this.i18n.translations.SAVED_ITEMS),this.$scope.setRetainState(!0),this.$scope.saveditems.visible=!0,this.$scope.viewState.currentView="savedItems",this.events.publish("actions","saved_items:open"))}keepalive(){if(!this.idle)return this.savedItems.save(),this.$timeout(this.keepalive,this.keepalive_interval)}flowSave(e){return this.flow.save([e])}defineStrategies(){return{summon:{add:this.savedItems.add,remove:this.savedItems.remove,clear:this.savedItems.clear,contains:this.savedItems.contains,items:this.savedItems.items,toggle:this.toggle,authd:!1,user:this.savedItems.user,loginEnabled:this.savedItems.loginEnabled},flow:{add:this.flowSave,remove:angular.noop,clear:angular.noop,contains:this.flow.contains,items:this.flow.items,toggle:angular.noop,authd:!0}}}selectStrategy(e){return(()=>{const t=[];for(var i in this.strategies[e]){var s=this.strategies[e][i];this.$scope.saveditems.strategy=e,t.push(this.$scope.saveditems[i]=s)}return t})()}}e.$inject=["$scope","savedItemsService","$timeout","eventService","flowService","embeddedWidgetValues","translationService","$location","localizationService"],angular.module("summonApp.controllers").controller("SavedItemsCtrl",e)},9662:()=>{"use strict";class e{constructor(e,t,i,s,a,r){this.saveSearch=this.saveSearch.bind(this),this.handleError=this.handleError.bind(this),this.hideSpinner=this.hideSpinner.bind(this),this.$scope=e,this.cloudStorage=t,this.savedSearch=i,this.events=s,this.i18n=a,this.alerts=r,this.$scope.i18n=this.i18n,this.$scope.savedSearch=this.savedSearch.scope,this.$scope.providers=this.cloudStorage.scope.providers,this.$scope.saveSearch=this.saveSearch,this.$scope.isSignedIn=this.cloudStorage.isSignedIn,this.$scope.signedInProvider=this.cloudStorage.signedInProvider}saveSearch(){const{currentSearch:e}=this.savedSearch.scope;if(!e.saved)return this.$scope.showSpinner=!0,this.$scope.spinnerAction=this.i18n.translations.SAVING_THIS_ITEM,this.savedSearch.saveSearch().then((t=>{const i=e.activeIdx<0?"new":"edit",s=this.$scope.isSignedIn()?this.i18n.translations.SEARCH_SAVED:this.i18n.translations.SEARCH_SAVED_FOR_SESSION;return this.alerts.toast("savedSearchSuccess",s),this.events.gaPush("saved search","saved",i),this.hideSpinner()})).catch(this.handleError)}handleError(e){return"duplicate"==e.message?this.alerts.setAlert("cloudStorageApiError",this.i18n.translations.SAVE_SEARCH_DUPLICATED):e?this.alerts.setAlert("cloudStorageApiError",this.i18n.translations.CLOUD_STORAGE_API_ERROR+": "+e.name):console.error("Unhandled undefined error",e),this.hideSpinner()}hideSpinner(){return this.$scope.showSpinner=!1}}e.$inject=["$scope","cloudStorageService","savedSearchService","eventService","translationService","alertService"],angular.module("summonApp.controllers").controller("SavedSearchAndItemsBaseCtrl",e)},3007:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l,c,h,d,u){this.setCurrentSearch=this.setCurrentSearch.bind(this),this.resetDialog=this.resetDialog.bind(this),this.getSavedSearches=this.getSavedSearches.bind(this),this.removeSearch=this.removeSearch.bind(this),this.runSearch=this.runSearch.bind(this),this.toggleSavedSearches=this.toggleSavedSearches.bind(this),this.$controller=e,this.$scope=t,this.$location=i,this.cloudStorage=s,this.savedSearch=a,this.events=r,this.i18n=o,this.alerts=l,this.appState=c,this.viewState=h,this.menuManagerService=d,this.moreFacetsService=u,this.$scope.runSearch=this.runSearch,this.$scope.removeSearch=this.removeSearch,this.$scope.toggleSavedSearches=this.toggleSavedSearches,this.$scope.setCurrentSearch=this.setCurrentSearch,this.$scope.getSavedSearches=this.getSavedSearches,this.$scope.cancelEdit=this.savedSearch.resetCurrentSearch,this.$scope.getFilterText=this.savedSearch.getFilterText,this.$scope.removeAllSearches=this.savedSearch.removeAllSearches,this.baseCtrl=this.$controller("SavedSearchAndItemsBaseCtrl",{$scope:this.$scope,cloudStorage:this.cloudStorage,savedSearch:this.savedSearch,events:this.events,i18n:this.i18n,alerts:this.alerts})}setCurrentSearch(e,t){return this.resetDialog(),this.savedSearch.setCurrentSearch(e,t)}resetDialog(){return this.$scope.removeIndex=-1,this.alerts.resetAlert("cloudStorageApiError"),this.savedSearch.resetCurrentSearch()}getSavedSearches(){return this.alerts.resetAlert("savedSearchError"),this.savedSearch.getSavedSearches()}removeSearch(e){return this.savedSearch.resetCurrentSearch(),this.$scope.removeIndex=e,this.$scope.showSpinner=!0,this.$scope.spinnerAction=this.i18n.translations.REMOVING_THIS_ITEM,this.savedSearch.removeSearch(e).then((e=>(this.resetDialog(),this.events.gaPush("saved search","removed","existing"),this.baseCtrl.hideSpinner()))).catch(this.baseCtrl.handleError)}runSearch(e){return this.viewState.currentView="search",this.$scope.resetNewSearchFlag(),this.appState.applyStateWithSnapShot((()=>(this.appState.params=angular.copy(e),this.events.gaPush("saved search","run",e.q))))}toggleSavedSearches(){return"/search"!==this.$location.path&&this.$location.path("/search"),this.menuManagerService.closeAllMenuTypeSubMenu(),"savedSearches"===this.viewState.currentView?(this.$scope.setWindowTitle(this.i18n.translations.RESULTS_FOR+`"${this.$scope.search.query}"`),this.$scope.savedSearch.visible=!1,this.viewState.currentView="search",this.events.publish("actions","saved_searches:close")):(this.$scope.setWindowTitle(this.i18n.translations.SAVED_SEARCHES),this.$scope.setRetainState(!0),this.$scope.savedSearch.visible=!0,this.viewState.currentView="savedSearches",this.events.publish("actions","saved_searches:open"))}}e.$inject=["$controller","$scope","$location","cloudStorageService","savedSearchService","eventService","localizationService","translationService","alertService","appStateService","viewStateService","menuManagerService","moreFacetsService"],angular.module("summonApp.controllers").controller("SavedSearchCtrl",e)},4338:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){this.setCurrentSearch=this.setCurrentSearch.bind(this),this.modalSave=this.modalSave.bind(this),this.$controller=e,this.$scope=t,this.cloudStorage=i,this.savedSearch=s,this.events=a,this.i18n=r,this.alerts=n,this.$scope.title=this.i18n.translations.SAVE_THIS_SEARCH,this.setCurrentSearch(),this.$controller("SavedSearchAndItemsBaseCtrl",{$scope:this.$scope,cloudStorage:this.cloudStorage,savedSearch:this.savedSearch,events:this.events,i18n:this.i18n,alerts:this.alerts}),this.$scope.modalSave=this.modalSave}setCurrentSearch(){return this.alerts.resetAlert("cloudStorageApiError"),this.savedSearch.setCurrentSearch()}modalSave(){return this.$scope.saveSearch().then((()=>this.$scope.close()))}}e.$inject=["$controller","$scope","cloudStorageService","savedSearchService","eventService","translationService","alertService"],angular.module("summonApp.controllers").controller("SavedSearchModalCtrl",e)},6309:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a,r,n,o,l,c,h,d,u,p,m,g,v,S,f,b){this.useEnhancedAutocomplete=this.useEnhancedAutocomplete.bind(this),this.getAutocomplete=this.getAutocomplete.bind(this),this.toggleAdvanced=this.toggleAdvanced.bind(this),this.runSearch=this.runSearch.bind(this),this.clearSearch=this.clearSearch.bind(this),this.$log=S,this.$scope=e,this.appState=t,this.$location=i,this.events=a,this.configs=r,this.datepickerService=n,this.$http=o,this.$locale=l,this.$q=c,this.menuManagerService=u,this.moreFacetsService=p,this.acService=m,this.$uibModal=g,this.dialogService=v,this.searchScopeService=f,this.searchService=b;const y=this.configs.data;this.$scope.search=this.$scope.search||{},this.$scope.search.query=this.$scope.search.query||"",this.$scope.search.advanced=!1,this.$scope.round=Math.round,this.$uibModalInstance=null,this.$scope.search.enableNewSearchButton=y.search.enableNewSearchButton,this.$scope.search.runSearch=s.debounce(this.runSearch,500,!0),this.$scope.search.toggleAdvanced=this.toggleAdvanced,this.$scope.search.useEnhancedAutocomplete=this.useEnhancedAutocomplete,this.$scope.getAutocomplete=s.debounce(this.getAutocomplete,250,!0),this.$scope.deferAutocompleteAbort=null,this.$scope.embeddedValues=h,this.$scope.clearSearch=this.clearSearch,this.$scope.search.onEnhancedAutocompleteResponse=this.acService.transformResponse,this.$scope.search.url=this.acService.getUrl(),this.$scope.hasSearchScopes=this.searchScopeService.hasSearchScopes,this.$scope.isScopeBuilderInit=!1,this.i18n=d,this.$scope.textInformation={textWidth:0,textToMeasure:this.$scope.advancedEnabled?this.i18n.translations.OPTIONS:""};const _=()=>{s.has(this.appState.params,"advanced")&&(this.$scope.search.advanced=!0,delete this.appState.params.advanced);const e=void 0===this.appState.params.q?"":this.appState.params.q;return this.$scope.search.query=e,this.$scope.search.journalTitle=this.appState.params.jt||!1,s.has(this.appState.params,"bookMark")?this.$scope.setWindowTitle(this.i18n.translations.BOOKMARK_RESULT):null!=this.$scope.search.query?this.$scope.setWindowTitle(this.i18n.translations.RESULTS_FOR+`"${this.$scope.search.query}"`):this.$scope.setWindowTitle("Summon 2.0")};this.appState.on("apply",_),this.$scope.$on("$destroy",(()=>this.appState.off("apply",_)))}useEnhancedAutocomplete(){return this.configs.data.autocomplete.enhancedEnabled}getAutocomplete(e){if(!this.configs.data.autocomplete.enabled)return{};const t=this.configs.data.head.client;return this.$scope.deferAutocompleteAbort=this.$q.defer(),this.$http.get("/metadata/suggest/suggest",{params:{prefix:e,type:["/time/event","/event","/base/newsevents/news_reported_event","/base/argumentmaps/morally_disputed_activity","/book/book_subject","/education/field_of_study","/location","/education/academic","/common/topic/subject_of","/medicine","/base/argumentmaps"],type_strict:"should",all_types:!1},timeout:this.$scope.deferAutocompleteAbort.promise}).then((function(e){return s.reject(e.data.result,(function(e){if("vt"===t)return"virginia tech massacre"===e.name.toLowerCase()})).map((e=>e.name))}))}toggleAdvanced(e=!1){this.$scope.isScopeBuilderInit=e;const t=e?" search-scope":"",i=!e;this.dialogService.displayModalDialog(this.$scope,"AdvancedSearchModalCtrl","advanced-search","advancedSearch/advancedSearch.html",i,t)}runSearch(){return this.$scope.newSearchInfo.isNewSearch=!1,this.$scope.viewState.currentView="search",this.$scope.deferAutocompleteAbort&&this.$scope.deferAutocompleteAbort.resolve(),this.searchService.runSearch(this.$scope.search,this.$scope.view)}clearSearch(){return this.$scope.search.query="",angular.element(".searchBox").focus()}}a.$inject=["$scope","appStateService","$location","eventService","configService","datepickerService","$http","$locale","$q","embeddedWidgetValues","translationService","menuManagerService","moreFacetsService","autocompleteService","$uibModal","dialogService","$log","searchScopeService","searchService"],angular.module("summonApp.controllers").controller("SearchBoxCtrl",a)},8630:(e,t,i)=>{"use strict";i.r(t);var s=i(7025),a=i.n(s);class r{constructor(e,t,i,s,a){this.resultsContainerId="main",this.selectTab=this.selectTab.bind(this),this.$scope=e,this.config=t,this.citationTrail=i,this.moreFacets=s,this.searchTabs=a,this.$scope.citationTrail=this.citationTrail.scope,this.$scope.displayCitationTrail=t.data.results.displayCitationTrail,this.$scope.shouldDisplayCitationTrail=e=>t.data.results.displayCitationTrail&&(this.citationTrail.hasCitedBy(e)||this.citationTrail.hasCites(e)),this.$scope.selectedTab=this.searchTabs.search,this.$scope.searchTabs=this.searchTabs,this.$scope.sections={},this.$scope.selectTab=this.selectTab,this.citationTrail.on("citationsTriggered",(()=>this.$scope.selectedTab=this.searchTabs.citationTrail)),this.citationTrail.on("citationsReset",(()=>this.$scope.selectedTab=this.searchTabs.search)),this.generateCustomSection()}initResultsScrollListener(){const e=document.getElementById(this.resultsContainerId);e?(a().element(e).on("scroll",(()=>{const t=e.scrollTop;this.$scope.$applyAsync((()=>{this.$scope.isScrolledDown=t>100}))})),this.$scope.$on("$destroy",(()=>{a().element(e).off("scroll")}))):console.error(`Element with ID "${this.resultsContainerId}" not found.`)}selectTab(e){return this.$scope.selectedTab=e}generateCustomSection(){const e=this.config.data.customSections.displayOrder;this.$scope.sections={};for(let t=0;t<e.length;t++){const i=e[t];this.$scope.sections[i]=`order${t+1} ${i}`}}}r.$inject=["$scope","configService","citationTrailService","moreFacetsService","$searchTabs"],a().module("summonApp.controllers").controller("SearchCtrl",r)},9710:()=>{"use strict";var e=function(){let t;return(e=class{static initClass(){t={Home:{path:"/search",view:"search"},"Course Reserves":{path:"/course_reserves",view:"course_reserves"}}}constructor(e,i,s,a,r,n){this.$scope=e,this.$location=i,this.$timeout=a,this.i18n=r,this.config=s,this.researchAssistantService=n,this.$scope.goToPath=this.goToPath.bind(this),this.$scope.paths=t,this.$scope.navEnabled=!!this.config.data.alma.api_key.trim(),this.$scope.isResearchAssistantEnabled=this.researchAssistantService.isResearchAssistantEnabled,this.$scope.i18n=this.i18n}goToPath(e,t=angular.noop){return t(),this.$location.path(e)}}).initClass(),e}();e.$inject=["$scope","$location","configService","$timeout","translationService","researchAssistantService"],angular.module("summonApp.controllers").controller("TopLinksCtrl",e)},4415:()=>{"use strict";class e{constructor(e,t,i,s){this.wrapInQuotes=this.wrapInQuotes.bind(this),this.displayTopics=this.displayTopics.bind(this),this.$scope=e,this.topics=t,this.util=i,this.feed=s,this.$scope.topic=this.topics.scope,this.$scope.wrapInQuotes=this.wrapInQuotes,this.$scope.displayTopics=this.displayTopics}wrapInQuotes(e){return'"'+this.util.summonEscape(e)+'"'}displayTopics(){return this.$scope.topic.visible}}e.$inject=["$scope","topicService","utilitiesService","resultsFeedService"],angular.module("summonApp.controllers").controller("TopicCtrl",e)},189:()=>{"use strict";angular.module("summonApp.directives").directive("goTo",(()=>({link:(e,t,i)=>(t.on("focus",(function(){const e=angular.element("div.modal");return e.is(":visible")?e.filter(":visible").focus():t.closest("li").removeClass("offscreen").closest("div.skipnav").removeClass("offscreen")})).on("blur",(()=>t.closest("li").addClass("offscreen").closest("div.skipnav").addClass("offscreen"))).on("keypress click",(function(t){var s,a,r;if(""!==i.goTo&&("click"===t.type||"keypress"===t.type&&13===t.keyCode)){let t;return e.closeAllMenuTypeSubMenu(),(null===(s=e.saveditems)||void 0===s?void 0:s.visible)&&(t="#savedItemsContent"),(null===(a=e.savedSearch)||void 0===a?void 0:a.visible)&&(t="#savedSearchContent"),(null===(r=e.docDetail)||void 0===r?void 0:r.visible)&&(t="#detailSummary"),e.$apply(),t=t||i.goTo,angular.element(t).attr("tabindex",-1).focus()}})),e.$on("$destroy",(()=>t.off("focus blur keypress click"))))}))).directive("disableEnter",(()=>({link:(e,t,i)=>t.on("keypress",(function(e){if("keypress"===e.type&&13===e.keyCode)return e.preventDefault()}))}))).directive("keyEvents",["$document","localizationService","dialogService",(e,t,i)=>({link(s){const{isRTL:a}=t.localization;return e.on("keyup",(function(e){const t="search"===s.view&&!s.search.advanced&&!s.menu.facets.open&&!s.subMenu.links.open,r=s.menu.facets.open,n=s.menu.thirdPanel.open,o=s.subMenu.links.open,l=s.saveditems.visible,c=s.docDetail.visible,h=s.search.advanced,d=angular.element("div.modal").is(":visible"),u=a?39:37,p=a?37:39,m=angular.element(document.activeElement),g=angular.element("input[type=text], input[type=email], textarea"),v=angular.element("div.refinePane"),S=angular.element("div.linksMenu"),f=angular.element("#moreFacetsCloseBtn"),b=angular.element("#results"),y=angular.element("#rightPane"),_=angular.element("div.queryBox input[type=text]"),E=m.closest("#results > .inner > ul > li"),A=m.closest("div.citation-content ul > li"),C=E.prev(),$=E.next(),T=(E.find("div.documentSummary"),angular.element("li.activeResult"),angular.element("#menuContentOverlay")),I=angular.element("div.savedItemsDialog"),R=angular.element("#main"),w=angular.element("div.detailPage"),L=(angular.element("div.navigateBack"),angular.element("div.siteHeader *:tabbable:last")),k=angular.element("div.advancedSearchDialog"),D=angular.element("div.modal:visible"),P=angular.element(".dropdown-menu").is(":visible"),O=function(e,t=!1){return t?m.is(e):m.is(e)||m.closest(e).length>0};if(27===e.which&&(!s.areAllMenuTypeSubMenuClosed()||O(_)||i.isClosing?(i.isClosing=!1,s.closeAllMenuTypeSubMenu(),s.$apply()):_.focus()),!O(g))switch(13===e.which&&(m.attr("ng-click")&&!m.is("button")?m.trigger("click"):(m.hasClass("lcs_slide_out")||m.hasClass("s-la-widget-sidetab-a"))&&(m.is("a")?m.trigger("click"):m.find("a").trigger("click"))),!0){case o:return T.on("blur",(()=>S.focus()));case d:if(9===e.which&&!O(D))return D.focus();break;case l:switch(e.which){case 9:if(O(R)&&I.focus(),O(R)&&e.shiftKey)return L.focus();break;case 38:if(O(I,!0)&&I.find("div.citation-content ul > li:first").focus(),O(I)&&!m.is("button.dropdown-toggle"))return A.prev().focus();break;case 40:if(O(I,!0)&&I.find("div.citation-content ul > li:first").focus(),O(I)&&!m.is("button.dropdown-toggle"))return A.next().focus()}break;case c:if(9===e.which&&(O(R)&&w.focus(),O(R)&&e.shiftKey))return L.focus();break;case h:if(9===e.which&&(O(R)&&k.focus(),O(R)&&e.shiftKey))return L.focus();break;case r:if(!o&&13===e.which&&O(f)&&v.focus(),s.menu.facets.floating&&27===e.which)return s.menu.facets.closeMenu(),s.$apply();break;case n:if(s.menu.thirdPanel.floating&&27===e.which)return s.menu.thirdPanel.closeMenu(),s.$apply();break;case t:if(!P)switch(e.which){case 38:if(!m.is(".self-key-binding")&&(O(b,!0)&&b.find("div.inner > ul > li:first").focus(),O(b)&&!m.is("button.dropdown-toggle")))return C.focus();break;case 40:if(!m.is(".self-key-binding")&&(O(b,!0)&&b.find("div.inner > ul > li:first").focus(),O(b)&&!m.is("button.dropdown-toggle")))return $.focus();break;case u:if(!m.is(".self-key-binding"))return!0===O(y)?b.focus():v.focus(),window.scrollTo(0,0);break;case p:if(!m.is(".self-key-binding")){switch(!0){case O(b,!0):case y.is(":visible"):y.focus();break;default:b.focus()}return window.scrollTo(0,0)}}}}))}})]).directive("focusMe",["$timeout",e=>({link:(t,i,s)=>t.$watch(s.focusMe,(function(t){if(t)return e((()=>i[0].focus()))}))})])},514:()=>{"use strict";angular.module("summonApp.directives").directive("advancedDatepickers",(()=>({replace:!0,controller:"AdvancedDatepickersCtrl",templateUrl:"/assets/advancedSearch/advancedDatepickers.html"}))).directive("advancedCheckboxes",["translationService","$facetTypes",(e,t)=>({replace:!0,templateUrl:"/assets/advancedSearch/advancedCheckboxes.html",scope:{filter:"=",values:"=",onChange:"&",blockName:"=",scopeBuilderMode:"<?"},link:i=>(i.i18n=e,i.getFilterClasses=e=>{if(e.disabled)return{applied:e.applied,disabledFacet:e.disabled}},i.orderBy=()=>{if(i.blockName!=t.REFINE_PANE)return i.values[0].orderBy})})]).directive("journalTitleRecommendation",["journalTitleService",e=>({replace:!0,templateUrl:"/assets/journalTitleRecommendation.html",link:t=>t.jt||(t.jt=e.jt)})]).directive("advancedBlock",["translationService","facetsService","advancedSearchService",(e,t,i)=>({replace:!0,templateUrl:"/assets/advancedSearch/advancedBlock.html",scope:{blockName:"@",scopeBuilderMode:"<?",advanced:"=",facetObject:"="},link:t=>(t.i18n=e,t.label=i.get("label",t.blockName),t.sortFacet=i.sortFacetType)})]).directive("advancedSearchDialog",(()=>({replace:!0,controller:"AdvancedSearchCtrl",templateUrl:"/assets/advancedSearchDialog.html",link:e=>e.advanced.syncWithState()}))).directive("advancedSearchFooter",(()=>({replace:!0,templateUrl:"/assets/advancedSearch/advancedSearchFooter.html"})))},9029:(e,t,i)=>{"use strict";var s=i(4125);const a=(e,t,i,s,a,r)=>({replace:!0,templateUrl:s,require:"^^detailPage",scope:{aiDoc:"=",fieldSearch:"&",openClickTrackLink:"&"},link(s){s.searchAIDocs=t.searchAIDocs,s.loaded=!0,s.hideDirective=!1;const n=function(e,t){if(i.isAIDocument(s.aiDoc)&&t.types.includes(r.other))return s.loaded=!0,s.hideDirective||(s.hideDirective="apiError"===e.name)};return s.$on("apiSuccess",n),s.$on("apiError",n),t.on("new",e,(function(){return i.isAIDocument(s.aiDoc)?(s.hideDirective=!1,s.loaded=!1):s.hideDirective=!0})),t.on("update",e,(function(){if(s.hideDirective=!1,null!=s.aiDoc)return i.isAIDocument(s.aiDoc)?(s.aiDocs=i.sortAIDocs(s.aiDoc,t.data.aiDocuments[s.aiDoc.id]),a(s)):s.hideDirective=!0;s.hideDirective=!0})),s.$on("$destroy",(()=>(t.off("new",e),t.off("update",e))))}});angular.module("summonApp.directives").directive("aiAvailability",["documentQueryService","aiDocumentService","translationService","$broadcastTypes",function(e,t,i,s){return a("aiAvailability",e,t,"/assets/aiAvailability.html",(function(e){if(e.i18n=i,e.aiDocs.length)return e.linkText=0===t.isPrint(e.aiDocs[0])?i.translations.AVAILABLE_IN_PRINT:i.translations.AVAILABLE_ONLINE}),s)}]).directive("aiButtons",["documentQueryService","aiDocumentService","$broadcastTypes",function(e,t,i){return a("aiButtons",e,t,"/assets/aiButtons.html",(function(e){if(e.aiButtons=t.getAIButtonValues(e.aiDoc,e.aiDocs),!e.aiButtons.primary.link&&!e.aiButtons.secondary.link)return e.hideDirective=!0}),i)}]).directive("aiDocuments",["documentQueryService","aiDocumentService","translationService","$broadcastTypes",function(e,t,i,s){const r=e=>e.linkText=0===t.isPrint(e)?i.translations.AVAILABLE_IN_PRINT:i.translations.AVAILABLE_ONLINE;return a("aiDocuments",e,t,"/assets/aiDocuments.html",(function(e){if(e.aiDocs.length)return angular.forEach(e.aiDocs,(function(e){return r(e),angular.forEach(e.peer_documents,(e=>r(e)))}));e.hideDirective=!0}),s)}]).directive("otherSources",["linkService","aiDocumentService","translationService",(e,t,i)=>({replace:!0,templateUrl:"/assets/otherSources.html",scope:{document:"="},link:a=>(a.sources=[],a.hideDirective=!1,a.i18n=i,e.on("update","otherSources",(function(e=[]){return a.loaded=!0,a.sources=e,a.hideDirective=!a.sources.length})),a.$watch("document",(function(i,a,r){if(!s.isEmpty(i))return t.isAIDocument(r.document)?(r.hideDirective=!1,r.loaded=!1,e.getSources(i)):r.hideDirective=!0})),a.$on("$destroy",(()=>e.off("update","otherSources"))))})])},5458:()=>{"use strict";angular.module("summonApp.directives").directive("eventAnimate",(()=>({link(e,t,i){const s=e.$eval(i.eventAnimate);return(()=>{const e=[];for(var i in s){var a=s[i];e.push((()=>{const e=[];for(var s in a){var r=a[s];e.push(t.on(i,((e,i)=>function(){return"this"===e&&(e=t),angular.element(e).addClass(i).one("webkitAnimationEnd oanimationend msAnimationEnd animationend webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(()=>angular.element(e).removeClass(i)))})(s,r)))}return e})())}return e})()}})))},7039:()=>{"use strict";angular.module("summonApp.directives").directive("logo",["configService",e=>({replace:!0,scope:{size:"@"},link(t){const{assets:i}=e.data;return t.homeUrl=i.home,t.title=i.title,t.logoSource=(()=>{switch(t.size){case"small":return i.logoSmall;case"large":return i.logoLarge;default:return""}})()},template:'<div><a ng-href="{{ ::homeUrl }}"><img class="img-responsive logo" ng-src="{{ ::logoSource }}" alt="{{ ::title }}"></a></div>'})])},9444:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.directives").directive("loggedInMenu",["$rootScope","$authEvents","authenticationService","menuManagerService",(e,t,i,a)=>({replace:!0,templateUrl:"/assets/loggedInMenu.html",link(r){const n="loggedInMenu"+r.$id,o={name:n,type:"dropdown",close:["any"]},l=()=>{if(r.disableHeading=!1,r.uniqueProvider=null,r.loggedInProviders=s.filter(i.scope.auth,(e=>e.loggedIn)),r.loggedOutProviders=s.filter(i.scope.auth,(e=>!e.loggedIn)),r.features=i.scope.features,r.loggedIn=r.loggedInProviders.length>0,r.featuresInMenu=s.keys(r.features).filter((e=>r.features[e].showInMenu())),r.loggedInMenuActive=r.features&&r.featuresInMenu.length>0,r.loggedInFeatures=s.filter(r.features,(e=>{let t;return t=i.getLoggedInProviderForFeature(e.name),s.map(e.supportedProviders,(e=>e.provider)).includes(t)})),r.loggedInFeatures.length===s.keys(r.features).length)r.disableHeading=s.every(r.loggedInFeatures,(e=>e.activeProvider===r.loggedInFeatures[0].activeProvider));else{const e={};Object.entries(r.features).forEach((([t,i])=>{i.providers.forEach((t=>{t.enabled&&(e[t.name]=e[t.name]?e[t.name]+1:1)}))})),r.disableHeading=Object.values(e).every((e=>e===r.featuresInMenu.length))}if(r.disableHeading){const e={},t=Object.values(r.features);if(t&&t.length){const t=r.features[r.featuresInMenu[0]];if(t){e[t.name]=t,r.features=e;const i=t.providers.filter((e=>e.enabled));1===i.length&&(r.uniqueProvider=i[0])}}}};return r.getLoggedInUsername=function(e){const t=r.loggedInProviders.find((t=>t.displayName===e));return null==t?void 0:t.username},a.registerMenu(o),e.$on(t.LOGOUTSUCCESS,l),e.$on(t.LOGINSUCCESS,l),r.onToggle=function(e){return e?a.subMenu[n].openMenu():a.subMenu[n].closeMenu()},r.uniqueLoginLogout=function(){const e=r.features[r.featuresInMenu[0]];e.activeProvider?r.openLogoutDialog(e.name,r.uniqueProvider.name):r.login(e.name,r.uniqueProvider.name)},r.openLogoutDialog=i.openLogoutDialog,r.login=i.login,l()}})])},1883:()=>{"use strict";angular.module("summonApp.directives").directive("summonAutocomplete",["$timeout","$compile","$rootScope",function(e,t,i){return{scope:{searchUrl:"=",onResponse:"&",minChars:"=",onSelect:"&?"},link(s,a,r){const n={url:s.searchUrl,minChars:s.minChars||3,markAsBold:!1,grouped:!0,groupTemplate:"<li class='autocomplete-group' ng-class='::data.groupClass'><ul class='autocomplete-items' role='listbox' /></li>",onSelect(e,t){var i;const{data:a}=angular.element(e).scope();if(angular.isFunction(s.onSelect))return s.onSelect({data:a});{const e=a.text_orig||(null===(i=a.hitAliases)||void 0===i?void 0:i[0])||a.text||("azlist"===a.type?a.name:void 0);return angular.element(this).val(e).focus().trigger("change")}},templateMethod(e,s){const a=i.$new(!0);a.data=s;const r=t(e)(a);return a.$digest(),r}};return e((()=>angular.element("#"+r.summonAutocomplete).tinyAutocomplete(n).on("receivedata",((e,t,i)=>t.json=s.onResponse({json:i})))))}}}]).directive("topicsTemplate",["translationService",e=>({replace:!0,templateUrl:"/assets/autocomplete/topics.html",link:(t,i,s)=>(t.i18n=e,t.relatedTopicClick=e=>t.data.text=e)})]).directive("bestBetsTemplate",["translationService",e=>({replace:!0,templateUrl:"/assets/autocomplete/bestBets.html",link:(t,i,s)=>t.i18n=e})]).directive("dbRecsTemplate",["translationService",e=>({replace:!0,templateUrl:"/assets/autocomplete/dbRecs.html",link:(t,i,s)=>t.i18n=e})]).directive("popularSearchesTemplate",["translationService",e=>({replace:!0,templateUrl:"/assets/autocomplete/popularSearches.html",link:(t,i,s)=>t.i18n=e})]).directive("azSearchTemplate",["translationService",e=>({replace:!0,templateUrl:"/assets/autocomplete/azSearch.html",link:(t,i,s)=>t.i18n=e})])},8477:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.$scope=e,this.availability=t,this.translationService=i,this.rtaAvailabilityService=a,this.viewStateService=r,this.docService=n,this.i18n=this.translationService,this.updateAvailability=this.updateAvailability,this.availability=this.availability,this.showFullTextRow=this.showFullTextRow,this.$scope.linkClickEvent=this.linkClickEvent,this.isSierraClient=s.data.rtaAvailability.isSierraClient,this.showAbbreviatedRTA=s.data.rtaAvailability.showAbbreviatedRTA,this.availabilityConfig=s.data.availability,this.setDefaultValuesForDirectiveVariables(),this.$scope.$on("$destroy",(()=>this.availability.off("update",this.$scope.$id))),this.availability.on("update",this.$scope.$id,((...e)=>this.updateAvailability.apply(this,e)))}showFullTextRow(e,t){return e?this.$scope.avDocs[t].fulltext||this.$scope.displayPdfQuickLinks&&this.doc.link_to_pdf:this.$scope.avDocs[t].fulltext}updateAvailability(e){if(null==e||0==e.length)return;const t=t=>s.filter(this.$scope.avDocs[t].physical,(function(t){return"rta"===t.type&&e.includes(t.doc.availability_id)}));let i=[];return s.each(this.$scope.contentTypes,(e=>i=[...i.concat(t(e))])),s.each(i,(e=>(e.availability=this.availability.getAvailability(e.doc.availability_id),e.availabilities=e.availability.availabilities,e.error=e.availability.error,e.loaded=!0))),this.$scope.rtaLoaded.loaded=!0}linkClickEvent(e){return this.openClickTrackLink(e)}hasRtaDocs(e){return s.some(this.$scope.avDocs[e].physical,(e=>"rta"===e.type))}$onChanges(e){if(e.doc&&!e.doc.isFirstChange())return this.setDefaultValuesForDirectiveVariables(),this.prepareAvailabilityInfoForRender()}$onInit(){return this.prepareAvailabilityInfoForRender()}setDefaultValuesForDirectiveVariables(){return this.firstFullTextDisplayText="",this.$scope.avDocs={},this.$scope.settings={},this.$scope.rtaLoaded=s.clone(this.availability.rtaLoaded)||{},this.availabilityConfig.hasRTA||(this.$scope.rtaLoaded.loaded=!0),this.$scope.contentTypes=[],this.$scope.contentTypesHaveRta={},this.$scope.showMore=!1,this.$scope.additionalFullTextLinks=[]}prepareAvailabilityInfoForRender(){var e;this.$scope.contentTypes.splice(0,this.$scope.contentTypes.length),this.$scope.onDetailPage=this.onDetailPage,this.$scope.isAiPage=this.isAiPage;const t=(e,t="")=>{let i=!1;const s={};[s.type,s.displayText,s.callNumDeweyText,s.callNumDeweyTextOnFail,s.linkInfo,s.additionalLinkInfo,s.provider]=this.availability.getAvailabilityInfo(e),s.doc=e,s.link=e[t||"link"],s.availability=e.availability||this.availability.getAvailability(e.availability_id),s.availabilities=s.availability.availabilities||[],s.error=s.availability.error,s.loaded=s.availabilities.length||s.error;const a=s.doc.content_type.toLowerCase();let r="";return"fulltext"===s.type?(r="fulltext",i||(i=!0,s.firstFullText=!0,this.firstFullTextDisplayText=s.displayText)):r="physical",this.$scope.avDocs[a]?this.$scope.avDocs[a][r]?this.$scope.avDocs[a][r].push(s):this.$scope.avDocs[a][r]=[s]:(this.$scope.contentTypes.push(a),this.$scope.avDocs[a]={},this.$scope.avDocs[a][r]=[s])},i=e=>(this.$scope.avDocs={},s.each(e,(e=>(e.link_to_html&&this.$scope.displayHtmlQuickLinks&&e.link_to_html!==e.link&&t(e,"link_to_html"),t(e)))),this.handleAdditionalLinks(),s.each(this.$scope.contentTypes,(e=>this.$scope.contentTypesHaveRta[e]=this.hasRtaDocs(e))));return(null===(e=this.availabilityDocs)||void 0===e?void 0:e.length)?i(this.availabilityDocs):this.$scope.onDetailPage?this.$scope.$watch("availabilityDocs",i,!0):i(this.availabilityDocs)}handleAdditionalLinks(){if(this.$scope.displayMultipleFullTextLinks)return this.deduplicateLinks(),this.formatAdditionalLinks(),this.addOpenUrlIfAppropriate()}addOpenUrlIfAppropriate(){if(this.$scope.displayLinkResolver&&this.doc.open_url&&this.$scope.maximumFullTextLinks>this.$scope.additionalFullTextLinks.length){const e=this.docService.getLinkResolver(this.doc);return this.$scope.additionalFullTextLinks.push(this.availability.formatLinkResolver(e))}}formatAdditionalLinks(){var e;if(null===(e=this.doc.summon_additional_links)||void 0===e?void 0:e.length)return s.each(this.doc.summon_additional_links.slice(0,+this.$scope.maximumFullTextLinks+1||void 0),(e=>this.$scope.additionalFullTextLinks.push(this.availability.formatAdditionalLink(this.firstFullTextDisplayText,e))))}deduplicateLinks(){var e;if(!(null===(e=this.doc.summon_additional_links)||void 0===e?void 0:e.length))return;const t=this;return this.doc.summon_additional_links=s.filter(this.doc.summon_additional_links,(e=>s.every(t.$scope.contentTypes,(i=>{var s;return e.provider_name!==(null===(s=t.$scope.avDocs[i].fulltext)||void 0===s?void 0:s[0].provider)}))))}}a.$inject=["$scope","availabilityService","translationService","configService","rtaAvailabilityService","viewStateService","documentService"],angular.module("summonApp.directives").controller("availabilityController",a).directive("availabilityBlock",(()=>({replace:!0,templateUrl:"/assets/availabilityBlock.html",controller:a,controllerAs:"vm",bindToController:{onDetailPage:"<",doc:"<",isAiPage:"=",availabilityDocs:"<",openDetailPage:"&",openClickTrackLink:"&",contentTypeIcon:"<"}})))},2405:()=>{"use strict";class e{constructor(e,t,i,s,a){this.onNewQuery=this.onNewQuery.bind(this),this.$http=e,this.acService=t,this.advancedService=i,this.dataService=s,this.results=[],this.count=-1,this.prev_query="",this.query="",this.maxResultSize=+a.data.widgets.azDatabaseDefaultResults,this.retrieveAzResultsSize=8*this.maxResultSize,this.searchError=!1,this.transformResponse=this.acService.transformResponse,this.suggestUrl=this.acService.getAzSearchUrl("suggest"),this.searchUrl=this.acService.getAzSearchUrl("search"),this.enableAutoSearch=a.data.widgets.enableAZSearchWidgetAutoSearch,this.dataService.on("new",this.onNewQuery)}clear(){return this.results=[],this.count=-1,this.searchError=!1}clearSearch(){return this.clear(),this.query=""}updateData(e){return this.results=e}search(e){if(this.query=e,0!==this.query.length)return this.prev_query=this.query,this.$http.get(`${this.searchUrl}&q=${this.query}&size=${this.retrieveAzResultsSize}`).then((e=>{if(null!==e.data){const t=e.data.az.map((function(e){return e.search_result=!0,e}));return"number"==typeof e.data.stats.hits?this.count=e.data.stats.hits:this.count=e.data.stats.hits.value,this.updateData(t)}})).catch((e=>(console.error(e),this.clear(),this.searchError=!0)))}parseQuery(e){if(/([^:]+):\(.+?\)?/.test(e)){const t=this.advancedService.parseQueryToAdvancedQueryValues(e);if(t&&t.length)return t.join(" ")}if(/([^:]+):".+?"/.test(e)){const t=e.match(/[^:]+:"([^"]+)"/);return t&&t.length?t[1]:""}return e.length>150?"":e}onNewQuery(e){const t=e.query.original_query;if(this.enableAutoSearch)return this.prev_query!==t?(this.clear(),this.query=this.parseQuery(t),this.search(this.query)):void 0;this.clear()}}e.$inject=["$http","autocompleteService","advancedSearchService","dataService","configService"];class t{constructor(e,t,i){this.submit=this.submit.bind(this),this.$scope=e,this.azService=t,this.query="",this.count=this.azService.count,this.maxResultSize=this.azService.maxResultSize,this.clear=this.azService.clear,this.azBrowseUrl=i.data.widgets.azBrowseUrl}$onInit(){return this.$scope.$watchCollection("results",(e=>this.query=this.azService.query))}onResponse(e){return this.azService.transformResponse({azSearch:e})}clearSearch(e){return this.clear(),this.query="",this.azService.clearSearch()}onSelect(e){return this.clear(),e.search_result=!0,this.azService.updateData([e]),this.$scope.$apply()}submit(){return this.clear(),this.azService.search(this.query)}}t.$inject=["$scope","azSearchService","configService"];class i{constructor(e,t,i,s){this.updatePaging=this.updatePaging.bind(this),this.$scope=e,this.$window=i,this.azService=s,this.pageSize=Math.min(this.azService.retrieveAzResultsSize,this.azService.maxResultSize),this.page=1,this.shouldShowNext=!1,this.maxResultSize=this.azService.maxResultSize,this.trustAsHtml=t.trustAsHtml}$onInit(){return this.$scope.$watchCollection("results.results",(e=>{if(this.updatePaging(),e&&0===e.length)return this.clear()}))}clear(){return this.page=1,this.shouldShowNext=!1}showNextX(){if(this.page<this.count/this.pageSize)return this.$window.scrollTo(0,0),this.updatePaging(1)}showPreviousX(){if(this.page>1)return this.$window.scrollTo(0,0),this.updatePaging(-1)}updatePaging(e=0){return this.page+=e,this.shouldShowNext=this.page<Math.min(this.count,this.azService.retrieveAzResultsSize)/this.pageSize}}i.$inject=["$scope","$sce","$window","azSearchService"],angular.module("summonApp.directives").service("azSearchService",e).controller("azSearchResultsController",i).controller("azSearchController",t).directive("azSearch",(()=>({controllerAs:"search",controller:t,templateUrl:"/assets/azSearchWidget.html",bindToController:{fromSearchInfo:"<"}}))).directive("azSearchResults",(()=>({controllerAs:"results",controller:i,templateUrl:"/assets/azSearchWidgetResults.html",bindToController:{results:"<",count:"<"}})))},12:()=>{"use strict";class e{constructor(){}}angular.module("summonApp.directives").controller("backToResultsController",e).directive("backToResults",(()=>({bindToController:{callback:"&"},controllerAs:"vm",controller:e,replace:!0,template:'<button tabindex="0" class="navigateBackLink summonBtn" ng-click="vm.callback()"><i class="uxf-icon uxf-left-open" aria-hidden="true"></i><span ng-bind="::i18n.translations.BACK_TO_SEARCH"></span></button>'})))},9784:()=>{"use strict";angular.module("summonApp.directives").directive("bxRecommenderLink",["bxRecommenderService","translationService","relatedItemsService",function(e,t,i){return{replace:!0,templateUrl:"/assets/bxRecommenderToggle.html",link(s){return s.bxRetrievedDocuments=e.retrievedDocuments,s.imActive=e.imActive,s.i18n||(s.i18n=t),s.toggleBxRecommendations=function(){var t;if(e.toggleRecommendations.apply(e,arguments))return e.bxStyle.md.top=(null===(t=angular.element(".header").offset())||void 0===t?void 0:t.top)+"px",i.reset()}.bind(this)}}}]).directive("bxRecommender",["bxRecommenderService",e=>({templateUrl:"/assets/bxRecommender.html",controller:"BxRecommenderCtrl",link:(t,i,s)=>(t.imActive=e.imActive,t.behavior=s.bxBehavior||"md")})])},7330:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.directives").directive("imagesRollup",["localizationService","translationService",(e,t)=>({replace:!0,scope:{images:"=",query:"@",headerClick:"&",authorSearch:"&",openLink:"&"},templateUrl:"/assets/imagesRollup.html",link(i,a){let r,n;const o=a.find(".imageCarousel"),l=o.find("ul");let c=n=r=0,h=[];const{isRTL:d}=e.localization;i.i18n=t;const u=function(){if(!h.length){const e=o.outerWidth();let t=0;const i=l.find('> li:not(".ng-hide")');return h=s.map(i,(function(i){var s;return t<e?(t+=null!==(s=$(i).outerWidth())&&void 0!==s?s:0,t>e?{left:$(i).position().left,width:t-e}:void 0):{left:$(i).position().left,width:$(i).outerWidth()}})),h=s.compact(h)}},p=function(e,t){return d?e.animate({marginRight:t},150):e.animate({marginLeft:t},150)};return a.find(".btnPrev").bind("click",(function(){if(u(),c<0||c===r)return;const e="+="+h[c].width;return p(l,e),r=c,n=r,c-=1})),a.find(".btnNext").bind("click",(function(){if(u(),n+1>h.length)return;const e="-="+h[n].width;return p(l,e),n+=1,c=r,r=n}))}})]).directive("rollupImage",["dialogService","localizationService","translationService","$window",function(e,t,i,s){return{scope:{image:"=",authorSearch:"&",openLink:"&"},templateUrl:"/assets/rollupImage.html",link(a,r){const{isRTL:n}=t.localization;return a.i18n=i,a.displayDialog=function(){if(s.innerWidth<1025)return e.displayDialog("imageModal",a)},$(r).hoverIntent({over(){var e,t,i,s;a.$apply(a.image.showDetails=!0);const r=$(this),o=r.find(".hoverImage");return n?o.css("marginRight",-((null!==(e=o.outerWidth())&&void 0!==e?e:1)/2-(null!==(t=r.outerWidth())&&void 0!==t?t:1)/2)):o.css("marginLeft",-((null!==(i=o.outerWidth())&&void 0!==i?i:1)/2-(null!==(s=r.outerWidth())&&void 0!==s?s:1)/2))},out:()=>a.$apply(a.image.showDetails=!1)})}}}]).directive("imageWrapper",["translationService",e=>({replace:!0,scope:!0,templateUrl:"/assets/imageWrapper.html",transclude:!0,link:t=>t.i18n=e})])},6367:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(){this.$onInit=this.$onInit.bind(this)}$onInit(){return this.name=this.name||Date.now().toString(36),this.visible=void 0===this.visible||this.visible}closeFn(){if(this.visible=!1,s.isFunction(this.actionFn))return this.actionFn()}}angular.module("summonApp.directives").controller("chipController",a).directive("chip",(()=>({restrict:"E",controller:a,controllerAs:"vm",transclude:{body:"?chipBody"},template:'<button ng-if="vm.visible" type="button" ng-click="vm.closeFn()" class="btn btn-chip" id="chip_{{vm.name}}"><span class="closeChip">Ã—</span><span ng-transclude="body"></span></button>',bindToController:{name:"@?",text:"<?",visible:"<?",actionFn:"&"}})))},4016:()=>{"use strict";angular.module("summonApp.directives").directive("citationTrailLinks",["configService","citationTrailService","translationService","$searchTabs",(e,t,i,s)=>({replace:!0,templateUrl:"/assets/citationTrail/citationTrailLinks.html",scope:{citationDoc:"=",selectedTab:"=",callback:"&"},link(e){const a=e.citationDoc;return e.i18n=i,e.citedBy=t.hasCitedBy(a),e.cites=t.hasCites(a),e.getCites=function(){if(t.reset({clearPath:e.selectedTab===s.search}),t.getCites(a),e.callback)return e.callback()},e.getCitedBy=function(){if(t.reset({clearPath:e.selectedTab===s.search}),t.getCitedBy(a),e.callback)return e.callback()}}})]).directive("citationTrailFeed",["citationTrailService","configService","$searchTabs",(e,t,i)=>({replace:!0,templateUrl:"/assets/citationTrail/citationTrailFeed.html",link(s){s.inf=1/0,s.pageSize=t.data.results.pageSize,s.retry=e.retry,s.$searchTabs=i}})]).directive("citationTrailInfo",(()=>({replace:!0,templateUrl:"/assets/citationTrail/citationTrailInfo.html"}))).directive("citationPath",["citationTrailService","translationService",function(e,t){return{replace:!0,templateUrl:"/assets/citationTrail/citationPath.html",link(i,s,a){return this.maxItems=5,i.citationTrail=e.scope,i.i18n=t,i.selectWaypoint=e.selectWaypoint,i.onToggle=function(e){return e?i.subMenu.citationPath.openMenu():i.subMenu.citationPath.closeMenu()},i.showPath=e=>e<=this.maxItems-1||e===i.citationTrail.path.length-1,i.showKabob=e=>!i.showPath(e)&&e===this.maxItems}}}])},2713:()=>{"use strict";angular.module("summonApp.directives").directive("cloudStorageSignOutLink",["cloudStorageService","alertService","translationService","viewStateService",(e,t,i,s)=>({replace:!0,templateUrl:"/assets/cloudStorage/signOutLink.html",link:(a,r,n)=>(a.cloudStorage=e.scope,a.viewState=s,a.iconClass=()=>"icons-"+a.cloudStorage.signedInProvider().name.toLowerCase()+"-icon-sm",a.signOut=function(){const s=a.cloudStorage.signedInProvider();return e.signOut(s.name.toLowerCase()).then((()=>t.pulseAlert("cloudStorageSignOut",i.translate(i.translations.SIGN_OUT_FROM_X_CONFIRM,{x:s.name}),5e3)))})})]).directive("signInButton",["cloudStorageService","alertService","translationService","authenticationService",(e,t,i,s)=>({replace:!0,templateUrl:"/assets/cloudStorage/signInButton.html",controller:"SavedSearchCtrl",scope:{signInFunction:"&",currentProvider:"=",authFeature:"@"},link:t=>(t.i18n=i,t.provider=t.currentProvider,t.openLoginDialog=()=>{s.openLoginDialog("cloudStorage")},t.signIn=()=>"cloudStorage"!==t.authFeature?t.signInFunction():e.signIn(t.provider.name))})]).directive("chooseProviderSignIn",["cloudStorageService","translationService",(e,t)=>({replace:!0,templateUrl:"/assets/cloudStorage/chooseProviderSignIn.html",scope:{allProviders:"="},link:i=>(i.i18n=t,i.providers=i.allProviders?i.allProviders:e.scope.providers)})]).directive("cloudStorageSignedIn",["cloudStorageService","translationService",(e,t)=>({replace:!0,templateUrl:"/assets/cloudStorage/cloudStorageSignedIn.html",scope:{helpLinkKey:"@"},link(i){i.i18n=t,i.providers=e.scope.providers,i.isSignedIn=e.isSignedIn,i.signedInProvider=e.signedInProvider}})])},5991:()=>{"use strict";angular.module("summonApp.directives").directive("courseReserves",["$route","$routeParams",e=>({replace:!0,templateUrl:"/assets/courseReserves/courseReserves.html",link:t=>(t.routeAction=e.current.action,t.$on("$routeChangeSuccess",(()=>t.routeAction=e.current.action)))})]).directive("courseReservesView",(()=>({replace:!0,templateUrl:"/assets/courseReserves/courseReservesView.html",controller:"CourseReservesCtrl"}))).directive("courseReserveDetail",(()=>({replace:!0,templateUrl:"/assets/courseReserves/courseReserveDetail.html",controller:"CourseReservesCtrl"}))).directive("courseReservesSearchBox",(()=>({replace:!0,templateUrl:"/assets/courseReserves/courseReservesSearchBox.html",controller:"CourseReservesCtrl"}))).directive("courseReserveList",(()=>({scope:{reserves:"=",courseReserveSearch:"&"},replace:!0,templateUrl:"/assets/courseReserves/courseReserveList.html",link(e){const t=e=>void 0===e||"null"===e.toLowerCase()?"":e,i=e=>{if(e){const t=e.split(";");return t.length>1?t[0].trim():e}},s=e=>{const t=e.code?e.code+" : ":"",i=e.instructors?" | "+e.instructors:"";return`${t}${e.name}${i}`},a=[];for(var r of e.reserves||[]){var n=r.split("||"),o={},l=t(n[3]);o.code=t(n[1]),o.name=t(n[2]),o.instructors=l,o.instructor=i(l),o.display=s(o),a.push(o)}return e.courses=a}})))},1751:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.directives").directive("customSearchField",["advancedSearchService","$booleanValues","$queryModifiers","$identifierQueryModifiers","$identifierFields","$minLengthForBeginsWithQueries",(e,t,i,a,r,n)=>({templateUrl:"/assets/advancedSearch/customSearchField.html",controller:"AdvancedSearchCtrl",scope:{model:"=",fields:"=",index:"@",addField:"&",removeField:"&",parentForm:"<?",scopeBuilderMode:"<?"},link:e=>(e.fieldNumber=parseInt(e.index)+1,e.booleanValues=t,e.selectedField=s.find(e.fields,(t=>t.key===e.model.key)),e.focusNext=e=>$(e.target).parents(".customField").next().find(":focusable:eq(0)").focus(),e.model.queryModifier||e.scopeBuilderMode?e.scopeBuilderMode&&(e.model.queryModifier="ExactMatch"):e.model.queryModifier=r.includes(e.model.key)?"ExactMatch":"AllWords",e.getApplicableModifiers=function(){return r.includes(e.model.key)?a:["TitleCombined","PublicationTitle"].includes(e.model.key)?i:"Notes"==e.model.key?["AllWords","ExactMatch"]:[]},e.displayModifiers=()=>(["TitleCombined","PublicationTitle","Notes"].includes(e.model.key)||r.includes(e.model.key))&&!e.scopeBuilderMode,e.setModifier=function(){return e.selectedField=s.find(e.fields,(t=>t.key===e.model.key)),e.model.queryModifier=r.includes(e.model.key)?"ExactMatch":"AllWords"},e.updateValidators=()=>e.model.minLength="BeginsWith"===e.model.queryModifier?n:-1,e.getFieldError=(t,i)=>e.parentForm[t].$error[i])})]).directive("advSearchEnterSubmit",(()=>({link:(e,t)=>(t.on("keypress",(function(e){if(13===e.keyCode)return angular.element("#advSearchSubmit").trigger("click")})),t.on("destroy",(()=>t.off("keypress"))))})))},1633:()=>{"use strict";angular.module("summonApp.directives").directive("customSections",["customSectionsService","resultsFeedService","bxRecommenderService","$sce",(e,t,i,s)=>({replace:!0,templateUrl:"/assets/customSections.html",link:(t,a)=>(t.sections=e.scope,t.displaySections=()=>t.sections.sections.length&&!i.showRecommendations,t.displayMoreButton=()=>t.sections.showMoreOptionally&&t.sections.limit<t.sections.sections.length,t.displayLessButton=()=>t.sections.showMoreOptionally&&t.sections.limit>t.sections.minLimit&&t.sections.limit===t.sections.sections.length,t.trustAsHtml=s.trustAsHtml)})])},8116:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s){this.isRangeSelected=this.isRangeSelected.bind(this),this.toggle=this.toggle.bind(this),this.$scope=e,this.appState=t,this.events=i,this.searchScopeService=s}isRangeSelected(e){return this.appState.params.rf&&s(this.appState.params.rf).some((t=>t.indexOf("NewRecords")>-1&&t.indexOf(e)>-1))}isRangeSelectedByScope(e){return this.appState.searchScopeParams.rf&&s(this.appState.searchScopeParams.rf).some((t=>t.indexOf("NewRecords")>-1&&t.indexOf(e)>-1))}toggle(e,t){null==e||e.preventDefault();const{days:i}=t;if(!this.isRangeSelectedByScope(i))return this.appState.applyStateWithSnapShot((()=>this.isRangeSelected(i)?(this.appState.params.rf=s(this.appState.params.rf).reject((e=>0===e.indexOf("NewRecords"))),this.events.gaPush("refinements","clear","NewRecords")):(this.appState.params.rf=s(this.appState.params.rf).reject((e=>0===e.indexOf("NewRecords"))),this.appState.params.rf.push(`NewRecords,${i}:*`),this.events.gaPush("refinements","add",this.appState.params.rf))));this.searchScopeService.clearScopeAsSideEffect()}}a.$inject=["$scope","appStateService","eventService","searchScopeService"],angular.module("summonApp.directives").controller("daysOldController",a).directive("daysOld",[()=>({replace:!0,templateUrl:"/assets/daysOldList.html",controller:a,controllerAs:"vm",bindToController:{facet:"="}})])},6452:()=>{"use strict";angular.module("summonApp.directives").directive("diagnostics",(()=>({replace:!0,templateUrl:"/assets/diagnostics/diagnostics.html",controller:"DiagnosticsCtrl",scope:{diagnostics:"=?",parentKey:"=?",key:"=?"}}))).directive("diagnosticsContainer",["$compile",e=>({replace:!0,scope:{diagnosticsContainer:"=",parentKey:"=",key:"="},template:"<div></div>",link:(t,i)=>(i.append("<div diagnostics='diagnosticsContainer' parent-key='parentKey' key='key'></div>"),e(i.contents())(t))})])},823:(e,t,i)=>{"use strict";var s=i(4125);const a=function(e){const t=e.text.match(/^(.*)\%\{linkStart\}(.*)\%\{linkEnd\}(.*)$/m);if(t&&4===t.length)return e.start=t[1],e.middle=t[2],e.end=t[3]},r=function(e){return null==e.touches?e:{pageX:(e=e.touches[0]).pageX,pageY:e.pageY}};angular.module("summonApp.directives").directive("fulltextBanner",(()=>({replace:!0,templateUrl:"/assets/fulltextBanner.html"}))).directive("hamburgerMenu",["$timeout","configService",(e,t)=>({templateUrl:"/assets/hamburger.html",link(i){const s=angular.element("body");return i.toggleMenu=function(a){return a.stopPropagation(),i.subMenu.links.open?i.subMenu.links.closeMenu():(i.subMenu.links.openMenu(),void s.on("click",(function(a){var r,n,o;s.off("click");const l=(null===(r=t.data.flow)||void 0===r?void 0:r.authUrl)||"";if((null===(o=null===(n=null==a?void 0:a.target)||void 0===n?void 0:n.form)||void 0===o?void 0:o.action)!==l)return e((function(){return i.subMenu.links.closeMenu(),i.$apply()}),0)})))},i.$on("$destroy",(()=>s.off("click")))}})]).directive("menuToggle",["$timeout","$window","menuManagerService",(e,t,i)=>({scope:{forceClose:"<menuToggleForceClose",name:"@menuToggleName",pin:"<menuTogglePin",scrollTop:"<menuToggleScrollTop"},link:(s,a,r)=>a.on("click",(function(){if(s.forceClose||i.menu[s.name].open?(i.menu[s.name].closeMenu(!0),s.pin&&i.menu[s.name].unpin()):(i.menu[s.name].openMenu(!0),s.pin&&i.menu[s.name].pin()),s.$apply(),s.scrollTop)return e((()=>t.scrollTo(0,0)))}))})]).directive("menuPinToggle",["menuManagerService",e=>({scope:{name:"@menuToggleName"},link:(t,i,s)=>i.on("click",(function(){return e.menu[t.name].pinned?e.menu[t.name].unpin():e.menu[t.name].pin(),t.$apply()}))})]).directive("permalink",["$document","$window","translationService","$timeout","configService","shortenUrlService",function(e,t,i,s,a,r){const{enableShortenPermalink:n}=a.data.results;return{templateUrl:"/assets/permalink.html",link:{pre:(e,t,i)=>e.recordAction="recordAction"===i.permalink,post(a,o){const{location:l}=t,c=l.port?":"+l.port:"",h=l.protocol+"//"+l.hostname+c;a.bookmarkUrl=h+"/#!/search?bookMark="+a.document.bookmark,a.shortened=!n;const d=function(e){if(e.stopPropagation(),o.find("input[type=text]").focus(),n)return r.getShorten(a.document.bookmark,a.bookmarkUrl).then((function(e){return a.bookmarkUrl=e,a.shortened=!0}))};o.on("click",d);const u=i.translations.PERMANENT_LINK_COPIED_TO_CLIPBOARD,p=i.translations.PERMANENT_LINK_COPY_ERROR;return a.copyAttempted=!1,a.back=function(){return o.find("button.copyBtn").focus(),a.copyAttempted=!1},a.closePermalink=function(e){return e.preventDefault(),e.stopPropagation(),s((()=>o.find("button.dropdown-toggle").trigger("click").focus()))},a.copy=function(t){t.stopPropagation(),o.find("input[type=text]").select(),a.copyAttempted=!0;try{return e[0].execCommand("copy")?(a.isSuccess=!0,a.msg=u):(a.isSuccess=!1,a.msg=p)}catch(e){return a.isSuccess=!1,a.msg=p}},a.$on("$destroy",(()=>o.off("click",d)))}}}}]).directive("confirmClick",["$window",e=>({priority:1,scope:{confirmAction:"&"},link:{pre(t,i,s){const a=s.confirmClick||"Are you sure?",r=function(i){return e.confirm(a)?t.$apply(t.confirmAction()):(i.stopImmediatePropagation(),i.preventDefault())};return i.on("click",r),t.$on("$destroy",(()=>i.off("click",r)))}}})]).directive("topLinks",(()=>({replace:!0,templateUrl:"/assets/topLinks.html",controller:"TopLinksCtrl"}))).directive("vpnBanner",["$timeout","$compile",(e,t)=>({replace:!0,templateUrl:"/assets/vpnBanner.html",compile:()=>({post:(i,s)=>e((function(){const e=s.find(".vpnBannerLink");if(0!==e.length)return e.removeClass("vpnBannerLink"),e.attr("ellipsis-height","32"),e.attr("ellipsis",""),t(e)(i)}),0)})})]).directive("translatableTextWithLink",(()=>({replace:!0,template:'<span>{{start}}<a ng-attr-id="{{linkId}}" ng-click="click()" class="customPrimaryLink" tabindex="0" role="link">{{middle}}</a>{{end}}</span>',scope:{linkId:"@?",text:"@",click:"&"},link:a}))).directive("translatableTextWithDropdown",["menuManagerService",e=>({replace:!0,transclude:!0,templateUrl:"/assets/translatableTextWithDropdown.html",scope:{text:"@",readableLabel:"@",labelClass:"@"},link(t){const i="translatableTextWithDropdown"+t.$id,s={name:i,type:"dropdown",close:["any"]};return e.registerMenu(s),t.onToggle=function(t){return t?e.subMenu[i].openMenu():e.subMenu[i].closeMenu()},a(t)}})]).directive("dynamicLink",(()=>({replace:!0,scope:{isInternal:"@",linkClass:"@",link:"@",text:"@",noEllipsis:"@",click:"&",openLink:"&",ariaLabelCustom:"@"},templateUrl:"/assets/dynamicLink.html"}))).directive("ellipsis",["$timeout",e=>({restrict:"A",link(e,t){t.addClass("ellipsis-3")}})]).directive("knowTextWidth",["$timeout",e=>({restrict:"A",scope:{textInfo:"="},link(e,t){const i=(e,t)=>angular.element(e).css(t);return e.textInfo={textWidth:function(e,t,i){const s=(i.canvas||(i.canvas=document.createElement("canvas"))).getContext("2d");return s.font=t,s.measureText(e).width}(e.textInfo.textToMeasure,function(e=document.body){return`${i(e,"font-weight")||"normal"} ${i(e,"font-size")||"16px"} ${i(e,"font-family")||"Times New Roman"}`}(t),e),textToMeasure:e.textInfo.textToMeasure}}})]).directive("savedItemsDialog",(()=>({replace:!0,templateUrl:"/assets/savedItemsDialog.html"}))).directive("detailPage",(()=>({replace:!0,controller:"DocumentDetailCtrl",templateUrl:"/assets/detailPage.html"}))).directive("homeView",(()=>({replace:!0,templateUrl:"/assets/home.html"}))).directive("searchView",(()=>({replace:!0,controller:"SearchCtrl",templateUrl:"/assets/search.html"}))).directive("searchResultsTabs",(()=>({templateUrl:"/assets/searchResultsTabs.html"}))).directive("links",["configService",e=>({replace:!0,templateUrl:"/assets/links.html",link:t=>t.enableWidgetsLink=e.data.widgets.enableWidgetsLink})]).directive("customLinks",(()=>({replace:!0,templateUrl:"/assets/customLinks.html",controller:"LinksCtrl"}))).directive("navTabs",(()=>({replace:!0,templateUrl:"/assets/navTabs.html"}))).directive("languageSwitcher",(()=>({replace:!0,controller:"LocalizationCtrl",templateUrl:"/assets/languageSwitcher.html"}))).directive("menuBar",(()=>({replace:!0,controller:"MenuBarCtrl",templateUrl:"/assets/menuBar.html"}))).directive("facetDatepickers",["translationService",e=>({replace:!0,templateUrl:"/assets/facetDatepickers.html",scope:{source:"=",date:"="},link:t=>t.i18n=e})]).directive("linkedContributorList",["configService","translationService",(e,t)=>({scope:{contributors:"=",onSearch:"&?",hidePrefix:"=",limit:"@",label:"@"},replace:!0,templateUrl:"/assets/linkedContributorList.html",link:i=>(i.i18n=t,i.enableTransliterations=e.data.results.enableTransliterations,i.hasSearch="function"==typeof i.onSearch,i.limitItems=i.limit,i.showAll=!1,i.viewMore=()=>(i.showAll=!0,i.limitItems=i.showAll?i.contributors.length:i.limit))})]).directive("linkedSubjectList",(()=>({scope:{subjects:"=",subjectSearch:"&",delimiter:"@"},replace:!0,templateUrl:"/assets/linkedSubjectList.html"}))).directive("journalTitleSearchLink",(()=>({replace:!0,templateUrl:"/assets/journalTitleSearchLink.html"}))).directive("layout",(function(){return{controller:"LayoutCtrl"}})).directive("header",(()=>({replace:!0,templateUrl:"/assets/header.html"}))).directive("backToTop",(()=>({replace:!0,templateUrl:"/assets/backToTop.html",scope:{containerId:"@"},link(e){e.scrollToTop=()=>{e.isScrolledDown=!1;const t=document.getElementById(e.containerId);t?t.scrollTo({top:0,behavior:"smooth"}):console.error("Child container not found")},(()=>{const t=document.getElementById(e.containerId);e.isScrolledDown=!1,t?(angular.element(t).on("scroll",(()=>{const i=t.scrollTop;e.$applyAsync((()=>{e.isScrolledDown=i>100}))})),e.$on("$destroy",(()=>{angular.element(t).off("scroll")}))):console.error(`Element with ID "${e.containerId}" not found.`)})()}}))).directive("idleTimer",["$document","configService","flowService",function(e,t,i){const{savedItemsTimeout:s}=t.data.savedSearchAndItems;return{link(t,a){var r=function(){if(void 0===i.auth.user)return i.once("authChange",r);if(!i.auth.user.authenticated){const i=60*s*1e3,r=i-3e5;return t.idle=!1,e.on("idle.idleTimer",(()=>t.$apply((()=>t.idle=!0)))),e.on("active.idleTimer",(()=>t.$apply((()=>t.idle=!1)))),e.idleTimer(i),t.idleMessage=!1,a.on("idle.idleTimer",(function(e){return e.stopPropagation(),t.$apply((()=>t.idleMessage=!0))})),a.on("active.idleTimer",(()=>t.$apply((()=>t.idleMessage=!1)))),a.idleTimer(r)}};return r()}}}]).directive("citation",(()=>({replace:!0,scope:{documents:"=",list:"=",citationSource:"@"},controller:"CitationCtrl",templateUrl:"/assets/citation.html"}))).directive("citationSidebar",(()=>({replace:!0,scope:{documents:"=",view:"="},controller:"CitationCtrl",templateUrl:"/assets/citationSidebar.html"}))).directive("draggable",["$document","$window",(e,t)=>({scope:{dragClass:"@"},link(i,a){const n="touchmove mousemove",{dragClass:o}=i,l=angular.element(t),c=l.height(),h=l.width(),d=n.split(" ");return a.on("touchstart mousedown",(function(t){const i=$(t.target);if(!i.hasClass(o)&&!i.parent().hasClass(o))return;t.preventDefault();let l=parseInt(a.css("left")),u=parseInt(a.css("top"));const p=r(t);let m;isNaN(l)&&(l=0),isNaN(u)&&(u=0);const g=function(e){const t=r(e);return a.css({left:l+(t.pageX-p.pageX)+"px",top:u+(t.pageY-p.pageY)+"px"}),m=void 0},v="undefined"!=typeof requestAnimationFrame?function(e){return m&&(cancelAnimationFrame(m),m=void 0),m=requestAnimationFrame((()=>g(e)))}:s.throttle(g,50);return e.on(n,v),e.on("touchend touchcancel mouseup mouseleave",(function(t){return t.preventDefault(),a.position().top<0&&a.css("top",0),(c||0===c)&&a.position().top+a.outerHeight()>c&&a.css("top",c-a.outerHeight()),a.position().left<0&&a.css("left",0),(h||0===h)&&a.position().left+a.outerWidth()>=h&&a.css("left",h-a.outerWidth()),d.map((t=>e.off(t,v)))}))}))}})]).directive("scrollToTop",["$window","$timeout",(e,t)=>({restrict:"A",link(i,s,a){const r=a.scrollDelay||0;return s.on(a.scrollToTop,(()=>t((()=>e.scrollTo(0,0)),r))),i.$on("$destroy",(()=>s.off(a.scrollToTop)))}})]).directive("ngEnter",["$timeout",e=>({link:(t,i,s)=>(i.on("keypress",(function(i){if(13===i.which)return e((()=>t.$eval(s.ngEnter))),i.preventDefault()})),t.$on("$destroy",(()=>i.off("keypress"))))})]).directive("keyedClick",[()=>({link:(e,t,i)=>(t.on("keypress",(function(t){if(13===t.which||32===t.which)return e.$apply(e.$eval(i.keyedClick)),t.preventDefault()})).on("click",(function(t){return e.$apply(e.$eval(i.keyedClick)),t.preventDefault()})),e.$on("$destroy",(()=>t.off("keypress").off("click"))))})]).directive("toggleImage",["$timeout",e=>({scope:{doc:"=toggleImage"},link:(t,i)=>(t.doc.display_thumbnail||(t.doc.display_thumbnail=!1),i.on("load",(function(){const s=(r=i[0]).naturalWidth,a=r.naturalHeight;var r;return e((()=>t.doc.display_thumbnail=1!==s&&1!==a))})),t.$on("$destroy",(()=>i.off("load"))))})]).directive("summonFormAction",(()=>({link(e,t,i){const s=t.find("input[type=submit],button[type=submit]");return s.on("click",(function(){t.attr("action",e.$eval(i.summonFormAction));const s=e.$eval(i.beforeSend);s?s.then((e=>{for(let i in e)t.append(`<input type="hidden" name="${i}" value="${e[i]}">`);t.submit()})):t.submit()})),e.$on("$destroy",(()=>s.off("click")))}}))).directive("datePresetLinks",["translationService",e=>({replace:!0,templateUrl:"/assets/datePresetLinks.html",scope:{date:"=",presets:"=",datePresetLinks:"&",labels:"=?"},link:(t,i,s)=>(t.i18n=e,t.labels||(t.labels={}),t.noTitle="true"===s.noTitle)})]).directive("facetDatePresetLinks",["translationService","viewStateService",(e,t)=>({replace:!0,templateUrl:"/assets/facetDatePresetLinks.html",scope:{presets:"=",retrievePresetDates:"&",labels:"=?",selection:"<",facetDatepicker:"<",toggleFacetDatepicker:"&",source:"="},link:i=>(i.i18n=e,i.labels||(i.labels={}),i.viewState=t)})]).directive("libraryNotes",(()=>({replace:!0,templateUrl:"/assets/libraryNotes.html",scope:{notes:"="}}))).directive("previewEnv",(()=>({restrict:"C",templateUrl:"/assets/previewEnv.html"}))).directive("recaptcha",["recaptchaService","$timeout",(e,t)=>({replace:!0,template:'<div id="{{::recaptchaId}}" ng-model="recaptchaIsValid"></div>',link:(i,s,a)=>(i.recaptchaId=a.recaptcha,s.on("recaptchaValidated",(function(e,t){i.$apply((function(){i.recaptchaIsValid=t}))})),t((()=>e.renderCaptcha(a.recaptcha))))})]).directive("pagination",(()=>({replace:!0,scope:{itemsCount:"=",view:"@",selectedTab:"=?",itemsPerPage:"=?"},templateUrl:"/assets/resultsFeed/pagination.html",controller:"PaginationCtrl"}))).directive("modalHeader",["translationService","dialogService",(e,t)=>({replace:!0,templateUrl:"/assets/modalHeader.html",scope:{view:"@",headerTitle:"@",ctrl:"=",iconName:"@",uxfIconName:"@"},link:i=>(i.i18n=e,i.viewState=t.viewState,i.closeDialog=e=>t.closeModalDialog(e))})]).directive("quickLookContent",(()=>({replace:!0,templateUrl:"/assets/quickLook/quickLookContent.html"}))).directive("quickLookDetails",(()=>({replace:!0,templateUrl:"/assets/quickLook/quickLookDetails.html"}))).directive("secondaryResourceTypesWarning",(()=>({replace:!0,templateUrl:"/assets/secondaryResourceTypesWarning.html"}))).directive("quickLookNavigation",(()=>({replace:!0,templateUrl:"/assets/quickLook/quickLookNavigation.html"}))).directive("recordActionsGroup",(()=>({replace:!0,templateUrl:"/assets/recordActionsGroup.html"}))).directive("titleToggle",["translationService",e=>({templateUrl:"/assets/titleToggle.html",scope:{titleLabel:"@",title:"@",detailsExpanded:"="},link:t=>(t.i18n=e,t.toggleCollapsed=e=>t.detailsExpanded[e]=!t.detailsExpanded[e])})]).directive("menu",["$timeout",e=>({controller:"MenuCtrl",scope:{type:"@menuType",name:"@menuName",pinned:"<menuPinned",openSize:"<menuOpen",closeSize:"<menuClose",floatSize:"<menuFloat",pinnable:"<menuPinnable",closeOnAppstateChange:"<menuCloseOnAppstateChange"},link:(t,i,s)=>(t.$watch("open",(i=>{if(i&&t.userState)return e((()=>$('*[menu-name="'+t.name+'"] .floatingPanelContent').find(":focusable:first").focus()),50)})),t.$watch("floating",(e=>e?s.$addClass("floatingPanel"):s.$removeClass("floatingPanel"))))})]).directive("visible",(()=>({link:(e,t,i)=>e.$watch(i.visible,(function(e){return e?i.$removeClass("invisible"):i.$addClass("invisible")}))}))).directive("hideUntilLoaded",["$timeout",e=>({link(e,t,i){const s=i.$observe("ngSrc",(()=>t.removeClass("fadein-animated").addClass("loading-image")));return i.$addClass("loading-image"),t.on("load",(()=>$(t).addClass("fadein-animated").removeClass("loading-image"))),e.$on("$destroy",(function(){return t.off("load"),i.$set("ngSrc",""),s()}))}})])},7610:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.directives").directive("moreDetails",["documentService","translationService",(e,t)=>({replace:!0,templateUrl:"/assets/moreDetails.html",scope:{document:"=",fieldSearch:"&"},link:i=>(i.i18n=t,i.$watch("document",(function(t,i,a){if(t&&!s.isEmpty(t))return a.computedVals=e.getComputedValues(t)})))})]).directive("detailRow",["translationService",e=>({templateUrl:"/assets/detailRow.html",transclude:!0,scope:{rowLabel:"@",rowValue:"=",displayValue:"@",delimiter:"@",transclude:"=",fieldSearch:"&",labelClass:"@",valueClass:"@"},link:t=>t.i18n=e})]).directive("sourceLinks",["translationService",e=>({replace:!0,templateUrl:"/assets/sourceLinks.html",scope:{databases:"="},link:t=>t.i18n=e})]).directive("doiLink",["configService","utilitiesService",(e,t)=>({replace:!0,template:'<a ng-href="{{ link }}" target="_blank" ng-bind="doi"></a>',scope:{doi:"@",openAccess:"<"},link(i){i.$watch("doi",(function(){const s=e.data,a=`https://dx.doi.org/${i.doi}`;i.link=s.results.proxyDoiLinks&&!i.openAccess?t.proxify(a,s.vpnBanner.proxy):a}))}})]).directive("ericLink",(()=>({replace:!0,template:'<a ng-href="//eric.ed.gov/ERICWebPortal/detail?accno={{ ::eric }}" target="_blank" ng-bind="eric"></a>',scope:{eric:"@"}}))).directive("bookReviews",["documentQueryService","$broadcastTypes","translationService",(e,t,i)=>({replace:!0,templateUrl:"/assets/bookReviews.html",scope:{reviewDoc:"="},link(s){s.searchReviews=e.searchReviews,s.i18n=i,s.fieldSearch=s.$parent.fieldSearch,s.openClickTrackLink=s.$parent.openClickTrackLink;const a=function(e,i){if(s.reviewsPossible&&i.types.includes(t.other))return s.loaded=!0,s.hideSection||(s.hideSection="apiError"===e.name)};return s.$on("apiSuccess",a),s.$on("apiError",a),e.on("new","bookReviews",(function(){if(s.reviewsPossible=["Book","eBook"].includes(s.reviewDoc.content_type),s.reviewsPossible)return s.loaded=!1})),e.on("update","bookReviews",(function(){if(s.reviewsPossible=["Book","eBook"].includes(s.reviewDoc.content_type),s.reviewsPossible)return s.reviews=e.data.reviews[s.reviewDoc.id],s.loaded=!0,s.hideSection=!s.reviews||!s.reviews.length})),s.$on("$destroy",(()=>(e.off("new","bookReviews"),e.off("update","bookReviews"))))}})]).directive("libraryThing",["translationService",e=>({replace:!0,templateUrl:"/assets/libraryThing.html",scope:{isbn:"@"},link:t=>(t.i18n=e,t.$watch("isbn",(function(e){if(""===e)return;const i=$.trim(e),s=function(e){return null==e&&(e={}),t.info=e[i]||{}},a={url:`//www.librarything.com/api/json/workinfo.js?ids=${i}`,cache:!0,dataType:"jsonp",success:s,error:s};return $.ajax(a)})))})]).directive("contentType",["translationService",e=>({replace:!0,templateUrl:"/assets/contentType.html",scope:{isLabel:"@",contentTypes:"="},link:t=>t.i18n=e})]).directive("clickTrackLinkForm",["configService","$window",(e,t)=>({replace:!0,templateUrl:"/assets/clickTrackLinkForm.html",link:(i,s,a)=>(t.bowser.ios||e.data.metrics.clicktrackFormTargetsSelf||s.attr("target","_blank"),e.data.authentication.referUrlAuth&&s.attr("rel",""),i.$watch("clickTrackLinkForm.linkData",(function(){const e=i.clickTrackLinkForm;if(""!==e.action&&""!==e.linkData)return s.attr("action",i.$eval(a.summonFormAction)),s.submit(),e.action="/2.0.0/link",e.linkData=""})))})])},6006:()=>{"use strict";angular.module("summonApp.directives").directive("flowAuth",(()=>({restrict:"A",replace:!0,controller:"FlowAuthCtrl",templateUrl:"/assets/flow/auth.html"}))).directive("flowBanner",(()=>({restrict:"A",replace:!0,controller:"FlowAuthCtrl",templateUrl:"/assets/flow/banner.html"}))).directive("flowAuthForm",(()=>({restrict:"A",replace:!0,controller:"FlowAuthCtrl",templateUrl:"/assets/flow/authForm.html",link(e,t,i){const{flowConfigs:s}=e;return e.formAction=i.isSignup?s.signupUrl:s.authUrl,e.submitText=i.flowAuthForm||s.loginText}}))).directive("flowLogoutForm",(()=>({restrict:"A",replace:!0,controller:"FlowAuthCtrl",templateUrl:"/assets/flow/logoutForm.html"}))).directive("flowSignOff",(()=>({restrict:"A",controller:"FlowAuthCtrl",link:(e,t)=>(t.on("click",(()=>e.signOff())),e.$on("$destroy",(()=>t.off("click"))))}))).directive("flowToggleForm",(()=>({restrict:"A",replace:!0,controller:"FlowAuthCtrl",templateUrl:"/assets/flow/toggleForm.html",link:(e,t,i)=>"folder"===i.flowToggleForm?(e.placement="bottom",e.classes="uxf-icon uxf-folder navSave"):(e.placement="top",e.classes="uxf-icon uxf-folder-add")})))},906:()=>{"use strict";class e{constructor(e,t){this.$scope=e,this.i18n=t}}class t{constructor(e,t){this.$scope=e,this.i18n=t}}class i{constructor(e,t){this.$scope=e,this.i18n=t}}e.$inject=["$scope","translationService"],t.$inject=["$scope","translationService"],i.$inject=["$scope","translationService"],angular.module("summonApp.directives").directive("journalCoverageSummary",(()=>({replace:!0,templateUrl:"/assets/journalCoverageSummary.html",controllerAs:"jc",controller:e,bindToController:{coverageRange:"<",gapRange:"<",moreGap:"<",context:"<"}}))).directive("journalCoverageDetails",(()=>({replace:!0,templateUrl:"/assets/journalCoverageDetails.html",controllerAs:"jcd",controller:t}))).directive("journalCoverageDetailsContent",(()=>({replace:!0,templateUrl:"/assets/journalCoverageDetailsContent.html",controllerAs:"content",controller:i,bindToController:{quickLook:"<"}}))).controller("journalCoverageSummaryController",e).controller("journalCoverageDetailsController",t).controller("journalCoverageDetailsContentController",i)},5026:()=>{"use strict";class e{constructor(e,t,i,s){this.$onInit=this.$onInit.bind(this),this.mapDocument=this.mapDocument.bind(this),this.$sce=e,this.$scope=t,this.jsonldService=i,this.documentDetailService=s,this.documentDetailService.on("new",this.mapDocument),this.$scope.$on("$destroy",(()=>this.documentDetailService.off("new",this.mapDocument)))}$onInit(){return this.mapDocument()}mapDocument(){return this.data=this.$sce.trustAsHtml(JSON.stringify(this.jsonldService.mapDocumentToJsonld(this.documentDetailService.scope.doc)))}}e.$inject=["$sce","$scope","jsonldService","documentDetailService"],angular.module("summonApp.directives").controller("jsonldDataController",e).directive("jsonldData",[()=>({replace:!0,template:'<script type="application/ld+json" ng-bind-html="vm.data"><\/script>',controllerAs:"vm",controller:e})])},3750:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a,r,n,o,l,c){this.$scope=e,this.$location=t,this.$timeout=i,this.configService=n,this.sierraService=o,this.i18n=a,this.options=s.map(this.configService.data.libraryCard.sections,(e=>(e.translation=this.i18n.translations[e.name],e.mode=e.name,e))),this.mode=this.options[0].mode,this.modeTranslated=this.options[0].translation,this.alerts=r,this.reloadTrigger=!1,l.$on(c.LOGOUTSUCCESS,(()=>this.mode=this.options[0].mode)),l.$on(c.LOGINSUCCESS,(()=>this.reloadCurrentList()))}showMode(e){return this.resetLibraryCardAlerts(),this.mode=e,this.modeTranslated=this.i18n.translations[e]}showLibraryCard(){return this.resetLibraryCardAlerts(),this.showMode(this.options[0].mode),"/library_card"!==this.$location.path()?this.$location.path("/library_card"):this.$location.path("/")}resetLibraryCardAlerts(){return this.alerts.resetAlert("libraryCardError"),this.alerts.resetAlert("libraryCardListLoadError"),this.alerts.resetAlert("libraryCardSuccess")}reloadCurrentList(){return this.reloadTrigger=!0,this.resetLibraryCardAlerts(),this.$timeout((()=>this.reloadTrigger=!1),5e3)}displayLibraryCardName(){return this.configService.data.libraryCard.customLibraryName?this.configService.data.libraryCard.customLibraryName:this.sierraService.userInfo.libraryInfo.displayName?this.sierraService.userInfo.libraryInfo.displayName:""}}class r{constructor(e,t){this.sierraService=t,this.i18n=e}}class n{constructor(e,t){this.documentService=t,this.i18n=e}$onInit(){return this.doc.summary=this.documentService.getDocumentSummary(this.doc),this.doc.hasDetailPage=this.documentService.displayDetailPage(this.doc)||this.documentService.displayAIPage(this.doc)}}class o{constructor(e,t){this.$onChanges=this.$onChanges.bind(this),this.showThisField=this.showThisField.bind(this),this.hasMaxMultipleRows=this.hasMaxMultipleRows.bind(this),this.$scope=e,this.translationService=t,this.i18n=this.translationService,this.$scope.setMode=this.$scope.$parent.vm.setMode,this.$scope.dateLimits=this.$scope.$parent.vm.dateLimits,this.$scope.phoneDescription=this.$scope.$parent.vm.phoneDescription,this.$scope.vm.getOption=this.$scope.$parent.vm.getOption,this.maxRows=5}$onChanges(e){if(e.reloadTrigger.currentValue&&s.includes(["phones","addresses"],this.model.key))return this.model.values.forEach((e=>e.value.model=this.getOption(this.model.helperOptions,"code",e.value.type)))}showThisField(){return this.model.hidden=!1}hasMaxMultipleRows(){return this.model.values.length>=this.maxRows}}a.$inject=["$scope","$location","$timeout","translationService","alertService","configService","sierraService","$rootScope","$authEvents"],r.$inject=["translationService","sierraService"],n.$inject=["translationService","documentService"],o.$inject=["$scope","translationService"],angular.module("summonApp.directives").directive("libraryCard",["translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCard.html",controllerAs:"libraryCard",controller:a})]).directive("libraryCardLeftBar",(()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardLeftBar.html",controllerAs:"vm",controller:r}))).directive("libraryCardItemList",["translationService","documentService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardListItem.html",controllerAs:"vm",controller:n,bindToController:{doc:"<",hideThumbnail:"<"}})]).directive("libraryCardRequestList",["sierraService","apiService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardRequestList.html",controllerAs:"vm",controller:"libraryCardRequestListController",bindToController:{reloadTrigger:"<",newRequestMade:"<"}})]).directive("libraryCardCheckoutList",["sierraService","apiService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardCheckoutList.html",controllerAs:"vm",controller:"libraryCardCheckoutListController",bindToController:{reloadTrigger:"<"}})]).directive("libraryCardFineList",["sierraService","apiService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardFineList.html",controllerAs:"vm",controller:"libraryCardFineListController",bindToController:{reloadTrigger:"<"}})]).directive("libraryCardMessageList",["sierraService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardMessageList.html",controllerAs:"vm",controller:"libraryCardMessageListController",bindToController:{reloadTrigger:"<"}})]).directive("libraryCardPersonalDetails",["sierraService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardPersonalDetails.html",controllerAs:"vm",controller:"libraryCardPersonalDetailsController",bindToController:{reloadTrigger:"<"}})]).directive("patronDetailField",["translationService",()=>({replace:!0,templateUrl:"/assets/libraryCard/patronDetailField.html",controllerAs:"vm",controller:o,bindToController:{model:"<",addField:"&",removeField:"&",reloadTrigger:"<"}})]).directive("libraryCardReadingHistoryList",["sierraService","apiService","translationService","alertService",()=>({replace:!0,templateUrl:"/assets/libraryCard/libraryCardReadingHistoryList.html",controllerAs:"vm",controller:"libraryCardReadingHistoryListController",bindToController:{reloadTrigger:"<"}})])},9160:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t){this.$onInit=this.$onInit.bind(this),this.getPublicNotes=this.getPublicNotes.bind(this),this.mapToPublicNotesArray=this.mapToPublicNotesArray.bind(this),this.publicNoteService=e,this.isLoading=!1,this.dbNotes=[],this.isPublicNotesFeatureEnabled=t.quickLookConfig.showPublicNotes,this.isLocationNotesFeatureEnabled=t.quickLookConfig.showLocationNotes}$onInit(){return this.getPublicNotes()}$onChanges(e){if(e.doc&&!e.doc.isFirstChange())return this.getPublicNotes()}getPublicNotes(){var e;return this.isLoading=!0,this.publicNoteService.getNotes(this.doc.iedl_dbids.join(),null===(e=this.doc.ssids)||void 0===e?void 0:e.join()).then((e=>(this.isLoading=!1,this.dbNotes=this.mapToPublicNotesArray(e.data)))).catch((e=>(this.isLoading=!1,console.error(`PublicNotes: ${e.data.message}`))))}mapToPublicNotesArray(e){const t=[],i=s.toArray(e);for(var a of i){var r={name:a.name,notes:[]};this.isPublicNotesFeatureEnabled&&a.databaseNote&&r.notes.push(a.databaseNote);var n=s.toArray(a.titles)[0];this.isPublicNotesFeatureEnabled&&((null==n?void 0:n.titleNote)?r.notes.push(n.titleNote):a.allTitleNote&&r.notes.push(a.allTitleNote)),(null==n?void 0:n.titleLocationNote)&&this.isLocationNotesFeatureEnabled&&r.notes.push(n.titleLocationNote),r.notes.length&&(r.notes=s.uniq(r.notes),t.push(r))}return t}}a.$inject=["publicNoteService","quickLookService"],angular.module("summonApp.directives").controller("publicNotesController",a).directive("publicNotes",["$window",e=>({templateUrl:"/assets/publicNotes.html",controllerAs:"vm",controller:a,bindToController:{doc:"<"}})])},9482:()=>{"use strict";class e{constructor(e){this.$scope=e}}class t{constructor(e){this.$scope=e}}class i{constructor(e){this.$scope=e}}e.$inject=["$scope"],t.$inject=["$scope"],i.$inject=["$scope"],angular.module("summonApp.directives").directive("refinements",(()=>({replace:!0,controller:"RefinePaneCtrl",templateUrl:"/assets/refine/refinePane.html"}))).directive("quickFilters",(()=>({replace:!0,controller:"QuickFiltersCtrl",templateUrl:"/assets/refine/quickFilters.html"}))).directive("facetFields",["dataService","$timeout","$window",(e,t,i)=>({replace:!0,controller:"FacetsCtrl",templateUrl:"/assets/refine/facets.html",link(i){const s=()=>t((function(){if(i.triggerId){let e;return(e=document.getElementById(i.triggerId))&&e.focus(),i.triggerId=null}}));return e.on("new",s),i.$on("$destroy",(()=>e.off("new",s)))}})]).directive("facetField",["$timeout",e=>({replace:!0,templateUrl:"/assets/refine/facetField.html",link:(t,i,s)=>e((function(){const e=angular.element(i);if(!t.facet.showmore)return;const s=e.find(".moreFacetsLink")[0];if(!s)return;const a={root:e[0]};var r=new IntersectionObserver((e=>e.forEach((function(e){if(e.isIntersecting)return t.moreFacetValues(t.facet),r.unobserve(s)}))),a);return r.observe(s)}))})]).directive("dateSlider",(()=>({replace:!0,controller:"PubDateSliderCtrl",templateUrl:"/assets/refine/dateSlider.html"}))).directive("facetName",(()=>({replace:!0,templateUrl:"/assets/refine/facetName.html",controllerAs:"fn",controller:e,bindToController:{facet:"<",count:"<",index:"<",moreFacetsFilter:"<",source:"<"}}))).directive("facetExclude",(()=>({replace:!0,templateUrl:"/assets/refine/facetExclude.html",controllerAs:"fe",controller:t,bindToController:{facet:"<",index:"<",isSelected:"<"}}))).directive("datePresetLink",(()=>({replace:!0,templateUrl:"/assets/refine/datePresetLink.html",controllerAs:"dpl",controller:i,bindToController:{displayText:"<",isSelected:"<"}})))},8014:()=>{"use strict";angular.module("summonApp.directives").directive("relatedItemsLink",["translationService",e=>({replace:!0,templateUrl:"/assets/relatedItemsToggle.html",controller:"RelatedItemsCtrl",link:t=>t.i18n||(t.i18n=e)})]).directive("relatedItems",["translationService","utilitiesService","$relatedItemTypes",(e,t,i)=>({replace:!0,templateUrl:"/assets/relatedItems.html",controller:"RelatedItemsCtrl",link:(s,a,r)=>(s.i18n||(s.i18n=e),s.types||(s.types=i),s.titleCase||(s.titleCase=t.titleCase))})])},9616:()=>{"use strict";const e={"ar-AR":"ar","br-PT":"pt","ca-ES":"ca","cs-CZ":"cs","da-DK":"da","de-DE":"de","en-AU":"en","en-NZ":"en","en-UK":"en",en:"en","es-ES":"es","fa-FA":"fa","fi-FI":"fi","fr-CA":"fr","fr-FR":"fr","gb-CY":"cy","gr-GR":"el","he-HE":"he","is-IS":"is","it-IT":"it",jp:"ja","ko-KO":"ko","mi-NZ":"mi","ms-MY":"ms","nl-NL":"nl","no-NO":"nb",pl:"pl","pt-PT":"pt","ru-RU":"ru","sv-SE":"sv","th-TH":"th","tu-TU":"tr","za-CN":"zh-tw","zh-CN":"zh"};class t{constructor(e,t,i,s,a){this.$scope=e,this.researchAssistantService=t,this.apiService=i,this.params=angular.copy(s.defaults,{}),this.documentService=a}listenToClickInResearchAssistantDocument(){const e=document.getElementById("research-assistant");e&&e.addEventListener("application",(e=>{"source"===e.detail.event&&"click"===e.detail.status&&e.detail.value&&(e.preventDefault(),this.toggleQuickLookForResearchAssistant(e.detail.value))}))}toggleQuickLookForResearchAssistant(e){e.startsWith("cdi_")&&(e=e.substring(4)),this.params.solrPassThroughQuery=`(sys_participant_id:${e})`,this.params.pn=0,this.params.ps=1,this.params.ho="f",this.apiService.searchResearchAssistantDocument(this.params).then((e=>{let t=e.data.documents[0];t&&(t=this.documentService.getResearchResultDocument(t),this.$scope.toggleQuickLook(t))}))}}t.$inject=["$scope","researchAssistantService","apiService","appStateService","documentService"],angular.module("summonApp.directives").controller("researchAssistantController",t).directive("researchAssistant",["$rootScope","$authEvents","localizationService","configService","authenticationService","researchAssistantService",(i,s,a,r,n,o)=>({replace:!1,templateUrl:"/assets/researchAssistant.html",controllerAs:"ra",controller:t,authenticationService:n,link(t,n,o,l){if(t.standardLocale=a.getStandardLocale(),t.language=(e[t.standardLocale]||t.standardLocale).toLowerCase(),t.baseURL=this.getBaseURLForClientEnv(),t.libhash=this.getLibhash(),i.$on(s.LOGINSUCCESS,(()=>{let e=this.getProviderName(),t={provider:e,csrf:this.getCSRF(e),user:this.getUser(e)};this.updateAPIParamsForProvider(t)})),i.$on("csrfTokenRefreshed",((e,t)=>{this.updateAPIParamsForProvider(t)})),t.language&&t.baseURL){const e=document.getElementById("research-assistant-placeholder");if(e){let i=this.getProviderName();e.innerHTML=`\n                    <cdi-research-assistant\n                        id="research-assistant"\n                        height="90vh"\n                        client-key="${t.libhash}"\n                        product="summon"\n                        show-beta="true"\n                        language="${t.language}"\n                        api-url="${t.baseURL}/research-assistant"\n                        shows-toasts="true"\n                        show-advanced="true"\n                        enable-history="false"\n                        how-to-cite-link="${r.data.researchAssistant.citeLink}"\n                        api-params='${JSON.stringify({provider:i,csrf:this.getCSRF(i),user:this.getUser(i)})}'\n                        show-quotum="true">\n                    </cdi-research-assistant>\n                `,null==l||l.listenToClickInResearchAssistantDocument()}else console.error("Placeholder element for the component was not found.")}else console.error("Required properties are not ready: language or baseURL is missing.")},getBaseURLForClientEnv(){const e=r.data.env.value,t=r.data.head.client;switch(e){case"development":return"http://localhost:9000";case"test":return`https://${t}.test.summon.serialssolutions.com`;case"ci":return`https://${t}.ci.summon.serialssolutions.com`;case"preview":return`https://${t}.preview.summon.serialssolutions.com`;case"production":return`https://${t}.summon.serialssolutions.com`;default:return console.warn(`Unknown environment: ${t} . ${e}`),`https://${t}.preview.summon.serialssolutions.com`}},getLibhash:()=>r.data.availability.libHash,getProviderName:()=>n.getLoggedInProviderForFeature("research_assistant")||"",getCSRF:e=>n.getAuthValue(e,"csrf")||"",getUser:e=>n.getAuthValue(e,"user")||"",updateAPIParamsForProvider(e){const t=document.getElementById("research-assistant");t?(t.setAttribute("api-params",JSON.stringify(e)),console.log("API params updated for provider:",t)):console.error('Element with id "research-assistant" not found.')}})])},9477:()=>{"use strict";angular.module("summonApp.directives").directive("resultsFeed",(()=>({replace:!0,controller:"ResultsFeedCtrl",templateUrl:"/assets/resultsFeed.html"}))).directive("document",(()=>({priority:10,link:{pre:(e,t,i)=>e.document=e.$eval(i.document)}}))).directive("documentSummary",["documentService","quickLookService","configService","journalCoverageDetailsService",(e,t,i,s)=>({replace:!0,templateUrl:"/assets/documentSummary.html",scope:!0,link:{pre(a,r,n){const o=i.data.results,{libHash:l}=i.data.availability;a.headingLevel=n.headingLevel||"h3",a.showQuickLook=!!n.showQuicklook,a.showRelated=!!n.showRelated,a.resultNumber=!!n.resultNumber;const c=a.document,h=c.issns&&c.issns.length;if(c.thumbnail_small||(c.thumbnail_small=!1),c.thumbnail_medium||(c.thumbnail_medium=!1),c.thumbnail_large||(c.thumbnail_large=!1),c.thumbnail_small||(c.thumbnail_small=c.thumbnail_medium),c.thumbnail_small||(c.thumbnail_small=c.thumbnail_large),c.hasDetailPage=e.displayDetailPage(c)||e.displayAIPage(c),a.summary=e.getDocumentSummary(c),a.availabilityDocs=[c].concat(c.peer_documents||[]),a.authors=e.getAuthors(c),a.altmetrics=i.data.altmetrics,a.journalTitleSearchLink=o.enableJournalTitleLink&&e.getJournalTitleSearchLink(c),a.displayOpenAccessIndicator=o.displayOpenAccessIndicator&&c.is_open_access,a.addOpenAccessLink=o.addOpenAccessLink&&c.open_access_link,a.displayPeerReviewIndicator=o.displayPeerReviewIndicator&&c.is_peer_reviewed,a.displayOnlineIndicator=o.displayOnlineIndicator,a.displayRelatedItemsLink=o.displayRelatedItems,a.displayPdfQuickLinks=o.displayPdfQuickLinks,a.displayHtmlQuickLinks=o.displayHtmlQuickLinks,a.displayEditor=o.displayEditor,a.maximumFullTextLinks=o.maximumFullTextLinks,a.enableAdditionalFullTextLinks=o.enableAdditionalFullTextLinks,a.displayMultipleFullTextLinks=a.maximumFullTextLinks>1&&a.enableAdditionalFullTextLinks,a.displayLinkResolver=o.displayLinkResolver,a.showDocumentGlanceability=e.showDocumentGlanceability,a.getDocumentGlancebilityIcon=e.getDocumentGlancebilityIcon,a.displayWarningGlanceability=e.displayWarningGlanceability,a.getWarningGlanceabilityPublications=e.getWarningGlanceabilityPublications,a.getWarningGlanceabilityNotices=e.getWarningGlanceabilityNotices,a.checkGlanceabilityEnablmentFromCustomizer=e.checkGlanceabilityEnablmentFromCustomizer,a.displaySecondaryPublicationsTypesSeparator=e.displaySecondaryPublicationsTypesSeparator,a.displaySecondaryNoticeTypesSeparator=e.displaySecondaryNoticeTypesSeparator,a.showVideoLink=e.showVideoLink(c),a.showVideoLink&&(a.videoLink=e.getVideoLink(c)),a.syndeticsIsbn=c.isbn,c.databases=t.setDatabases(c),a.computedVals=e.getComputedValues(c),c.simple_title=e.getSimpleTitle(c.title),c.journalCoverageSummary=s.getJournalCoverageSummary(c),a.showJournalCoverage=s.isJournalCoverageAvailable(c)&&o.displayJournalCoverageRanges,h){const e=c.issns[0];c.eJournalLink=s.getJournalConverageDetailEJournalLink(l,e)}if(a.isAlmaClient=o.isAlmaClient,a.isAlmaClient){const e=i.data.alma.ill||i.data.alma.suprima||i.data.alma.citation_linker||i.data.alma.journal_search;if(e){const t=new URL(e).hostname,i=o.almaId,a=c.external_document_id;return c.eJournalLinkSOA=s.getJournalConverageDetailEJournalLinkSOA(t,i,a)}}}}})]).directive("documentCitation",[()=>({replace:!0,templateUrl:"/assets/documentCitation.html"})]).directive("documentAction",["dialogService","alertService","translationService",(e,t,i)=>({replace:!0,templateUrl:"/assets/documentAction.html",scope:{documents:"=",openClickTrackLink:"=",openPage:"=",search:"=",action:"@"},link:s=>("citation"==s.action?(s.translation=i.translations.CITE_THIS_ITEM,s.showExportOptions=!0,s.displayDialog=function(i){const{currentTarget:a}=i;return t.resetAlert("citationError"),e.displayDialog("cite",s,(e=>s.close=e.close)).then((function(){if(null!=a)return a.focus()}))}):"email"==s.action?(s.translation=i.translations.EMAIL_THIS_ITEM,s.displayDialog=function(i){const{currentTarget:a}=i;return t.resetAlert("citationError"),t.resetAlert("citationEmailError"),e.displayDialog("email",s,(e=>s.close=e.close)).then((function(){if(null!=a)return a.focus()}))}):"bulk_download"==s.action&&(s.translation=i.translations.EXPORT_RESULTS,s.displayDialog=function(t){const{currentTarget:i}=t;return e.displayDialog("bulkExport",s,(e=>s.close=e.close)).then((function(){if(null!=i)return i.focus()}))}),s.getRecordCount=function(){var e;return null===(e=s.$parent.feed.items[0])||void 0===e?void 0:e.recordCount},s.openDetailPage=function(e){return s.close(),s.openPage(e)},s.fieldSearch=function(e,t){return s.close(),s.search(e,t)})})]).directive("moreActions",["citationService","menuManagerService",(e,t)=>({replace:!0,templateUrl:"/assets/moreActions.html",link(i){const s="moreActions"+i.$id,a={name:s,type:"dropdown",close:["any"]};return t.registerMenu(a),i.onToggle=function(e){return e?t.subMenu[s].openMenu():t.subMenu[s].closeMenu()},i.setExportOptions=function(){return i.exportOptions=e.styles.export,e.prepCitationExportOptions(i.document,i.exportOptions)}}})]).directive("libguides",(()=>({replace:!0,scope:{libguides:"="},templateUrl:"/assets/libguides.html",link(e){if(e.columns=[],e.libguides&&e.libguides.length){if(e.libguides.length<=4)return e.columns.push(e.libguides);{const t=Math.ceil(e.libguides.length/2),i=e.libguides.length-t;return e.columns.push(e.libguides.slice(0,t)),e.columns.push(e.libguides.slice(t,t+i))}}}})))},6830:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c,h){this.removeLocalStorageItems=this.removeLocalStorageItems.bind(this),this.$scope=e,this.$window=t,this.$timeout=i,this.rtaAvailabilityService=s,this.availabilityService=a,this.$location=n,this.authentication=o,this.$uibModal=l,this.config=c,this.sierraService=h,this.i18n=r,this.isSierraClient=this.config.data.rtaAvailability.isSierraClient,this.showAbbreviatedRTA=this.config.data.rtaAvailability.showAbbreviatedRTA,this.showLocationsColumnIsOn=this.config.data.rtaAvailability.showLocationsColumn,this.isLoggedIn=!1,this.isRequestable=this.rtaAvailabilityService.isRequestable,this.formatProperty=this.rtaAvailabilityService.formatProperty,this.getStatusMessage=this.rtaAvailabilityService.getStatusMessage,this.hasProperty=this.rtaAvailabilityService.hasProperty,this.getAvailabilityStatus=this.rtaAvailabilityService.getAvailabilityStatus,this.openDetailPage=this.$scope.openDetailPage,this.openClickTrackLink=this.$scope.openClickTrackLink,this.loadingMessage='<div class="loading" aria-label="{{::i18n.translations.LOADING}}"></div>'+this.i18n.translations.REQUEST_CHECK_ALLOWED,this.requestButtonMessage=this.i18n.translations.REQUEST_RTA,this.setDirectiveVariablesWithDefaultValues()}$onChanges(e){if(e.docs&&!e.docs.isFirstChange())return this.setDirectiveVariablesWithDefaultValues(),this.prepareRTAAvailabilityInfoForRender()}$onInit(){return this.prepareRTAAvailabilityInfoForRender()}setDirectiveVariablesWithDefaultValues(){return this.status=null,this.doc=null,this.requestAllowed=!0,this.hasAvailabilities=!1,this.hasMultipleBibIds=!1,this.showVolume=!1,this.showYear=!1,this.showLocationCol=!1,this.showCallNumberCol=!1,this.userCanChoose=!1,this.useItemId=!1,this.showLocations=!1,this.showAllAvailabilities=!1,this.availabilities=[],this.allItems=[],this.selectedBibId="",this.selectedItemId="",this.isSierraRTA=!1}prepareRTAAvailabilityInfoForRender(){var e,t;if(!this.docs||!(null===(e=this.docs)||void 0===e?void 0:e.length))return;this.doc=this.docs[0].doc;let i=this.doc.external_document_id;return this.selectedBibId=this.$window.localStorage.getItem("summon_request_bibid"),this.selectedItemId=this.$window.localStorage.getItem("summon_request_itemid"),s.each(this.docs,(e=>(this.rtaAvailabilityService.prepareRtaDoc(e,this.isSierraClient),i!==e.doc.external_document_id&&this.isSierraClient&&(this.hasMultipleBibIds=!0),i=e.doc.external_document_id,this.availabilities=this.availabilities.concat(e.availabilities)))),(null===(t=this.availabilities)||void 0===t?void 0:t.length)?(this.$scope.$watch("vm.selectedItemId",((e,t)=>this.requestAllowed=!this.userCanChoose||e),!0),s.any(this.docs,(e=>e.doc.external_document_id===this.selectedBibId))?(this.toggleLocations(),this.$timeout((()=>{if(this.authentication.isLoggedIn(this.sierraService.provider))return this.requestItem()}),200)):this.selectedBibId=this.doc.external_document_id,this.availabilities=s.sortBy(this.availabilities,this.rtaAvailabilityService.statusSort),this.allItems=s.chain(this.availabilities).filter((e=>e&&!e.isSuppressed)).groupBy((e=>`${e.location}_${e.statusMessage}_${e.callNumber}_${e.volume}}`)).map(((e,t)=>this.rtaAvailabilityService.sanitizeAvailabilities(e,this.isSierraClient))).value(),this.selectedItemId&&s.find(this.allItems,(e=>s.find(e,(e=>e.itemId===this.selectedItemId))))&&(this.showAllAvailabilities=!1,this.toggleShowAllAvailabilities(),this.toggleLocations(!0)),this.initAvailabilities(this.availabilities)):void 0}initAvailabilities(e){return this.showVolume=this.rtaAvailabilityService.hasVolume(e),this.showYear=this.rtaAvailabilityService.hasYear(e),this.showLocationCol=this.rtaAvailabilityService.hasLocation(e)&&this.showLocationsColumnIsOn,this.showCallNumberCol=this.rtaAvailabilityService.hasCallNumber(e),this.userCanChoose=e.length>1&&(this.showVolume||this.hasMultipleBibIds),this.useItemId=this.showVolume||this.requestLevelIsItem(),!this.userCanChoose&&this.useItemId&&(this.selectedItemId=e[0].itemId),this.status=this.rtaAvailabilityService.getStatusForAvailabilities(e),this.isSierraRTA=this.isSierraClient&&("unknown"!==this.status.code||e.length>1),this.hasRequestableStatus=this.rtaAvailabilityService.isRequestableForAvailabilities(e),this.isLoggedIn=this.authentication.isLoggedIn(this.sierraService.provider),this.hasRequestableStatus||(this.requestButtonMessage=this.i18n.translations.REQUEST_NOT_ALLOWED),this.hasAvailabilities=s.some(e),this.requestAllowed=!this.rtaAvailabilityService.hasVolume(e)||this.selectedItemId}requestLevelIsItem(){var e,t,i,s;const a=this.sierraService.getLoadedUserInfo();if(!a)return!1;const r=(null===(e=a.holdConfig)||void 0===e?void 0:e.item)&&Object.keys(null===(t=a.holdConfig)||void 0===t?void 0:t.item).length,n=(null===(i=a.holdConfig)||void 0===i?void 0:i.bib)&&Object.keys(null===(s=a.holdConfig)||void 0===s?void 0:s.bib).length;return r&&!n}getMainDisplayInfo(){return s.includes(["ai","citation"],this.availabilities[0].type)?this.availabilities[0].statusMessage:!this.showAbbreviatedRTA&&this.availabilities[0].displayString.length?this.availabilities[0].displayString:this.status.translation}toggleShowAllAvailabilities(){return this.showAllAvailabilities=!this.showAllAvailabilities,this.limitItems=this.showAllAvailabilities?this.availabilities.length:this.limitTo}handleClick(e,t,i=0){if(!this.isSierraRTA)return t.preventDefault(),this.isExternalLink(e)?this.openClickTrackLink(e[0].link,e[0]):this.openDetailPage(this.docs[i].doc)}isExternalLink(e){return!this.isSierraRTA&&("ai"!==e[0].type&&(!this.doc.hasDetailPage||"rta"!==e[0].type)||this.$scope.onDetailPage)}rowIsClickable(e){return!this.$scope.onDetailPage||this.isSierraRTA?!this.isSierraRTA:"ai"!==e.type}removeLocalStorageItems(){return this.$window.localStorage.removeItem("summon_request_bibid"),this.$window.localStorage.removeItem("summon_request_itemid")}selectAvailItem(e){if(!this.userCanChoose)return;this.isLoggedIn=this.authentication.isLoggedIn(this.sierraService.provider);const t=s.find(this.allItems,(e=>s.find(e,(e=>e.itemId===this.selectedItemId))));if(t){this.selectedBibId=t[0].bibId;const e=s.find(this.docs,(e=>e.doc.external_document_id===this.selectedBibId));this.doc=e.doc,this.$window.localStorage.setItem("summon_request_bibid",this.selectedBibId)}return this.$window.localStorage.setItem("summon_request_itemid",this.selectedItemId),this.hasMultipleBibIds&&this.isLoggedIn?this.checkWithSierraForRequestability():void 0}toggleLocations(e=!this.showLocations){return this.isLoggedIn=this.authentication.isLoggedIn(this.sierraService.provider),this.isCheckingRequestability=!1,this.showLocations=e,this.showLocations?this.hasRequestableStatus&&this.isLoggedIn&&!this.hasMultipleBibIds?this.checkWithSierraForRequestability():void 0:this.removeLocalStorageItems()}reloadAvailability(){return this.rtaLoaded.loaded=!1,this.availabilityService.getSingleDocRTA(this.doc,!1,!1)}requestItem(){if(this.authentication.isLoggedIn(this.sierraService.provider))return this.removeLocalStorageItems(),this.$uibModal.open({templateUrl:"/assets/rtaAvailabilityRequest.html",controller:"rtaAvailabilityRequestController",controllerAs:"vm",resolve:{doc:()=>this.doc,availabilities:()=>this.availabilities,itemId:()=>this.selectedItemId,useItemId:()=>this.useItemId},backdrop:!0,keyboard:!0});this.authentication.openLoginDialog("sierra").then((()=>{this.$log.debug("after login")})).catch((()=>{this.isLoggedIn=this.authentication.isLoggedIn(this.sierraService.provider),this.isLoggedIn&&!this.hasMultipleBibIds&&this.sierraService.patronInfoLoadedPromise.promise.then((()=>{this.checkWithSierraForRequestability().then((e=>{e&&this.requestItem()}))}))}))}checkWithSierraForRequestability(){this.isCheckingRequestability=!0,this.requestButtonMessage=this.loadingMessage;const e=this.sierraService.transformBibId(this.selectedBibId);return this.sierraService.getHoldRequestByBibId(e).catch((e=>(132===e.data.code&&(this.requestButtonMessage=this.i18n.translations.REQUEST_NOT_ALLOWED,this.hasRequestableStatus=!1),!1))).then((e=>!!e&&(this.requestButtonMessage=this.i18n.translations.REQUEST_RTA,!0))).finally((()=>this.isCheckingRequestability=!1))}}class r{constructor(e,t,i,s,a,r,n,o,l,c,h,d,u,p,m){this.$onInit=this.$onInit.bind(this),this.afterClose=this.afterClose.bind(this),this.loadDialogContent=this.loadDialogContent.bind(this),this.handleError=this.handleError.bind(this),this.login=this.login.bind(this),this.$window=e,this.$q=t,this.$uibModalInstance=i,this.rtaAvailabilityService=s,this.sierraService=a,this.configService=r,this.doc=c,this.availabilities=h,this.itemId=d,this.useItemId=u,this.$log=p,this.$filter=m,this.i18n=n,this.alerts=l,this.provider=this.sierraService.provider,this.userIsAuthenticated=o.isLoggedIn(this.provider),this.isLoading=!1,this.pickupLocations=[],this.selectedPickupLocation="",this.showOptionalFields=!1,this.cancelDate=null,this.holdNote=null,this.cancelDateAllowed=!1,this.isCancelDatePickerOpen=!1,this.cancelDateOptions={minDate:new Date},this.bibId=this.sierraService.transformBibId(this.doc.external_document_id),this.recordType="b",this.showMode="FORM",this.hasError=!1}$onInit(){return this.isLoading=!0,this.alerts.resetAlert("requestHoldError"),this.alerts.resetAlert("requestHoldSuccess"),this.$uibModalInstance.result.then((e=>this.afterClose(e))).catch((e=>this.afterClose(e))),this.userIsAuthenticated?this.loadDialogContent():this.hasError=!1}afterClose(e){return this.$log.debug("rta Dialog closed",e),this.alerts.resetAlert("requestHoldError"),this.alerts.resetAlert("requestHoldSuccess")}loadDialogContent(){return this.sierraService.getHoldRequestByBibId(this.bibId).then((e=>{var t,i,s,a,r,n,o,l,c,h;const d=this.useItemId?"item":"bib",u=this.sierraService.getLoadedUserInfo();return!e.data.holdshelf||(null===(i=null===(t=u.holdConfig)||void 0===t?void 0:t[d])||void 0===i?void 0:i.useHomePickupLocation)||(null===(a=null===(s=u.holdConfig)||void 0===s?void 0:s[d])||void 0===a?void 0:a.useItemPickupLocation)?(this.selectedPickupLocation={name:"",code:u.libraryInfo.locationId||"default"},(null===(n=null===(r=u.holdConfig)||void 0===r?void 0:r[d])||void 0===n?void 0:n.useHomePickupLocation)&&u.libraryInfo.locationId?this.selectedPickupLocation={name:u.libraryInfo.locationName,code:u.libraryInfo.locationId}:(null===(l=null===(o=u.holdConfig)||void 0===o?void 0:o[d])||void 0===l?void 0:l.useItemPickupLocation)&&this.sierraService.getItemByItemId(this.bibId).then((e=>{if(e.data.entries[0].location)return this.selectedPickupLocation=e.data.entries[0].location})).catch(err)((()=>this.selectedPickupLocation={name:"",code:"default"}))):(this.pickupLocations=e.data.holdshelf.locations,e.data.holdshelf.selected&&(this.pickupLocations.unshift(e.data.holdshelf.selected),this.selectedPickupLocation=e.data.holdshelf.selected),1===this.pickupLocations.length&&(this.selectedPickupLocation=this.pickupLocations[0],this.pickupLocations=[])),(null===(h=null===(c=this.sierraService.userInfo.holdConfig)||void 0===c?void 0:c[d])||void 0===h?void 0:h.notNeededAfter)&&(this.cancelDateAllowed=!0),this.isLoading=!1})).catch(this.handleError)}handleError(e){let t;return this.showMode="SUMMARY",this.hasError=!0,this.isLoading=!1,t=e.data&&e.data.description?e.data.description.replace("XCirc error :",""):e.data&&e.data.msg?e.data.msg.replace("XCirc error :",""):this.i18n.translate(this.i18n.translations.REQUEST_ERROR_UNKNOWN),this.alerts.setAlert("requestHoldError",this.i18n.translate(this.i18n.translations.REQUEST_HOLD_FAILED,{reason:t}))}login(e,t="cas"){return e.preventDefault(),this.authentication.login("sierra",t)}openCancelDatePicker(){return this.isCancelDatePickerOpen=!0}cancel(){return this.$uibModalInstance.dismiss("cancel")}request(e){var t,i;if(e){this.isLoading=!0;const e={recordType:this.useItemId?"i":"b",recordNumber:this.useItemId?parseInt(this.itemId):parseInt(this.bibId),pickupLocation:null===(i=null===(t=this.selectedPickupLocation)||void 0===t?void 0:t.code)||void 0===i?void 0:i.trim()};return this.holdNote&&(e.note=this.holdNote),this.cancelDate&&(e.neededBy=this.$filter("date")(this.cancelDate,"yyyy-MM-dd")),this.sierraService.createHoldRequest(e,this.bibId).then((e=>(this.showMode="SUMMARY",this.isLoading=!1,this.alerts.setAlert("requestHoldSuccess",this.i18n.translations.REQUEST_HOLD_CREATED)))).catch(this.handleError)}}}a.$inject=["$scope","$window","$timeout","rtaAvailabilityService","availabilityService","translationService","$location","authenticationService","$uibModal","configService","sierraService"],r.$inject=["$window","$q","$uibModalInstance","rtaAvailabilityService","sierraService","configService","translationService","authenticationService","alertService","doc","availabilities","itemId","useItemId","$log","$filter"],angular.module("summonApp.directives").controller("rtaAvailabilityRequestController",r).controller("rtaAvailabilityController",a).directive("rtaAvailability",(()=>({replace:!0,templateUrl:"/assets/rtaAvailability.html",controllerAs:"vm",controller:a,bindToController:{docs:"<",limitTo:"<",rtaLoaded:"<",contentTypeIcon:"<"}})))},6430:()=>{"use strict";angular.module("summonApp.directives").directive("saveable",["$compile","flowService","$templateCache","$timeout",(e,t,i,s)=>({link(a,r){const n=function(e){if(a.saveditems.contains(a.document)||e.errorMessage&&e.ids.includes(a.document.id))return a.saving=!1};return a.performAction=function(e){if(!e.link)return e.openLink?a.openClickTrackLink(e.openLink):void 0},t.on("itemSaveCompletion",n),a.$on("$destroy",(()=>t.off("itemSaveCompletion",n))),s((function(){const t=e(i.get("/assets/recordActionsGroup.html"))(a);return angular.element(r).append(t)}))}})]).directive("removable",["$compile","localizationService","$templateCache","$timeout",(e,t,i,s)=>({link:(a,r)=>(a.isRTL=t.localization.isRTL,s((()=>angular.element(r).append(e(i.get("/assets/removeSavedItem.html"))(a)))))})]).directive("savedItemsFolder",["menuManagerService","moreFacetsService",(e,t)=>({replace:!0,controller:"SavedItemsCtrl",templateUrl:"/assets/savedItemsFolder.html",link:(t,i,s)=>(t.hasTooltip="hasTooltip"===s.savedItemsFolder,t.toggle=function(){return e.closeAllMenuTypeSubMenu(),t.saveditems.toggle()})})]).directive("flashTooltip",["$timeout","flowService",(e,t)=>({link(i,s){const a=angular.element(".savedItemsFolder"),r=angular.element("button.savedItemsButton");s.on("mouseenter",(()=>(n(),r.trigger("customEvent")))),s.on("mouseleave",(()=>r.trigger("customEvent")));var n=()=>i.tooltipMsg=a.hasClass("flashingTooltip")?i.flashTip:i.regTip;const o=()=>(a.toggleClass("flashingTooltip"),n(),r.trigger("customEvent"));var l=function(){return void 0===t.auth.user?t.once("authChange",l):t.auth.user.authenticated?void 0:(e(o,0),e(o,5e3))},c=i.$watch("saveditems.items.length",(function(e){if(e>0)return l(),c()}));return i.$on("$destroy",(function(){return s.off("mouseenter"),s.off("mouseleave")}))}})])},6572:()=>{"use strict";angular.module("summonApp.directives").directive("savedSearchesToggle",(()=>({replace:!0,templateUrl:"/assets/savedSearchesToggle.html",controller:"SavedSearchCtrl"}))).directive("savedSearchesDialog",["$helpLinks",()=>({replace:!0,templateUrl:"/assets/savedSearchesDialog.html",controller:"SavedSearchCtrl"})]).directive("saveSearchHelp",["$helpLinks","translationService",(e,t)=>({replace:!0,templateUrl:"/assets/saveSearchHelp.html",scope:{helpLinkKey:"@"},link(i){i.helpLink=e[i.helpLinkKey],i.i18n=t}})])},7447:()=>{"use strict";angular.module("summonApp.directives").directive("searchBox",(()=>({restrict:"A",replace:!0,controller:"SearchBoxCtrl",templateUrl:"/assets/searchBox.html"})))},3656:()=>{"use strict";class e{constructor(e,t,i,s,a){this.$scope=e,this.appState=i,this.searchScopeService=t,this.advanced=s,this.dialogService=a,this.currentSearchScope=this.searchScopeService.currentSearchScope,this.advanced.on("clearSearchScope",(()=>{this.$scope.fromAdvancedSearch&&(this.currentSearchScope=this.searchScopeService.getSearchScopeByName("all"),this.updateState())})),this.searchScopeService.on("clearScopeAsSideEffect",((e="",t,i)=>{this.showLeavingSearchScopeAlert(e,t,i)}))}$onInit(){this.appState.on("apply",(()=>{this.currentSearchScope=this.searchScopeService.currentSearchScope}))}showLeavingSearchScopeAlert(e,t,i){if(this.searchScopeService.$uibModalInstance)return;this.searchScopeService.warningMetaData={fromAdvanced:!!e,scopeLabel:e,callBack:t,callbackDateParams:i};const s=e?" advanced":"";this.searchScopeService.$uibModalInstance=this.dialogService.displayModalDialog(this.$scope,"LeavingSearchScopeModalCtrl","leave-search-scope","refine/leaveSearchScope.html",!1,s)}updateState(){this.searchScopeService.updateState(this.currentSearchScope,!this.$scope.fromAdvancedSearch),angular.isFunction(this.$scope.onChange())&&this.$scope.onChange()(this.currentSearchScope)}}e.$inject=["$scope","searchScopeService","appStateService","advancedSearchService","dialogService"],angular.module("summonApp.directives").controller("searchScopeController",[e]).directive("searchScopeDropdown",[()=>({replace:!0,templateUrl:"/assets/searchScopeDropdown.html",controller:e,controllerAs:"searchScpCtrl",scope:{fromAdvancedSearch:"<",onChange:"&",focusMe:"<"}})])},2802:()=>{"use strict";class e{constructor(e,t,i,s,a,r){this.onNewQuery=this.onNewQuery.bind(this),this.$http=e,this.$window=t,this.acService=i,this.advancedService=s,this.dataService=a,this.config=r,this.results=[],this.count=-1,this.prev_query="",this.query="",this.maxResultSize=3,this.searchError=!1,this.siteName=this.config.data.widgets.secondaryClient.name,this.site=this.buildSecondarySiteUrl(),this.searchUrl="api/secondarysearch",this.enableAutoSearch=!0,this.dataService.on("new",this.onNewQuery)}buildSecondarySiteUrl(){const e=this.config.data.head.client;return-1!==this.$window.location.origin.indexOf(e)?this.$window.location.origin.replace(e,this.siteName):`https://${this.siteName}.summon.serialssolutions.com`}clear(){return this.results=[],this.count=-1,this.searchError=!1}clearSearch(){return this.clear(),this.query=""}updateData(e){return this.results=e}search(e){if(this.query=e,0===this.query.length)return;this.prev_query=this.query;const t=`${this.searchUrl}?q=${this.query}`;return this.$http.get(t).then((e=>{const t=e.data.documents.map((function(e){return e.search_result=!0,e}));return this.count=e.data.record_count,this.updateData(t)})).catch((e=>(console.error(e),this.clear(),this.searchError=!0)))}parseQuery(e){if(/([^:]+):\(.+?\)?/.test(e)){const t=this.advancedService.parseQueryToAdvancedQueryValues(e);if(t&&t.length)return t.join(" ")}if(/([^:]+):".+?"/.test(e)){const t=e.match(/[^:]+:"([^"]+)"/);return t&&t.length?t[1]:""}return e.length>150?"":e}onNewQuery(e){const t=e.query.original_query;if(this.enableAutoSearch)return this.prev_query!==t?(this.clear(),this.query=this.parseQuery(t),this.search(this.query)):void 0;this.clear()}}e.$inject=["$http","$window","autocompleteService","advancedSearchService","dataService","configService"];class t{constructor(e,t,i){this.submit=this.submit.bind(this),this.$scope=e,this.secondarySearchService=t,this.query="",this.count=this.secondarySearchService.count,this.maxResultSize=this.secondarySearchService.maxResultSize,this.clear=this.secondarySearchService.clear,this.secondarySiteName=this.secondarySearchService.siteName}$onInit(){return this.$scope.$watchCollection("secondaryResults",(e=>this.query=this.secondarySearchService.query))}clearSearch(e){return this.clear(),this.query="",this.secondarySearchService.clearSearch()}onSelect(e){return this.clear(),e.search_result=!0,this.secondarySearchService.updateData([e]),this.$scope.$apply()}submit(){return this.clear(),this.secondarySearchService.search(this.query)}}t.$inject=["$scope","secondarySearchService","configService"];class i{constructor(e,t,i,s){this.$scope=e,this.$window=i,this.secondarySearchService=s,this.secondaryBaseUrl=this.secondarySearchService.site,this.maxResultSize=this.secondarySearchService.maxResultSize,this.secondarySiteName=this.secondarySearchService.siteName}$onInit(){return this.$scope.$watchCollection("secondaryResults.results",(e=>this.secondaryUrl=this.secondaryBaseUrl+"/#!/search?q="+this.secondarySearchService.query))}}i.$inject=["$scope","$sce","$window","secondarySearchService"],angular.module("summonApp.directives").service("secondarySearchService",e).controller("secondarySearchResultsController",i).controller("secondarySearchController",t).directive("secondarySearch",(()=>({controllerAs:"secondarySearch",controller:t,templateUrl:"/assets/secondarySearchWidget.html"}))).directive("secondarySearchResults",(()=>({controllerAs:"secondaryResults",controller:i,templateUrl:"/assets/secondarySearchWidgetResults.html",bindToController:{results:"<",count:"<"}})))},4672:()=>{"use strict";class e{constructor(e){this.$scope=e}}class t{constructor(e,t){var i,s;this.$scope=e,this.i18n=t,this.directLink=(null===(i=this.$scope.vm.doc)||void 0===i?void 0:i.link_to_pdf)||(null===(s=this.$scope.vm.doc)||void 0===s?void 0:s.link_to_unpaywall)}}class i{constructor(e,t){this.$scope=e,this.i18n=t}}e.$inject=["$scope"],t.$inject=["$scope"],i.$inject=["$scope"],angular.module("summonApp.directives").directive("summonButton",(()=>({replace:!0,templateUrl:"/assets/shared/summonButton.html",controllerAs:"sb",controller:e,bindToController:{dotCode:"<",displayText:"<",hoverText:"<",toggle:"<"}}))).directive("summonLink",(()=>({replace:!0,templateUrl:"/assets/shared/summonLink.html",controllerAs:"sl",controller:t,bindToController:{link:"<",displayText:"<",hoverText:"<",icon:"<",dotCode:"<",loadStatus:"<",internalRedirect:"<"}}))).directive("summonDropdown",(()=>({replace:!0,templateUrl:"/assets/shared/summonDropdown.html",controllerAs:"vm",controller:t,bindToController:{primaryLink:"<",options:"<",displayText:"<",linkClickEvent:"&",primaryLinkLabel:"<",dotCode:"<"}}))).directive("summonCheckbox",(()=>({replace:!0,templateUrl:"/assets/shared/summonCheckbox.html",controllerAs:"sc",controller:i,bindToController:{isSelected:"<",isDisabled:"<",hoverText:"<",scLabel:"<",inputId:"<",toggle:"&"}})))},4737:()=>{"use strict";angular.module("summonApp.directives").directive("summonAlert",["alertService","translationService",(e,t)=>({templateUrl:"/assets/summonAlert.html",scope:{alertName:"@",retryAction:"&",translationParams:"=?"},compile:()=>({pre:i=>(i.alerts=e.alerts,i.translationParams||(i.translationParams={}),i.i18n=t),post(t,i,s){if(null!=s.closeButton)return t.closeable=!0,t.close=()=>e.resetAlert(t.alertName)}})})])},6093:(e,t,i)=>{"use strict";i.r(t);var s=i(7025),a=i.n(s);let r;const n=/[A-Z]/g,o=function(e,t="_"){return e.replace(n,((e,i)=>(i?t:"")+e.toLowerCase()))},l=["badgeType","badgePopover","badgeDetails","noScore","hideLessThan","condensed"],c={};for(r of l)c[r]="=?";c.doc="=?",c.hasHeader="=?",a().module("summonApp.directives").directive("summonAltmetrics",["$timeout","translationService",function(e,t){let i=0;return{restrict:"C",templateUrl:"/assets/summonAltmetrics.html",transclude:!0,replace:!0,scope:c,link(t,s,n){const c=s.find(".altmetricContent");return t.altmetricsShowHideEvents=function(t){return e((()=>(this.elem.removeClass("altmetric-embed"),this.hasVisibleAltmetric=t)))},t.$watch("doc",(function(s){var h;s._hasAltmetric||(s._hasAltmetric=!1),t.hasVisibleAltmetric||(t.hasVisibleAltmetric=!1),c.empty(),c.append(t.elem=a().element("<span />"));const d={dois:"data-doi",pmids:"data-pmid"};for(var u in d){var p=d[u];(null===(h=s[u])||void 0===h?void 0:h.length)&&(t.elem.attr(p,s[u][0]),s._hasAltmetric=!0)}if(s._hasAltmetric){let s;const a={};for(s of l)n[s]&&t[s]&&(a[s]=t[s]);for(r of(t.elem.addClass("altmetricClass"),t.elem.addClass("altmetric-embed"),t.elem.attr("data-template","summon"),t.elem.attr("data-link-target","_blank"),document.getElementsByClassName("altemtrics_details"),Object.keys(a)))t.elem.attr("data-"+o(r,"-"),a[r]);return t.elem.on("altmetric:show",(()=>t.altmetricsShowHideEvents(!0))),t.elem.on("altmetric:hide",(()=>t.altmetricsShowHideEvents(!1))),i++,e((function(){if(i--,!i&&"_altmetric_embed_init"in window)return _altmetric_embed_init()}))}}))}}}])},3526:()=>{"use strict";angular.module("summonApp.directives").directive("svgIcon",["svgIconService","$sce","localizationService",(e,t,i)=>({restrict:"E",template:'<span ng-if="textBefore" ng-bind="textBefore"></span> <span ng-class="iconClass"> <svg ng-class="svgClass" ng-attr-view_box="{{viewBox}}" ng-bind-html="data"></svg> </span> <span ng-if="text" ng-bind="text"></span>',scope:{name:"@",viewbox:"@?",style:"@?",iconClass:"@?",svgClass:"@?",text:"<?",textBefore:"<?",flip:"<?",transform:"@?",flipForRtl:"<?"},link:(s,a,r)=>(s.data=t.trustAsHtml(e.get(s.name)),s.iconClass=s.iconClass||"svgIcon",s.viewBox=e.determineViewBox(s.name),i.localization.isRTL&&s.flipForRtl?s.flip||(s.transform="scale(-1, 1)"):s.flip&&(s.transform="scale(-1, 1)"),a.find("svg").attr("style",s.style),a.find("svg").attr("transform",s.transform))})]).directive("svgIconRaw",["svgIconService","$sce","localizationService",(e,t,i)=>({restrict:"E",replace:!0,template:'<svg ng-class="svgClass" ng-attr-view_box="{{viewBox}}" ng-bind-html="data"></svg>',scope:{name:"@",viewBox:"@?",svgClass:"@?",flip:"<?",transform:"@?",flipForRtl:"<?",style:"@?"},link:(s,a,r)=>(s.data=t.trustAsHtml(e.get(s.name)),s.viewBox=e.determineViewBox(s.name),i.localization.isRTL&&s.flipForRtl?s.flip||(s.transform="scale(-1, 1)"):s.flip&&(s.transform="scale(-1, 1)"),r.$set("style",s.style),r.$set("transform",s.transform))})])},2139:()=>{"use strict";angular.module("summonApp.directives").directive("syndetics",["$timeout","translationService",(e,t)=>({replace:!0,templateUrl:"/assets/syndetics.html",scope:{isbn:"@",clientId:"@",type:"@",view:"@",contentLoaded:"=?"},link(i,s){let a=null;return i.i18n=t,i.$watch("isbn",(function(t,r,n){a&&(e.cancel(a),a=null),i.contentLoaded&&(i.contentLoaded.loaded=!1);const o=$(s);o.data("processed",!1);const l=o.find(".syndetics-loading"),c=o.find(".syndetics-content");return""!==t&&i.clientId?(o.show(),l.show(),c.hide(),c.empty(),a=e((function(){if(!o.length||o.data("processed"))return;o.data("processed",!0);const s=$.trim(t),a=c.data("fields").split(" ");return c.attr("id","syndetics-plus_"+i.$id).append(function(e){const t=[];for(var i of e)t.push(`<div data-syndeticsid="${i}" class="syndetics-item ${i}"></div>`);return t.join("")}(a)).find(".syndetics-item").each((function(){const e=$(this);return e.attr("id",e.data("syndeticsid"))})),$syndetics.id=n.clientId,$syndetics.isbn=s,$syndetics.enhance(o,(function(t){return l.hide(),c.find("div[data-syndeticsid]:empty").length===c.find("div[data-syndeticsid]").length?o.hide():(c.find(".syndetics-item").removeAttr("id").end().show(),i.contentLoaded?e((()=>i.contentLoaded.loaded=!0)):void 0)}))}),1e3)):(c.hide(),c.empty(),void o.hide())}))}})])},8420:()=>{"use strict";angular.module("summonApp.directives").directive("topicSummary",(()=>({replace:!0,templateUrl:"/assets/topicSummary.html",controller:"TopicCtrl",controllerAs:"vm",bindToController:{fromSearchInfo:"<"}})))},7416:(e,t,i)=>{"use strict";var s=i(4125);angular.module("summonApp.directives").directive("parseDate",["$locale","translationService",(e,t)=>({require:"ngModel",link(i,a,r,n){const o=n,l=e.DATETIME_FORMATS.shortDate,c=new RegExp("^(y+)[\\.\\-\\/]{1}(M{1,2})[\\.\\-\\/]{1}(d{1,2})$"),h=new RegExp("^(d{1,2})[\\.\\-\\/]{1}(M{1,2})[\\.\\-\\/]{1}(y+)$"),d=new RegExp("^(y+)[\\.\\-\\/]{1}\\s{1}(M{1})[\\.\\-\\/]{1}\\s{1}(d{1})[\\.]{1}$"),u=new RegExp("^(M{1,2})[\\.\\-\\/]{1}(d{1,2})[\\.\\-\\/]{1}(y+)$"),p=new RegExp("^(\\d{1,2})[\\.\\-\\/]{1}(\\d{4})$"),m=new RegExp("^(\\d{1,2})[\\.\\-\\/]{1}(\\d{1,2})[\\.\\-\\/]{1}(\\d{4}|\\d{2})$"),g=new RegExp("^(\\d{4}|\\d{2})[\\.\\-\\/]{1}\\s{0,1}(\\d{1,2})[\\.\\-\\/]{1}\\s{0,1}(\\d{1,2})[\\.]{0,1}$"),v=new RegExp("^(\\d{4})$"),S=function(e="parseDate"){var t,i;return null===(i=(t=a[0]).setCustomValidity)||void 0===i||i.call(t,""),o.$setValidity(e,!0),!0},f=function(e="parseDate",i=t.translations.ENTER_VALID_DATE){var s,r;return null===(r=(s=a[0]).setCustomValidity)||void 0===r||r.call(s,i),o.$setValidity(e,!1),!0},b=(e,t,i)=>{const s=parseInt(String((new Date).getFullYear()).substr(2));return(i=parseInt(i))<100&&(i+=i>s?1900:2e3),S()&&new Date(i,parseInt(e)-1,parseInt(t))};return o.$parsers.unshift((function(e){const n=o.$viewValue;if((e=function(e){let t;if("object"==typeof n)return S()&&e;if(""===n)return S()&&null;switch(!0){case!!n.match(v):return a.attr("id").match(/from/i)?S()&&new Date(parseInt(n),0):S()&&new Date(parseInt(n),11,31,11,59,59);case!!n.match(p):var[i,s]=n.match(p).slice(1,3);return i>12?f()&&e:S()&&new Date(parseInt(s),parseInt(i)-1);case!(!n.match(m)||!l.match(h)&&!l.match(u)):return l.match(h)?[t,i,s]=n.match(m).slice(1,4):[i,t,s]=n.match(m).slice(1,4),b(i,t,s);case!!n.match(g)&&!!l.match(c)||!!l.match(d):return[s,i,t]=n.match(g).slice(1,4),b(i,t,s)}return f()&&void 0}(e))&&(null!=r.minDate&&(e=function(e){let a=i;for(var n of r.minDate.split("."))a=a[n];return s.isDate(a)?e>=a?(S("minDate"),e):void f("minDate",t.translations.FROM_DATE_BEFORE_TO):(S("minDate"),e)}(e)),e))return null!=r.maxDate?function(e){let a=i;for(var n of r.maxDate.split("."))a=a[n];return s.isDate(a)?e<=a?(S("maxDate"),e):void f("maxDate",t.translations.FROM_DATE_BEFORE_TO):(S("maxDate"),e)}(e):e}))}})])},1715:()=>{"use strict";angular.module("summonApp.directives").directive("chatWidgetLink",(()=>({templateUrl:"/assets/chatWidgetLink.html",controller:"ChatCtrl"}))).directive("rightChat",(()=>({templateUrl:"/assets/rightChat.html",controller:"ChatCtrl"}))).directive("chatWidget",["$compile","$sce","localizationService",(e,t,i)=>({replace:!0,templateUrl:"/assets/chatWidget.html",controller:"ChatCtrl",link(s,a){const r=s.chat;s.submitButton=a.find(".btn");const n=angular.element(window).height(),o=angular.element(window).width(),l=a.outerHeight(),c=a.outerWidth(),{isRTL:h}=i.localization;return(n||0===n)&&a.css("top",n-l-40),h?a.css("left",60):(o||0===o)&&a.css("left",o-c-60),s.$watch("chat.visible",(function(i){if(!i)return a.find(".springshareWidget, .libraryh3lpWidget, .questionPointWidget").remove();{const i=a.find(".chat");switch(r.type){case"libraryh3lp":var n=r.skin?`skin=${r.skin}`:`css=${r.cssHost}${r.libraryh3lpCssPath}`;r.iframeSource=t.trustAsResourceUrl(`${r.iframeSource}?${n}`);var o=e('<iframe class="libraryh3lpWidget" ng-class="{noOptions:!chat.email}" ng-src="{{chat.iframeSource}}" frameborder="0"></iframe>')(s);return i.append(o);case"springshare":var l=e('<div class="springshareWidget" ng-include="\'/assets/springshareWidget.html\'"></div>')(s);return i.append(l);case"questionpoint":var c=e('<iframe class="questionPointWidget" src="/widgets/questionPointWidget.html"></iframe>')(s);return i.append(c)}}}))}})]).directive("springshareV2",["$compile","configService",(e,t)=>({replace:!0,link(i,s){const a=t.data.chat.widget;if("springshare_v2"===a.type){i.widgetConfig=a;const t=e("<div ng-include=\"'/assets/springshareWidgetV2.html'\"></div>")(i);return s.replaceWith(t)}}})]).directive("whatsApp",["translationService","menuManagerService","configService",(e,t,i)=>({replace:!0,templateUrl:"/assets/whatsappChat.html",link(s,a,r){const n="whatsappChat"+s.$id,o={name:n,type:"dropdown",close:["any"]};return t.registerMenu(o),s.whatsAppHref=`https://api.whatsapp.com/send?phone=${i.data.chat.widget.number}&text=`,s.i18n=e,s.getText=()=>encodeURIComponent(s.message||""),s.click=()=>a.find(".dropdown-menu a")[0].click(),s.onToggle=function(e){return e&&t.subMenu[n].openMenu(),a.find("input[type=text]").focus()}}})]).directive("embeddedWidgetsView",(()=>({replace:!0,templateUrl:"/assets/widgets.html",controller:"EmbeddedWidgetsCtrl"}))).directive("embeddedWidgetsBox",["embeddedWidgetValues","$location",function(e,t){const i={"widget-type":"/widgets",search:"/search",customize:"/widgets",code:"/widgets"},s=function(s){if(e.activeTab=s,"search"!==s||e.activeWidget){if(t.path()!==i[s])return t.path(i[s])}else if(t.path()!==i["widget-type"])return t.path(i["widget-type"])};return{restrict:"A",templateUrl:"/assets/embeddedWidgetsBox.html",link:t=>(t.embeddedValues=e,t.setFlowLocation=s)}}])},8570:()=>{"use strict";angular.module("summonApp.factories").factory("authInterceptor",["$rootScope","$q","$injector","$authEvents","$log",function(e,t,i,s,a){return this.$rootScope=e,this.$q=t,this.$authEvents=s,this.$log=a,{request:e=>{const t=i.get("authenticationService");if(!t.scope.samlForPrivateSite&&-1===e.url.indexOf("/auth/")&&-1===e.url.indexOf("/sierra_api/")&&-1===e.url.indexOf("/save-search")&&-1===e.url.indexOf("/save-item")&&-1===e.url.indexOf("/api"))return e;let s="";if(0===e.url.indexOf("/auth/")){const t=/\/auth\/([^\/]+)\//.exec(e.url);t&&t.length>1&&(s=t[1])}else 0===e.url.indexOf("/sierra_api/")?s=t.getLoggedInProviderForFeature("sierra"):0===e.url.indexOf("/save-search/")||0===e.url.indexOf("/save-item")?s=t.getLoggedInProviderForFeature("cloudStorage"):0===e.url.indexOf("/api/")&&(s=t.getLoggedInProviderForFeature("searchapi")||"saml");if(!s)return e;e.headers=e.headers||{},e.headers["X-Provider"]=s;const a=t.getAuthValue(s,"csrf");if(!a)return e;const r=this.$q.defer();return-1===e.url.indexOf(`/auth/${s}/refresh`)?t.doRefreshToken(s).then((()=>(e.headers=e.headers||{},e.headers["X-CSRF-Token"]=t.getAuthValue(s,"csrf"),r.resolve(e)))).catch((t=>r.reject({config:e,error:t,errorMessage:"Failed to refresh token"}))):(e.headers=e.headers||{},e.headers["X-CSRF-Token"]=a,r.resolve(e)),r.promise},responseError:e=>{var t;let s=i.get("authenticationService");const a=(null===(t=e.config)||void 0===t?void 0:t.url)||"";if(!a)return e;if(!s.scope.samlForPrivateSite&&-1===a.indexOf("/auth/")&&-1===a.indexOf("/sierra_api/")&&-1===a.indexOf("/save-search/")&&-1===a.indexOf("/save-item"))return e;let r="";if(0===a.indexOf("/auth/")){const e=/\/auth\/([^\/]+)\//.exec(a);e&&e.length>1&&(r=e[1])}else 0===a.indexOf("/sierra_api/")?r=s.getLoggedInProviderForFeature("sierra"):0!==a.indexOf("/save-search/")&&0!==a.indexOf("/save-item")||(r=s.getLoggedInProviderForFeature("cloudStorage"));return this.$q.defer(),401!==e.status||"lti"==r||"saml"==r&&s.scope.samlForPrivateSite||(this.$log.debug(`Interceptor found 401 error for ${a}, emiting notauthenticated event. Provider: ${r}`),this.$rootScope.$broadcast(this.$authEvents.NOTAUTHENTICATED,{redirectUri:a,provider:r})),this.$q.reject(e)}}}])},801:e=>{"use strict";const t=function(){return function(e){const t=e.advanced_search,i=t.custom_search_rows.length,s=(i?t.custom_search_rows:["AND,","AND,","AND,"]).map((function(e,t){const[s,a]=(i?e:"AND,").split(",");return{key:null!=a?a:"",value:"",boolean:null!=s?s:"AND",queryModifier:"",minLength:0,id:t}}));return{enabled:t.enabled,searchButtonAboveForm:t.search_button_above_form,customSearchRows:s,customSearchFields:t.custom_search_fields.map((e=>({key:e.key,label:e.label||e.key}))),scopeBuilderSearchFields:[{label:"ISSN",key:"IssnAll"}],scopeBuilderSearchRows:[{key:"IssnAll",value:"",boolean:"AND",queryModifier:"",minLength:0,id:0}],maxCustomFields:20,maxSearchScopeFields:10,filters:{contentType:t.content_type_filter||[],discipline:t.discipline_filter||[],language:t.content_type_filter||[]},datePicker:{enabled:t.direct_date_entry},refinePane:{enabled:t.refine_in_options,refineList:t.refine_in_options_list,intstitutionName:e.info.institutionName},facets:{enabled:t.enable_facets,facetsList:t.facets,allFacets:[{name:"contentType",label:"Content Type"},{name:"discipline",label:"Discipline"},{name:"language",label:"Language"},{name:"library",label:"Library Location"},{name:"newRecords",label:"New Records"}]}}}};angular.module("summonApp.factories.configs").factory("advancedSearchConfig",t),e.exports=t},6935:()=>{"use strict";angular.module("summonApp.factories.configs").factory("autocompleteConfig",(()=>e=>{var t;return{libhash:e.info.libhash,enabled:e.widgets.enable_autocomplete,enhancedEnabled:e.widgets.enable_enhanced_autocomplete,dbRecsEnabled:e.site.db_recommender_enabled,url:e.autocomplete.url,numResults:e.autocomplete.num_results,topicSourcePriority:null===(t=e.info.topics)||void 0===t?void 0:t.topicSourcePriority,topicsDisplay:e.topics.topics_display,azSearchUrl:e.autocomplete.az_search_url}}))},552:()=>{"use strict";angular.module("summonApp.factories.configs").factory("availabilityConfig",(()=>function(e){var t,i;const{site:s}=e;return{libHash:e.info.libhash,showCallNums:s.show_callnums,showDeweys:s.show_deweys,showDetailCallNums:s.show_quicklook_callnums,showDetailDeweys:s.show_quicklook_deweys,showCallNumsOnFail:s.show_availability_callnums,showDatabaseInfo:void 0!==s.show_availability_database_info&&s.show_availability_database_info,showDeweysOnFail:s.show_availability_deweys,hasRTA:null===(i=null===(t=e.info)||void 0===t?void 0:t.dbs)||void 0===i?void 0:i.some((e=>e.availabilityLink))}}))},8145:()=>{"use strict";angular.module("summonApp.factories.configs").factory("chatConfig",(()=>function(e){const{widgets:t}=e;return{email:t.chat_widget_email,location:t.chat_widget_location,offlineImage:t.chat_widget_offline_image,onlineImage:t.chat_widget_online_image,widget:(()=>{switch(!1){case!0!==t.enable_whatsapp_chat:return{type:"whatsapp",number:t.whatsapp_number};case!0!==t.enable_libraryh3lp_chat:return{type:"libraryh3lp",queue:t.libraryh3lp_queue,skin:t.libraryh3lp_skin};case!0!==t.enable_springshare_chat:return{type:"springshare",iid:t.springshare_iid,domain:t.springshare_domain,key:t.springshare_key};case!0!==t.enable_springshare_v2_chat:return{type:"springshare_v2",elementId:t.springshare_v2_element_id,scriptSrc:t.springshare_v2_script_src};case!0!==t.enable_qwidget_chat:return{type:"questionpoint"};default:return{}}})()}}))},6402:()=>{"use strict";const e=e=>function(t){const i={name:"summon",label:e.translations.SEARCH_RESULTS_FORMAT,alternate:e.translations.SEARCH_RESULTS_FORMAT_ALT},s=[{name:"refworks",label:e.translations.REFWORKS},{name:"easybib",label:e.translations.EASYBIB},{name:"bibliographic_software",label:e.translations.ENDNOTE,alias:"endnote"},{name:"bibliographic_software",label:e.translations.ZOTERO,alias:"endnote"},{name:"bibtex",label:e.translations.BIBTEX},{name:"bibliographic_software",label:e.translations.CITAVI,alias:"citavi"}],{citation_formats:a}=t;t.citation_formats.citace_integration&&s.push({name:"bibliographic_software",label:e.translations.CITACE_COM,alias:"citace",url:"https://www.citacepro.com/ris?file="});const r=!a.enable_refworks&&a.enable_csl&&a.csl_formats.length?a.csl_formats:a.formats;return{citation_styles:[i].concat(r),export_styles:s,enable_sender_email_citation:t.search_results.enable_sender_email_citation,require_sender_email_citation:t.search_results.require_sender_email_citation}};e.$inject=["translationService"],angular.module("summonApp.factories.configs").factory("citationConfig",e)},4408:()=>{"use strict";angular.module("summonApp.factories.configs").factory("authenticationConfig",(()=>e=>{var t,i,s;return{enabled:e.authentication.enabled,onlyUseRedirect:e.authentication.only_use_redirect,sessionSeconds:60*e.authentication.session_minutes,keepAuthenticatedSessionAlive:e.authentication.session_keep_alive,logoutSummonOnly:e.authentication.logout_summon_only,sierraAuthProtocol:(null===(t=e.sierra)||void 0===t?void 0:t.authentication_protocol)||"SAML",samlAlias:e.saml.saml_idp_alias,useSamlForSearchApiAuth:e.saml.saml_is_primary_auth,samlForPrivateSite:e.site.private&&e.saml.saml_is_primary_auth,samlConfigurationExists:e.saml.saml_configuration_exists,casConfigurationExists:"cas"===e.authentication.service&&((null===(i=e.sierra)||void 0===i?void 0:i.rta_enabled)||!1),ltiConfigurationExists:!!(null===(s=e.lti)||void 0===s?void 0:s.lti_issuer_id_exists),oAuthProviders:["microsoft","google"],referUrlAuth:e.site.referred_url_authenticated,vpnAuthenticated:e.info.authenticated}})).factory("almaConfig",(()=>e=>e.alma)).factory("altmetricsConfig",(()=>e=>({altmetrics_search_results:e.widgets.altmetrics_search_results,altmetrics_quicklook:e.widgets.altmetrics_quicklook,altmetrics_detail_page:e.widgets.altmetrics_detail_page}))).factory("assetsConfig",(()=>function(e){const{site:t}=e;return{home:t.home,title:t.title,logoSmall:t.small_logo_url,logoLarge:t.large_logo_url}})).factory("bxRecommenderConfig",(()=>e=>({libHash:e.info.libhash,linkResolver:e.site.link_resolver}))).factory("customizerConfig",(()=>e=>({customizerUrl:e.site.customizer_url}))).factory("customSectionsConfig",(()=>e=>({showMoreEnabled:e.custom_sections.show_more_enabled,defaultSectionsDisplayed:e.custom_sections.default_sections_displayed,displayOrder:e.custom_sections.display_order}))).factory("documentConfig",(()=>function(e){const t=e.detail_page;return{enableGlanceability:e.search_results.enable_glanceability,enableDetailPage:t.enable_opac,enableAIPage:t.enable_a_i,videoDBIDs:e.info.video_dbids,useGetForIllReq:t.use_get_for_ill_requests}})).factory("envConfig",(()=>e=>({value:e.info.env}))).factory("feedbackConfig",(()=>e=>({emailRequired:e.site.client_email_required,enableFeedbackRoles:e.site.enable_feedback_roles}))).factory("googleConfig",(()=>function(e){return{useProviderStorage:!1!==e.google.use_provider_storage}})).factory("headConfig",(()=>e=>({title:e.site.title,client:e.info.name}))).factory("localizationConfig",(()=>e=>({languages:e.site.languages,defaultLanguage:e.site.default_language}))).factory("metricsConfig",(()=>function(e){const t=e.metrics,i=e.info;return{url:t.url,enabled:t.enabled,client:i.name,authenticated:i.authenticated,clicktrackFormTargetsSelf:t.clicktrack_form_targets_self}})).factory("microsoftConfig",(()=>function(e){return{useProviderStorage:!1!==e.microsoft.use_provider_storage}})).factory("quickLookConfig",(()=>e=>({syndeticsClient:e.info.syndeticsClient,enableSyndeticsPlus:e.widgets.enable_syndeticsplus,showCallNums:e.site.show_quicklook_callnums,showDeweys:e.site.show_quicklook_deweys,displayCitationCounts:null!=e.search_results?e.search_results.display_citation_counts_enabled:void 0,showPublicNotes:e.search_results.display_eresource_public_notes,showLocationNotes:e.search_results.display_eresource_location_notes,expandedItems:e.quick_look?e.quick_look.quick_look_items:[],displayLibraryNotes:e.quick_look.display_library_notes}))).factory("recaptchaConfig",(()=>e=>({siteKey:e.recaptcha.siteKey}))).factory("relatedItemsConfig",(()=>e=>({libHash:e.info.libhash,enabled:e.search_results.enable_related_items}))).factory("savedSearchAndItemsConfig",(()=>e=>({searchEnabled:e.advanced_search.saved_search,itemsEnabled:e.advanced_search.saved_items,providers:e.advanced_search.saved_search_types,savedItemsTimeout:e.site.saved_items_timeout}))).factory("searchConfig",(()=>e=>({enableNewSearchButton:e.search_results.enable_new_search_button,nonExactResultCount:e.search_results.non_exact_result_count,hasSearchScopes:e.search_scopes.filter((e=>!e.disabled)).length>0,searchScopes:e.search_scopes.filter((e=>!e.disabled))}))).factory("socialSharingServicesConfig",(()=>function(e){return e.site.enable_share_services?[{label:"Twitter",href:"https://twitter.com/intent/tweet/?text={TEXT}&url={URL}",fill:"#00ACEE;"},{label:"Facebook",href:"https://facebook.com/sharer/sharer.php?u={URL}",fill:"#3B5998;"},{label:"Pinterest",href:"https://pinterest.com/pin/create/button/?url={URL}&media={URL}&description={TEXT}",fill:"#C8232C;"},{label:"LinkedIn",href:"https://www.linkedin.com/shareArticle?mini=true&url={URL}&title={TITLE}&summary={TEXT}&source={URL}",fill:"#0E76A8;"},{label:"WhatsApp",href:"https://web.whatsapp.com/send?text={TEXT}%20{URL}",hrefMobile:"whatsapp://send?text={TEXT}%20{URL}",fill:"#4FCE5D;"},{label:"Telegram",href:"https://telegram.me/share/url?url={URL}&text={TEXT}",hrefMobile:"tg://msg?text={TEXT}",fill:"#0088CC;"},{label:"Evernote",href:"https://www.evernote.com/clip.action?url={URL}&title={TEXT}",fill:"#2EBE60;"}]:[]})).factory("springshareConfig",(()=>e=>e.springshare)).factory("topicsConfig",(()=>e=>{var t;return{displayTopics:null===(t=e.custom_sections.display_order)||void 0===t?void 0:t.includes("topic-summary"),topics:e.topics.topics_display}})).factory("widgetsConfig",(()=>e=>{var t;return{enableWidgetsLink:e.widgets.enable_widgets_link,enableAZSearchWidget:null===(t=e.custom_sections.display_order)||void 0===t?void 0:t.includes("az-search"),enableAZSearchWidgetAutoSearch:e.widgets.enable_az_database_widget_auto_search,azDatabaseProxyUrl:e.springshare.az_database_proxy_url,azBrowseUrl:e.springshare.az_browse_url,secondaryClient:e.info.secondaryClient,azDatabaseDefaultResults:e.springshare.az_database_default_results}})).factory("rtaAvailabilityConfig",(()=>e=>{var t,i,s,a,r,n,o,l;return{isSierraClient:(null===(t=e.sierra)||void 0===t?void 0:t.rta_enabled)||!1,rtaAvailableStatusMap:(null===(i=e.sierra)||void 0===i?void 0:i.rta_available_status_map)||[],rtaRequestableStatusMap:(null===(s=e.sierra)||void 0===s?void 0:s.rta_requestable_status_map)||[],rtaNotRequestableTypeMap:(null===(r=null===(a=e.sierra)||void 0===a?void 0:a.no_request_i_types)||void 0===r?void 0:r.split(","))||[],denyRequestIfNoDueDate:null===(n=e.sierra)||void 0===n?void 0:n.deny_request_if_no_due_date,dbs:e.info.dbs,client:e.info.name,showAbbreviatedRTA:e.search_results.enable_short_availability_status,showLocationsColumn:e.search_results.enable_locations_column,customAvailableCodes:null===(o=e.sierra)||void 0===o?void 0:o.custom_available_codes,customRequestableCodes:null===(l=e.sierra)||void 0===l?void 0:l.custom_requestable_codes}})).factory("libraryCardConfig",(()=>e=>{var t,i,s,a,r,n,o,l;return{enableSierra:(null===(t=e.sierra)||void 0===t?void 0:t.api_integration_enabled)||!1,displayLibraryCard:(null===(i=e.sierra)||void 0===i?void 0:i.my_library_card)&&(null===(s=e.sierra)||void 0===s?void 0:s.api_integration_enabled)||!1,editablePersonalDetails:(null===(a=e.sierra)||void 0===a?void 0:a.editable_personal_details)||[],displayReadingHistory:(null===(r=e.sierra)||void 0===r?void 0:r.reading_history_enabled)||!1,webpacPatronInfoUrl:null===(n=e.sierra)||void 0===n?void 0:n.webpac_patron_info_base_url,customLibraryName:null===(o=e.sierra)||void 0===o?void 0:o.custom_library_name,sections:null===(l=e.sierra)||void 0===l?void 0:l.library_card_sections}})).factory("refinePaneConfig",(()=>e=>({selectedFacetsViewDisabled:e.facets.selected_facets_view_disabled,independentFacetsScrollingEnabled:e.facets.independent_scrolling_enabled_on}))).factory("bulkExportConfig",(()=>e=>({libhash:e.info.libhash,enabled:e.search_results.allow_download_search_results}))).factory("researchAssistantConfig",(()=>e=>{var t,i;return{enabled:null===(t=e.research_assistant)||void 0===t?void 0:t.enable_research_assistant,citeLink:null===(i=e.research_assistant)||void 0===i?void 0:i.custom_citing_ai_content}}))},9669:()=>{"use strict";angular.module("summonApp.factories.configs").factory("detailPageConfig",(()=>function(e){var t;const i=e.detail_page;return{aiPrimaryAction:i.a_i_primary_action,enableIll:i.enable_ill,enablePrimaryButton:i.enable_primary_button,enableSecondaryButton:i.enable_secondary_button,enableReserveLinks:!(null===(t=e.sierra)||void 0===t?void 0:t.api_integration_enabled)&&i.enable_reserve_links,illBaseUrl:i.ill_base_url,messages:i.messages,reserveLinks:i.reserve_links,sections:i.sections,syndeticsClient:e.info.syndeticsClient,enableTransliterations:e.site.enable_transliterations}}))},8855:(e,t,i)=>{"use strict";var s=i(4125);const a=e=>function(t){let i=[];return null!=t.facets&&(i=s(t.facets.facets2||[]).map((i=>({name:i.Name,label:e.translate(i.Label||i.Name),type:"Range"===i.Type?"daterange":"DaysOld"===i.Type?"daysold":"list",collapsed:!(t.facets.expanded_facets||[]).includes(i.Name),moreLoaded:!1,sortMethod:"-count"})))),i};a.$inject=["translationService"],angular.module("summonApp.factories.configs").factory("facetsConfig",a)},7363:()=>{"use strict";angular.module("summonApp.factories.configs").factory("flowConfig",(()=>function(e){const t=e.flow,i=e.info;return{externalGroupId:`summonGroupId:${i.libhash}`,clientName:i.name.toUpperCase(),authUrl:t.auth_url,signupUrl:t.signup_url,logoutUrl:t.logout_url,clientId:t.client_id,libraryUrl:t.library_url,enabled:t.enabled}}))},4054:()=>{"use strict";const e=(e,t,i)=>function(e){const{site:s}=e,{alma:a}=e,{almaId:r}=e.info,n={};if(r){const e=i.__locale.substring(0,2).toUpperCase();for(var o of a.enabled_links){var l=o.name;if(a.hasOwnProperty(l)){var c=l.substring(0,l.lastIndexOf("_label")),h=a[c];if("collection_discovery"===c){var d=a.ill||a.suprima||a.citation_linker||a.journal_search;h=`https://${new URL(d).hostname}/discovery/collectionDiscovery?vid=${r}:Services&inst=${r}`}var u=h.match(/lang=(.{2})/),p=(null==u?void 0:u[1])||"EN",m=t[e];m&&(h=h.replace("lang="+p,"lang="+m)),n[c]={href:h,label:a[l]}}}}return n.custom={href:s.custom_link,label:s.custom_link_label,image:s.custom_link_image.replace("http:","")},n.feedback={href:s.feedback_href,label:"Feedback"},n.help={href:s.help,label:"Help"},n};e.$inject=["translationService","$almaLanguages","$window"],angular.module("summonApp.factories.configs").factory("linksConfig",e)},1265:()=>{"use strict";const e=e=>function(t){var i;let s,a;function r(i){const s=[];return i.forEach((i=>{const a=i.name||i;let r;"full_text_online"===a?r={label:e.translations.FULL_TEXT_ONLINE,facet:"IsFullText",value:"true"}:"limit_to_scholarly"===a?r={label:e.translations.SCHOLARLY_PEER_REVIEW,facet:"IsScholarly",value:"true"}:"limit_to_peer_reviewed"===a?r={label:e.translations.PEER_REVIEW,facet:"IsPeerReviewed",value:"true"}:"open_access"===a?r={label:e.translations.OPEN_ACCESS_FILTER,facet:"IsOpenAccess",value:"true"}:"items_in_catalog"===a?r={label:e.translations.LIBRARY_CATALOG,facet:"SourceType",value:"Library Catalog"}:"items_at_my_institution"===a&&t.info.institutionName?r={label:e.translations.ITEMS_AT_MY_INSTITUTION,facet:"Institution",value:t.info.institutionName}:"physical_books_only"===a?r={label:e.translations.PHYSICAL_BOOKS_LIBRARY_CATALOG,facet:"print.books.only",value:"true",disabled:!1}:"ebooks_only"===a&&(r={label:e.translations.EBOOK_FULL_TEXT_ONLINE,facet:"ebooks.only",value:"true",disabled:!1}),"add_results_beyond_catalog"===a&&(r={label:e.translations.ADD_RESULTS_BEYOND_COLLECTION,facet:"ho",value:"f",disabled:!1}),"include_matches_full_text_override"===a&&(t.toolbar.include_matches_full_text_default||(r={label:e.translations.INCLUDE_MATCHES_IN_FULL_TEXT,facet:"include.ft.matches",value:!1,applied:!1})),r&&s.push(r)})),s}return t.advanced_search.refine_in_options_list&&(a=r([...t.advanced_search.refine_in_options_list])),null!=(null===(i=t.toolbar)||void 0===i?void 0:i.refine_search_selection)&&(s=r(t.toolbar.refine_search_selection),t.toolbar.include_matches_full_text_default&&(t.toolbar.refine_search_selection.includes("include_matches_full_text_override")?s.push({label:e.translations.INCLUDE_MATCHES_IN_FULL_TEXT,facet:"include.ft.matches",value:!0,applied:!0}):s.push({label:e.translations.INCLUDE_MATCHES_IN_FULL_TEXT,facet:"include.ft.matches",value:!0,applied:!1,hide:!0,defaultInclusion:!0})),t.toolbar.include_matches_full_text_default||t.toolbar.refine_search_selection.includes("include_matches_full_text_override")||s.push({label:e.translations.INCLUDE_MATCHES_IN_FULL_TEXT,facet:"include.ft.matches",value:!1,applied:!1,hide:!0})),{enabled:null!=t.facets&&t.facets.quick_filters,filters:s,advancedFilters:a}};e.$inject=["translationService"],angular.module("summonApp.factories.configs").factory("quickFiltersConfig",e)},3389:()=>{"use strict";angular.module("summonApp.factories.configs").factory("resultsConfig",(()=>function(e){var t;const i={};return null!=e.maverick&&(i.librarianContactUrl=e.maverick.librarian_contact_url.trim()),null!=(null===(t=e.toolbar)||void 0===t?void 0:t.refine_search_selection)&&(i.addResultsBeyondCatalog=e.toolbar.refine_search_selection.includes("add_results_beyond_catalog"),i.includeMatchesFulltextOverride=e.toolbar.refine_search_selection.includes("include_matches_full_text_override")),null!=e.advanced_search&&(i.enableJournalTitleLink=e.advanced_search.enable_journal_title_link),null!=e.site&&(i.enableTransliterations=e.site.enable_transliterations,i.showRss=e.site.enable_rss_icon,i.showDBRecommenderResults=e.site.db_recommender_enabled,i.enableQuerySuggestions=e.site.enable_query_suggestions,i.pageSize=e.site.default_search_result_count,i.showRtaForDbid=e.site.rta_enabled_for_dbid,i.pagesToShow=10===i.pageSize?5:2),null!=e.search_results&&(i.displayCitationCounts=e.search_results.display_citation_counts_enabled,i.displayResultCounts=e.search_results.display_result_counts_enabled,i.displayPermalink=e.search_results.display_permalink_enabled,i.enableShortenPermalink=e.search_results.enable_shorten_permalink,i.displayOpenAccessIndicator=e.search_results.open_access,i.addOpenAccessLink=e.search_results.show_open_access_link,i.displayPeerReviewIndicator=e.search_results.peer_review,i.displayOnlineIndicator=e.search_results.show_online_access_indicator,i.displayCitationTrail=e.search_results.display_citation_trail,i.displayRelatedItems=e.search_results.enable_related_items,i.displayPdfQuickLinks=e.search_results.display_pdf_quicklinks,i.displayHtmlQuickLinks=e.search_results.display_html_quicklinks,i.enableAdditionalFullTextLinks=e.search_results.enable_additional_full_text_links,i.maximumFullTextLinks=e.search_results.maximum_full_text_links,i.displayEditor=e.search_results.display_editor,i.proxyDoiLinks=e.search_results.proxy_doi_links,i.displayLinkResolver=e.search_results.display_link_resolver,i.displayJournalCoverageRanges=e.search_results.display_journal_coverage_ranges,i.isAlmaClient=!!e.info.almaId,i.almaId=e.info.almaId),i}))},8372:()=>{"use strict";angular.module("summonApp.factories.configs").factory("toolbarConfig",(()=>function(e){var t,i,s,a,r,n,o;const l=e.toolbar;return{excludeNews:null===(t=l.refine_search_selection)||void 0===t?void 0:t.includes("exclude_newspaper_articles"),fullTextOnline:null===(i=l.refine_search_selection)||void 0===i?void 0:i.includes("full_text_online"),institutionCatalog:null===(s=l.refine_search_selection)||void 0===s?void 0:s.includes("items_at_my_institution"),libraryCatalog:null===(a=l.refine_search_selection)||void 0===a?void 0:a.includes("items_in_catalog"),limitToPeerReviewed:null===(r=l.refine_search_selection)||void 0===r?void 0:r.includes("limit_to_peer_reviewed"),limitToScholarly:null===(n=l.refine_search_selection)||void 0===n?void 0:n.includes("limit_to_scholarly"),includeMatchesFullTextOverride:null===(o=l.refine_search_selection)||void 0===o?void 0:o.includes("include_matches_full_text_override"),includeMatchesFullTextDefault:l.include_matches_full_text_default}}))},6409:()=>{"use strict";angular.module("summonApp.factories.configs").factory("vpnBannerConfig",(()=>function(e){const{site:t}=e,{proxy:i}=e;return{authenticated:e.info.authenticated,enabled:t.enable_vpn_banner,text:t.vpn_banner,bannerUrl:t.vpn_banner_url,proxy:{url:i.url,type:i.vendor}}}))},5833:()=>{"use strict";var e=function(t){return e=class{constructor(e){this.scrolled=this.scrolled.bind(this),this.scope=e}scrolled(e){if(!(!this.scope.view||this.scope.layout.modal||this.scope.loadingNewSearchIndicator||this.scope.loadingSearchIndicator||t.detailScope.allLoaded))return angular.element("#courseReserveDetail").is(":visible")&&e?t.getDetailDocs():void 0}}};e.$inject=["courseReserveService"],angular.module("summonApp.factories.scrolls").factory("courseReservesDetailScroll",e)},4477:(e,t,i)=>{"use strict";var s=i(4125);const a=function(e,t,i){return Array.isArray(e)?angular.isUndefined(i)?e.join(t):s.map(e,(e=>e[i])).join(t):e},r=function(e){return null==e&&(e=""),e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substring(1)))},n=RegExp("%{.*?}");var o=function(e,t={}){let i;if(angular.isArray(e)){for(let i=0;i<e.length;i++){var s=e[i];e[i]=o(s,t)}i=e}else{const s=window.__translations||{};try{i=s[e]||e}catch(t){i=e}n.test(i)&&(i=function(e,t){for(var i in t){var s=t[i];e=e.replace(new RegExp(`%{${i}}`,"g"),s)}return e}(i,t))}return i};const l=(e,t)=>{var i;return null!==(i=e.slice(t))&&void 0!==i?i:[]},c=e=>angular.isArray(e),h=e=>e&&e.length>0;angular.module("summonApp.filters").filter("summonEscape",["utilitiesService",function(e){return this.utilities=e,e=>this.utilities.summonEscape(e)}]).filter("titleCase",(()=>r)).filter("formatClass",["$formats",e=>function(t,i=!1){if(null==t)return"";const s=t.toLowerCase().replace(/\s/g,"_");return`format-${i?`${i}-`:""}${e[s]||s}`}]).filter("translate",(()=>o)).filter("localeSort",["$filter","localizationService",function(e,t){this.$filter=e;const i=this.$filter("translate"),s=t.getStandardLocale(),a=function(e,t){const i=t.split(".");let s=e;for(var a of i){if(null==s[a])return;s=s[a]}return s};return function(e,...t){if(t.length<1)throw new Error("Object paths missing");return e.sort(((e,r)=>function(e,t,r){let n="",o="";for(var l of r)n+=i(a(e,l)),o+=i(a(t,l));return n.localeCompare(o,s)}(e,r,t)))}}]).filter("join",(()=>a)).filter("startAt",(()=>l)).filter("summonISODate",["$filter",function(e){return this.$filter=e,e=>{if(!e)return;const t=this.$filter("date"),i=new Date(e);return i?t(i,"mediumDate"):e}}]).filter("summonISODateWithHour",["$filter",function(e){return this.$filter=e,e=>{if(!e)return;const t=this.$filter("date"),i=new Date(e);return i?t(i,"MMM dd, yyyy hh:mm a"):e}}]).filter("summonDate",["$filter",function(e){return this.$filter=e,e=>{let t,i,s;if(!e)return;const a=this.$filter("date"),r=new RegExp("^(\\d{2}/){0,1}(\\d{2}/){0,1}(\\d{4})$"),n=e.match(r);if(n){const e=n.slice(1,4);e[0]&&(i=e[0].replace(/\//,"")),e[1]&&(t=e[1].replace(/\//,"")),s=e[2]}return i&&t&&s?a(new Date(s,i-1,t),"mediumDate"):e}}]).filter("summonTimestampToMMyyyyDate",["$filter",function(e){return this.$filter=e,e=>{if(!e)return;const t=new RegExp("^(0|[1-9][0-9]*)$");if(!e.match(t)||8!==e.length)return e;const i=e.substring(0,4),s=e.substring(4,6),a=e.substring(6,8),r=new Date(i,s-1,a),n=this.$filter("date");return r?n(r,"MM/yyyy"):e}}]).filter("range",["$filter","translationService",function(e,t){return this.$filter=e,this.i18n=t,e=>{if(!(null==e?void 0:e.end))return;let t="";const i=this.$filter("summonTimestampToMMyyyyDate");return t=e.start?i(`${e.start}`):this.i18n.translations.COVERAGE_ZERO_START,99991231===e.end?this.i18n.translate(this.i18n.translations.COVERAGE_START_TO_PRESENT,{start:t}):`${t} - ${i(`${e.end}`)}`}}]).filter("hasDetailPage",["documentService",function(e){return this.docService=e,e=>{if(e)return this.docService.displayDetailPage(e)||this.docService.displayAIPage(e)}}]).filter("isArray",(()=>c)).filter("hasValue",(()=>h)).filter("formatNumber",["$window",e=>function(t,i){return null==i&&(i={style:"decimal"}),new Intl.NumberFormat(e.__summonLocale,i).format(t)}]).filter("textMapping",["$filterTextMappings",e=>(t,i)=>e[i][t]||t]).filter("highlight",["$sce",e=>function(t,i){return i&&(t=t.replace(new RegExp("("+i+")","gi"),'<span class="highlighted">$1</span>')),e.trustAsHtml(t)}])},7138:(e,t,i)=>{"use strict";const s=e=>{e.keys().forEach(e)};Promise.resolve().then(i.t.bind(i,4796,23)),Promise.resolve().then(i.t.bind(i,7025,23)),i(3945),i(669),i(4477),i(3794),s(i(5782)),s(i(6642)),s(i(4635)),s(i(6897)),s(i(1701)),i(1970)},1970:()=>{"use strict";const e=angular.module("summonApp",["ngRoute","ngAnimate","ngSanitize","ngCookies","summonApp.services","summonApp.factories","summonApp.controllers","summonApp.directives","summonApp.filters","summonApp.constants","summonApp.values","summonApp.urlRewriter","summonApp.animations","summonApp.syndetics","summonApp.custom","summonApp.resultsFeedPlugins","ui.bootstrap","colorpicker.module","jsonFormatter","ngToast"]);class t{constructor(e,t,i,s,a,r,n,o,l){s.resourceUrlWhitelist(["self",/htt(p|ps):\/\/.*(-|\.)summon(-|\.)serialssolutions(-|\.)com((\..*){0,}\.(oclc\.org|edu)){0,1}\/.*/,/https:\/\/(\d+-){0,1}refworks(-|\.)proquest(-|\.)com((\..*){0,}\.(oclc\.org|edu)){0,1}\/.*/]),a.setTriggers({customEvent:"customEvent"}),l.configure({animation:"fade",horizontalPosition:"center",verticalPosition:"top",dismissButton:!0,timeout:5e3}),i.disableAutoScrolling(),t.html5Mode(!1),r.commentDirectivesEnabled(!1);const c=window.__configData&&window.__configData.info&&window.__configData.info.env?window.__configData.info.env:"unknown";document.documentElement.style.setProperty("--scrollbar-width",window.innerWidth-document.documentElement.offsetWidth+"px"),document.documentElement.style.setProperty("--advanced-selected-facets-height","0px"),o.debugEnabled("development"===c||window.location.hash&&window.location.hash.indexOf("debuglog=true")>-1),window.__configData&&window.__configData.authentication&&window.__configData.authentication.enabled&&n.interceptors.push("authInterceptor");const h="/advanced"===window.document.location.pathname&&["#!","#!/"].includes(window.document.location.hash);e.when("/",{redirectTo:h?"/search":"/",action:h?"advanced":null}).when("/advanced",{redirectTo:"/",action:"advanced"}).when("/:l/advanced/?",{redirectTo:"/",action:"advanced"}).when("/widgets",{}).when("/:l/widgets/?",{redirectTo:"/widgets"}).when("/diagnostics",{templateUrl:"/assets/diagnostics/index.html"}).when("/:l/diagnostics/?",{redirectTo:"/diagnostics"}).when("/course_reserves",{action:"home"}).when("/:l/course_reserves",{redirectTo:"/course_reserves"}).when("/course_reserves/:course_id",{action:"detail"}).when("/:l/course_reserves/:course_id/?",{redirectTo:"/course_reserves/:course_id"}).when("/scope_builder/init/search",{redirectTo:"/scope_builder/search",action:"advanced"}).when("/scope_builder/search",{}).when("/:l/scope_builder/search/?",{redirectTo:"/scope_builder/search"}).when("/search",{}).when("/:l/search/?",{redirectTo:"/search"}).when("/search/debug",{templateUrl:"/assets/apiDebugger.html",controller:"DebugCtrl"}).when("/search/document",{}).when("/:l/search/document/?",{redirectTo:"/search/document"}).when("/search/document/debug",{templateUrl:"/assets/apiDebugger.html",controller:"DebugCtrl"}).when("/search/results",{redirectTo:"/search"}).when("/:l/search/results",{redirectTo:"/search"}).when("/document/show",{redirectTo:"/search/document"}).when("/:l/document/show",{redirectTo:"/search/document"}).when("/:l/library_card",{redirectTo:"/library_card"}).when("/library_card",{auth:!0,feature:"sierra"}).when("/:l/research_assistant",{redirectTo:"/research_assistant"}).when("/research_assistant",{auth:!0,feature:"research_assistant"}).otherwise({redirectTo:"/"})}}t.$inject=["$routeProvider","$locationProvider","$anchorScrollProvider","$sceDelegateProvider","$uibTooltipProvider","$compileProvider","$httpProvider","$logProvider","ngToastProvider"],e.config(t),e.run(["$templateCache","authenticationService",function(e,t){var i,s;return(null===(s=null===(i=window.__configData)||void 0===i?void 0:i.authentication)||void 0===s?void 0:s.enabled)&&t.init(),(()=>{const t=[];for(var i in window.__templates){var s=window.__templates[i];t.push(e.put(i,s))}return t})()}])},3945:()=>{"use strict";angular.module("summonApp.factories",[]),angular.module("summonApp.factories.configs",[]),angular.module("summonApp.factories.scrolls",[]),angular.module("summonApp.services",["summonApp.factories.configs","summonApp.factories.scrolls"]),angular.module("summonApp.controllers",[]),angular.module("summonApp.directives",[]),angular.module("summonApp.constants",[]),angular.module("summonApp.values",[]),angular.module("summonApp.resultsFeedPlugins",[]),angular.module("summonApp.animations",[]),angular.module("summonApp.filters",[]),angular.module("summonApp.urlRewriter",[]),angular.module("summonApp.syndetics",[]),angular.module("summonApp.custom",[])},5082:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.name=e,this.label=t,this.enabled=i,this.applied=0,this.negated=0,this.selected=0,this.sorted="value",this.values=[]}}class r{constructor(e,t,i){this.facetType=e,this.value=t,this.translation=i,this.applied=!1,this.negated=!1,this.active=!1,this.disabled=!1,this.days=null,this.orderBy="translation"}}class n{constructor(e,t,i,n,o,l,c,h,d,u,p,m,g,v,S,f,b,y,_){var E,A;this.markLoadedFacetGroupAsLoaded=this.markLoadedFacetGroupAsLoaded.bind(this),this.getFacetChecklist=this.getFacetChecklist.bind(this),this.getContentTypes=this.getContentTypes.bind(this),this.getDisciplines=this.getDisciplines.bind(this),this.getLanguages=this.getLanguages.bind(this),this.getLibraryLocations=this.getLibraryLocations.bind(this),this.sortFacetType=this.sortFacetType.bind(this),this.getOrAddCustomSearchField=this.getOrAddCustomSearchField.bind(this),this.addCustomField=this.addCustomField.bind(this),this.removeCustomField=this.removeCustomField.bind(this),this.removeFacets=this.removeFacets.bind(this),this.clear=this.clear.bind(this),this.buildSearchFieldsQuery=this.buildSearchFieldsQuery.bind(this),this.removeFacetFromSelectedSummary=this.removeFacetFromSelectedSummary.bind(this),this.findFacet=this.findFacet.bind(this),this.findAndUpdateFacetAppliedOrNegated=this.findAndUpdateFacetAppliedOrNegated.bind(this),this.checkAnyType=this.checkAnyType.bind(this),this.selectionsOnChange=this.selectionsOnChange.bind(this),this.excludeOtherNewRecords=this.excludeOtherNewRecords.bind(this),this.handlePhysicalAndEbook=this.handlePhysicalAndEbook.bind(this),this.updateFacetsInfo=this.updateFacetsInfo.bind(this),this.getSelectedAsString=this.getSelectedAsString.bind(this),this.getFacetLabel=this.getFacetLabel.bind(this),this.includeMatchesInFullTextOverrideIsAlwaysDisabled=this.includeMatchesInFullTextOverrideIsAlwaysDisabled.bind(this),this.addFacetToSummaryIfAppliedOrNegated=this.addFacetToSummaryIfAppliedOrNegated.bind(this),this.syncWithState=this.syncWithState.bind(this),this.belongsToAnEnabledFacet=this.belongsToAnEnabledFacet.bind(this),this.setRefinePaneFacets=this.setRefinePaneFacets.bind(this),this.convertConfigListToRefinePane=this.convertConfigListToRefinePane.bind(this),this.parseTermForQueryModifier=this.parseTermForQueryModifier.bind(this),this.determineQueryModifier=this.determineQueryModifier.bind(this),this.determineMinLength=this.determineMinLength.bind(this),this.isBalancedWhere=this.isBalancedWhere.bind(this),this.isBalanced=this.isBalanced.bind(this),this.cleanParenthesesBalanced=this.cleanParenthesesBalanced.bind(this),this.countBalanced=this.countBalanced.bind(this),this.splitQueryOnBoolean=this.splitQueryOnBoolean.bind(this),this.unescapeParentheses=this.unescapeParentheses.bind(this),this.parseQueryToAdvancedQueryValues=this.parseQueryToAdvancedQueryValues.bind(this),this.parseQueryToAdvancedQuery=this.parseQueryToAdvancedQuery.bind(this),this.addNewRecordsFacet=this.addNewRecordsFacet.bind(this),this.setNewRecordsFacets=this.setNewRecordsFacets.bind(this),this.addOrRemoveDateFromSelectedSummary=this.addOrRemoveDateFromSelectedSummary.bind(this),this.createDateRangeValue=this.createDateRangeValue.bind(this),this.setDateSelection=this.setDateSelection.bind(this),this.toggleOrExcludeValue=this.toggleOrExcludeValue.bind(this),this.submit=this.submit.bind(this),this.facetHasItsOwnParam=this.facetHasItsOwnParam.bind(this),this.hasMaxCustomRows=this.hasMaxCustomRows.bind(this),this.isAbsentFacetApplied=this.isAbsentFacetApplied.bind(this),this.isFacetApplied=this.isFacetApplied.bind(this),this.isFacetNegated=this.isFacetNegated.bind(this),this.refinePaneFacetApplied=this.refinePaneFacetApplied.bind(this),this.updateSearchScope=this.updateSearchScope.bind(this),this.$rootScope=e,this.appState=t,this.utilities=i,this.$filter=n,this.events=o,this.searchScopeService=y,this.datepickerService=l,this.api=c,this.alerts=h,this.i18n=d,this.$booleanValues=m,this.$identifierFields=g,this.$minLengthForBeginsWithQueries=v,this.$broadcastTypes=f,this.$facetTypes=b,this.viewState=_,this.defaultScope={searchFields:p.data.advancedSearch.customSearchRows,searchFieldsConfig:p.data.advancedSearch.customSearchFields,scopeBuilderSearchFields:p.data.advancedSearch.scopeBuilderSearchRows,scopeBuilderSearchFieldsConfig:p.data.advancedSearch.scopeBuilderSearchFields,searchFieldsFromSecField:p.data.advancedSearch.customSearchRows.slice(1),config:p.data.advancedSearch,facetsConfig:p.data.facets,hasSearchScopes:p.data.search.hasSearchScopes,selectedSummary:[],includeFullTextMatchesDefault:p.data.toolbar.includeMatchesFullTextDefault,includeFullTextMatchesOverrideNonAdvanced:p.data.toolbar.includeMatchesFullTextOverride,hasSearched:!1,datePresets:this.datepickerService.datepicker.datePresets,datePresetLabels:this.datepickerService.datepicker.datePresetLabels,dateSelection:this.datepickerService.datepicker.search,moreSearchOptionsShown:!0,searchScope:(null===(E=this.searchScopeService.currentSearchScope)||void 0===E?void 0:E.label)||"",searchScopeTerms:(null===(A=this.appState.searchScopeParams)||void 0===A?void 0:A.q)||""},this.scope=angular.copy(this.defaultScope),this.scope.advFacetsEnabled=p.data.advancedSearch.facets.enabled,this.scope.advFacets=p.data.advancedSearch.facets,this.scope.facets={refinePane:new a(this.$facetTypes.REFINE_PANE,this.i18n.translations.REFINE_SEARCH,this.scope.config.refinePane.enabled)},this.$rootScope.$on("apiSuccess",this.markLoadedFacetGroupAsLoaded),this.$rootScope.$on("apiCancel",this.markLoadedFacetGroupAsLoaded),this.$rootScope.$on("apiError",this.markLoadedFacetGroupAsLoaded),this.scope.advFacetsEnabled&&s.map(this.scope.config.facets.facetsList,(e=>this.scope.facets[e.name]=new a(e.name,this.i18n.translate(e.label),!0))),s.map(this.scope.config.facets.allFacets,(e=>this.scope.facets[e.name]=new a(e.name,this.i18n.translate(e.label),!0))),this.scope.facets.refinePane.config={add_results_beyond_catalog:new r(this.$facetTypes.REFINE_PANE,"add_results_beyond_catalog",this.i18n.translations.ADD_RESULTS_BEYOND_COLLECTION),full_text_online:new r(this.$facetTypes.REFINE_PANE,"full_text_online",this.i18n.translations.FULL_TEXT_ONLINE),include_matches_full_text_override:new r(this.$facetTypes.REFINE_PANE,"include_matches_full_text_override",this.i18n.translations.INCLUDE_MATCHES_IN_FULL_TEXT),limit_to_scholarly:new r(this.$facetTypes.REFINE_PANE,"limit_to_scholarly",this.i18n.translations.SCHOLARLY_PEER_REVIEW),items_in_catalog:new r(this.$facetTypes.REFINE_PANE,"items_in_catalog",this.i18n.translations.LIBRARY_CATALOG),items_at_my_institution:new r(this.$facetTypes.REFINE_PANE,"items_at_my_institution",this.i18n.translations.ITEMS_AT_MY_INSTITUTION),open_access:new r(this.$facetTypes.REFINE_PANE,"open_access",this.i18n.translations.OPEN_ACCESS_FILTER),limit_to_peer_reviewed:new r(this.$facetTypes.REFINE_PANE,"limit_to_peer_reviewed",this.i18n.translations.PEER_REVIEW),physical_books_only:new r(this.$facetTypes.REFINE_PANE,"physical_books_only",this.i18n.translations.PHYSICAL_BOOKS_LIBRARY_CATALOG),ebooks_only:new r(this.$facetTypes.REFINE_PANE,"ebooks_only",this.i18n.translations.EBOOK_FULL_TEXT_ONLINE)},this.scope.newRecordsDaysFacet={7:7,30:30,90:90},this.localeSort=this.$filter("localeSort"),S.setHooks(this,"AdvancedSearchService",["clearDate","clearSearchScope","reflectDate"]),u.on("update",(e=>{if(null!=e.facet&&e.facet_values){const t=Object.values(e.facet_values)[0];if(!t.counts||0===t.counts.length)return;s.map(this.scope.facets,(t=>{const i=this.scope.config.facets.facetsList.filter((e=>e.name===t.name));if(!t.values.length)return t.values=this.getFacetChecklist(t.name,e,null==i?void 0:i[0])}));const i=!1;return this.syncWithState(i)}}))}markLoadedFacetGroupAsLoaded(e,t){const i=this;return angular.forEach(t.types,(function(e){let t;if(e===i.$broadcastTypes.contentTypes&&(t=i.$facetTypes.CONTENT_TYPE),e===i.$broadcastTypes.disciplines&&(t=i.$facetTypes.DISCIPLINE),e===i.$broadcastTypes.languages&&(t=i.$facetTypes.LANGUAGE),e===i.$broadcastTypes.library&&(t=i.$facetTypes.LIBRARY),i.scope.facets[t])return i.scope.facets[t].loaded=!0}))}get(e,t){return this.scope.facets[t][e]}getFacetChecklist(e,t,i){if(t.facet.toLowerCase()===e.toLowerCase()){const e=i.length?s.filter(Object.values(t.facet_values)[0].counts,(e=>s.contains(i,e.value))):Object.values(t.facet_values)[0].counts,a=this.localeSort(s.map(e,(e=>{const t=this.i18n.translate(e.value);return{translation:t,value:e.value,applied:!1,negated:!1,order:i.length?s.indexOf(i,e.value):t}})),"order");return a.unshift({translation:this.i18n.translations.ANY_TYPE,value:"",applied:!0,negated:!1}),a}return[]}getContentTypes(){if(!this.scope.facets.contentType.values.length)return this.alerts.resetAlert("contentTypesError"),this.api.contentTypes()}getDisciplines(){if(!this.scope.facets.discipline.values.length)return this.alerts.resetAlert("disciplinesError"),this.api.disciplines()}getLanguages(){if(!this.scope.facets.language.values.length)return this.alerts.resetAlert("languagesError"),this.api.languages()}getLibraryLocations(){if(!this.scope.facets.library.values.length)return this.alerts.resetAlert("libraryError"),this.api.libraryLocations()}sortFacetType(e,t){if(e&&!(this.scope.facets[e].values.length<=0))return"value"===this.scope.facets[e].sorted&&"value"===t?t="-value":"-value"===this.scope.facets[e].sorted&&"-value"===t&&(t="value"),this.scope.facets[e].values=(()=>{switch(t){case"-count":return this.$filter("orderBy")(this.scope.facets[e].values,"-count");case"value":return this.$filter("localeSort")(this.scope.facets[e].values,"value");case"-value":return this.$filter("localeSort")(this.scope.facets[e].values,"value"),this.scope.facets[e].values.reverse();case"selected":return this.$filter("orderBy")(this.scope.facets[e].values,["-negated","-applied"]);case"negated":return this.$filter("orderBy")(this.scope.facets[e].values,"-negated");case"applied":return this.$filter("orderBy")(this.scope.facets[e].values,"-applied");default:return this.scope.facets[e].values}})(),this.scope.facets[e].sorted=t}shouldDisplayModifiers(e){return["TitleCombined","PublicationTitle","Notes"].includes(e)||this.$identifierFields.includes(e)}getOrAddCustomSearchField(e=-1){const t=this.viewState.scopeBuilderMode?this.scope.scopeBuilderSearchFields:this.scope.searchFields;if(-1===e){const i=s.find(t,(e=>""===e.value));if(null==i)return this.viewState.scopeBuilderMode?this.addCustomField(this.scope.scopeBuilderSearchFields):this.addCustomField(this.scope.searchFields);e=i.id}return t.length>e?t[e]:this.viewState.scopeBuilderMode?this.addCustomField(this.scope.scopeBuilderSearchFields,e):this.addCustomField(this.scope.searchFields,e)}addCustomField(e,t=-1,i=!1){if(!this.hasMaxCustomRows(i)){const a=s.max(e,(e=>e.id)).id;let r={};-1===t?t=a:r=e[t];const n=Object.assign(Object.assign({},r),{key:i?"IssnAll":"",value:"",boolean:i?"OR":"AND",queryModifier:"",minLength:0,id:1+a});return e.splice(t+1,0,n),n}}removeCustomField(e,t){return e.splice(t,1)}removeFacets(e){const t=this.utilities.lowerCaseFirstChar(e.facetGroup);if("daterange"===t){const e=!1;this.fire("clearDate",e)}else this.scope.facets[t]&&this.selectionsOnChange(e,t,!1,!1);return this.removeFacetFromSelectedSummary(e),!1}clearSearchScopeFromAdvanced(){this.fire("clearDate",!0),this.fire("clearSearchScope")}clear(e=!0){for(var t in e&&(this.fire("clearDate",e),this.clearSearchScopeFromAdvanced()),this.scope.facets){var i=this.scope.facets[t];for(var s of i.values)s.applied=""===s.value,s.negated=!1,s.fromSearchScope=!1;t!==this.$facetTypes.REFINE_PANE?(i.sorted="value",this.updateFacetsInfo(t),this.$filter("localeSort")(this.scope.facets[t].values,"value")):this.updateFacetsInfo(t)}this.defaultScope.selectedSummary=[],this.defaultScope.facets=this.scope.facets,Object.keys(this.defaultScope).map((e=>this.scope[e]=angular.copy(this.defaultScope[e])))}buildSearchFieldsQuery(){const e=s.reject(this.scope.searchFields.concat(this.scope.scopeBuilderSearchFields),(e=>!e||!e.value));let t=!1;const i=e.length-1;return s.map(e,(function(s,a){let r;s.value=s.value.replace(/(?!\\)([\(\)])/g,"\\$1"),"AnyWords"===s.queryModifier?s.query=s.value.split(/\sOR\s|\s+/gi).join(" OR "):"ExactMatch"===s.queryModifier?s.query='"'+s.value.replace(/^"+(.*?)"+$/,"$1").replace(/(?![^\\])?"/g,'\\"')+'"':"BeginsWith"===s.queryModifier?s.query='"'+s.value.replace(/^"+(.*?)"+$/,"$1").replace(/(?![^\\])?"/g,'\\"')+'*"':s.query=s.value;let n=s.key?`(${s.key}:(${s.query}))`:`(${s.query})`;return a<i&&(r=e[a+1].boolean),"OR"===r&&a!==i||!t?"OR"===r&&a<i&&!t&&(n=`(${n}`,t=!0):(n=`${n})`,t=!1),a<i&&(n+=` ${r}`),n})).join(" ")}removeFacetFromSelectedSummary(e){var t,i;const a=!!(null===(t=this.scope.searchScopeParams)||void 0===t?void 0:t.rf.find((e=>e.includes("PublicationDate"))))&&e.applied,r=!!(null===(i=this.scope.selectedSummary.find((t=>t.value===e.value)))||void 0===i?void 0:i.fromSearchScope);if(!this.scope.searchScope||!a&&!r)return this.scope.selectedSummary=s.reject(this.scope.selectedSummary,(t=>t.value===e.value));this.searchScopeService.clearScopeAsSideEffect(this.scope.newSearchScope||this.scope.searchScope)}findFacet(e,t){let i=s.find(this.scope.facets[t].values,(t=>t.value===e.value));return i||t!==this.$facetTypes.REFINE_PANE||(i=s.find(this.scope.facets.refinePane.config,(t=>t.value===e.value))),i}findAndUpdateFacetAppliedOrNegated(e,t,i,s,a,r){let n;if(this.scope.facets[t]){if(!this.scope.facets[t].enabled)return(i||s)&&(n=this.findFacet(e,t),n.applied=i||a,n.negated=s||r,n.fromSearchScope=a||r),n;if(0!==this.scope.facets[t].values.length){if(n=this.findFacet(e,t),!n)throw new Error(`Could not find ${JSON.stringify(e,null,2)} for ${t}`);return n.facetGroup=t,n.applied=i||a,n.fromSearchScope=a||r,!0===s&&(n.negated=!0,n.applied=!1),t!==this.$facetTypes.REFINE_PANE&&this.checkAnyType(t,!1),this.updateFacetsInfo(t),n}console.error("Type does not have values: ",t)}else console.error("Type does not exist: ",t)}checkAnyType(e,t=!1){const i=s.find(this.scope.facets[e].values,(e=>""===e.value));if(t)s.each(this.scope.facets[e].values,(e=>{e.applied=!1,e.negated=!1,this.removeFacetFromSelectedSummary(e)})),i&&(i.applied=!0);else if(i)return i.applied=!1}selectionsOnChange(e,t,i,a,r){var n;if(e.disabled)return;"checkmark"===(null===(n=null==r?void 0:r.target)||void 0===n?void 0:n.className)&&r.preventDefault();const o=s.find(this.scope.facets[t].values,(t=>t.value===e.value));if(o){if(!this.scope.searchScope||!o.fromSearchScope){if(null===i||!1===i?o.applied=!1:!0===i&&(o.applied=!o.applied,o.facetType===this.$facetTypes.NEW_RECORDS&&this.excludeOtherNewRecords(o)),null===a||!1===a?o.negated=!1:!0===a&&(o.negated=!o.negated,o.applied=!1),""!==e.value&&(o.negated||o.applied)){const e=t===this.$facetTypes.REFINE_PANE?o.value:this.utilities.titleCase(t),i=t===this.$facetTypes.REFINE_PANE?"f":o.value;this.addFacetToSummaryIfAppliedOrNegated(o,{name:e,value:i})}else this.removeFacetFromSelectedSummary(o);return this.checkAnyType(t,""===e.value),this.updateFacetsInfo(t)||t===this.$facetTypes.REFINE_PANE?t===this.$facetTypes.REFINE_PANE&&this.handlePhysicalAndEbook():(this.checkAnyType(t,!0),this.updateFacetsInfo(t)),o.facetGroup=t,!0}this.searchScopeService.clearScopeAsSideEffect(this.scope.newSearchScope||this.scope.searchScope)}else console.error("facet is undefined: ",t,e)}excludeOtherNewRecords(e){this.scope.facets.newRecords.values.filter((t=>t!==e)).map((e=>(e.applied=!1,this.removeFacetFromSelectedSummary(e))))}handlePhysicalAndEbook(){const e=s.find(this.scope.facets.refinePane.values,(e=>"physical_books_only"===e.value)),t=s.find(this.scope.facets.refinePane.values,(e=>"ebooks_only"===e.value));if(e&&t)return e&&e.applied&&t&&t.applied?(t.applied=!1,t.disabled=!0,delete this.appState.params[this.eBooksFacet],this.scope.searchScopeParams[this.eBooksFacet]&&this.searchScopeService.clearScopeAsSideEffect(this.scope.newSearchScope||this.scope.searchScope)):t&&t.applied&&e?(e.disabled=!0,t.disabled=!1,e.applied=!1,delete this.appState.params[this.printBooksFacet],this.scope.searchScopeParams[this.printBooksFacet]&&this.searchScopeService.clearScopeAsSideEffect(this.scope.newSearchScope||this.scope.searchScope)):e&&e.applied&&t?(t.disabled=!0,e.disabled=!1,t.applied=!1):(t.disabled=!1,e.disabled=!1),e&&t?(e.tooltip=this.i18n.translate(this.i18n.translations.QUICKFILTER_REMOVE_OTHER_X,{facet:this.i18n.translations.EBOOK_FULL_TEXT_ONLINE}),t.tooltip=this.i18n.translate(this.i18n.translations.QUICKFILTER_REMOVE_OTHER_X,{facet:this.i18n.translations.PHYSICAL_BOOKS_LIBRARY_CATALOG})):void 0}updateFacetsInfo(e){const t=s.filter(this.scope.facets[e].values,(e=>e.applied)),i=s.filter(this.scope.facets[e].values,(e=>e.negated)),a=s.find(this.scope.facets[e].values,(e=>""===e.value));return this.scope.facets[e].applied=a&&a.applied?t.length-1:t.length,this.scope.facets[e].negated=a&&a.applied?i.length-1:i.length,this.scope.facets[e].selected=this.scope.facets[e].negated+this.scope.facets[e].applied,this.scope["readableSelected"+this.utilities.titleCase(e)]=this.getSelectedAsString(t),this.scope.facets[e].selected>0}getSelectedAsString(e){const t=s.pick(e,((e,t)=>e));return 0===t.length||t[""]?this.i18n.translations.ANY_TYPE:s.reduce(s.keys(t),((e,t)=>e+", "+t))}getFacetLabel(e,t){const i=s.find(this.scope.facetsConfig,(t=>t.name===e));return null!=i?i.label:e===this.$facetTypes.REFINE_PANE?this.i18n.translations.REFINE_SEARCH:e}includeMatchesInFullTextOverrideIsAlwaysDisabled(){return!this.findFacet({value:"include_matches_full_text_override"},this.$facetTypes.REFINE_PANE).active&&!this.scope.includeFullTextMatchesOverrideNonAdvanced}addFacetToSummaryIfAppliedOrNegated(e,t){if(((null==e?void 0:e.applied)||(null==e?void 0:e.negated))&&(e.name=t.name,e.fromSearchScope=t.fromSearchScope||e.fromSearchScope,e.label=e.translation||this.getFacetLabel(t.name),e.rawValue="AuthorName"!==t.name&&"Library"!==t.name||!t.originalValue?t.value:t.originalValue,!s.find(this.scope.selectedSummary,(t=>t.name===e.name&&t.label===e.label))))return this.scope.selectedSummary.push(e)}parseFacetsFromParams(e,t=!1){return s.map(e.fvf,(e=>{const i=this.utilities.splitOnEscaped(e,",");return{name:i[0],value:this.utilities.summonUnEscape(i[1]),originalValue:i[1],applied:"f"===i[2],negated:"t"===i[2],fromSearchScope:t}}))}syncFacetBasedSearchOptions(e){angular.forEach(e,(e=>{let t;if("IsFullText"===e.name&&"true"===e.value&&e.applied)t=this.findAndUpdateFacetAppliedOrNegated({value:"full_text_online"},this.$facetTypes.REFINE_PANE,!0,!1,e.fromSearchScope,!1);else if("IsScholarly"===e.name&&"true"===e.value&&e.applied)t=this.findAndUpdateFacetAppliedOrNegated({value:"limit_to_scholarly"},this.$facetTypes.REFINE_PANE,!0,!1,e.fromSearchScope,!1);else if("IsPeerReviewed"===e.name&&"true"===e.value&&e.applied)t=this.findAndUpdateFacetAppliedOrNegated({value:"limit_to_peer_reviewed"},this.$facetTypes.REFINE_PANE,!0,!1,e.fromSearchScope,!1);else if("IsOpenAccess"===e.name&&"true"===e.value&&e.applied)t=this.findAndUpdateFacetAppliedOrNegated({value:"open_access"},this.$facetTypes.REFINE_PANE,!0,!1,e.fromSearchScope,!1);else if("SourceType"===e.name&&"Library Catalog"===e.value&&e.applied)t=this.findAndUpdateFacetAppliedOrNegated({value:"items_in_catalog"},this.$facetTypes.REFINE_PANE,!0,!1,e.fromSearchScope,!1);else if((e.applied||e.negated)&&this.belongsToAnEnabledFacet(e)){const i=this.utilities.lowerCaseFirstChar(e.name);t=this.findAndUpdateFacetAppliedOrNegated(e,i,e.applied,e.negated,e.fromSearchScope,!1)}else t={negated:e.negated,applied:e.applied,name:e.name,value:e.value,rawValue:e.value,facetGroup:this.utilities.lowerCaseFirstChar(e.name),translation:this.i18n.translate(e.value)};return this.addFacetToSummaryIfAppliedOrNegated(t,e)}));const t=this.findAndUpdateFacetAppliedOrNegated({value:"ebooks_only"},this.$facetTypes.REFINE_PANE,"true"===this.appState.params["ebooks.only"],!1,"true"===this.scope.searchScopeParams["ebooks.only"],!1);this.addFacetToSummaryIfAppliedOrNegated(t,{name:"ebooks_only"});const i=this.findAndUpdateFacetAppliedOrNegated({value:"physical_books_only"},this.$facetTypes.REFINE_PANE,"true"===this.appState.params["print.books.only"],!1,"true"===this.scope.searchScopeParams["print.books.only"],!1);if(this.addFacetToSummaryIfAppliedOrNegated(i,{name:"physical_books_only"}),!this.includeMatchesInFullTextOverrideIsAlwaysDisabled()){const e=this.findAndUpdateFacetAppliedOrNegated({value:"include_matches_full_text_override"},this.$facetTypes.REFINE_PANE,"t"===this.appState.params["include.ft.matches"]||!0===this.appState.params["include.ft.matches"],!1,"t"===this.scope.searchScopeParams["include.ft.matches"]||!0===this.scope.searchScopeParams["include.ft.matches"],!1);this.addFacetToSummaryIfAppliedOrNegated(e,{name:"include_matches_full_text_override"})}const s=this.findAndUpdateFacetAppliedOrNegated({value:"add_results_beyond_catalog"},this.$facetTypes.REFINE_PANE,!this.appState.params.ho,!1,!this.scope.searchScopeParams.ho,!1);this.addFacetToSummaryIfAppliedOrNegated(s,{name:"add_results_beyond_catalog"});const a=this.findAndUpdateFacetAppliedOrNegated({value:"items_at_my_institution"},this.$facetTypes.REFINE_PANE,this.appState.params.myinst,!1,this.scope.searchScopeParams.myinst,!1);this.addFacetToSummaryIfAppliedOrNegated(a,{name:"items_at_my_institution"})}syncWithState(e=!0,t=!0){var i,s;let a=[];e&&(this.scope.facets.contentType&&this.getContentTypes(),this.scope.facets.discipline&&this.getDisciplines(),this.scope.facets.language&&this.getLanguages(),this.scope.facets.library&&this.getLibraryLocations(),this.scope.facets.refinePane.enabled&&this.setRefinePaneFacets(),this.scope.facets.newRecords&&this.setNewRecordsFacets()),t&&(this.clear(!1),this.scope.selectedSummary=[],this.appState.params.fvf.length&&a.push(...this.parseFacetsFromParams(this.appState.params)),this.parseQueryToAdvancedQuery(this.appState.params.q),this.addOrRemoveDateFromSelectedSummary(this.scope.dateSelection.date)),this.defaultScope.searchScope=null===(i=this.searchScopeService.currentSearchScope)||void 0===i?void 0:i.label,this.scope.searchScopeParams=this.scope.searchScopeParams||angular.copy(this.appState.searchScopeParams),this.scope.searchScopeTerms=(null===(s=this.scope.searchScopeParams)||void 0===s?void 0:s.q)||"",this.scope.searchScopeParams.fvf.length&&a.push(...this.parseFacetsFromParams(this.scope.searchScopeParams,!0)),this.syncFacetBasedSearchOptions(a),this.addNewRecordsFacet(),this.scope.inUse=!0,this.handlePhysicalAndEbook()}belongsToAnEnabledFacet(e){const t=this.utilities.lowerCaseFirstChar(e.name);return!!this.scope.facets[t]}setRefinePaneFacets(){this.convertConfigListToRefinePane(this.scope.config.refinePane.refineList);const e=s.filter(this.scope.facets.refinePane.config,(e=>e.active)),t=s.sortBy(e,(e=>e.order));return this.scope.facets.refinePane.values=t}convertConfigListToRefinePane(e,t){return e.map(((e,t)=>(this.scope.facets.refinePane.config[e.name]||(this.scope.facets.refinePane.config[e.name]={}),this.scope.facets.refinePane.config[e.name].translation||(this.scope.facets.refinePane.config[e.name].translation=e.label),this.scope.facets.refinePane.config[e.name].active=!0,this.scope.facets.refinePane.config[e.name].order=t)))}parseTermForQueryModifier(e,t){return"AllWords"===t?e:"AnyWords"===t?e.replace(/\sOR\s/g," "):"ExactMatch"===t?e.replace(/^"(.*)"$/,"$1"):"BeginsWith"===t?e.replace(/^"(.*)"$/,"$1").slice(0,-1):void 0}determineQueryModifier(e,t){if(this.shouldDisplayModifiers(e)){if(/^"(.*)"$/.test(t))return t.indexOf("*")===t.length-2?"BeginsWith":"ExactMatch";if(t.indexOf("OR")>-1)return"AnyWords"}return"AllWords"}determineMinLength(e){return"BeginsWith"===e?this.$minLengthForBeginsWithQueries:-1}isBalancedWhere(e){const t=[];if(null==e||""===e)return"balanced";for(let s=0;s<e.length;s++){var i=e[s];if("("===i&&"\\"!==e[s-1])t.push(s);else if(")"===i&&"\\"!==e[s-1]&&null==t.pop())return"left"}return 0===t.length?"balanced":t.length>0?"right":void 0}isBalanced(e){return"balanced"===this.isBalancedWhere(e)}cleanParenthesesBalanced(e){const t=this.countBalanced(e);if(null!=e)return e.substring(t.count,e.length-t.count)}countBalanced(e){let t,i;const s=this.isBalancedWhere(e);if(null==e||""===e)return{count:0,balanced:s};let a=0;if("right"!==s)for(i=0;i<e.length&&(t=e[i],"("===t&&"\\"!==e[i-1]);i++)a++;else{const s=e.split("").reverse();for(i=0;i<s.length&&(t=s[i],")"===t&&"\\"!==e[i-1]);i++)a++}return{count:a,balanced:s}}splitQueryOnBoolean(e){const t=[],i=[],s=[];return angular.forEach(e,((a,r)=>{if("("===a&&"\\"!==e[r-1]&&(t.push({idx:r,type:"parentheses",value:"open"}),i.push(r)),")"===a&&"\\"!==e[r-1]){const a=i.pop();t.push({idx:r,type:"parentheses",value:"close",matchIdx:a}),"("!==e[a+1]&&":("!==e.slice(a-1,+a+1||void 0)&&s.push({type:"term",value:e.slice(a+1,+(r-1)+1||void 0)})}if(r<e.length-5&&") OR ("===e.substring(r,r+6)&&(t.push({idx:r+2,type:"boolean",value:"OR",inside:0!==i.length}),s.push({type:"boolean",value:"OR"})),r<e.length-6&&(") AND ("===e.substring(r,r+7)&&(t.push({idx:r+2,type:"boolean",value:"AND",inside:0!==i.length}),s.push({type:"boolean",value:"AND"})),") NOT ("===e.substring(r,r+7)))return t.push({idx:r+2,type:"boolean",value:"NOT",inside:0!==i.length}),s.push({type:"boolean",value:"NOT"})})),s}unescapeParentheses(e){return e.replace(/\\([\(\)])/g,"$1")}parseQueryToAdvancedQueryValues(e){if(!e)return;const t=this.viewState.scopeBuilderMode?this.scope.scopeBuilderSearchFieldsConfig:this.scope.config.customSearchFields,i=[];0===e.indexOf("(")&&this.isBalanced(e)||i.push(e);const a=this.splitQueryOnBoolean(e);return angular.forEach(a,((e,a)=>{if("boolean"!==e.type){const a=e.value.match(/([^:]+):(\(.+?\))\)?$/);if(a){let r;const n=a[1];if(r=n,s.pluck(t,"key").includes(r)){const e=this.unescapeParentheses(this.cleanParenthesesBalanced(a[2])),t=this.determineQueryModifier(n,e);return i.push(this.parseTermForQueryModifier(e,t))}return i.push(this.unescapeParentheses(this.cleanParenthesesBalanced(e.value)))}return i.push(this.unescapeParentheses(this.cleanParenthesesBalanced(e.value)))}})),i}parseQueryToAdvancedQuery(e){if(!e)return;const t=this.viewState.scopeBuilderMode?this.scope.scopeBuilderSearchFieldsConfig:this.scope.config.customSearchFields;let i=this.getOrAddCustomSearchField();if(0!==e.indexOf("(")||!this.isBalanced(e))return void(i.value=e);const a=this.splitQueryOnBoolean(e);let r=null;return angular.forEach(a,((e,a)=>{if("boolean"===e.type)i=this.getOrAddCustomSearchField(),i.boolean=e.value;else{const a=e.value.match(/([^:]+):(\(.+?\))\)?$/);if(a){let n;const o=a[1];if(n=o,s.pluck(t,"key").includes(n)){const e=this.unescapeParentheses(this.cleanParenthesesBalanced(a[2]));i.queryModifier=this.determineQueryModifier(o,e),i.minLength=this.determineMinLength(i.queryModifier),i.key=o,i.value=this.parseTermForQueryModifier(e,i.queryModifier)}else r&&"term"===r.type?i.value+=" "+this.unescapeParentheses(this.cleanParenthesesBalanced(e.value)):i.value=this.unescapeParentheses(this.cleanParenthesesBalanced(e.value))}else r&&"term"===r.type?i.value+=" "+this.unescapeParentheses(this.cleanParenthesesBalanced(e.value)):i.value=this.unescapeParentheses(this.cleanParenthesesBalanced(e.value))}return r=e}))}addNewRecordsFacet(){var e;const t=null===(e=this.scope.searchScopeParams)||void 0===e?void 0:e.rf.find((e=>e.indexOf("NewRecords")>-1)),i=this.appState.params.rf.find((e=>e.indexOf("NewRecords")>-1)),s=t||i;if(s){const e=this.utilities.splitOnEscaped(s,","),i=this.utilities.splitOnEscaped(e[1],":")[0],a={name:e[0],value:e[1],applied:!0,fromSearchScope:!!t},r={name:e[0],value:i,originalValue:e[1],days:i,applied:!0,negated:!1,facetGroup:this.$facetTypes.NEW_RECORDS,translation:this.i18n.translate(this.i18n.translations.LAST_X_DAYS,{x:i}),fromSearchScope:a.fromSearchScope};return this.scope.facets.newRecords&&(this.scope.facets.newRecords.values.filter((e=>e.days===parseInt(i))).map((e=>(e.applied=!0,e.fromSearchScope=a.fromSearchScope,e))),this.scope.facets.newRecords.applied=1),this.addFacetToSummaryIfAppliedOrNegated(r,a)}}setNewRecordsFacets(){if(!this.scope.facets.newRecords.values.length)return(()=>{const e=[];for(var t in this.scope.newRecordsDaysFacet){var i=new r(this.$facetTypes.NEW_RECORDS,t,this.i18n.translate(this.i18n.translations.LAST_X_DAYS,{x:t}));i.active=!0,i.days=parseInt(t),i.orderBy="days",e.push(this.scope.facets.newRecords.values.push(i))}return e})()}addOrRemoveDateFromSelectedSummary(e){if(this.removeFacetFromSelectedSummary({value:"date"}),e.start){const t={applied:!0,negated:!1,facetGroup:"daterange",name:this.createDateRangeValue(e),translation:this.createDateRangeValue(e),value:"date",label:this.createDateRangeValue(e)};return this.scope.selectedSummary.push(t)}}createDateRangeValue(e){const t=e.selectedYears;return t?this.i18n.translations["DATE_PRESET_"+t+"Y"]:this.i18n.translations.CUSTOM_DATES}setDateSelection(e){this.scope.dateSelection.date={start:e.start,end:e.end,selectedYears:e.selectedYears},this.datepickerService.datepicker.search.date.start=e.start,this.datepickerService.datepicker.search.date.end=e.end,this.addOrRemoveDateFromSelectedSummary(e)}toggleOrExcludeValue(e){let t="";return e.negated&&(t="t"),e.applied&&(t="f"),t}submit(){this.scope.hasSearched=!0,this.scope.inUse=!1;const e=this.datepickerService.datepicker.search;return this.datepickerService.datepicker.clean(),this.appState.applyStateWithSnapShot((()=>{var t,i,a,r;this.appState.resetParams(!1);const{params:n}=this.appState;n.q=this.buildSearchFieldsQuery();let o=!1;if(!this.scope.searchScopeParams.rf.some((e=>e.indexOf("PublicationDate")>-1))&&(e.date.start&&(o=!0),e.date.end)){const t=new Date;e.date.end.getDate()===t.getDate()&&e.date.end.getFullYear()===t.getFullYear()&&e.date.end.getMonth()===t.getMonth()||(o=!0)}o&&n.rf.push("PublicationDate,"+(this.utilities.dateToFilterDate(e.date.start)||"*")+":"+(this.utilities.dateToFilterDate(e.date.end)||"*"));const l=this.utilities.summonEscape,c=this;(null===(t=this.scope.facets.contentType)||void 0===t?void 0:t.values)&&angular.forEach(this.scope.facets.contentType.values,(function(e,t){if(e&&""!==e.value&&!e.fromSearchScope&&c.toggleOrExcludeValue(e))return n.fvf.push(["ContentType",l(e.value),c.toggleOrExcludeValue(e)].join(","))})),(null===(i=this.scope.facets.discipline)||void 0===i?void 0:i.values)&&angular.forEach(this.scope.facets.discipline.values,(function(e,t){if(e&&""!==e.value&&!e.fromSearchScope&&c.toggleOrExcludeValue(e))return n.fvf.push(["Discipline",l(e.value),c.toggleOrExcludeValue(e)].join(","))})),(null===(a=this.scope.facets.language)||void 0===a?void 0:a.values)&&angular.forEach(this.scope.facets.language.values,(function(e,t){if(e&&""!==e.value&&!e.fromSearchScope&&c.toggleOrExcludeValue(e))return n.fvf.push(["Language",l(e.value),c.toggleOrExcludeValue(e)].join(","))})),(null===(r=this.scope.facets.library)||void 0===r?void 0:r.values)&&angular.forEach(this.scope.facets.library.values,(function(e,t){if(e&&""!==e.value&&!e.fromSearchScope&&c.toggleOrExcludeValue(e))return n.fvf.push(["Library",l(e.value),c.toggleOrExcludeValue(e)].join(","))})),this.refinePaneFacetApplied("full_text_online")&&!this.refinePaneFacetAppliedBySearchScope("IsFullText,true,f")&&n.fvf.push("IsFullText,true,f"),this.refinePaneFacetApplied("limit_to_scholarly")&&!this.refinePaneFacetAppliedBySearchScope("IsScholarly,true,f")&&n.fvf.push("IsScholarly,true,f"),this.refinePaneFacetApplied("limit_to_peer_reviewed")&&!this.refinePaneFacetAppliedBySearchScope("IsPeerReviewed,true,f")&&n.fvf.push("IsPeerReviewed,true,f"),this.refinePaneFacetApplied("open_access")&&!this.refinePaneFacetAppliedBySearchScope("IsOpenAccess,true,f")&&n.fvf.push("IsOpenAccess,true,f"),this.refinePaneFacetApplied("items_in_catalog")&&!this.refinePaneFacetAppliedBySearchScope("SourceType,Library Catalog,f")&&n.fvf.push("SourceType,Library Catalog,f"),angular.forEach(this.scope.selectedSummary,(e=>{if(!this.facetHasItsOwnParam(e)&&!e.fromSearchScope){const t=e.applied?"f":"t",i=`${e.name},${e.rawValue},${t}`,a=`${e.name},${l(e.rawValue)},${t}`;if(!s.includes(n.fvf,i)&&!s.includes(n.fvf,a)&&!this.refinePaneFacetApplied(e.value))return n.fvf.push(i)}})),n.ho=!(this.refinePaneFacetApplied("add_results_beyond_catalog")||this.isAbsentFacetApplied("add_results_beyond_catalog"))&&this.scope.searchScopeParams.ho,this.includeMatchesInFullTextOverrideIsAlwaysDisabled()?n["include.ft.matches"]=this.scope.includeFullTextMatchesDefault:n["include.ft.matches"]=this.refinePaneFacetApplied("include_matches_full_text_override")&&![!0,"t"].includes(this.scope.searchScopeParams["include.ft.matches"])||this.isAbsentFacetApplied("include_matches_full_text_override"),this.refinePaneFacetApplied("ebooks_only")&&"true"!==this.scope.searchScopeParams["ebooks.only"]||this.isAbsentFacetApplied("ebooks_only")?n["ebooks.only"]="true":(this.refinePaneFacetApplied("physical_books_only")&&"true"!==this.scope.searchScopeParams["print.books.only"]||this.isAbsentFacetApplied("physical_books_only"))&&(n["print.books.only"]="true"),(this.refinePaneFacetApplied("items_at_my_institution")&&!this.scope.searchScopeParams.myinst||this.isAbsentFacetApplied("items_at_my_institution"))&&this.scope.config.refinePane.intstitutionName&&(n.myinst=`${this.scope.config.refinePane.intstitutionName}`);const h=s.find(this.scope.selectedSummary,(e=>"NewRecords"===e.name));if((null==h?void 0:h.applied)&&!this.scope.searchScopeParams.rf.some((e=>e.indexOf("NewRecords")>-1))){const{days:e}=h;n.rf.push(`NewRecords,${e}:*`)}return n.searchscope=this.scope.newSearchScope||this.scope.searchScope,this.events.publish("actions","advanced_search:query",{params:n}),this.events.gaPush("search","advanced",n.q)}))}facetHasItsOwnParam(e){return"add_results_beyond_catalog"===e.name||"include_matches_full_text_override"===e.name||"daterange"===e.facetGroup||"physical_books_only"===e.name||"ebooks_only"===e.name||"items_at_my_institution"===e.name||e.facetGroup===this.$facetTypes.NEW_RECORDS}hasMaxCustomRows(e=!1){return e?this.scope.scopeBuilderSearchFields.length>=this.scope.config.maxSearchScopeFields:this.scope.searchFields.length>=this.scope.config.maxCustomFields}isAbsentFacetApplied(e){const t=s.find(this.scope.selectedSummary,(t=>t.value===e));return!!t&&t.applied}isFacetApplied(e,t){const i=s.find(this.scope.facets[e].values,(e=>e.value===t));return i?i.applied:null}isFacetNegated(e,t){const i=s.find(this.scope.facets[e].values,(e=>e.value===t));return i?i.negated:null}refinePaneFacetApplied(e){return this.isFacetApplied(this.$facetTypes.REFINE_PANE,e)}refinePaneFacetAppliedBySearchScope(e){return this.appState.searchScopeParams.fvf.includes(e)}reflectSearchScopeDate(){this.fire("reflectDate",this.scope.searchScopeParams)}resetSearchscope(){this.updateSearchScope(this.searchScopeService.currentSearchScope||this.searchScopeService.getDefaultScope())}removeNewRecordsAppliedBySearchScope(){let e=!1;this.scope.facets.newRecords.values.filter((e=>e.fromSearchScope)).map((t=>{e=e||t.applied,t.applied=!1})),e&&(this.scope.facets.newRecords.applied=0)}removeSearchScopeFacets(){var e;this.scope.selectedSummary=[...this.scope.selectedSummary.filter((e=>!e.fromSearchScope))];const t=[];(null===(e=this.scope.searchScopeParams)||void 0===e?void 0:e.fvf.length)&&t.push(...this.parseFacetsFromParams(this.scope.searchScopeParams,!0)),angular.forEach(t,(e=>{if("IsFullText"===e.name)this.findAndUpdateFacetAppliedOrNegated({value:"full_text_online"},this.$facetTypes.REFINE_PANE,!1,!1,!1,!1);else if("IsScholarly"===e.name)this.findAndUpdateFacetAppliedOrNegated({value:"limit_to_scholarly"},this.$facetTypes.REFINE_PANE,!1,!1,!1,!1);else if("IsPeerReviewed"===e.name)this.findAndUpdateFacetAppliedOrNegated({value:"limit_to_peer_reviewed"},this.$facetTypes.REFINE_PANE,!1,!1,!1,!1);else if("IsOpenAccess"===e.name)this.findAndUpdateFacetAppliedOrNegated({value:"open_access"},this.$facetTypes.REFINE_PANE,!1,!1,!1,!1);else if("SourceType"===e.name)this.findAndUpdateFacetAppliedOrNegated({value:"items_in_catalog"},this.$facetTypes.REFINE_PANE,!1,!1,!1,!1);else if(this.belongsToAnEnabledFacet(e)){const t=this.utilities.lowerCaseFirstChar(e.name);this.findAndUpdateFacetAppliedOrNegated(e,t,!1,!1,!1,!1)}})),this.findAndUpdateFacetAppliedOrNegated({value:"ebooks_only"},this.$facetTypes.REFINE_PANE,"true"===this.appState.params["ebooks.only"],!1,!1,!1),this.findAndUpdateFacetAppliedOrNegated({value:"physical_books_only"},this.$facetTypes.REFINE_PANE,"true"===this.appState.params["print.books.only"],!1,!1,!1),this.includeMatchesInFullTextOverrideIsAlwaysDisabled()||this.findAndUpdateFacetAppliedOrNegated({value:"include_matches_full_text_override"},this.$facetTypes.REFINE_PANE,"t"===this.appState.params["include.ft.matches"]||!0===this.appState.params["include.ft.matches"],!1,!1,!1),this.findAndUpdateFacetAppliedOrNegated({value:"add_results_beyond_catalog"},this.$facetTypes.REFINE_PANE,!this.appState.params.ho,!1,!1,!1),this.findAndUpdateFacetAppliedOrNegated({value:"items_at_my_institution"},this.$facetTypes.REFINE_PANE,this.appState.params.myinst,!1,!1,!1),this.removeNewRecordsAppliedBySearchScope()}updateSearchScope(e){this.removeSearchScopeFacets(),this.appState.parseSearchScopeFromUrlParams(e.query,this.scope.searchScopeParams),this.scope.newSearchScope=e.label,this.reflectSearchScopeDate(),this.syncWithState(!1,!1)}}n.$inject=["$rootScope","appStateService","utilitiesService","$filter","eventService","datepickerService","apiService","alertService","translationService","dataService","configService","$booleanValues","$identifierFields","$minLengthForBeginsWithQueries","hooksService","$broadcastTypes","$facetTypes","searchScopeService","viewStateService"],angular.module("summonApp.services").service("advancedSearchService",n)},3053:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t){this.sortAIDocs=this.sortAIDocs.bind(this),this.getAIButtonValues=this.getAIButtonValues.bind(this),this.docService=e,this.translationService=t,this.detailConfig=this.docService.detailConfig,this.isAIDocument=this.docService.displayAIPage}getCatalogLink(e=[]){let t="";return e.length&&s.intersection(s.map(e[0].content_types,(e=>e.toLowerCase())),["journal","book"]).length&&(t=e[0].link||""),t}isPrint(e){return null===e.content_type.match(/^e(journal|book).*/i)&&e.is_print?0:1}sortAIDocs(e,t){const i=[];return angular.forEach(t,(t=>{let a=!1,r=t.peer_documents||[];if(r.unshift(t),r=s.sortBy(r,this.isPrint),angular.forEach(r,(function(t){if(!a)return a="Journal Article"===e.content_type&&e.issns.length&&s.difference(e.issns,s.difference(e.issns,t.issns)).length||"Book Chapter"===e.content_type&&e.isbns.length&&s.difference(e.isbns,s.difference(e.isbns,t.isbns)).length})),!a)return;t.peer_documents=[];const n=s.find(r,(e=>0===this.isPrint(e)));return n?(r=s.without(r,n),n.peer_documents=r,i.push(n)):void 0})),i}getAIButtonValues(e,t){const i={};if(!this.docService.displayAIPage(e))return i;const a={ill:{text:this.translationService.translations.REQUEST,link:this.docService.getIllRequestLink(e),clickTrack:!1},catalog:{text:this.translationService.translate("Get %{type}",{type:this.translationService.translate(e.content_type)}),link:this.getCatalogLink(t),clickTrack:!0}},r=this.detailConfig.aiPrimaryAction,n=s.chain(a).omit(r).keys().first().value();return this.detailConfig.enablePrimaryButton&&(i.primary=a[r]),this.detailConfig.enableSecondaryButton&&(i.secondary=a[n]),i}}a.$inject=["documentService","translationService"],angular.module("summonApp.services").service("aiDocumentService",a)},6582:()=>{"use strict";class e{constructor(e,t,i){this.toastAlert=this.toastAlert.bind(this),this.resetToastAlert=this.resetToastAlert.bind(this),this.setAlert=this.setAlert.bind(this),this.resetAlert=this.resetAlert.bind(this),this.pulseAlert=this.pulseAlert.bind(this),this.$timeout=e,this.translationService=t,this.ngToast=i,this.alerts={emailNotify:{class:"email-notifier alertFade",msg:!1},pageRequestError:{type:"danger",msg:!1,retry:!0},facetError:{type:"danger",msg:!1,retry:!0},contentTypesError:{type:"danger",msg:!1,retry:!0},disciplinesError:{type:"danger",msg:!1,retry:!0},languagesError:{type:"danger",msg:!1,retry:!0},libraryError:{type:"danger",msg:!1,retry:!0},citationTrailError:{type:"danger",msg:!1,retry:!0},citationError:{type:"danger",msg:!1,retry:!0},citationEmailError:{type:"danger",msg:!1,retry:!0},bulkExportError:{type:"danger",msg:this.translationService.translations.BULK_EXPORT_ERROR,retry:!0},bulkExportSuccess:{type:"success",msg:this.translationService.translations.BULK_EXPORT_SUCCESS,retry:!1},feedbackError:{type:"danger",msg:!1,retry:!0},chatEmailError:{type:"danger",msg:!1,retry:!0},cloudStorageApiError:{type:"warning",msg:!1,retry:!1},googleSignOut:{class:"alertFade",type:"success",msg:!1,retry:!1},cloudStorageSignOut:{class:"alertFade",type:"success",msg:!1,retry:!1},savedSearchSuccess:{iconClass:"uxf-icon uxf-check uxf-green",class:"alertFade",type:"success",msg:!1,retry:!1},savedItemSuccess:{iconClass:"uxf-icon uxf-check uxf-green",class:"alertFade",type:"success",msg:!1,retry:!1},savedSearchError:{type:"warning",msg:!1,retry:!0},relatedItemsError:{type:"danger",msg:!1,retry:!0},requestHoldError:{type:"danger",msg:!1,retry:!1},sierraApiError:{type:"danger",msg:!1,retry:!1},libraryCardError:{type:"danger",msg:!1,retry:!1},libraryCardListLoadError:{type:"danger",msg:!1,retry:!0},libraryCardSuccess:{type:"success",msg:!1,retry:!1},authenticationNotice:{type:"success",msg:!1,retry:!1},requestHoldSuccess:{iconClass:"uxf-icon uxf-check uxf-green",type:"success",msg:!1,retry:!1}}}toastAlert(e,t="An error occurred",i,s="",a=!0){if(null==this.alerts[e])throw new Error(this.translationService.translations.ALERT_NAME_DOES_NOT_EXIST);let r=!0;return"danger"===i&&(r=!1),a&&this.resetToastAlert(e),s&&(t=`${s}: ${t}`),this.alerts[e].toast=this.ngToast.create({content:t,className:i,dismissOnTimeout:r})}toast(e,t){const i=t||this.alerts[e].msg||"An error occurred";let s=!0;const a=this.alerts[e].type;return"danger"===a&&(s=!1),this.alerts[e].toast=this.ngToast.create({content:i,className:a,dismissOnTimeout:s})}resetToastAlert(e){if(null==this.alerts[e])throw new Error(this.translationService.translations.ALERT_NAME_DOES_NOT_EXIST);if(null!=this.alerts[e].toast)return this.ngToast.dismiss(this.alerts[e].toast)}setAlert(e,t="An error occurred",i=""){if(null==this.alerts[e])throw new Error(this.translationService.translations.ALERT_NAME_DOES_NOT_EXIST);return this.alerts[e].msg=t,this.alerts[e].retryText=i}resetAlert(e){if(null==this.alerts[e])throw new Error(this.translationService.translations.ALERT_NAME_DOES_NOT_EXIST);return this.alerts[e].msg=!1}pulseAlert(e,t,i=2500,s=""){return this.setAlert(e,t,s),this.$timeout((()=>this.resetAlert(e)),i)}}e.$inject=["$timeout","translationService","ngToast"],angular.module("summonApp.services").service("alertService",e)},184:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.applyParams=this.applyParams.bind(this),this.get=this.get.bind(this),this.search=this.search.bind(this),this.documentDetail=this.documentDetail.bind(this),this.reviews=this.reviews.bind(this),this.aiDocuments=this.aiDocuments.bind(this),this.facetValues=this.facetValues.bind(this),this.contentTypes=this.contentTypes.bind(this),this.disciplines=this.disciplines.bind(this),this.languages=this.languages.bind(this),this.libraryLocations=this.libraryLocations.bind(this),this.courseReserves=this.courseReserves.bind(this),this.cites=this.cites.bind(this),this.citedBy=this.citedBy.bind(this),this.relatedItems=this.relatedItems.bind(this),this.bulkExport=this.bulkExport.bind(this),this.$http=e,this.$rootScope=t,this.$q=i,this.$timeout=s,this.$broadcastTypes=a,this.$window=r,this.session_id=null,this.sessionHeader="SUMMON-SID",this.endpoint="/api",this.storedQuery=null,this.previousApiRequest=null,n.setHooks(this,"ApiService",["update"])}apiParamsFor(e){const t={};for(var i in t.screen_res=`W${this.$window.innerWidth}H${this.$window.innerHeight}`,t.__refererURL=decodeURIComponent(__refererURL),e){var a=e[i],r=!0===a?"t":!1===a?"f":angular.copy(a);(s.isNumber(r)||(null==r?void 0:r.length)>0)&&(t[i]=r)}return t}applyParams(e){let t;if(t="id",s.keys(e).includes("id")&&e.id){const t={q:`id:${e.id}`};return delete e.id,this.search(e),this.documentDetail(t)}return this.search(e)}get(e,t,{debug:i=!1,avoidUpdateFire:s=!1,httpPost:a=!1}={}){i||(this.previousApiRequest={method:e,params:t});const r=this.apiParamsFor(t);let n=$.param(r);n.length&&(n=`?${n}`),i&&(n=`${n}&raw=true`);const o={};this.session_id&&(o[this.sessionHeader]=this.session_id);let l={types:[]};if("search"===e){const e=r.q;e===this.storedQuery?l.types.push(this.$broadcastTypes.search):(this.storedQuery=e,l.types.push(this.$broadcastTypes.newSearch)),this.$rootScope.$broadcast("apiRequest",l)}"facet_values"===e&&(l.types.push(this.$broadcastTypes.moreFacets),this.$timeout((()=>this.$rootScope.$broadcast("apiRequest",l)))),"search"===e&&this.requestCanceler&&!this.requestCompleted&&(this.requestCanceler.resolve(),delete this.requestCanceler);const c={headers:o};this.requestCompleted=!1,"search"===e&&(this.requestCanceler=this.$q.defer(),c.timeout=this.requestCanceler.promise);const h=Date.now(),d=a?this.$http.post(`${this.endpoint}/${e}`,r,c):this.$http.get(`${this.endpoint}/${e}${n}`,c),u=(i,s={})=>{let a;return l={types:[],isPageRequest:t.pn>1,errorObject:s},"search"===e&&(l.types.push(this.$broadcastTypes.newSearch),l.types.push(this.$broadcastTypes.search)),"facet_values"===e&&(a=!0,l.types.push(this.$broadcastTypes.moreFacets)),"content_types"===e&&l.types.push(this.$broadcastTypes.contentTypes),"disciplines"===e&&l.types.push(this.$broadcastTypes.disciplines),"languages"===e&&l.types.push(this.$broadcastTypes.languages),"library"===e&&l.types.push(this.$broadcastTypes.library),["citations/cites","citations/citedby"].includes(e)&&l.types.push(this.$broadcastTypes.citationTrail),["reviews","ai_documents"].includes(e)&&l.types.push(this.$broadcastTypes.other),a?this.$timeout((()=>this.$rootScope.$broadcast(i,l))):this.$rootScope.$broadcast(i,l)};return d.then((e=>(this.session_id||(this.session_id=e.headers()[this.sessionHeader.toLowerCase()]),e.data._elapsedTime=Date.now()-h,s||this.fire("update",e.data,i),this.requestCompleted=!0,500===e.status?u("apiError"):u("apiSuccess"),e))).catch((e=>{const{status:t}=e;let{data:i}=e;const a=!!(t+"").match(/[45]\d{2}/);if(i&&""!==i||a?((i||0===t)&&(this.requestCompleted=!0),i&&""!==i||0===parseInt(t)||(i={httpStatus:parseInt(t)}),u("apiError",i)):u("apiCancel"),s)throw e;return e}))}searchResearchAssistantDocument(e){const t=this.apiParamsFor(e);let i=$.param(t);i.length&&(i=`?${i}`);const s={};this.session_id&&(s[this.sessionHeader]=this.session_id),this.requestCanceler&&!this.requestCompleted&&(this.requestCanceler.resolve(),delete this.requestCanceler);const a={headers:s};this.requestCompleted=!1,this.requestCanceler=this.$q.defer(),a.timeout=this.requestCanceler.promise;const r=Date.now();return this.$http.get(`${this.endpoint}/search${i}`,a).then((e=>(this.session_id||(this.session_id=e.headers()[this.sessionHeader.toLowerCase()]),e.data._elapsedTime=Date.now()-r,this.requestCompleted=!0,e))).catch((e=>{const{status:t}=e;let{data:i}=e;const s=!!(t+"").match(/[45]\d{2}/);return i&&""!==i||s?((i||0===t)&&(this.requestCompleted=!0),i&&""!==i||0===parseInt(t)||(i={httpStatus:parseInt(t)}),console.log("apiError",i)):console.log("apiCancel"),e}))}search(e){return this.get("search",e)}documentDetail(e){return this.get("document",e)}reviews(e){return this.get("reviews",e)}aiDocuments(e){return this.get("ai_documents",e)}facetValues(e,t){const i=this.apiParamsFor(t);return i.facet=e,i.pn=1,this.get("facet_values",i)}contentTypes(){return this.get("content_types",{})}disciplines(){return this.get("disciplines",{})}languages(){return this.get("languages",{})}libraryLocations(){return this.get("library",{})}courseReserves(e){return this.get("search",e,{avoidUpdateFire:!0})}cites(e){return this.get("citations/cites",e,{avoidUpdateFire:!0})}citedBy(e){return this.get("citations/citedby",e,{avoidUpdateFire:!0})}relatedItems(e){return this.get("related_items",e,{avoidUpdateFire:!0,httpPost:!0})}bulkExport(e){return this.get("bulk_export",e,{avoidUpdateFire:!0,httpPost:!0})}}a.$inject=["$http","$rootScope","$q","$timeout","$broadcastTypes","$window","hooksService"],angular.module("summonApp.services").service("apiService",a)},9796:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.resetParams=this.resetParams.bind(this),this.takeSnapShot=this.takeSnapShot.bind(this),this.filtersApplied=this.filtersApplied.bind(this),this.numberOfFiltersApplied=this.numberOfFiltersApplied.bind(this),this.applyState=this.applyState.bind(this),this.applyStateWithSnapShot=this.applyStateWithSnapShot.bind(this),this.rollbackState=this.rollbackState.bind(this),this.checkAppliedStatusForFullTextMatches=this.checkAppliedStatusForFullTextMatches.bind(this),this.getFullTextMatchesParameterValue=this.getFullTextMatchesParameterValue.bind(this),this.checkDefaultInclusion=this.checkDefaultInclusion.bind(this),this.applyStateFromUrlParams=this.applyStateFromUrlParams.bind(this),this.apiService=e,this.urlService=t,this.utilities=o,this.$window=i,this.$q=r,this.customizerUrl=a.data.customizer.customizerUrl+"/"+a.data.head.client,this.isDefaultInclusion=this.checkDefaultInclusion(a.data.quickFilters),this.viewStateService=n,this.defaults={pn:1,ho:!0,"include.ft.matches":this.getFullTextMatchesParameterValue(a.data.quickFilters),fvf:[],fvfi:[],myinst:"",jt:"",rf:[],l:this.$window.__summonLocale,searchscope:""},this.resetParams(),this.paramsSnapShot={},s.setHooks(this,"AppStateService",["apply"])}resetParams(e=!0){this.params=angular.copy(this.defaults,{}),e&&(this.searchScopeParams=angular.copy(this.defaults,{}))}takeSnapShot(){return this.paramsSnapShot=angular.copy(this.params)}filtersApplied(){return this.filtersAppliedBy(this.params)||this.filtersAppliedBy(this.searchScopeParams)}filtersAppliedBy(e){return!e.ho||e.fvf.length||e.fvfi.length||e.rf.length||e.myinst||e.oaf||e["print.books.only"]||e["ebooks.only"]||this.checkAppliedStatusForFullTextMatches(e)}numberOfFiltersApplied(){let e=0;this.params.ho&&this.searchScopeParams.ho||(e+=1),(this.params.myinst||this.searchScopeParams.myinst)&&(e+=1),(this.params.oaf||this.searchScopeParams.oaf)&&(e+=1),(this.params["print.books.only"]||this.searchScopeParams["print.books.only"])&&(e+=1),(this.params["ebooks.only"]||this.searchScopeParams["ebooks.only"])&&(e+=1);const t=this.params["include.ft.matches"]||this.searchScopeParams["include.ft.matches"];return"f"!==t&&t&&!this.isDefaultInclusion&&(e+=1),e+=this.params.fvf.length+this.searchScopeParams.fvf.length,e+=this.params.fvfi.length+this.searchScopeParams.fvfi.length,e+=this.params.rf.length+this.searchScopeParams.rf.length,e-this.getNumOfFacetsDuplicated(this.params,this.searchScopeParams)}getNumOfFacetsDuplicated(e,t){let i=0;if(e.fvf.length&&t.fvf.length){const s=e.fvf.map((e=>e.substring(0,e.lastIndexOf(",")))),a=t.fvf.map((e=>e.substring(0,e.lastIndexOf(","))));i+=this.getDuplicatedFacetsCount(s,a)}if(e.rf.length&&t.rf.length){const s=e.rf.map((e=>e.split(",")[0])),a=t.rf.map((e=>e.split(",")[0]));i+=this.getDuplicatedFacetsCount(s,a)}return i}getDuplicatedFacetsCount(e,t){let i=0;for(const s of e)t.includes(s)&&i++;return i}applyState(e={isPageRequest:!0}){e.isPageRequest||(this.params.pn=1),this.sendScopeIfBuildingScope(),this.urlService.applyParams(this.params);const t=this.apiService.applyParams(s.omit(this.params));return this.fire("apply",this.params.pn),t}updatePageInUrl(e){this.params.pn=e,this.urlService.applyParams(this.params)}applyStateWithSnapShot(e=angular.noop){if(!s.isFunction(e))throw new Error("takes a function");return this.takeSnapShot(),e(),this.applyState()}sendScopeIfBuildingScope(){if(this.viewStateService.scopeBuilderMode){const e=this.urlService.urlParamsStringFor(this.params);this.$window.parent.postMessage({query:e},"*")}}rollbackState(){if(!s.isEqual(this.params,this.paramsSnapShot))return this.resetParams(),angular.extend(this.params,this.paramsSnapShot),this.applyState()}isDifferent(e,t){for(var i in t){var a=t[i];if("pn"!==i&&!angular.equals(e[i],a))return!0}return!!s.difference(s.keys(e),s.keys(t)).length}checkAppliedStatusForFullTextMatches(e){return!this.isDefaultInclusion&&"f"!==e["include.ft.matches"]&&!!e["include.ft.matches"]}getFullTextMatchesParameterValue(e){let t="";return s(null==e?void 0:e.filters).map((e=>{if("include.ft.matches"===e.facet)return t=e.value?"t":"f"})),t}checkDefaultInclusion(e){let t=!1;return s(null==e?void 0:e.filters).map((e=>{if("include.ft.matches"===e.facet&&e.defaultInclusion)return t=!0})),t}dontIncludeFTMatchViaEmptySearchScope(e,t){t||(e["include.ft.matches"]="f")}parseSearchScopeFromUrlParams(e,t=this.searchScopeParams){let i;const a=this.urlService.urlParamsFromString(e),r=$.extend(!0,{},this.defaults,this.urlService.toParams(a));for(i in this.dontIncludeFTMatchViaEmptySearchScope(r,e),r)delete t[i];for(i of s.difference(s.keys(t),s.keys(r)))delete t[i];$.extend(t,r)}applyStateFromUrlParams(e){let t;const i=$.extend(!0,{},this.defaults,this.urlService.toParams(e)),a=this.isDifferent(this.params,i);for(t in i)delete this.params[t];for(t of s.difference(s.keys(this.params),s.keys(i)))delete this.params[t];if($.extend(this.params,i),a){this.urlService.applyParams(this.params);const e=this.apiService.applyParams(this.params);return this.fire("apply",this.params.pn),e}return this.$q.resolve(!0)}}a.$inject=["apiService","urlService","$window","hooksService","configService","$q","viewStateService","utilitiesService"],angular.module("summonApp.services").service("appStateService",a)},7936:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t=!0,i=!1){this.displayName=e,this.loggedIn=!1,this.enabled=!1,this.canLoginManually=t,this.initialized=!1,this.refreshInterval=null,this.error=null,this.csrf="",this.user="",this.expiry=0,this.summonOnly=i}}class r{constructor(e,t="",i="",s=angular.noop){this.providers=[],this.name=e,this.translation=t,this.description=i,this.providerUpdateHook=s,this.activeProvider=null,this.supportedProviders=[],this.showInLoginMenu=!0,this.showInMenu=this.showFeatureInMenu.bind(this)}showFeatureInMenu(){return this.showInLoginMenu&&this.providers.some((e=>e.enabled))}setProvider(e,t){const i=s.find(this.supportedProviders,(t=>e===t.provider));return i?i.params=t:this.supportedProviders.push({provider:e,params:t}),this.providerUpdateHook()}getSupportedProviders(){return s.map(this.supportedProviders,(e=>e.provider))}loginParamsForProvider(e){const t=s.find(this.supportedProviders,(t=>e===t.provider));return t?t.params:null}}class n{constructor(e,t,i,s,r,n,o,l,c,h,d,u,p,m,g,v){this.init=this.init.bind(this),this.determineProviders=this.determineProviders.bind(this),this.registerFeature=this.registerFeature.bind(this),this.updateFeaturesWithLoginState=this.updateFeaturesWithLoginState.bind(this),this.toggleProviderEnabledBasedOnFeature=this.toggleProviderEnabledBasedOnFeature.bind(this),this.setUserNameForProvider=this.setUserNameForProvider.bind(this),this.setEmailForProvider=this.setEmailForProvider.bind(this),this.setUserNameForBanner=this.setUserNameForBanner.bind(this),this.getUserForProvider=this.getUserForProvider.bind(this),this.setSierraPatronIdForProvider=this.setSierraPatronIdForProvider.bind(this),this.getSierraPatronIdForProvider=this.getSierraPatronIdForProvider.bind(this),this.authenticationRouteChangeHandler=this.authenticationRouteChangeHandler.bind(this),this.handleRouteErrors=this.handleRouteErrors.bind(this),this.notAuthenticatedHandler=this.notAuthenticatedHandler.bind(this),this.loginExpiredHandler=this.loginExpiredHandler.bind(this),this.logoutSuccessHandler=this.logoutSuccessHandler.bind(this),this.checkIfOnAuthRouteAndMoveAway=this.checkIfOnAuthRouteAndMoveAway.bind(this),this.loginErrorWithMessageIfOnAuthRoute=this.loginErrorWithMessageIfOnAuthRoute.bind(this),this.checkIfValidateRequestNeeded=this.checkIfValidateRequestNeeded.bind(this),this.doInitializeProvider=this.doInitializeProvider.bind(this),this.formatUrl=this.formatUrl.bind(this),this.hookLocalStorage=this.hookLocalStorage.bind(this),this.startRefreshTimer=this.startRefreshTimer.bind(this),this.stopRefreshTimer=this.stopRefreshTimer.bind(this),this.getProviderFromCallback=this.getProviderFromCallback.bind(this),this.doValidateAfterCallback=this.doValidateAfterCallback.bind(this),this.doRefreshToken=this.doRefreshToken.bind(this),this.setAppState=this.setAppState.bind(this),this.getAppState=this.getAppState.bind(this),this.getAuthState=this.getAuthState.bind(this),this.shouldBroadcastAuthstateChange=this.shouldBroadcastAuthstateChange.bind(this),this.setAuthState=this.setAuthState.bind(this),this.getLoggedInProviderForFeature=this.getLoggedInProviderForFeature.bind(this),this.getLoggedInProvidersForFeature=this.getLoggedInProvidersForFeature.bind(this),this.isLoggedInForFeature=this.isLoggedInForFeature.bind(this),this.providerSupportsFeature=this.providerSupportsFeature.bind(this),this.getFeaturesForProvider=this.getFeaturesForProvider.bind(this),this.getProvidersForFeature=this.getProvidersForFeature.bind(this),this.getProviderForFeature=this.getProviderForFeature.bind(this),this.getAuthValue=this.getAuthValue.bind(this),this.setAuthValue=this.setAuthValue.bind(this),this.updateScopeFromLocalStorage=this.updateScopeFromLocalStorage.bind(this),this.isLoggedIn=this.isLoggedIn.bind(this),this.login=this.login.bind(this),this.logout=this.logout.bind(this),this.openPopupWindow=this.openPopupWindow.bind(this),this.loginError=this.loginError.bind(this),this.logoutAfterExpire=this.logoutAfterExpire.bind(this),this.afterLogout=this.afterLogout.bind(this),this.clearAuthState=this.clearAuthState.bind(this),this.isAuthExpired=this.isAuthExpired.bind(this),this.deleteAppState=this.deleteAppState.bind(this),this.storeAppState=this.storeAppState.bind(this),this.getPreviousAppState=this.getPreviousAppState.bind(this),this.optApplyPrevState=this.optApplyPrevState.bind(this),this.afterLogIn=this.afterLogIn.bind(this),this.loginSuccessHandler=this.loginSuccessHandler.bind(this),this.loginToSummonWithSaml=this.loginToSummonWithSaml.bind(this),this.closeLoginDialog=this.closeLoginDialog.bind(this),this.closeLogoutDialog=this.closeLogoutDialog.bind(this),this.checkLogoutHappened=this.checkLogoutHappened.bind(this),this.openLogoutDialog=this.openLogoutDialog.bind(this),this.getProviderDisplayName=this.getProviderDisplayName.bind(this),this.openLoginDialog=this.openLoginDialog.bind(this),this.$window=e,this.i18n=i,this.$log=s,this.$q=r,this.$location=n,this.appState=o,this.$http=l,this.$rootScope=c,this.$authEvents=h,this.$uibModal=d,this.$timeout=u,this.$route=p,this.$interval=m,this.configs=t,this.authConfigs=this.configs.data.authentication,this.alerts=g,this.dialogService=v,this.alerts.resetAlert("authenticationNotice"),this.uibModalInstance=null,this.authenticateWithRedirect=!0,this.configProviders=this.configs.data.savedSearchAndItems.providers,this.isVpnAuthenticated=this.configs.data.vpnBanner.authenticated,this.isAuthenticationEnabled=this.authConfigs.enabled||this.configProviders.length||this.configs.data.rtaAvailability.isSierraClient||this.authConfigs.samlConfigurationExists,this.loginStarted=!1,this.loginPopup=null,this.scope={loginUrl:"/auth/:provider",logoutUrl:"/auth/:provider/logout",refreshUrl:"/auth/:provider/refresh",validateUrl:"/auth/:provider/validate",provider:"",loggedInStatusForBanner:!1,usernameForBanner:"",features:{},auth:{microsoft:new a("Microsoft"),google:new a("Google"),cas:new a(this.i18n.translations.LIBRARY_ACCOUNT),saml:new a(this.authConfigs.samlAlias,!0,this.authConfigs.useSamlForSearchApiAuth&&!this.authConfigs.vpnAuthenticated),lti:new a("LTI",!1,!0)},useSamlForSearchApiAuth:this.authConfigs.useSamlForSearchApiAuth,samlForPrivateSite:this.authConfigs.samlForPrivateSite},this.providers=this.determineProviders(),this.searchApiFeature=this.registerFeature("searchapi","SUMMON"),this.searchApiFeature.setProvider("lti",{}),this.scope.useSamlForSearchApiAuth&&!this.authConfigs.vpnAuthenticated&&this.searchApiFeature.setProvider("saml",{})}init(){return this.$log.debug("authenticationservice init"),this.$rootScope.$on(this.$authEvents.LOGOUTSUCCESS,this.logoutSuccessHandler),this.$rootScope.$on(this.$authEvents.LOGINAFTERPOPUP,this.checkIfValidateRequestNeeded),this.$rootScope.$on(this.$authEvents.LOGINSUCCESS,this.loginSuccessHandler),this.$rootScope.$on(this.$authEvents.LOGOUTAFTERPOPUP,((e,t)=>this.afterLogout(t.provider,!1))),this.$rootScope.$on(this.$authEvents.NOTAUTHENTICATED,this.notAuthenticatedHandler),this.$rootScope.$on(this.$authEvents.LOGINEXPIRED,this.loginExpiredHandler),this.$rootScope.$on("$routeChangeStart",this.authenticationRouteChangeHandler),this.$rootScope.$on("$routeChangeError",this.handleRouteErrors),this.hookLocalStorage(),this.loginStarted=!1,this.authenticateWithRedirect=this.authConfigs.onlyUseRedirect||this.$window.bowser.mobile&&!(this.$window.bowser.ios&&this.$window.bowser.safari),this.updateFeaturesWithLoginState()}determineProviders(){const e=[];for(var t in this.authConfigs.casConfigurationExists&&e.push("cas"),this.authConfigs.samlConfigurationExists&&e.push("saml"),this.authConfigs.ltiConfigurationExists&&e.push("lti"),s.map(this.authConfigs.oAuthProviders,(t=>e.push(t.toLowerCase()))),this.scope.auth)this.scope.auth[t].enabled=e.includes(t);return e}registerFeature(e,t,i){if(!t)throw new Error(`Feature ${e} needs a translation ID!`);i||(i=`${t}_DESCRIPTION`);const s=new r(e,this.i18n.translations[t],this.i18n.translations[i],this.updateFeaturesWithLoginState);return this.scope.features[e]=s,this.updateFeaturesWithLoginState(),s}updateFeaturesWithLoginState(){for(var e in this.toggleProviderEnabledBasedOnFeature(),this.scope.features){var t=this.scope.features[e];for(var i of(t.providers=[],t.getSupportedProviders())){var s=this.scope.auth[i];if(s){var a=t.activeProvider?t.activeProvider===i:s.enabled&&s.canLoginManually;t.providers.push({name:i,displayName:s.displayName,loggedIn:s.loggedIn,enabled:a})}}}return this.scope.features}toggleProviderEnabledBasedOnFeature(){return(()=>{const e=[];for(var t in this.scope.features){var i=this.scope.features[t],s=this.getLoggedInProviderForFeature(t);s?e.push(i.activeProvider=s):e.push(i.activeProvider=null)}return e})()}setUserNameForProvider(e,t){return this.scope.auth[t].username=e}setEmailForProvider(e,t){return this.scope.auth[t].email=e}setUserNameForBanner(e){return this.scope.usernameForBanner=e}getUserForProvider(e){return this.scope.auth[e].user}getSummonOnlyForProvider(e){return this.scope.auth[e].summonOnly}providerCanLoginManually(e){return this.scope.auth[e].canLoginManually}setSierraPatronIdForProvider(e,t){return this.scope.auth[t].sierraPatronId=e}getSierraPatronIdForProvider(e){return this.scope.auth[e].sierraPatronId}isLoggedIntoSummonApi(){return!!this.isLoggedInForFeature("searchapi")||!!this.scope.useSamlForSearchApiAuth&&this.scope.auth.saml.loggedIn}authenticationRouteChangeHandler(e,t,i){const a=this.getProviderFromCallback(),r=s.map(this.providers,(e=>this.doInitializeProvider(e))),n=this.$q.all(r),o=this.$route.routes[this.$location.path()];if(this.$log.debug(`routeChangeStart, provider from URL=${a}, nextroute=${o}`),null==o?void 0:o.auth){const e=this.$location.absUrl();return o.resolve=o.resolve||{},o.resolve.auth=()=>n.then((t=>{this.$log.debug("provider init done, result",t);const i=this.isLoggedInForFeature(o.feature),s=this.shouldSkipAuthentication(o.feature);if(!i&&!s)return this.$q.reject({feature:o.feature,notAuthenticated:!0,providers:this.getProvidersForFeature(o.feature),redirectUrl:e})})).catch((t=>this.$q.reject({feature:o.feature,notAuthenticated:!0,providers:this.getProvidersForFeature(o.feature),redirectUrl:e})))}}shouldSkipAuthentication(e){return"research_assistant"==e&&this.isVpnAuthenticated}handleRouteErrors(e,t,i,s){if(s.notAuthenticated)return this.$log.debug("Not authenticated error, opening login dialog",s),e.preventDefault(),this.openLoginDialog(s.feature,s.redirectUrl).catch((e=>this.checkIfOnAuthRouteAndMoveAway()))}notAuthenticatedHandler(e,t){return this.loginError(t.provider,{msg:this.i18n.translations.AUTHENTICATION_ERROR_NOT_AUTHENTICATED}),this.updateFeaturesWithLoginState(),this.checkIfOnAuthRouteAndMoveAway()}loginExpiredHandler(e,t){return this.loginErrorWithMessageIfOnAuthRoute(t.provider,{msg:this.i18n.translations.LOG_IN_EXPIRED}),this.updateFeaturesWithLoginState(),this.checkIfOnAuthRouteAndMoveAway()}logoutSuccessHandler(e,t){return t.previousState!==this.$authEvents.UNKNOWN&&t.previousState!==this.$authEvents.LOGINEXPIRED&&t.previousState!==this.$authEvents.LOGOUTAFTEREXPIRED&&t.previousState!==this.$authEvents.SILENTLOGOUTINPROGRESS&&this.alerts.toastAlert("authenticationNotice",this.i18n.translations.LOGGED_OUT_SUCCESS,"success",this.getProviderDisplayName(t.provider)),this.updateFeaturesWithLoginState(),this.checkIfOnAuthRouteAndMoveAway()}checkIfOnAuthRouteAndMoveAway(){const e=this.$route.routes[this.$location.path()];if(null==e?void 0:e.auth)return this.$location.path("/")}loginErrorWithMessageIfOnAuthRoute(e,t){const i=this.$route.routes[this.$location.path()];if(null==i?void 0:i.auth)return this.loginError(e,t);{const i=!0;return this.loginError(e,t,i)}}checkIfValidateRequestNeeded(e,t){if(this.loginStarted)return this.loginStarted=!1,this.doValidateAfterCallback(t.provider).then((()=>(this.alerts.toastAlert("authenticationNotice",this.i18n.translations.LOG_IN_SUCCESS,"success",this.getProviderDisplayName(t.provider)),this.$route.reload())))}doInitializeProvider(e){if(this.scope.auth[e].initialized)return this.$q.resolve({provider:e,result:"already_initialized"});this.scope.auth[e].initialized=!0;const t=this.getAuthState(e);return this.$log.debug(`doInitializeProvider '${e}', current state=${t} (will perform auth checks now)`),(t===this.$authEvents.LOGININPROGRESS||"lti"===e||"saml"===e&&this.scope.samlForPrivateSite)&&this.doValidateAfterCallback(e).then((t=>(console.log(t),this.alerts.toastAlert("authenticationNotice",this.i18n.translations.LOG_IN_SUCCESS,"success",this.getProviderDisplayName(e))))).catch((e=>{console.error(e)})),t===this.$authEvents.LOGINSUCCESS?this.doRefreshToken(e,0,!0).then((()=>this.setAuthState(e,this.$authEvents.LOGINSUCCESS,!0))):(t===this.$authEvents.LOGOUTINPROGRESS||t===this.$authEvents.SILENTLOGOUTINPROGRESS?this.afterLogout(e,!0):this.isLoggedIn(e)?this.afterLogIn(e,null,!0):this.afterLogout(e),this.$q.resolve({provider:e,result:"initialized"}))}formatUrl(e,t,i=!1){let s=this.scope[t].replace(":provider",e);if(i){let e="";"80"!==this.$location.port()&&(e=`:${this.$location.port()}`),s=`${this.$location.protocol()}://${this.$location.host()}${e}${s}`}return s}hookLocalStorage(){return this.$window.addEventListener("storage",(e=>{if(/summon_auth_state/.test(e.key)){const t=e.key.replace("summon_auth_state_",""),i=e.oldValue,s=e.newValue;return this.$log.debug(`state change, provider=${t}, old=${i}, new=${s}, from store=${this.getAuthState(t)}`),this.updateScopeFromLocalStorage(t)}}))}startRefreshTimer(e,t=this.authConfigs.sessionSeconds-60){if(!this.scope.auth[e].refreshInterval)return t<60&&(this.$log.debug("reset interval to 60, it was too small",t),t=60),this.$log.debug(`starting authentication refresh timer for ${e} interval=${t}`),this.stopRefreshTimer(e),this.scope.auth[e].refreshInterval=this.$interval((()=>(this.$log.debug(`- running ${e} authentication refresh timer...`),this.doRefreshToken(e,t,!0).catch((t=>this.stopRefreshTimer(e,t.error))))),1e3*t);this.$log.debug("timer already started, not starting one again")}stopRefreshTimer(e,t=""){if(t&&this.$log.debug(`stopping authentication refresh timer for ${e}: ${t}`),this.scope.auth[e]&&this.scope.auth[e].refreshInterval)return this.$interval.cancel(this.scope.auth[e].refreshInterval),this.scope.auth[e].refreshInterval=null}getProviderFromCallback(){return this.$location.search().auth_provider}doValidateAfterCallback(e,t){const i=this.$q.defer();return this.$log.debug("Validate after callback "+e),null==e&&(e=this.getProviderFromCallback()),null!=e?this.$http.post(this.formatUrl(e,"validateUrl")).then((t=>(this.$log.debug("validate callback success",t.data),t={user:t.data.uid,expiry:t.data.expiry,csrf:t.data.csrf,provider:e,access_token:t.data.access_token,access_expiry:t.data.access_expiry,display_name:t.data.display_name},this.afterLogIn(e,t),i.resolve({provider:e,result:"validate_success"})))).catch((t=>("lti"==e||"saml"==e&&this.scope.samlForPrivateSite||(this.afterLogout(e,!1),this.loginError(e,{msg:this.i18n.translations.AUTHENTICATION_ERROR_REFRESH_ERROR,error:t})),i.reject({provider:e,result:"validate_error",error:t})))):i.reject({provider:e,result:"validate_error",error:"no provider provided"}),i.promise}doRefreshToken(e,t=300,i=!1){const s=this.$q.defer();this.$log.debug(`doRefreshToken for '${e}, refresh seconds: ${t}, force=${i}`);const a=this.getAuthValue(e,"csrf");if(i||this.isAuthExpired(e,t))this.getAuthState(e)===this.$authEvents.LOGINEXPIRED?(this.logoutAfterExpire(e),s.reject({error:"login expired, cannot refresh token"})):this.$http.get(this.formatUrl(e,"refreshUrl"),{headers:{"X-CSRF-Token":a}}).then((t=>(this.$log.debug("refresh token successful",t.data),t={user:t.data.uid,expiry:t.data.expiry,csrf:t.data.csrf,provider:e,access_token:t.data.access_token,access_expiry:t.data.access_expiry,display_name:t.data.display_name},this.afterLogIn(e,t,!0),this.$rootScope.$broadcast("csrfTokenRefreshed",{provider:e,csrf:t.csrf,user:t.user}),s.resolve(t)))).catch((t=>(this.$log.error("update token error, logging out",t),this.afterLogout(e),this.loginError(e,{msg:this.i18n.translations.AUTHENTICATION_ERROR_REFRESH_ERROR,error:t}),s.reject({error:"refresh error, not logged in",original:t}))));else{this.$log.debug(`refreshing token not necessary yet (still within ${t})`);const i={user:this.getAuthState(e,"user"),expiry:this.getAuthState(e,"expiry"),csrf:this.getAuthState(e,"csrf"),provider:e};s.resolve(i)}return s.promise}setAppState(e){return null===e?this.$window.localStorage.setItem("summon_app_state","{}"):this.$window.localStorage.setItem("summon_app_state",e)}getAppState(){return this.$window.localStorage.getItem("summon_app_state")}getAuthState(e){let t;const i=this.$window.localStorage.getItem("summon_auth_state_"+e);return t=i,s.values(this.$authEvents).includes(t)?i:(this.$log.debug("GetAuthstate got empty auth state, returning UNKNOWN",i),this.$authEvents.UNKNOWN)}shouldBroadcastAuthstateChange(e,t,i){return i||e!==t&&e!==this.$authEvents.UNKNOWN}setAuthState(e,t,i=!1){let a;if(this.$log.debug("setAuthState for "+e+" state: "+t),a=t,!s.values(this.$authEvents).includes(a))throw new Error(`Trying to set invalid auth state '${t}'`);const r=this.getAuthState(e);if(t===this.$authEvents.LOGINSUCCESS?this.scope.auth[e].loggedIn=!0:this.scope.auth[e].loggedIn=!1,this.$window.localStorage.setItem(`summon_auth_state_${e}`,t),this.shouldBroadcastAuthstateChange(r,t,i))return this.$log.debug(`setAuthState - broadcasting state=${t}, provider=${e}, forced?=${i}`),this.$rootScope.$broadcast(t,{provider:e,forced:i,previousState:r})}getLoggedInProviderForFeature(e){const t=this.getLoggedInProvidersForFeature(e);return t.length?t[0]:null}getLoggedInProvidersForFeature(e){const t=s.filter(this.providers,(t=>this.scope.auth[t].loggedIn&&this.providerSupportsFeature(t,e)));return this.scope.features[e]&&this.scope.features[e].activeProvider?s.filter(t,(t=>t===this.scope.features[e].activeProvider)):t}isLoggedInForFeature(e){return!!this.getLoggedInProviderForFeature(e)}providerSupportsFeature(e,t){var i;return s.includes(null===(i=this.scope.features[t])||void 0===i?void 0:i.getSupportedProviders(),e)}getFeaturesForProvider(e){const t=[];for(var i of s.keys(this.scope.features))this.providerSupportsFeature(e,i)&&t.push(this.scope.features[i]);return t}getProvidersForFeature(e){const t=s.filter(this.providers,(t=>this.providerSupportsFeature(t,e)));return 0===t.length?null:t}getProviderForFeature(e){const t=this.getProvidersForFeature(e);return null==t||0===t.length?null:t[0]}getAuthValue(e,t){const i=this.$window.localStorage.getItem(`summon_${e}`);try{if(i){const e=JSON.parse(i);if("object"==typeof e&&t in e)return e[t]}}catch(e){return this.$log.error("getAuthValue error",e),null}return null}setAuthValue(e,t){return null===t?this.$window.localStorage.removeItem(`summon_${e}`):this.$window.localStorage.setItem(`summon_${e}`,JSON.stringify(t))}updateScopeFromLocalStorage(e){const t=this.getAuthState(e);return t!==this.$authEvents.LOGINAFTERREDIRECT&&t!==this.$authEvents.LOGINAFTERPOPUP&&t!==this.$authEvents.UNKNOWN&&(this.scope.auth[e].expiry=this.getAuthValue(e,"expiry"),this.scope.auth[e].user=this.getAuthValue(e,"user"),this.scope.auth[e].csrf=this.getAuthValue(e,"csrf"),this.scope.auth[e].accessToken=this.getAuthValue(e,"access_token"),this.scope.auth[e].accessExpiry=this.getAuthValue(e,"access_expiry"),this.scope.auth[e].username=this.getAuthValue(e,"display_name"),this.scope.auth[e].email=this.getAuthValue(e,"email"),this.scope.auth[e].loggedIn=t===this.$authEvents.LOGINSUCCESS),this.$timeout((()=>(this.$log.debug("broadcasting ",t,{provider:e}),this.$rootScope.$broadcast(t,{provider:e}))),100)}isLoggedIn(e){if(!e)return!1;this.$log.debug("islogged in called for "+e);const t=this.getAuthState(e);return t!==this.$authEvents.LOGOUTINPROGRESS&&t!==this.$authEvents.LOGOUTSUCCESS&&t!==this.$authEvents.SILENTLOGOUTINPROGRESS&&!this.isAuthExpired(e,0)&&this.scope.auth[e].loggedIn}login(e,t,i=this.$window.location.href){if(!1===this.scope.features[e].enabled)return void this.loginError(t,"Feature not supported for this provider");if(this.scope.features[e].activeProvider)return void this.loginError(t,"Already an active provider for this feature");this.loginInProgress=!0,this.setAuthState(t,this.$authEvents.LOGININPROGRESS);const s=this.formatUrl(t,"loginUrl",!0);this.loginStarted=!1;const a=this.scope.features[e].loginParamsForProvider(t);let r="";if(a&&(r="&"+$.param(a)),this.authenticateWithRedirect)return this.$log.debug("*** login start for "+t+" redirect to: "+i),this.storeAppState(),this.$window.location.href=`${s}?redirect=${encodeURIComponent(i)}&source=redirect`+r;{this.$log.debug("*** login start for "+t);const e="saml"===t?s:`${s}?source=popup&redirect=${encodeURIComponent(i)}`+r;return this.openPopupWindow(e).then((e=>{this.getAuthState(t)===this.$authEvents.LOGININPROGRESS&&"canceled"===e&&this.setAuthState(t,this.$authEvents.LOGINCANCELED)})),this.loginStarted=!0}}loginToSummonWithSaml(){this.login("searchapi","saml")}logout(e,t,i,s=!1,a=!0){let r="";return i&&(r=`&redirect=${encodeURIComponent(i)}`),this.alerts.resetToastAlert("authenticationNotice"),this.setAuthState(t,a?this.$authEvents.LOGOUTINPROGRESS:this.$authEvents.SILENTLOGOUTINPROGRESS),this.$http.get(`${this.formatUrl(t,"logoutUrl")}?localOnly=${s}${r}`).then((e=>{this.redirectIfRedirectUrl(e.data.redirect_url)})).finally((()=>{if(this.afterLogout(t,a),s)return this.closeLogoutDialog(e,t)}))}redirectIfRedirectUrl(e){e&&this.$window.location.replace(e)}openPopupWindow(e){const t=this.$q.defer(),i=angular.element(this.$window);if(null===this.loginPopup||this.loginPopup.closed){const a=i.height(),r=i.width();!r&&0!==r||!a&&0!==a||(this.loginPopup=this.$window.open(e,"SummonAuthenticatePopup",`location=no,width=${r-60},height=${a-60},left=30,top=30`));const n=()=>{if(this.loginPopup.closed)return this.$interval.cancel(s),this.$log.debug("popup window closed: ",e),t.resolve("canceled")};var s=this.$interval(n,1e3)}else this.loginPopup.focus();return t.promise}loginError(e,t,i=!1){return i||(this.$log.error(t),null!=t?this.alerts.toastAlert("authenticationNotice",this.i18n.translate(this.i18n.translations.LOGGED_OUT_FORCED_DUE,{reason:t.msg}),"danger",this.getProviderDisplayName(e),!0):this.alerts.toastAlert("authenticationNotice",this.i18n.translations.LOGGED_OUT_FORCED,"danger",this.getProviderDisplayName(e).true)),this.scope.auth[e].error=t.msg,this.setAuthState(e,this.$authEvents.LOGOUTAFTEREXPIRED),this.clearAuthState(e)}logoutAfterExpire(e){return this.$log.debug("afterlogout "+e),this.authConfigs.keepAuthenticatedSessionAlive&&this.stopRefreshTimer(e),this.setAuthState(e,this.$authEvents.LOGOUTAFTEREXPIRED),this.clearAuthState(e)}afterLogout(e,t=!1){return this.$log.debug("afterlogout "+e),this.authConfigs.keepAuthenticatedSessionAlive&&this.stopRefreshTimer(e),this.setAuthState(e,this.$authEvents.LOGOUTSUCCESS,t),this.clearAuthState(e)}clearAuthState(e,t=!0){if(this.setAuthValue(e,null),this.scope.auth[e].expiry="",this.scope.auth[e].user="",this.scope.auth[e].csrf="",this.scope.auth[e].loggedIn=!1,this.scope.auth[e].accessToken="",this.scope.auth[e].accessExpiry="",this.scope.auth[e].username="",this.scope.auth[e].email="",this.scope.loggedInStatusForBanner=!1,t)return this.optApplyPrevState()}isAuthExpired(e,t=60){if(this.getAuthState(e)===this.$authEvents.LOGINEXPIRED)return this.$log.debug("auth expired - LOGINEXPIRED state found"),this.logoutAfterExpire(e),!0;const i=parseInt(this.getAuthValue(e,"expiry"));if(isNaN(parseInt(t)))throw new Error("param is not an integer");if(isNaN(i))return this.$log.debug("auth expired - no date in localstorage"),this.logoutAfterExpire(e),!0;const s=(new Date(1e3*i)-new Date)/1e3<t;return(new Date(1e3*i)-new Date)/1e3<0&&this.setAuthState(e,this.$authEvents.LOGINEXPIRED),this.$log.debug(`auth expired = ${s}`),s&&this.logoutAfterExpire(e),s}deleteAppState(){return this.setAppState(null)}storeAppState(){return this.setAppState(JSON.stringify(this.appState.takeSnapShot()))}getPreviousAppState(){try{return JSON.parse(this.getAppState())}catch(e){return null}}optApplyPrevState(){const e=this.getPreviousAppState();if(e&&!s.isEmpty(e)){const t=()=>this.appState.params=e;return this.appState.applyStateWithSnapShot(t),this.deleteAppState()}}afterLogIn(e,t,i=!1){if(this.$log.debug(`afterlogin for: ${e}, refreshing only: ${i}`),t?(t.expiryToDate=new Date(1e3*parseInt(t.expiry)),this.scope.provider=e,this.scope.auth[e].expiry=t.expiry,this.scope.auth[e].user=t.user,this.scope.auth[e].csrf=t.csrf,this.scope.auth[e].loggedIn=!0,this.scope.auth[e].accessToken=t.access_token,this.scope.auth[e].accessExpiry=t.access_expiry,this.scope.auth[e].username=t.display_name,this.scope.auth[e].email=t.email,this.scope.loggedInStatusForBanner=!0,this.$log.debug("afterLogin - got data: ",t),this.setAuthValue(e,t)):(this.$log.debug("afterLogin - grabbing from localstorage"),this.updateScopeFromLocalStorage(e)),this.authConfigs.keepAuthenticatedSessionAlive&&this.startRefreshTimer(e),!i)return this.setAuthState(e,this.$authEvents.LOGINSUCCESS,!0),this.optApplyPrevState()}loginSuccessHandler(e,t){return this.updateFeaturesWithLoginState(),this.closeLoginDialog(t.provider)}closeLoginDialog(e){var t;return null===(t=this.uibModalInstance)||void 0===t?void 0:t.close(e)}closeLogoutDialog(e){var t;return null===(t=this.uibModalInstance)||void 0===t?void 0:t.close(e)}checkLogoutHappened(e){return this.$log.info("Check if logout is needed?")}openLogoutDialog(e,t,i){const a=this.getLoggedInProviderForFeature(e);if(!a)return this.$log.error("logout dialog called for feature but not logged in",e,i,a),this.alerts.toastAlert("authenticationNotice",this.i18n.translations.LOGGED_OUT_ALREADY,"warning",this.getProviderDisplayName(a)(!0)),this.afterLogout(t,!0),this.$q.resolve();const r=s(this.providers).some((e=>this.getAuthState(e)===this.$authEvents.LOGINEXPIRED))?"LOG_IN_EXPIRED":"";return this.uibModalInstance=this.$uibModal.open({templateUrl:"/assets/logoutDialog.html",controller:"authenticationController",controllerAs:"vm",resolve:{feature:()=>e,reason:()=>r,redirectUrl:()=>i,provider:()=>({provider:a,display:this.getProviderDisplayName(a),summonOnly:this.getSummonOnlyForProvider(a)})},backdrop:!0,keyboard:!0,windowClass:"authentication-modal"}),this.uibModalInstance.result.then((e=>this.checkLogoutHappened(t))).catch((e=>this.checkLogoutHappened(t)))}openRetryDialog(e,t){return this.uibModalInstance=this.$uibModal.open({templateUrl:"/assets/retryLoginDialog.html",controller:"authenticationController",controllerAs:"vm",resolve:{feature:()=>e,provider:()=>t},backdrop:!0,keyboard:!0,windowClass:"authentication-modal"}),this.uibModalInstance.result}getProviderDisplayName(e){return"object"==typeof e?e.displayName?e.displayName:"":this.scope.auth[e]&&this.scope.auth[e].displayName?this.scope.auth[e].displayName:""}openLoginDialog(e,t=this.$window.location.href){const i=[];s.each(this.getProvidersForFeature(e)||[],(e=>i.push({provider:e,display:this.getProviderDisplayName(e),canLoginManually:this.providerCanLoginManually(e),name:e})));const a=s(this.providers).some((e=>this.getAuthState(e)===this.$authEvents.LOGINEXPIRED))?"LOG_IN_EXPIRED":"";return this.uibModalInstance=this.$uibModal.open({templateUrl:"/assets/institutionLoginDialog.html",controller:"authenticationController",controllerAs:"vm",resolve:{reason:()=>a,feature:()=>e,redirectUrl:()=>t,providers:()=>i},backdrop:!0,keyboard:!0,windowClass:"authentication-modal"}),this.uibModalInstance.result.then((e=>{if(this.getAuthState(e||provider)!==this.$authEvents.LOGINSUCCESS)return this.checkIfOnAuthRouteAndMoveAway()}))}}n.$inject=["$window","configService","translationService","$log","$q","$location","appStateService","$http","$rootScope","$authEvents","$uibModal","$timeout","$route","$interval","alertService","dialogService"],angular.module("summonApp.services").service("authenticationService",n)},1116:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.getUrl=this.getUrl.bind(this),this.getAzSearchUrl=this.getAzSearchUrl.bind(this),this.updateTopics=this.updateTopics.bind(this),this.prioritizeResults=this.prioritizeResults.bind(this),this.transformResponse=this.transformResponse.bind(this),this.i18n=t,this.l10n=i,this.config=e.data.autocomplete,this.azDatabaseProxyUrl=e.data.widgets.azDatabaseProxyUrl,this.defaultTopicPriority=["credo","eb","gale","netadvance","worldbook","wikipedia"],this.topicsDisplay=s.map(this.config.topicsDisplay,(e=>e.name.slice(0,e.name.indexOf("_label"))))}getUrl(){const e=this.l10n.getStandardLocale();let t=`${this.config.url}client=${this.config.libhash}&size=${this.config.numResults}&hl=true&language=${e.split("-")[0]}`;return this.config.dbRecsEnabled||(t+="&index[]=best-bets&index[]=popular-searches&index[]=topics"),t}getAzSearchUrl(e="suggest"){const t="search"===e;let i="";return this.azDatabaseProxyUrl&&(i=`&proxy=${encodeURIComponent(this.azDatabaseProxyUrl)}`),`${this.config.azSearchUrl}/${e}?hl=${t}&client=${this.config.libhash}${i}`}updateTopics(e){const t=this.config.topicSourcePriority||this.defaultTopicPriority;return s.chain(e).map((e=>{var i,a,r;if(this.topicsDisplay.includes("encyclopedia")||delete e.encyclopedia,this.topicsDisplay.includes("recommended_research_guides")||delete e.libguide,this.topicsDisplay.includes("related_topics")||delete e.relatedTopics,null!=e.encyclopedia){const i=s.filter(e.encyclopedia,(e=>(e.order=t.indexOf(e.source),e.order>-1)));e.encyclopedia=s.sortBy(i,(e=>e.order))}return e.text=e.topic,(null===(i=e.encyclopedia)||void 0===i?void 0:i.length)||(null===(a=e.libguide)||void 0===a?void 0:a.length)||(null===(r=e.relatedTopics)||void 0===r?void 0:r.length)?e:null})).compact().value()}prioritizeResults(e){let t=this.config.numResults;return null!=e.topics&&(e.topics=this.updateTopics(e.topics).slice(0,2)),null!=e.bestBets&&(e.bestBets=e.bestBets.slice(0,2)),null!=e.topics&&null!=e.bestBets?(e.topics=e.topics.slice(0,1),e.bestBets=e.bestBets.slice(0,1),t-=2):null!=e.topics?t-=e.topics.length:null!=e.bestBets&&(t-=e.bestBets.length),null!=e.dbRecs&&(e.dbRecs=e.dbRecs.slice(0,2),t-=e.dbRecs.length),null!=e.popularSearches&&(e.popularSearches=e.popularSearches.slice(0,t)),e}transformResponse(e){const t=this.prioritizeResults(e),i=s.map(t,(function(e,t){let i,a;const r=t.replace(/[A-Z]/g,((e,t)=>(t>0?"-":"")+e.toLowerCase()));if(s.each(e,(function(e){var t,i;if(e.rawTitle=e.title=(null===(t=e.orig)||void 0===t?void 0:t.length)?e.orig[0]:e.parsed_text||e.text,null===(i=e.highlighted)||void 0===i?void 0:i.length)return e.title=e.highlighted[0]})),0!==e.length)switch(t){case"topics":a=1,i="library-rec";break;case"bestBets":a=2,i="library-rec";break;case"dbRecs":a=3,i="search";break;case"popularSearches":a=4,i="search"}return{groupClass:i,data:e,order:a,template:`<li ${r}-template></li>`}}));return s.chain(i).compact().sortBy("order").value()}}a.$inject=["configService","translationService","localizationService"],angular.module("summonApp.services").service("autocompleteService",a)},2257:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.reset=this.reset.bind(this),this.processNew=this.processNew.bind(this),this.processUpdate=this.processUpdate.bind(this),this.rtaLocale=this.rtaLocale.bind(this),this.getAvailability=this.getAvailability.bind(this),this.getSingleDocRTA=this.getSingleDocRTA.bind(this),this.getResultsFeedRTA=this.getResultsFeedRTA.bind(this),this.saveRTA=this.saveRTA.bind(this),this.unsaveRTA=this.unsaveRTA.bind(this),this.getRTA=this.getRTA.bind(this),this.handleNewItems=this.handleNewItems.bind(this),this.updateAvailabilityFromCache=this.updateAvailabilityFromCache.bind(this),this.getFullTextLinkDisplayText=this.getFullTextLinkDisplayText.bind(this),this.formatAdditionalLink=this.formatAdditionalLink.bind(this),this.formatLinkResolver=this.formatLinkResolver.bind(this),this.getAvailabilityInfo=this.getAvailabilityInfo.bind(this),this.data=e,this.l10nService=i,this.$http=s,this.$window=a,this.$timeout=r,this.translationService=n,this.rtaLoaded={},this.reset(),this.availabilityConfig=t.data.availability,this.aiEnabled=t.data.document.enableAIPage,this.showRtaForDbid=t.data.results.showRtaForDbid,this.data.on("new",this.processNew),this.data.on("update",this.processUpdate),o.setHooks(this,"AvailabilityService",["update"],!0)}reset(){this.availabilities||(this.availabilities={});const e=s.chain(this.availabilities).map((function(e,t){if(e.saved)return t})).compact().value();return this.availabilities=s.pick(this.availabilities,e),this.startIndex=0,this.rtaLoaded.loaded=!1}processNew(){return this.reset(),this.getResultsFeedRTA()}processUpdate(){return this.rtaLoaded.loaded=!1,this.getResultsFeedRTA()}rtaLocale(){return this.l10nService.getStandardLocale().replace(/(-.*$)/,"")}getAvailability(e){const t=this.availabilities[e];return t?{availabilities:t.availabilities||null,error:t.error||!1}:{availabilities:null,error:!1}}getSingleDocRTA(e,t=!1,i=!0){return this.getRTA([e],t,i)}getResultsFeedRTA(){let e=this.data.data.search.documents;const t=e?e.length:0;return e=e?e.slice(this.startIndex):[],this.startIndex=t,this.$timeout((()=>this.getRTA(e)),50)}checkIfRtaIsEnabledForAvailId(e){if(!e)return!1;const t=e.replace(/(...)\s.+/,"$1");return this.showRtaForDbid[t]}getAvailabilityIDs(e){const t=[];for(var i of e)if(i.availability_id&&this.checkIfRtaIsEnabledForAvailId(i.availability_id)&&t.push(i.availability_id),null!=i.peer_documents)for(var a of i.peer_documents)this.checkIfRtaIsEnabledForAvailId(a.availability_id)&&t.push(a.availability_id);return s.uniq(s.compact(t))}saveRTA(e){if(this.availabilities[e.availability_id])return this.availabilities[e.availability_id].saved=!0}unsaveRTA(e){if(this.availabilities[e.availability_id])return this.availabilities[e.availability_id].saved=!1}getRTA(e,t=!1,i=!0){const a=this.getAvailabilityIDs(e);if(0===a.length)return this.fire("update",a),this.rtaLoaded.loaded=!0;{const e={"s.id":a,uilang:this.rtaLocale(),"s.cache":i||"update"},r=$.param(e,!0);return this.$http.get(`/2.0.0/availability/${this.availabilityConfig.libHash}?${r}`,{cache:i}).then((e=>{const{data:r}=e,n=s.pluck(r.availabilityItems,"id"),o=s.zip(s.pluck(r.availabilityItems,"availabilities"),s.times(n.length,(()=>t))),l=s.map(o,(e=>s.object(["availabilities","saved"],e))),c=s.object(n,l);let h=s.difference(a,n);return h=s.object(h,s.times(h.length,(()=>({error:!0,saved:t})))),this.handleNewItems(s.extend(c,h),a,i)}),(()=>{const e=s.object(a,s.times(a.length,(()=>({error:!0,saved:t}))));return this.handleNewItems(e,a,i)}))}}handleNewItems(e,t,i){return i?(e=s.omit(e,s.keys(this.availabilities)),s.extend(this.availabilities,e)):e=s.extend(this.availabilities,e),this.fire("update",t),this.rtaLoaded.loaded=!0}updateAvailabilityFromCache(e){return this.fire("update",e)}getFullTextLinkDisplayText(e){let t;return t=e.toLowerCase(),["book","book chapter","book review","case","conference proceeding","dissertation","ebook","journal","journal article","newsletter","newspaper article","paper","report","trade publication article","ejournal","government document","magazine article"].includes(t)?this.translationService.translations.FULL_TEXT_ONLINE:this.translationService.translations.AVAILABLE_ONLINE}formatAdditionalLink(e,t){if(null==t||"string"!=typeof e)return;let i="";return t.provider_name&&(i=this.translationService.translate(t.provider_name)),{displayText:e,linkInfo:i,additionalLinkInfo:"",link:t=t.link||""}}formatLinkResolver(e){if("string"==typeof e)return{displayText:this.translationService.translations.LINK_RESOLVER,directLink:!0,link:e}}getAvailabilityInfo(e){var t,i,s;if(null==e)return;let a="",r="",n="",o="";const l=[],c=[];return o=(1===(null===(t=e.libraries)||void 0===t?void 0:t.length)?e.library:"")||(e=>{var t;if(1===(null===(t=e.databases)||void 0===t?void 0:t.length)&&this.availabilityConfig.showDatabaseInfo&&!e.databases[0].source_types.includes("Library Catalog"))return e.databases[0].name})(e)||"",!e.has_fulltext||e.is_print||null!=e.availability_id&&"book"===e.content_type.toLowerCase()?((null===(i=e.lc_call_numbers)||void 0===i?void 0:i.length)&&(this.availabilityConfig.showCallNums&&l.push(e.lc_call_numbers[0]),this.availabilityConfig.showCallNumsOnFail&&c.push(e.lc_call_numbers[0])),(null===(s=e.deweys)||void 0===s?void 0:s.length)&&(this.availabilityConfig.showDeweys&&l.push(e.deweys[0]),this.availabilityConfig.showDeweysOnFail&&c.push(e.deweys[0])),e.availability_id?(a="rta",r=this.translationService.translations.CHECK_AVAILABILITY):e.is_a_i&&this.aiEnabled&&!e.is_print?(a="ai",r=this.translationService.translations.CITATION_ONLINE):e.library||e.is_print?(a="physical",r=this.translationService.translations.CHECK_AVAILABILITY):(a="citation",r=this.translationService.translations.CITATION_ONLINE),n=r,(null==l?void 0:l.length)?n=n+", "+l.join(" "):(null==c?void 0:c.length)&&(n=n+", "+c.join(" ")),o&&(n=n+", "+o)):(a="fulltext",null!=e.link_provider&&(o=e.link_provider),n=o,r=this.getFullTextLinkDisplayText(e.content_type)),[a,r,l.join(" "),c.join(" "),n,"",o]}}a.$inject=["dataService","configService","localizationService","$http","$window","$timeout","translationService","hooksService"],angular.module("summonApp.services").service("availabilityService",a)},2232:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t){this.update=this.update.bind(this),this.sendRawData=this.sendRawData.bind(this),this.sendData=this.sendData.bind(this),this.saveGenericValues=this.saveGenericValues.bind(this),this.api=e,this.http=t,this.beaconData=null,this.genericValues=["A","I","S","SRVR","P","OP","T","O8"],this.api.on("update",this.update)}update(e){if(e.beacon_data){const t=atob(e.beacon_data)+"T="+e._elapsedTime;return this.saveGenericValues(t),this.sendRawData(t)}}sendRawData(e){return this.http.post("/beacon",btoa(e))}sendData(e){if(!this.beaconData)return;s.extend(this.beaconData,e);const t=s.map(this.beaconData,((e,t)=>`${t}=${e}`)).join("&");return this.sendRawData(t)}saveGenericValues(e){return this.beaconData=s.chain(e.split("&")).map((e=>{const[t,i]=e.split("=");if(this.genericValues.includes(t))return[t,i]})).compact().object().value()}}a.$inject=["apiService","$http"],angular.module("summonApp.services").service("beaconService",a)},5481:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.setupViewBehaviors=this.setupViewBehaviors.bind(this),this.checkSize=this.checkSize.bind(this),this.containerFocus=this.containerFocus.bind(this),this.containerUnfocus=this.containerUnfocus.bind(this),this.reset=this.reset.bind(this),this.getNewLookup=this.getNewLookup.bind(this),this.getLookup=this.getLookup.bind(this),this.successLookup=this.successLookup.bind(this),this.toggleRecommendations=this.toggleRecommendations.bind(this),this.successRecommendations=this.successRecommendations.bind(this),this.errorHandler=this.errorHandler.bind(this),this.close=this.close.bind(this),this.imActive=this.imActive.bind(this),this.data=e,this.$http=t,this.$timeout=s,this.$window=a,this.menuManager=n,this.config=i.data.bxRecommender,r.setHooks(this,"BxRecommenderService",["togglingRecommendations"]),this.bxStyle={sm:{},md:{}},this.bxClass={sm:{active:!1},md:{}},this.recommendations=[],this.showRecommendations=!1,this.loadingError=!1,this.loading=!1,this.limit=5,this.currentId="",this.token="",this.data.on("new",this.getNewLookup),this.data.on("update",this.getLookup),this.reset(),this.setupViewBehaviors()}setupViewBehaviors(){this.checkSize();let e=!1;return angular.element(this.$window).on("resize",(()=>(e&&this.$timeout.cancel(e),e=this.$timeout((()=>(this.checkSize(),e=!1)),100))))}checkSize(){return this.currentBehavior=(()=>{switch(!1){case this.$window.innerWidth<1025:return"md";case this.$window.innerWidth>=1025||this.$window.innerWidth<701:return"sm";default:return"xs"}})()}containerFocus(){"md"===this.currentBehavior&&this.menuManager.menu.thirdPanel.openMenu();const e=()=>{var e;const t=angular.element(".bxRecommenderContainer:visible .content");t.focus();const i=angular.element(".header").height(),s="sm"===this.currentBehavior?angular.element(this.callerEvent).parents(".documentSummary"):t,a=null===(e=null==s?void 0:s.offset())||void 0===e?void 0:e.top;if((a||0===a)&&(i||0===i))return angular.element("html, body").animate({scrollTop:a-i-20},750)};return this.bxClass.sm.active=!0,"sm"===this.currentBehavior?this.$timeout(e,750):this.$timeout(e,10)}containerUnfocus(){return this.bxClass.sm.active=!1}reset(){return this.close(),this.loadingError=!1,this.retrievedDocuments={}}getNewLookup(e){return this.reset(),this.getLookup(e)}getLookup(e){if(null==e.documents||!e.documents.length)return;const t=e.documents;return(e=this.compoundLookup(t)).length?this.$http.post("/2.0.0/services/bx/lookup",{bxItems:e}).then(this.successLookup):void 0}compoundLookup(e){return s.compact(e.map((e=>e.bx_open_url&&!this.retrievedDocuments.hasOwnProperty(e.id)?{docID:e.id,bxOpenURL:e.bx_open_url}:null)))}successLookup({data:e}){return this.token||(this.token=e.bxToken),e.bxIdentifiers.forEach((e=>{if(e.bxIdentifier)return this.retrievedDocuments[e.docID]=e.bxIdentifier}))}toggleRecommendations(e,t){if(null!=this.retrievedDocuments[e]){if(this.currentId!==e)return this.callerEvent=t.currentTarget,this.showRecommendations=!0,this.fire("togglingRecommendations"),this.loading=!0,this.recommendations=[],this.loadingError=!1,this.limit=5,this.currentId=e,this.$http.get(`/bx/recommendations/${this.config.libHash}/${this.retrievedDocuments[e]}/${this.token}`,{cache:!0}).then(this.successRecommendations,this.errorHandler);this.close(t)}}successRecommendations({data:e}){const t=e.documents.slice(0,10);return t.forEach((function(e){try{return e.publication_date=null!=e.publication_date?new Date(e.publication_date).getUTCFullYear():""}catch(e){}})),this.recommendations=t,this.loading=!1,this.$timeout(this.containerFocus)}errorHandler(){return this.loading=!1,this.loadingError=!0,this.bxClass.sm.active=!0}close(e){const t=function(t){return(null==e?void 0:e.currentTarget)!==t.callerEvent&&t.$timeout((()=>t.callerEvent.focus()),0),t.recommendations=[],t.showRecommendations=!1,t.currentId="",t.fire("togglingRecommendations")};return"sm"===this.currentBehavior?this.$timeout(t.call(e,this),750):t(this),this.containerUnfocus()}imActive(e){return this.currentId===e}}a.$inject=["dataService","$http","configService","$timeout","$window","hooksService","menuManagerService"],angular.module("summonApp.services").service("bxRecommenderService",a)},7802:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n){if(this.setStatus=this.setStatus.bind(this),this.checkAvailability=this.checkAvailability.bind(this),this.getSpringShareInfo=this.getSpringShareInfo.bind(this),this.email=this.email.bind(this),this.$timeout=t,this.translationService=s,this.$q=a,this.$http=r,this.chatConfig=e.data.chat,this.widgetConfig=this.chatConfig.widget,this.offlineText=this.translationService.translations.CHAT_IS_OFFLINE,this.onlineText=this.translationService.translations.CHAT_WITH_LIBRARIAN,this.scope={chat:{enabled:["libraryh3lp","springshare","questionpoint","whatsapp"].includes(this.widgetConfig.type)&&["top","right"].includes(this.chatConfig.location),email:this.chatConfig.email||"",type:this.widgetConfig.type||!1,skin:this.widgetConfig.skin||!1,locateRight:"right"===this.chatConfig.location,imageUrl:this.chatConfig.offlineImage||"",linkText:this.offlineText,hideText:this.translationService.translations.USE_EMAIL_TO_SEND_QUESTION,offlineText:this.offlineText}},this.chatScope=this.scope.chat,this.scope.chat.enabled&&void 0!==typeof jabber_resources){let e;const t=i.port()?`:${i.port()}`:"";switch(this.chatScope.cssHost=`https://${i.host()}${t}`,this.widgetConfig.type){case"libraryh3lp":var o=this.widgetConfig.queue.toLowerCase();this.widgetConfig.queue.includes("@")?(e=o,o=o.split("@")[0]):e=`${o}@chat.libraryh3lp.com`;var l=this.widgetConfig.queue.match(/^.*@chat\.(.*)\.libraryh3lp\.com$/),c=l&&l.length?`${l[1]}.`:"",h=c+"libraryh3lp.com",d=["chat.",c,"libraryh3lp.com"].join("");this.chatScope.iframeSource=`https://${c}libraryh3lp.com/chat/${e}`,this.pollingUrl=[`${i.protocol()}:/`,h,"presence/jid",o,d,"js"].join("/"),this.pollingUrl=n.trustAsResourceUrl(this.pollingUrl),this.completeCallback=()=>{if("undefined"!=typeof jabber_resources)return this.setStatus(jabber_resources&&jabber_resources.length>0&&["available","chat"].includes(jabber_resources[0].show))};break;case"springshare":this.chatScope.iid=this.widgetConfig.iid,this.getSpringShareInfo(),this.pollingUrl=`${i.protocol()}://libanswers.com/chat_client_status.php?d=0&iid=${this.widgetConfig.iid}`,this.successCallback=e=>this.setStatus(e&&e.status);break;default:this.setStatus(!0)}["questionpoint","whatsapp","libraryh3lp"].includes(this.widgetConfig.type)?"libraryh3lp"==this.widgetConfig.type&&this.loadScript():this.checkAvailability()}}setStatus(e){return this.chatScope.isAvailable=e,e?(this.chatScope.imageUrl=this.chatConfig.onlineImage||"",this.chatScope.linkText=this.onlineText):(this.chatScope.imageUrl=this.chatConfig.offlineImage||"",this.chatScope.linkText=this.offlineText)}loadScript(){const e=document.createElement("script");e.setAttribute("async","true"),e.src=this.pollingUrl,e.onload=this.completeCallback,document.body.appendChild(e),this.$timeout(this.loadScript,3e5)}checkAvailability(){return this.$http.jsonp(this.pollingUrl).then(this.successCallback||angular.noop,angular.noop).finally(this.completeCallback||angular.noop),this.$timeout(this.checkAvailability,3e5)}getSpringShareInfo(){return this.$http.jsonp(`https://libanswers.com/api_chat_info.php?iid=${this.widgetConfig.iid}`).then((e=>e?(this.chatScope.domain=e.system.domain,this.chatScope.key=e.libchat.key):(this.chatScope.domain=this.widgetConfig.domain,this.chatScope.key=this.widgetConfig.key)),(()=>(this.chatScope.domain=this.widgetConfig.domain,this.chatScope.key=this.widgetConfig.key)))}email(e){const t=this.chatScope.email,i=this.$q.defer(),{promise:s}=i,a={replyTo:e.replyTo,recipients:e.sendCopy?[t,e.replyTo]:t,subject:this.translationService.translations.QUESTION_FROM_CHAT_DIALOG,message:e.message};return this.$http.post("/email/chat",a).then((e=>i.resolve(e)),(e=>i.reject(e))),s}}e.$inject=["configService","$timeout","$location","translationService","$q","$http","$sce"],angular.module("summonApp.services").service("chatService",e)},407:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.cite=this.cite.bind(this),this.email=this.email.bind(this),this.addSenderEmailToMessageBody=this.addSenderEmailToMessageBody.bind(this),this.prepCitationExportOptions=this.prepCitationExportOptions.bind(this),this.getExportPath=this.getExportPath.bind(this),this.getNonQueryExportPath=this.getNonQueryExportPath.bind(this),this.getExternalExportPath=this.getExternalExportPath.bind(this),this.convertStyle=this.convertStyle.bind(this),this.$http=e,this.$q=t,this.$location=i,this.$window=s,this.translationService=r,this.availabilityService=n,this.recaptcha=o,this.config=a.data.citation,this.styles={citation:this.config.citation_styles.map((e=>this.convertStyle(e))),export:this.config.export_styles.map((e=>this.convertStyle(e)))},this.refworksSession=null}cite(e,t){const i={ids:this.normalize(e).map((e=>e.id)).join(","),format:t,l:this.$window.__summonLocale},s=this.$q.defer(),a={};return this.refworksSession&&(a.headers={RefWorksSession:this.refworksSession}),this.$http.get(`/citation/cite?${$.param(i)}`,a).then((e=>(this.refworksSession=e.headers("RefWorksSession"),s.resolve(e.data))),(e=>(this.refworksSession=null,s.reject(e.data)))),s.promise}email(e){const t=this.normalize(e.documents),i=t.map((e=>e.id)),s={ids:i.join(","),format:e.style,recipient:e.recipient,message:e.message,email_html:e.emailHtml,captchaValidation:this.recaptcha.get("emailCaptcha"),l:this.$window.__summonLocale};if(e.sender&&(s.message=this.addSenderEmailToMessageBody(e)),"summon"===e.style&&e.emailHtml)for(var a of(s.uilang=this.availabilityService.rtaLocale(),s.availability_ids=this.availabilityService.getAvailabilityIDs(t).join(","),s.docs_with_av_info={},t)){var r=[a].concat(a.peer_documents||[]);s.docs_with_av_info[a.id]=r.map((e=>{const t={content_type:e.content_type,link:e.link,av_info:this.availabilityService.getAvailabilityInfo(e)};return e.availability_id&&(t.availability_id=e.availability_id),t}))}return this.$http.post("/citation/email",s).then((e=>(this.recaptcha.reset(s.captchaValidation),e.data))).catch((e=>{throw this.recaptcha.reset(s.captchaValidation),e}))}addSenderEmailToMessageBody(e){let t="From: "+e.sender;return e.message&&(t+="\n\n"),t+e.message}prepCitationExportOptions(e,t){return t.forEach((t=>{switch(t.target="_blank",t.name){case"refworks":case"easybib":return t.href=this.getExternalExportPath(e,t.name);case"citace":var i=this.$location.protocol()+"://"+this.$location.host()+(this.$location.port()&&"80"!==this.$location.port()?":"+this.$location.port():"");return t.href=t.url+i+this.getNonQueryExportPath(e,"endnote");default:return t.href="none"===t.name?void 0:this.getExportPath(e,t.name,t.file_name)}}))}getExportPath(e,t,i){const s={ids:this.normalize(e).map((e=>e.id)).join(","),format:t};return i&&(s.file_name=i.toLowerCase()),`/citation/export?${$.param(s)}`}getNonQueryExportPath(e,t){return`/citation/export/${this.normalize(e).map((e=>e.id)).join(",")}/${t}`}getExternalExportPath(e,t){const i={ids:s.pluck(this.normalize(e),"id").join(",")};return`/citation/${t}?${$.param(i)}`}normalize(e){return angular.isArray(e)?e:[e]}convertStyle(e){return{name:e.alias||e.name,file_name:e.label,text:e.description?this.translationService.translate(`${e.label} (${e.description})`):this.translationService.translate(e.label),alternate:e.alternate,url:e.url}}}a.$inject=["$http","$q","$location","$window","configService","translationService","availabilityService","recaptchaService"],angular.module("summonApp.services").service("citationService",a)},5681:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.reset=this.reset.bind(this),this.getCites=this.getCites.bind(this),this.getCitedBy=this.getCitedBy.bind(this),this.getCitations=this.getCitations.bind(this),this.responseProcessor=this.responseProcessor.bind(this),this.responseErrorProcessor=this.responseErrorProcessor.bind(this),this.loadMore=this.loadMore.bind(this),this.retry=this.retry.bind(this),this.query=this.query.bind(this),this.sortType=this.sortType.bind(this),this.addWaypoint=this.addWaypoint.bind(this),this.selectWaypoint=this.selectWaypoint.bind(this),this.clearPath=this.clearPath.bind(this),this.hasCitedBy=this.hasCitedBy.bind(this),this.hasCites=this.hasCites.bind(this),this.api=e,this.types=t,this.availability=i,this.alerts=n,this.config=o,s.setHooks(this,"CitationTrailService",["citationsTriggered","citationsReset"]),r.on("new",(()=>this.reset({clearPath:!0}))),this.scope={sortType:this.sortType,path:[],nonExactResultCount:this.config.data.search.nonExactResultCount,pageSize:this.config.data.results.pageSize},this.labels={},this.labels[this.types.CITES]=a.translations.CITES,this.labels[this.types.CITED_BY]=a.translations.CITED_BY,this.reset()}reset(e={}){return e.clearPath&&(this.clearPath(),delete e.clearPath),s.extend(this.scope,{docs:[],type:!1,loading:!1,loadingError:!1,count:1/0,pn:1,typeLabel:"",sortOrder:"relevance",currentDoc:null},e),this.fire("citationsReset")}getCites(e){return this.getCitations(e,this.types.CITES)}getCitedBy(e){return this.getCitations(e,this.types.CITED_BY)}getCitations(e,t,i=1,s=!0){if(this.alerts.resetAlert("citationTrailError"),null!==this.scope.currentDoc&&this.scope.currentDoc.id!==e.id||this.scope.loading)return;this.scope.currentDoc=e,this.scope.type=t,this.scope.addWaypoint=s,this.fire("citationsTriggered"),this.scope.typeLabel=this.labels[t];const a=(()=>{switch(t){case this.types.CITES:return"cites";case this.types.CITED_BY:return"citedBy"}})();return this.scope.loading=!0,this.api[a](this.query(e,i)).then(this.responseProcessor(e,i)).catch(this.responseErrorProcessor).finally((()=>this.scope.loading=!1))}responseProcessor(e,t=1){return i=>{var a;if(null!==this.scope.currentDoc&&this.scope.currentDoc.id===e.id)if(null!=(null===(a=i.data)||void 0===a?void 0:a.documents)){const a=i.data.documents;1===this.scope.pn&&this.scope.addWaypoint&&this.addWaypoint(e,this.scope.type),this.availability.getRTA(a),s.each(a,((e,i)=>{if(e.index=i+this.scope.pageSize*(t-1)+1,s.pluck(this.scope.docs,"id").indexOf(e.id)<=-1)return this.scope.docs.push(e)})),this.scope.count=i.data.record_count}else if(this.scope.count===1/0)return this.scope.count=0}}responseErrorProcessor(){return this.scope.loadingError=!0}loadMore(e=1){if(!this.scope.loadingError)return this.getCitations(this.scope.currentDoc,this.scope.type,e)}goToTop(){window.scrollTo(0,0)}loadPage(e){this.scope.docs.forEach((e=>e.hidden=!0)),this.scope.docs.find((t=>t.index===this.scope.pageSize*(e-1)+1))?this.loadPageFromCache(e):this.loadMore(e),this.goToTop()}loadPageFromCache(e){let t=0;const i=this.scope.docs.findIndex((t=>t.index===(e-1)*this.scope.pageSize+1));t=Math.ceil(this.scope.count/this.scope.pageSize)===e?this.scope.docs.findIndex((e=>e.index===this.scope.count)):this.scope.docs.findIndex((t=>t.index===e*this.scope.pageSize));for(let e=i;e<=t;e++)this.scope.docs[e].hidden=!1}retry(){return this.scope.loadingError=!1,this.loadMore()}query(e,t=1){const i={q:`ID:${e.id}`,pn:t,ho:!1};return"relevance"!==this.scope.sortOrder&&(i.sort=this.scope.sortOrder),i}sortType(e){return this.reset({currentDoc:this.scope.currentDoc,sortOrder:e,type:this.scope.type}),this.getCitations(this.scope.currentDoc,this.scope.type,1,!1)}addWaypoint(e,t){if(null==t)throw new Error('Waypoint requires a "type"');const i={type:t,typeLabel:this.labels[t],title:e.title,id:e.id};return this.scope.path.unshift(i)}selectWaypoint(e){const t=this.scope.path[e];return this.clearPath(e),this.reset(),this.getCitations(t,t.type,1,!1)}clearPath(e=null){return this.scope.path=null!=e?this.scope.path.slice(e):[]}hasCitedBy(e){var t,i,s;return(null===(t=e.cited_by_id)||void 0===t?void 0:t.length)||(null===(i=e.cited_by_doi)||void 0===i?void 0:i.length)||(null===(s=e.cited_by_isbn)||void 0===s?void 0:s.length)}hasCites(e){var t,i,s;return(null===(t=e.cites_id)||void 0===t?void 0:t.length)||(null===(i=e.cites_doi)||void 0===i?void 0:i.length)||(null===(s=e.cites_isbn)||void 0===s?void 0:s.length)}}a.$inject=["apiService","$citationTrailTypes","availabilityService","hooksService","translationService","dataService","alertService","configService"],angular.module("summonApp.services").service("citationTrailService",a)},9666:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c,h,d){this.loginSuccessHandler=this.loginSuccessHandler.bind(this),this.logoutSuccessHandler=this.logoutSuccessHandler.bind(this),this.init=this.init.bind(this),this.signIn=this.signIn.bind(this),this.signOut=this.signOut.bind(this),this.isSignedIn=this.isSignedIn.bind(this),this.signedInProvider=this.signedInProvider.bind(this),this.signedInProviderService=this.signedInProviderService.bind(this),this.getFileId=this.getFileId.bind(this),this.getFileContents=this.getFileContents.bind(this),this.writeToFile=this.writeToFile.bind(this),this.handleApiError=this.handleApiError.bind(this),this.getProviders=this.getProviders.bind(this),this.i18n=s,this.hooksService=a,this.googleApi=r,this.microsoftApi=n,this.summonUserService=o,this.$log=l,this.$q=c,this.authService=h,this.$authEvents=d,this.configs=t.data.savedSearchAndItems,this.providers=[{name:"google",authProviders:["google"],display:"Google",loginParams:{useProviderStorage:t.data.google.useProviderStorage},serviceName:"googleApiService",service:this.googleApi},{name:"microsoft",authProviders:["microsoft"],display:"Microsoft",loginParams:{useProviderStorage:t.data.microsoft.useProviderStorage},serviceName:"microsoftApiService",service:this.microsoftApi},{name:"summon",authProviders:["saml"],display:"Summon",serviceName:"summonUserService",service:this.summonUserService,loginParams:{}}],this.scope={userDisplay:"",providers:[],isSignedIn:this.isSignedIn,signedInProvider:this.signedInProvider},e.$on(this.$authEvents.LOGINSUCCESS,this.loginSuccessHandler),e.$on(this.$authEvents.LOGOUTSUCCESS,this.logoutSuccessHandler),this.hooksService.setHooks(this,"CloudStorageService",["signIn","signOut"],!0),this.init()}loginSuccessHandler(e,t){return s.each(this.scope.providers,(i=>{if(i.authProviders.includes(t.provider))return i.service.loginSuccessHandler(e,t)}))}logoutSuccessHandler(e,t){return s.each(this.scope.providers,(i=>{if(i.authProviders.includes(t.provider))return i.service.logoutSuccessHandler(e,t)}))}init(){for(var e of((this.configs.itemsEnabled||this.configs.searchEnabled)&&this.configs.providers.length>0&&(this.featureAuthentication=this.authService.registerFeature("cloudStorage","SAVE_SEARCH_AND_ITEM","SAVE_SEARCH_DESCRIPTION")),this.providers))if(s.contains(this.configs.providers,e.name)){if(e.active=!0,e.order=this.configs.providers.indexOf(e.name),this.featureAuthentication)for(var t of e.authProviders)this.featureAuthentication.setProvider(t,e.loginParams);e.service.init(),e.service.scope.providerDisplayName&&(e.display=e.service.scope.providerDisplayName),e.canLoginManually=!1!==e.service.scope.canLoginManually,e.service.on("initSuccess",(()=>this.fire("signIn"))),e.service.on("initFailed",(()=>this.fire("signOut"))),e.service.on("signOut",(()=>this.fire("signOut")))}return this.scope.providers=s.chain(this.providers).filter((e=>e.active)).sortBy("order").value()}signIn(e){const t=s.find(this.scope.providers,(t=>t.name===e));return null!=t?this.authService.login("cloudStorage",t.authProviders[0]):this.$log.error("Invalid provider:",e)}signOut(e){const t=s.find(this.scope.providers,(t=>t.name===e));return this.authService.openLogoutDialog("cloudStorage",t.authProviders[0])}isSignedIn(){return!!this.signedInProvider()}signedInProvider(){var e;return null===(e=this.signedInProviderService())||void 0===e?void 0:e.scope}signedInProviderService(){var e;const t=this.authService.getLoggedInProviderForFeature("cloudStorage");return t?null===(e=s.find(this.scope.providers,(e=>e.authProviders.includes(t))))||void 0===e?void 0:e.service:null}getFileId(e){return this.signedInProviderService().getFileId(e).catch((e=>this.handleApiError(e)))}getFileContents(e,t){return this.signedInProviderService().getFileContents(e,t).catch((e=>this.handleApiError(e)))}writeToFile(e,t,i,s){return this.signedInProviderService().writeToFile(e,t,i,s)}handleApiError(e){return e instanceof Error&&(e.hasOwnProperty("name")||(e.name="cloudStorageApiError"),e.message=this.i18n.translations.CLOUD_STORAGE_API_ERROR+": "+e.name),this.$q.reject(e)}getProviders(){return this.providers}}a.$inject=["$rootScope","configService","storeService","translationService","hooksService","googleApiService","microsoftApiService","summonUserService","$log","$q","authenticationService","$authEvents"],angular.module("summonApp.services").service("cloudStorageService",a)},914:()=>{"use strict";class e{constructor(e){this.initialize=this.initialize.bind(this),this.pluginInit=this.pluginInit.bind(this),this.fetch=this.fetch.bind(this),this.update=this.update.bind(this),this.injector=e,this.plugins={},this.raw={},this.data={},this.initialize()}initialize(){if(!this.initialized)return this.initialized=!0,angular.module(["summonApp.factories.configs"])._invokeQueue.map((e=>e[2][0])).forEach(this.pluginInit),this.fetch(),this.update()}pluginInit(e){const t=this.injector.get(e),i=e.replace("Config","");return this.plugins[i]=t}fetch(e=window.__configData){return this.raw=e}update(){return(()=>{const e=[];for(var t in this.plugins){var i=this.plugins[t];e.push(this.data[t]=i(this.raw))}return e})()}}e.$inject=["$injector"],angular.module("summonApp.services").service("configService",e)},4613:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.setDefaultScope=this.setDefaultScope.bind(this),this.get=this.get.bind(this),this.filterResults=this.filterResults.bind(this),this.getCourseReserve=this.getCourseReserve.bind(this),this.setDefaultDetailScope=this.setDefaultDetailScope.bind(this),this.setDetailed=this.setDetailed.bind(this),this.getDetailDocs=this.getDetailDocs.bind(this),this.setAllLoaded=this.setAllLoaded.bind(this),this.areAllDetailLoaded=this.areAllDetailLoaded.bind(this),this.complementData=this.complementData.bind(this),this.handleFields=this.handleFields.bind(this),this.runSearch=this.runSearch.bind(this),this.runNewSearch=this.runNewSearch.bind(this),this.checkNewSearch=this.checkNewSearch.bind(this),this.$http=e,this.$timeout=t,this.apiService=a,this.availability=r,this.utils=n,this.fields=i.data.alma.course_reserve_fields,this.resultsConfig=i.data.results;const o=[],l={id:()=>o.push(s.translations.COURSE_ID),description:()=>o.push(s.translations.DESCRIPTION),instructor:()=>o.push(s.translations.INSTRUCTOR),section:()=>o.push(s.translations.SECTION)};this.handleFields(l),this.defaultScope={data:{},count:1/0,currentCount:0,offset:0,limit:20,page:1,allLoaded:!1,loading:!1,headers:o,loadedPagesMap:{1:0},surplussOffset:0},this.defaultDetailScope={courseReserve:{},docs:[],count:1/0,pn:1,ps:this.resultsConfig.pageSize,allLoaded:!1,loading:!1,isEndOfResults:this.isEndOfResults.bind(this)},this.setDefaultScope(),this.setDefaultDetailScope()}setDefaultScope(){return this.scope||(this.scope={q:""}),s.extend(this.scope,angular.copy(this.defaultScope))}calculateNextOffset(e){let t=1;for(let i=1;i<e;i++)i in this.scope.loadedPagesMap&&(t=i);return(e-t)*this.scope.limit+this.scope.loadedPagesMap[t]}get(e){if(this.scope.loading||this.scope.allLoaded&&!e)return;if(this.scope.loading=!0,e&&this.handlePageLoad(e))return;const{params:t,filterQuery:i}=this.createParams();return this.$http.get("/course_reserves",{params:t}).then((e=>{let t;if(0===this.scope.offset&&(this.scope.count=e.data.count),this.scope.currentCount+=s.keys(this.scope.data).length,this.scope.loading=!1,i&&(t=this.filterResults(e,i)),this.hidePriorItems(),this.complementData(null!=t?t:e.data.course_reserves),this.showItemsForPage(this.scope.page),this.scope.count<1/0&&this.scope.count>0&&!(0===e.data.count&&this.scope.offset>0)){if(this.updateOffsets(),e.data.count>0&&s.keys(this.scope.data).filter((e=>this.scope.data[e].page==this.scope.page)).length<this.scope.limit)return this.lowerHigherPageNumbers(),this.scope.loadedPagesMap[this.scope.page]>this.scope.offset-this.scope.limit?(this.setSurplussOffset(),void this.loadFromCache(this.scope.page)):this.get();this.setSurplussOffset(),this.setAllLoaded()}})).catch((()=>this.scope.loading=!1))}filterResults(e,t){const i=t.split(" ");return s.filter(e.data.course_reserves,(function(e){let t=0,a=[];a=a.concat(e.name.trim().toUpperCase().split(" ")),a=a.concat(e.code.trim().toUpperCase().split(" ")),e.instructors.map((e=>e.full_name.trim().toUpperCase())).forEach((e=>a=a.concat(e.split(" "))));const r=s.compact(a).join("");return i.forEach((function(e){const i=new RegExp(e,"ig");if(r.match(i))return t+=1})),1!==i.length?t>1:t>=1}))}getCourseReserve(e,t=angular.noop){if(!this.scope.loading)return this.scope.loading=!0,this.$http.get(`/course_reserves/${e}`).then((e=>(this.complementData([e.data]),this.scope.loading=!1,t()))).catch((()=>this.scope.loading=!1))}setDefaultDetailScope(){return this.detailScope=this.detailScope||{},s.extend(this.detailScope,angular.copy(this.defaultDetailScope))}setDetailed(e){return this.scope.data.hasOwnProperty(e)?(this.detailScope.courseReserve.id!==e&&this.setDefaultDetailScope(),s.extend(this.detailScope.courseReserve,angular.copy(this.scope.data[e])),this.getDetailDocs()):(this.setDefaultDetailScope(),this.getCourseReserve(e,(()=>this.setDetailed(e))))}getDetailDocs(e){if(this.detailScope.loading||this.areAllDetailLoaded()&&!e)return;if(e&&(this.detailScope.pn=e,this.canLoadDetailsFromCache(e)))return void this.loadDetailsFromCache(e);const t=s.pick(this.detailScope,"pn","ps"),i=[],a={CourseName:this.detailScope.courseReserve.name.trim(),CourseCodeAndSection:this.detailScope.courseReserve.code.trim()+(this.detailScope.courseReserve.section.length?"."+this.detailScope.courseReserve.section:"")};for(var r in a){var n=a[r];i.push(`${r}:"${n}"`)}return t.q=i.join(" AND "),this.detailScope.loading=!0,this.apiService.courseReserves(t).then((e=>{var t;return this.hidePriorDetails(),null!=(null===(t=e.data)||void 0===t?void 0:t.documents)?(this.availability.getRTA(e.data.documents),s.each(e.data.documents,((e,t)=>(e.hidden=!1,e.index=t+1+this.detailScope.ps*(this.detailScope.pn-1),this.detailScope.docs.push(e)))),this.detailScope.count=e.data.record_count):this.detailScope.count=0,this.detailScope.loading=!1})).catch((()=>this.detailScope.loading=!1))}setAllLoaded(){this.scope.allLoaded=this.scope.offset>=this.scope.count}areAllDetailLoaded(){return this.detailScope.allLoaded=this.detailScope.docs.length>=this.detailScope.count}isEndOfResults(){return this.detailScope.pn>=this.detailScope.count/this.detailScope.ps&&!this.detailScope.loading}loadDetailsFromCache(e){this.hidePriorDetails(),this.showCurrentDetails(e)}hidePriorDetails(){this.detailScope.docs.forEach((e=>e.hidden=!0))}showCurrentDetails(e){const t=(e-1)*this.detailScope.ps+1,i=t+this.detailScope.ps-1;this.detailScope.docs.forEach((e=>{e.index>=t&&e.index<=i&&(e.hidden=!1)}))}canLoadDetailsFromCache(e){return this.detailScope.docs.find((t=>t.index===(e-1)*this.detailScope.ps+1))}updateOffsets(){this.scope.loadedPagesMap[this.scope.page]=this.scope.offset,this.scope.offset+=this.scope.limit}setSurplussOffset(){const e=Math.max(...Object.keys(this.scope.loadedPagesMap).map((e=>+e)));this.scope.surplussOffset=this.scope.loadedPagesMap[e]-(e-1)*this.scope.limit}handlePageLoad(e){let t=!1;return this.scope.offset=this.calculateNextOffset(e),this.scope.page=e,e in this.scope.loadedPagesMap&&(this.loadFromCache(e),t=!0),t}createParams(){var e,t;const i=s.pick(this.scope,"offset","limit","q"),a=null===(e=i.q)||void 0===e?void 0:e.trim();return i.q=s.first((null===(t=i.q)||void 0===t?void 0:t.split(" "))||[]),{params:i,filterQuery:a}}loadFromCache(e){this.scope.offset=this.scope.loadedPagesMap[e]+20,this.hidePriorItems(),this.showItemsForPage(e),this.setAllLoaded(),this.scope.loading=!1}hidePriorItems(){for(let e in this.scope.data)this.scope.data[e].hidden=!0}showItemsForPage(e){for(let t in this.scope.data)this.scope.data[t].page===e&&(this.scope.data[t].hidden=!1)}lowerHigherPageNumbers(){const e=Object.keys(this.scope.loadedPagesMap).map((e=>parseInt(e,10))),t=Math.max(...e);for(let e=this.scope.page+1;e<=t;e++)e in this.scope.loadedPagesMap&&this.lowerPageNumber(e);t!=this.scope.page&&delete this.scope.loadedPagesMap[t]}lowerPageNumber(e){this.scope.loadedPagesMap[e-1]=this.scope.loadedPagesMap[e];for(let t in this.scope.data)this.scope.data[t].page===e&&this.scope.data[t].page--}complementData(e,t="<br>"){return e.forEach((e=>{if(!this.scope.data.hasOwnProperty(e.id)){const i=e.instructors.map((e=>e.full_name)).join(t),s=[],a={id:()=>s.push(e.code),description:()=>s.push(e.name),instructor:()=>s.push(i),section:()=>s.push(e.section)};this.handleFields(a),e.display=s,e.page=this.scope.page,this.scope.data[e.id]=e}}))}handleFields(e){return this.fields.forEach((t=>e[t]()))}runSearch(){return this.setDefaultScope(),this.get()}runNewSearch(){return this.scope.q="",this.runSearch()}checkNewSearch(){if(this.scope.count===1/0)return this.setDefaultScope()}}a.$inject=["$http","$timeout","configService","translationService","apiService","availabilityService","utilitiesService"],angular.module("summonApp.services").service("courseReserveService",a)},3293:()=>{"use strict";class e{constructor(e,t,i,s){this.update=this.update.bind(this),this.showMore=this.showMore.bind(this),this.showLess=this.showLess.bind(this),this.results=e,this.$timeout=t,this.menuManager=s,this.config=i.data.customSections,this.scope={sections:[],limit:this.config.defaultSectionsDisplayed,minLimit:this.config.defaultSectionsDisplayed,showMoreOptionally:this.config.showMoreEnabled,showMore:this.showMore,showLess:this.showLess},this.results.on("new",(()=>this.update()))}update(){return this.scope.limit=this.scope.minLimit,this.$timeout((()=>{if(this.scope.sections=this.results.data.search.recommendations.custom_sections||[],this.menuManager.menu.thirdPanel.updateContent("customSections",this.scope.sections.length>0),!this.scope.showMoreOptionally)return this.scope.limit=this.scope.sections.length}))}showMore(){return this.scope.limit=this.scope.sections.length}showLess(){return this.scope.limit=this.scope.minLimit}}e.$inject=["dataService","$timeout","configService","menuManagerService"],angular.module("summonApp.services").service("customSectionsService",e)},9804:()=>{"use strict";class e{constructor(e,t,i,s){this.reset=this.reset.bind(this),this.api=e,this.data={},this.viewState=i,this.$window=s,this.reset(),this.api.on("update",((e,t)=>{if(!t)return this.update(e)})),t.setHooks(this,"DataService",["new","update"])}update(e){var t;if(this.data.updateType&&(this.data.updateType=null),e.query&&this.viewState.scopeBuilderMode&&this.$window.parent.postMessage({params:e.query.query_string},"*"),e.query)return this.data.search=e,this.fire("new",e);{let i=!1;if(null!=e.documents?(this.data.updateType="documents",this.data.search.documents.push.apply(this.data.search.documents,e.documents),i=!0):(null===(t=this.data.search.documents)||void 0===t?void 0:t.length)||(i=!0),this.data.detailDocument=e.detail_documents?e.detail_documents[0]:null,this.data.detailDocument&&!this.data.updated&&(i=!0),null!=e.reviews&&(this.data.updateType="reviews",this.data.reviews={id:e.id,reviews:e.reviews}),null!=e.ai_documents&&(this.data.updateType="ai",this.data.aiDocuments={id:e.id,aiDocuments:e.ai_documents}),null!=e.facet_values){i=!0,this.data.facet_values||(this.data.facet_values={});const t=e.facet_values[0];this.data.facet_values[e.facet]=t}return this.data.updated=!0,void(i&&this.fire("update",e))}}reset(){return this.data.search={}}}e.$inject=["apiService","hooksService","viewStateService","$window"],angular.module("summonApp.services").service("dataService",e)},8579:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r){this.onResults=this.onResults.bind(this),this.onAppState=this.onAppState.bind(this),this.update=this.update.bind(this),this.reflect=this.reflect.bind(this),this.determinePresetSelectedYears=this.determinePresetSelectedYears.bind(this),this.setSelection=this.setSelection.bind(this),this.retrieveSince=this.retrieveSince.bind(this),this.applySelection=this.applySelection.bind(this),this.clearSelection=this.clearSelection.bind(this),this.isValidSelection=this.isValidSelection.bind(this),this.hasSelectionChanged=this.hasSelectionChanged.bind(this),this.toggleBtnDatepicker=this.toggleBtnDatepicker.bind(this),this.appState=e,this.results=t,this.events=i,this.utils=s,this.data={},this.today=new Date,this.range={start:null,end:null},this.selection={start:null,end:new Date(this.today.setHours(0,0,0,0)),selectedYears:null},this.currentSelection=angular.copy(this.selection),this.defaultPresets={"1Y":1,"3Y":3,"5Y":5,"10Y":10},this.datePresetLabels={"1Y":"_1_YEAR","3Y":"_3_YEARS","5Y":"_5_YEARS","10Y":"_10_YEARS"},this.results.on("new",this.onResults),this.appState.on("apply",this.onAppState),this.facetDatepicker={collapsed:!0},this.searchScopeService=a,r.setHooks(this,"DateRangeService",["setAdvancedSelection"])}onResults(){return this.update(this.results.data.search)}onAppState(){return this.reflectEitherParams()}update(e){return this.range.start=!!this.selection.start&&this.selection.start.getFullYear(),this.range.end=!!this.selection.end&&this.selection.end.getFullYear()}searchScopeDateIsApplied(){return!!this.appState.searchScopeParams.rf.find((e=>0===e.indexOf("PublicationDate")))}reflectEitherParams(){return this.reflect(this.appState.searchScopeParams)||this.reflect(this.appState.params)}reflect(e){let t=null,i=null;const a=s(e.rf).find((e=>0===e.indexOf("PublicationDate"))),r=new Date;if(a){const e=a.split(",")[1].replace(/\-/g,"/");[t,i]=e.split(":").map((function(e){return"*"!==e?new Date(e):null}))}const n=this.determinePresetSelectedYears(t,i);return this.setSelection({start:t,end:null===i?new Date(r.setHours(0,0,0,0)):i,selectedYears:n}),this.currentSelection=angular.copy(this.selection),this.facetDatepicker.collapsed=null===t&&null===i||n,null!==t||null!==i}determinePresetSelectedYears(e,t){if(null===e)return null;let i=!1;const s=new Date,a=s.getDate(),r=s.getMonth(),n=s.getFullYear();return(null===t||t.getDate()===a&&t.getMonth()===r&&t.getFullYear()===n)&&(i=!0),i&&e.getDate()===a&&e.getMonth()===r?n-e.getFullYear():null}setSelection(e,t=!1){t?this.fire("setAdvancedSelection",e):(this.selection.start=e.start,this.selection.end=e.end,this.selection.selectedYears=e.selectedYears)}retrieveSince(e){const t=new Date;return{start:new Date(t.getFullYear()-e,t.getMonth(),t.getDate()),end:new Date(t.setHours(0,0,0,0))}}applySelection(){this.hasSelectionChanged()&&(this.appState.params.pn=1,this.appState.applyStateWithSnapShot((()=>{if(this.currentSelection=angular.copy(this.selection),null!=this.selection.start||null!=this.selection.end){const e=this.utils.dateToFilterDate(this.selection.start),t=this.utils.dateToFilterDate(this.selection.end);this.appState.params.rf=s(this.appState.params.rf).reject((e=>0===e.indexOf("PublicationDate"))),this.appState.params.rf.push(`PublicationDate,${e}:${t}`),this.events.gaPush("refinements","add",this.appState.params.rf)}else this.appState.params.rf=[],this.events.gaPush("refinements","clear","PublicationDate")})))}checkForSearchScope(e="",t,i,s){const a=t||this.appState.searchScopeParams;return!(!a.rf||!a.rf.some((e=>e.indexOf("PublicationDate")>-1))||(this.searchScopeService.clearScopeAsSideEffect(e,i,s),0))}clearSelection(e=!0){if(this.setSelection({start:null,end:null,selectedYears:null}),e)return this.applySelection()}isValidSelection(){return null==this.selection.start||null==this.selection.end||this.selection.start<=this.selection.end}hasSelectionChanged(){return null!=this.selection.start&&null==this.currentSelection.start||null==this.selection.start&&null!=this.currentSelection.start||null!=this.selection.start&&null!=this.currentSelection.start&&this.selection.start.getTime()!==this.currentSelection.start.getTime()||null!=this.selection.end&&null==this.currentSelection.end||null==this.selection.end&&null!=this.currentSelection.end||null!=this.selection.end&&null!=this.currentSelection.end&&this.selection.end.getTime()!==this.currentSelection.end.getTime()}normalize(e){const t={};return e.forEach((e=>t[e.year]=e.count)),t}toggleBtnDatepicker(){return this.facetDatepicker.collapsed=!this.facetDatepicker.collapsed}}a.$inject=["appStateService","dataService","eventService","utilitiesService","searchScopeService","hooksService"],angular.module("summonApp.services").service("dateRangeService",a)},7474:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e){this.retrieveSince=this.retrieveSince.bind(this),this.update=this.update.bind(this),this.clear=this.clear.bind(this),this.clean=this.clean.bind(this),this.dateRangeService=e,this.pickerPrototype={date:{start:null,end:null},error:!1},this.datepicker={search:angular.copy(this.pickerPrototype),update:this.update,clear:this.clear,clean:this.clean},this.datepicker.search.date=this.dateRangeService.selection,this.datepicker.datePresets=this.dateRangeService.defaultPresets,this.datepicker.datePresetLabels=this.dateRangeService.datePresetLabels}retrieveSince(e){return s.extend(this.datepicker.search.date,this.dateRangeService.retrieveSince(e))}update(e,t,i="",s=null,a=angular.noop){const r=(i=!1,s=t)=>{if(i)"advancedSearch"===e?a():this.dateRangeService.reflectEitherParams();else if(s.selectedYears=this.dateRangeService.determinePresetSelectedYears(s.start,s.end),this.datepicker.search.date=Object.assign({},s),"refine"===e)this.dateRangeService.setSelection(s),this.dateRangeService.applySelection();else{const e=!0;this.dateRangeService.setSelection(s,e)}},n=Object.assign({},t);this.dateRangeService.checkForSearchScope(i,s,r,n)||r()}clear(e="search",t=!0){if(this.dateRangeService.checkForSearchScope()&&t)return;const i=this.datepicker[e];return i.date.start=null,i.date.end=null,i.error=!1,"search"===e?this.dateRangeService.clearSelection(t):void 0}clean(){return void 0===this.datepicker.search.date.start&&(this.datepicker.search.date.start=null),void 0===this.datepicker.search.date.end&&(this.datepicker.search.date.end=null),this.datepicker.search.error=!1}}a.$inject=["dateRangeService"],angular.module("summonApp.services").service("datepickerService",a)},1892:()=>{"use strict";class e{constructor(e,t){this.get=this.get.bind(this),this.$http=e,this.$location=t,this.session_id=null,this.endpoint="/diagnostics"}get(e=!1){const t={Accept:"application/json"};this.session_id&&(t["SUMMON-SID"]=this.session_id);const i=e?`?diagnostic=${e}`:"",s={method:"GET",url:`${this.endpoint}${i}`,headers:t};return this.$http(s).then((e=>e.data),(e=>{if(401===e.status)return this.$location.path("/")}))}}e.$inject=["$http","$location"],angular.module("summonApp.services").service("diagnosticsService",e)},4508:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.displayDialog=this.displayDialog.bind(this),this.displayModalDialog=this.displayModalDialog.bind(this),this.closeModalDialog=this.closeModalDialog.bind(this),this.$uibModal=e,this.$modalStack=t,this.isDisplayed=!1,this.isClosing=!1,this.modalInstance=null,this.viewState=i}displayDialog(e,t,i=function(e){}){if(this.isDisplayed)return;this.isDisplayed=!0,this.isClosing=!1,t.params||(t.params={});const a=this.$uibModal.open({templateUrl:"/assets/modals/"+e+".html",controller:"ModalInstanceCtrl",scope:t,backdrop:!0,keyboard:!0}),r=a.result.then((()=>(this.isDisplayed=!1,this.isClosing=!0)),(()=>(this.isDisplayed=!1,this.isClosing=!0)));return s.isFunction(i)&&i(a),r}displayModalDialog(e,t,i,s,a=!0,r=""){return this.viewState.subView=i,this.$uibModal.open({controller:t,controllerAs:"ctrl",templateUrl:"/assets/"+s,openedClass:"modal-open modal-"+i,windowClass:i+r,backdropClass:a?"modal-backdrop":void 0,animation:!0,backdrop:a,scope:e})}closeModalDialog(e){return null==e||e.preventDefault(),this.$modalStack.dismissAll("close modal")}}a.$inject=["$uibModal","$uibModalStack","viewStateService"],angular.module("summonApp.services").service("dialogService",a)},7616:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o){this.setDocument=this.setDocument.bind(this),this.clearDocument=this.clearDocument.bind(this),this.dataService=e,this.urlService=t,this.docService=i,this.config=s,this.availability=a,this.events=r,this.citationTrail=o,this.scope={doc:{},altmetrics_detail_page:this.config.data.altmetrics.altmetrics_detail_page,socialSharingServices:this.config.data.socialSharingServices,displayCitationTrail:this.config.data.results.displayCitationTrail,displayEditor:this.config.data.results.displayEditor},this.detailConfig=this.config.data.detailPage,n.setHooks(this,"DocumentDetailService",["new"]),this.dataService.on("update",(()=>{if(null!=this.dataService.data.detailDocument)return this.setDocument(this.dataService.data.detailDocument)}))}setDocument(e){this.scope.doc=e,this.scope.display_thumbnail=!1,this.scope.thumbnail_src=e.thumbnail_large||e.thumbnail_medium||e.thumbnail_small,this.scope.isAIPage=this.docService.displayAIPage(e),this.scope.isCatalogPage=this.docService.displayDetailPage(e),this.scope.summary=this.docService.getDocumentSummary(e),[this.scope.reservable,this.scope.reserveLink,this.scope.clickTrackLink]=this.docService.getReserveLinkInfo(e),this.scope.requestLink=this.docService.getIllRequestLink(e),this.scope.availabilityDocs=[e].concat(e.peer_documents||[]),this.scope.catalogLink=this.docService.getCatalogLink(this.scope.availabilityDocs),this.scope.customMessages=this.detailConfig.messages||[],this.scope.syndeticsClient=this.detailConfig.syndeticsClient,this.scope.displayCitationTrail=this.config.data.results.displayCitationTrail&&(this.citationTrail.hasCitedBy(e)||this.citationTrail.hasCites(e));const t={};(this.detailConfig.sections||[]).forEach((e=>t[e]=!0)),this.scope.sections=t,this.urlService.applyDocumentPath(e.merged_id);const i=this.availability.getAvailability(e.availability_id);return this.events.publish("actions","document:detail",{document:e}),i.availabilities||i.error||this.availability.getSingleDocRTA(e),this.fire("new")}clearDocument(){return this.scope.doc={},this.urlService.removeDocumentPath(),this.scope.displayCitationTrail=this.config.data.results.displayCitationTrail}}e.$inject=["dataService","urlService","documentService","configService","availabilityService","eventService","hooksService","citationTrailService"],angular.module("summonApp.services").service("documentDetailService",e)},4401:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.getReviews=this.getReviews.bind(this),this.getAIDocs=this.getAIDocs.bind(this),this.searchReviews=this.searchReviews.bind(this),this.searchAIDocs=this.searchAIDocs.bind(this),this.results=e,this.api=t,this.docDetail=i,this.utilities=s,this.appState=a,this.$timeout=r,this.data={reviews:{},aiDocuments:{}},n.setHooks(this,"DocumentQueryService",["new","update"],!0);const o=()=>{const{doc:e}=this.docDetail.scope;if(["Book","eBook"].includes(e.content_type)&&this.sendUpdateOrRetrieve(this.data.reviews,this.getReviews,e),this.docDetail.scope.isAIPage)return this.sendUpdateOrRetrieve(this.data.aiDocuments,this.getAIDocs,e)};o(),this.docDetail.on("new",o),this.results.on("update",(()=>{const e=this.results.data;if("reviews"===e.updateType&&(this.data.reviews[e.reviews.id]=e.reviews.reviews),"ai"===e.updateType&&(this.data.aiDocuments[e.aiDocuments.id]=e.aiDocuments.aiDocuments),["reviews","ai"].includes(e.updateType))return this.fire("update")}))}sendUpdateOrRetrieve(e,t,i){return s.chain(e).keys().contains(i.id).value()?this.$timeout((()=>this.fire("update")),100):t(i)}getReviews(e){const t={q:this.formReviewsQuery(e),id:e.id};return this.$timeout((()=>(this.api.reviews(t),this.fire("new"))),100)}getAIDocs(e){const t={q:this.formAIDocsQuery(e),id:e.id};return t.q?this.$timeout((()=>(this.api.aiDocuments(t),this.fire("new"))),100):(this.data.aiDocuments[e.id]=[],this.$timeout((()=>this.fire("update")),100))}searchReviews(e){return this.appState.applyStateWithSnapShot((()=>(this.appState.resetParams(),this.appState.params.q=this.formReviewsQuery(e),this.appState.params.fvf.push("ContentType,Book Review,f"))))}searchAIDocs(e){return this.appState.applyStateWithSnapShot((()=>(this.appState.resetParams(),this.appState.params.q=this.formAIDocsQuery(e))))}formReviewsQuery(e){return`"${this.utilities.removeHithighlightTags(e.title)}" ${this.utilities.removeHithighlightTags(e.subtitle?`AND "${e.subtitle}" `:"")}${s.pluck((e.authors||[]).concat(e.corporate_authors||[]),"fullname").join(" ")}`}formAIDocsQuery(e){return"Journal Article"!==e.content_type||s.isEmpty(e.issns)?"Book Chapter"!==e.content_type||s.isEmpty(e.isbns)?"":s.map(e.isbns,(e=>`ISBN:${e}`)).join(" OR "):s.map(e.issns,(e=>`ISSN:${e}`)).join(" OR ")}}a.$inject=["dataService","apiService","documentDetailService","utilitiesService","appStateService","$timeout","hooksService"],angular.module("summonApp.services").service("documentQueryService",a)},3215:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _=__webpack_require__(4125);class DocumentService{constructor(e,t,i,s,a,r,n){this.displayDetailPage=this.displayDetailPage.bind(this),this.getCatalogLink=this.getCatalogLink.bind(this),this.displayAIPage=this.displayAIPage.bind(this),this.getReserveLinkInfo=this.getReserveLinkInfo.bind(this),this.getIllRequestLink=this.getIllRequestLink.bind(this),this.getLinkResolver=this.getLinkResolver.bind(this),this.getComputedValues=this.getComputedValues.bind(this),this.getJournalTitleSearchLink=this.getJournalTitleSearchLink.bind(this),this.showDocumentGlanceability=this.showDocumentGlanceability.bind(this),this.getDocumentGlancebilityIcon=this.getDocumentGlancebilityIcon.bind(this),this.displayWarningGlanceability=this.displayWarningGlanceability.bind(this),this.getWarningGlanceabilityPublications=this.getWarningGlanceabilityPublications.bind(this),this.getWarningGlanceabilityNotices=this.getWarningGlanceabilityNotices.bind(this),this.checkGlanceabilityEnablmentFromCustomizer=this.checkGlanceabilityEnablmentFromCustomizer.bind(this),this.displaySecondaryPublicationsTypesSeparator=this.displaySecondaryPublicationsTypesSeparator.bind(this),this.displaySecondaryNoticeTypesSeparator=this.displaySecondaryNoticeTypesSeparator.bind(this),this.showVideoLink=this.showVideoLink.bind(this),this.getVideoLink=this.getVideoLink.bind(this),this.getDocumentSummary=this.getDocumentSummary.bind(this),this.getSimpleTitle=this.getSimpleTitle.bind(this),this.config=e,this.$filter=t,this.translationService=i,this.utils=s,this.docConfig=this.config.data.document,this.detailConfig=this.config.data.detailPage,this.linkResolver=this.config.data.bxRecommender.linkResolver,this.localizeDate=this.$filter("summonDate"),this.quickLookService=a,this.configService=r,this.journalCoverageDetailsService=n}displayDetailPage(e){if(null==e)return;const t=_.pluck(e.peer_documents,"source_types"),i=e.uris||[];return this.docConfig.enableDetailPage&&e.source_types&&e.source_types.includes("Library Catalog")&&(_.some(t,(e=>e.includes("Library Catalog")))||!t.length||1!=i.length)}getCatalogLink(e){if(null==e)return;const t=_.find(e,(e=>e.source_types.includes("Library Catalog")&&!e.has_fulltext));return null!=t?t.link:void 0}displayAIPage(e){return null!=e&&this.docConfig.enableAIPage&&e.is_a_i}getAuthors(e){return null!=e.authors&&e.authors.length?e.authors:e.corporate_authors}getReserveLinkInfo(doc){let reservable=!1,clickTrackLink=!0,reserveLink="";if(this.detailConfig.enableReserveLinks)if(doc.reserve_link_url&&doc.reserve_link_url.url)reservable=!0,reserveLink=doc.reserve_link_url.url;else{const{reserveLinks}=this.detailConfig,dbid=_.chain(reserveLinks).keys().intersection(_.pluck(doc.databases,"dbid")).first().value();if(dbid&&doc.external_document_id){let match;clickTrackLink=!1,reservable=!0;const regexString="{{(id|encodedId)(.replace([^}]+))}}",customReplace=new RegExp(regexString);if(match=reserveLinks[dbid].match(customReplace)){let modifiedId=match[2]?eval(`"${doc.external_document_id}"${match[2]}`):doc.external_document_id;match[1].match(/encodedId/)&&(modifiedId=encodeURIComponent(modifiedId)),reserveLink=reserveLinks[dbid].replace(new RegExp(regexString,"g"),modifiedId)}else reserveLink=reserveLinks[dbid].replace(/{{id}}/g,doc.external_document_id).replace(/{{encodedId}}/g,encodeURIComponent(doc.external_document_id))}else reservable=doc.from_library||!1,reserveLink=doc.link||""}return[reservable,reserveLink,clickTrackLink]}getIllRequestLink(e){if(this.detailConfig.enableIll&&this.detailConfig.illBaseUrl&&e.open_url){const t=this.detailConfig.illBaseUrl.trim().replace(/\?$/,""),i=t.includes("?")?"&":"?";return`${t}${i}${e.open_url}`}return""}getLinkResolver(e){if(this.linkResolver&&e.open_url){const t=this.linkResolver.trim().replace(/\?$/,""),i=t.includes("?")?"&":"?";return`${t}${i}${e.open_url}`}return""}getComputedValues(e){const t={},i=this.detailConfig.enableTransliterations;return t.titles=_.compact(i?[e.title].concat(e.document_titles_fl):[e.title]),t.subtitles=_.compact(i?[e.subtitle].concat(e.document_subtitles_fl):[e.subtitle]),t.publicationTitles=_.compact(i?[e.publication_title].concat(e.publication_titles_fl):[e.publication_title]),t.editions=_.compact(i?(e.editions||[]).concat(e.editions_fl):e.editions),t.pages={label:!e.content_type||"dissertation"===e.content_type.toLowerCase()||!(e.start_pages||[]).length||(e.end_pages||[]).length&&_.first(e.start_pages)!==_.first(e.end_pages)?"Pages":"Start Page",value:e.pages},e.page_count!==e.pages&&(t.pageCount=e.page_count),t.languages=_.map(e.languages,(e=>this.translationService.translate(e))),t}getJournalTitleSearchLink(e){if("Journal Article"!==e.content_type)return;const t=[];null!=e.publication_date&&t.push(this.localizeDate(e.publication_date)),null!=e.volumes&&e.volumes.length&&t.push(`${this.translationService.translations.VOLUME} ${e.volumes[0]}`),null!=e.issues&&e.issues.length&&t.push(`${this.translationService.translations.ISSUE} ${e.issues[0]}`);const i={};return i.title=e.publication_title,i.description=t.join(", "),i}showDocumentGlanceability(e){return!!this.checkGlanceabilityEnablmentFromCustomizer()&&("review_article"===e?this.translationService.translations.GLANCEABILITY_REVIEW_ARTICLE:"primary_source"===e?this.translationService.translations.GLANCEABILITY_PRIMARY_SOURCE:"preprint"===e&&this.translationService.translations.GLANCEABILITY_PRE_PRINT)}displayWarningGlanceability(e){return(null==e?void 0:e.includes("retracted_publication"))||(null==e?void 0:e.includes("withdrawn_publication"))||(null==e?void 0:e.includes("retraction_notice"))||(null==e?void 0:e.includes("withdrawal_notice"))||(null==e?void 0:e.includes("publication_exp_concern"))}getWarningGlanceabilityPublications(e){return"retracted_publication"===e?this.translationService.translations.GLANCEABILITY_RETRACTED_PUBLICATIONS:"withdrawn_publication"===e&&this.translationService.translations.GLANCEABILITY_WITHDRAWN_PUBLICATIONS}getWarningGlanceabilityNotices(e){return"retraction_notice"===e?this.translationService.translations.GLANCEABILITY_RETRACTION_NOTICE:"withdrawal_notice"===e?this.translationService.translations.GLANCEABILITY_WITHDRAWAL_NOTICE:"publication_exp_concern"===e&&this.translationService.translations.GLANCEABILITY_PUBLICATION_EXP_CONCERN}getDocumentGlancebilityIcon(e){return"review_article"===e?"reviewArticle":"primary_source"===e?"primarySource":"preprint"===e&&"prePrint"}checkGlanceabilityEnablmentFromCustomizer(){return this.config.data.document.enableGlanceability}displaySecondaryPublicationsTypesSeparator(e,t,i){if(e==t.length-1)return!1;const s=t.slice(e+1);return!(!s.includes("retracted_publication")&&!s.includes("withdrawn_publication"))}displaySecondaryNoticeTypesSeparator(e,t,i){if(e==t.length-1)return!1;const s=t.slice(e+1);return!(!s.includes("retraction_notice")&&!s.includes("withdrawal_notice"))}showVideoLink(e){var t;return"Streaming Video"===e.content_type&&(null===(t=e.uris)||void 0===t?void 0:t.length)}getVideoLink(e){return e.dbids.length!==_.difference(e.dbids,this.docConfig.videoDBIDs).length?e.uris[0]:e.link}getDocumentSummary(e){const t=[];switch(e.content_type){case"Journal Article":null!=e.publication_title&&t.push(e.publication_title),null!=e.publication_date&&t.push(this.localizeDate(e.publication_date)),null!=e.volumes&&e.volumes.length&&t.push(`${this.translationService.translations.VOLUME} ${e.volumes[0]}`),null!=e.issues&&e.issues.length&&t.push(`${this.translationService.translations.ISSUE} ${e.issues[0]}`);break;case"Book":case"eBook":null!=e.publication_series_title&&t.push(e.publication_series_title),null!=e.publication_years&&e.publication_years.length&&t.push(e.publication_years[0]),null!=e.editions&&e.editions.length&&t.push(e.editions[0]);break;case"Conference Proceedings":null!=e.meeting_names&&e.meeting_names.length&&t.push(e.meeting_names[0]),null!=e.publication_years&&e.publication_years.length&&t.push(e.publication_years[0]);break;case"Dissertation":null!=e.dissertation_schools&&e.dissertation_schools.length&&t.push(e.dissertation_schools[0]),null!=e.publication_years&&e.publication_years.length&&t.push(e.publication_years[0]);break;case"Newspaper Article":null!=e.publication_title&&t.push(e.publication_title),null!=e.publication_date&&t.push(this.localizeDate(e.publication_date)),null!=e.pages&&t.push(e.pages);break;default:null!=e.publication_title&&t.push(e.publication_title),null!=e.publication_date&&t.push(this.localizeDate(e.publication_date))}return t.join(", ")}getSimpleTitle(e){return this.utils.removeHithighlightTags(e)}getResearchResultDocument(e){if(e.thumbnail_small||(e.thumbnail_small=!1),e.thumbnail_medium||(e.thumbnail_medium=!1),e.thumbnail_large||(e.thumbnail_large=!1),e.thumbnail_small||(e.thumbnail_small=e.thumbnail_medium),e.thumbnail_small||(e.thumbnail_small=e.thumbnail_large),e.hasDetailPage=this.displayDetailPage(e)||this.displayAIPage(e),e.databases=this.quickLookService.setDatabases(e),e.simple_title=this.getSimpleTitle(e.title),e.journalCoverageSummary=this.journalCoverageDetailsService.getJournalCoverageSummary(e),e.issns&&e.issns.length){const t=e.issns[0];e.eJournalLink=this.journalCoverageDetailsService.getJournalConverageDetailEJournalLink(this.configService.data.availability,t)}if(e.isAlmaClient){const t=this.configService.data.alma.ill||this.configService.data.alma.suprima||this.configService.data.alma.citation_linker||this.configService.data.alma.journal_search;if(t){const i=new URL(t).hostname,s=this.configService.data.results.almaId,a=e.external_document_id;return e.eJournalLinkSOA=this.journalCoverageDetailsService.getJournalConverageDetailEJournalLinkSOA(i,s,a)}}return e.display_thumbnail=!(!e.thumbnail_small||"1x1"===e.thumbnail_small),e}}DocumentService.$inject=["configService","$filter","translationService","utilitiesService","quickLookService","configService","journalCoverageDetailsService"],angular.module("summonApp.services").service("documentService",DocumentService)},7576:()=>{"use strict";class e{constructor(e,t){this.alerts=e,this.translationService=t,this.clearEmailFields=this.clearEmailFields.bind(this),this.emailSuccess=this.emailSuccess.bind(this),this.emailError=this.emailError.bind(this),this.print=this.print.bind(this),this.isFormInvalid=this.isFormInvalid.bind(this),this.isEmailInvalid=this.isEmailInvalid.bind(this)}clearEmailFields(e){return e.recipient="",e.message="",e.sender="",e.emailForm.$setPristine()}emailSuccess(e){return this.alerts.pulseAlert("emailNotify",this.translationService.translations.EMAIL_SENT_SUCCESSFULLY),e.isSending=!1,this.clearEmailFields(e)}emailError(e,t,i){const s=422===e.status?e.data:"Email processing error.";return i.isSending=!1,i.translationParams={email_address:i.recipient},this.alerts.setAlert(t,s)}print(){const e=$(".screen-media-wrapper"),t=$(".print-media-wrapper"),i=$(".printable:visible").clone(),s=$('<button class="hide-print btn btn-default">Close</button>');return s.on("click",(function(){return t.hide(),t.empty(),e.show(),$(window).resize()})),t.hide(),t.append(s),t.append(i),e.hide(),t.show(),setTimeout(window.print,10)}isFormInvalid(e){var t;return this.isEmailInvalid(e,"recipient")&&(null===(t=e.recipient)||void 0===t?void 0:t.$dirty)||this.isEmailInvalid(e,"sender")&&e.sender.$dirty}isEmailInvalid(e,t){return e&&e[t]&&(e[t].$error.email||e[t].$error.required)}}e.$inject=["alertService","translationService"],angular.module("summonApp.services").service("emailService",e)},8568:()=>{"use strict";angular.module("summonApp.services").service("eventService",["$http",class{constructor(e){this.subscribe=this.subscribe.bind(this),this.publish=this.publish.bind(this),this.channels={},this.$http=e,this.endpoint="/api/usage/"}subscribe(e,t,i){return this.channels[e]||(this.channels[e]={}),this.channels[e][t]||(this.channels[e][t]=[]),this.channels[e][t].push(i)}publish(e,t,i={}){let s;if(s=this.channels[e]){let a;if((a=s["*"])&&a.forEach((s=>s(e,t,i))),a=s[t])return a.forEach((s=>s(e,t,i)))}}trackUsage(e,t){"wos"===e&&this.$http.post(`${this.endpoint}/${e}`,t)}gaPush(e,t,i,s=null,a=null){if("undefined"!=typeof _gaq&&null!==_gaq&&(_gaq.push(["_trackEvent",e,t,i,s,a]),"search"===e&&["new","advanced"].includes(t)))return _gaq.push(["_trackPageview",`/search?term=${i}`])}}])},4911:()=>{"use strict";class e{searchResults(){const e=document.createEvent("HTMLEvents");return e.initEvent("ZoteroItemUpdated",!0,!0),document.dispatchEvent(e)}}class t{static initClass(){this.prototype.hooks={searchResults:{}},this.prototype.plugins={zotero:new e}}constructor(){for(var e in this.on=this.on.bind(this),this.fire=this.fire.bind(this),this.plugins){var t=this.plugins[e];for(var i in this.hooks)t[i]&&this.on(i,e,t[i])}}on(e,t,i){return this.hooks[e][t]={callback:i}}fire(e){const t=[];Array.prototype.push.apply(t,arguments),t.splice(0,1);for(const i in this.hooks[e.name])this.hooks[e.name][i].callback.apply(null,t)}}t.initClass(),angular.module("summonApp.services").service("externalPluginsService",t)},6236:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l){this.update=this.update.bind(this),this.facetValue=this.facetValue.bind(this),this.negatedFacetValue=this.negatedFacetValue.bind(this),this.isApplied=this.isApplied.bind(this),this.isNegated=this.isNegated.bind(this),this.clear=this.clear.bind(this),this.toggle=this.toggle.bind(this),this.getFacetClasses=this.getFacetClasses.bind(this),this.removeFilterByFacetName=this.removeFilterByFacetName.bind(this),this.remove=this.remove.bind(this),this.add=this.add.bind(this),this.createFacet=this.createFacet.bind(this),this.createDateRangeValue=this.createDateRangeValue.bind(this),this.updateAppliedState=this.updateAppliedState.bind(this),this.sortFacet=this.sortFacet.bind(this),this.sortFacetCounts=this.sortFacetCounts.bind(this),this.updateCollapsedState=this.updateCollapsedState.bind(this),this.facets=this.facets.bind(this),this.getActiveFilters=this.getActiveFilters.bind(this),this.excludedDatabases=this.excludedDatabases.bind(this),this.toggleCollapsed=this.toggleCollapsed.bind(this),this.getValueToTranslate=this.getValueToTranslate.bind(this),this.results=t,this.appState=i,this.utils=s,this.events=a,this.translationService=r,this.searchScopeService=l,this.$filter=n,this.dateRange=o,this.scope={facets:[],applied:!1,activeFilters:[]},this.config=e.data,this.collapsed={},this.appState.on("apply",(e=>{"1"===e&&this.update()})),this.results.on("new",(e=>{var t;1===(null===(t=null==e?void 0:e.query)||void 0===t?void 0:t.page_number)&&this.update()})),this.i18n=this.translationService}update(){return this.scope.facets=this.facets(),this.scope.applied=s(this.scope.facets).any((e=>e.applied)),this.scope.activeFilters=this.getActiveFilters()}facetValue(e,t){return"DatabaseName"===e.name?`${e.name},${this.utils.summonEscapeWithParentesis(t)},f`:`${e.name},${this.utils.summonEscape(t)},f`}negatedFacetValue(e,t){return`${e.name},${this.utils.summonEscape(t)},t`}isApplied(e,t,i){return this.isAppliedBy(e,t,i,this.appState.params)||this.isAppliedBy(e,t,i,this.appState.searchScopeParams)}isAppliedBy(e,t,i,a){return"daysold"===e.type?s(a.rf).some((t=>t.indexOf(e.name)>-1&&t.indexOf(i.days)>-1)):"daterange"===e.type?s(a.rf).some((t=>t.indexOf(e.name)>-1)):s(a.fvf).contains(this.facetValue(e,t))}isNegated(e,t){return this.isNegatedBy(e,t,this.appState.params)||this.isNegatedBy(e,t,this.appState.searchScopeParams)}isNegatedBy(e,t,i){return"daterange"!==e.type&&"daysold"!==e.type&&s(i.fvf).contains(this.negatedFacetValue(e,t))}clear(e,t){let i="f";return"negated"===t&&(i="t"),this.appState.applyStateWithSnapShot((()=>{const t=new RegExp(`^${e.name},.*,${i}`);return this.appState.params.fvf=s(this.appState.params.fvf).reject((e=>t.test(e)))})),this.events.gaPush("refinements","clear",e.name)}toggle(e,t,i=!0){const s=this.isAppliedBy(e,t,null,this.appState.params),a=this.isNegatedBy(e,t,this.appState.params),r=this.isAppliedBy(e,t,null,this.appState.searchScopeParams),n=this.isNegatedBy(e,t,this.appState.searchScopeParams);if(!r&&!n)return this.appState.applyStateWithSnapShot((()=>(this.appState.params.pn=1,null!=i&&i!==s&&!i!==a?this.add(e,t,i):s||a?this.remove(e,t):this.add(e,t,i))));this.searchScopeService.clearScopeAsSideEffect()}getFacetClasses(e,t,i={countOnly:!0}){let s,a;return i.countOnly?(({applied:s}=t),({negated:a}=t)):(({applied:s}=e),({negated:a}=e)),{applied:s,negated:a}}removeFilterByFacetName(e,t){const i=s(this.scope.facets).find((t=>t.name===e)),a=i.counts.filter((e=>e.value===t))[0];if(!(null==a?void 0:a.fromSearchScope)){if("PublicationDate"===e)return this.dateRange.clearSelection();{const a=()=>(this.appState.params.pn=1,"NewRecords"===e?(this.appState.params.rf=s(this.appState.params.rf).reject((e=>0===e.indexOf("NewRecords"))),this.events.gaPush("refinements","clear","NewRecords")):this.remove(i,t));return this.appState.applyStateWithSnapShot(a)}}this.searchScopeService.clearScopeAsSideEffect()}remove(e,t,i={quiet:!1}){const a=this.facetValue(e,t),r=this.negatedFacetValue(e,t);if(this.appState.params.fvf=s(this.appState.params.fvf).reject((e=>e===a||e===r)),!i.quiet)return this.events.gaPush("refinements","remove",`${e.name}:${t}`),this.events.publish("actions","filters:remove",{facet:e,value:t})}add(e,t,i=!0){return this.remove(e,t,{quiet:!0}),this.appState.params.fvf.push(i?this.facetValue(e,t):this.negatedFacetValue(e,t)),this.events.gaPush("refinements","add",`${e.name}:${t}`),this.events.publish("actions","filters:add",{facet:e,value:t})}createFacet(e){const t=s.clone(e),i="daterange"===t.type?this.results.data.search.publication_date_facet:"daysold"===t.type?this.results.data.search.new_records_facet:s(this.results.data.search.facet_fields||[]).find((e=>e.display_name===t.name));if(i&&null!=i.counts&&(this.updateValues(t,i),this.updateAppliedState(t),this.updateCollapsedState(t),"daterange"===t.type||"daysold"===t.type)){const e=(e,t)=>e+t.count;t.visible=t.applied||s(t.counts).reduce(e,0)>1}return i?t:null}createDateRangeValue(){const e=this.dateRange.selection.selectedYears;return e?this.i18n.translations["DATE_PRESET_"+e+"Y"]:this.i18n.translations.CUSTOM_DATES}updateValues(e,t){let i;e.showmore=t.has_more_facets,e.fieldName=t.field_name,"daterange"===e.type&&(i=this.createDateRangeValue());const{i18n:a}=this;return e.counts=s(t.counts).map((t=>({value:"daysold"===e.type?a.translate(a.translations.LAST_X_DAYS,{x:t.days}):"daterange"===e.type?i:t.value,year:t.year,count:t.count,days:t.days})))}getValueToTranslate(e,t){return"SecondaryResourceType"===e?r.get(t):t}updateAppliedState(e){e.applied=!1,e.counts.forEach((t=>{t.applied=this.isApplied(e,t.value,t),t.negated=this.isNegated(e,t.value),t.translation=this.i18n.translate(this.getValueToTranslate(e.name,t.value)),t.selected=t.applied||t.negated,t.fromSearchScope=this.isAppliedBy(e,t.value,t,this.appState.searchScopeParams)||this.isNegatedBy(e,t.value,this.appState.searchScopeParams),e.applied=e.applied||t.applied||t.negated}));const t=s(e.counts).filter((e=>e.negated));e.negatedCount=t.length?t.length:"";const i=s(e.counts).filter((e=>e.applied));return e.appliedCount=i.length?i.length:"",this.sortFacetCounts(e)}sortFacet(e,t){return e.sortMethod=t,this.sortFacetCounts(e)}sortFacetCounts(e){if(e&&e.counts)return e.counts=(()=>{switch(e.sortMethod){case"-count":return this.$filter("orderBy")(e.counts,"-count");case"value":return this.$filter("localeSort")(e.counts,"value");case"selected":return this.$filter("orderBy")(e.counts,"-selected");case"negated":return this.$filter("orderBy")(e.counts,"-negated");case"applied":return this.$filter("orderBy")(e.counts,"-applied");default:return e.counts}})()}updateCollapsedState(e){if(e.name in this.collapsed&&(e.collapsed=this.collapsed[e.name]),e.applied)return e.collapsed=!1}facets(){const e=s(this.config.facets||[]).map((e=>this.createFacet(e)));return s(e).compact()}getActiveFilters(){const e=[];return s(this.scope.facets).forEach((function(t){if(t.applied)return s(t.counts).forEach((function(i){if(i.applied||i.negated)return i.facetGroup=t.name,e.push(i)}))})),e.concat(this.excludedDatabases(e))}excludedDatabases(e){const{utils:t}=this,i=[];return s(s(this.appState.params.fvf).filter((e=>0===e.indexOf("DatabaseName")))).forEach((function(a){const r=`${t.summonUnEscape(a.split(",")[1])}`;if(!s(e).some((e=>e.value===r)))return i.push({value:r,name:"DatabaseName",facetGroup:"DatabaseName",negated:!0})})),i}toggleCollapsed(e){return e.applied?e.collapsed=!1:e.collapsed=!e.collapsed,this.collapsed[e.name]=e.collapsed}}const r=new Map([["retracted_publication","Retracted Publication"],["retraction_notice","Retraction Notice"],["review_article","Review Article"],["preprint","Preprint"],["publication_addendum","Publication with Addendum"],["publication_corrigendum","Publication with Corrigendum"],["withdrawn_publication","Withdrawn Publication"],["withdrawal_notice","Withdrawal Notice"],["publication_exp_concern","Publication with Expression of Concern"],["primary_source","Primary Source"]]);a.$inject=["configService","dataService","appStateService","utilitiesService","eventService","translationService","$filter","dateRangeService","searchScopeService"],angular.module("summonApp.services").service("facetsService",a)},3205:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a){this.resetScope=this.resetScope.bind(this),this.send=this.send.bind(this),this.$http=e,this.$location=t,this.$feedbackTypes=i,this.$feedbackUserRoles=s,this.recaptcha=a,this.resetScope()}resetScope(){return this.scope={feedback_type:this.$feedbackTypes[1],role:this.$feedbackUserRoles[1],feedback_text:"",email:"",satisfaction_level:""}}send(){this.scope.referrer=this.$location.absUrl();const e=s.extend({},this.scope,{captchaValidation:this.recaptcha.get("feedbackCaptcha")});return this.$http.post("/feedback/submit",e).then((e=>e.data)).catch((function(e){throw e}))}feedbackTypes(){return this.$feedbackTypes}userRoles(){return this.$feedbackUserRoles}}a.$inject=["$http","$location","$feedbackTypes","$feedbackUserRoles","recaptchaService"],angular.module("summonApp.services").service("feedbackService",a)},5432:(e,t,i)=>{"use strict";var s=i(4125);i(8399);class a{static initClass(){this.prototype.authenticated=!1}}a.initClass();class r{static initClass(){this.prototype.authenticated=!0}constructor(e){this.name=e.name,this.email=e.email}}r.initClass();class n{constructor(e,t,i,s,a,r,n){this.getProfile=this.getProfile.bind(this),this.signOff=this.signOff.bind(this),this.getCallbackUrl=this.getCallbackUrl.bind(this),this.save=this.save.bind(this),this.contains=this.contains.bind(this),this.getCallBackUrlFor=this.getCallBackUrlFor.bind(this),this.setAuthenticated=this.setAuthenticated.bind(this),this.setGuest=this.setGuest.bind(this),this.$http=e,this.$q=t,this.translationService=a,this.savedItems=r,this.configs=angular.copy(i.data.flow),this.configs.banner={enabled:this.configs.enabled,signupText:this.translationService.translations.SIGN_UP_FREE},this.configs.loginText=this.translationService.translations.REFWORKS_LOG_IN,this.configs.logoutText=this.translationService.translations.LOG_OUT,this.auth={user:void 0},n.setHooks(this,"FlowService",["authChange","itemSaveCompletion"]),this.bucket=s.bucket("flowItems"),this.bucket.age()>1200&&this.bucket.clear(),this.items=this.bucket.get("items")||[]}getProfile(){const e=this.$q.defer();return e.promise.then((e=>this.setAuthenticated(e)),(()=>this.setGuest())),this.$http.get("/flow/profile").then((function(t){const{data:i}=t;return null!=i.error?e.reject("auth error"):e.resolve(i)}),(()=>e.reject("server error"))),e}signOff(){return this.bucket.clear(),this.setGuest()}getCallbackUrl(){const e=this.getCurrentUrlPrefix(),t=this.getCurrentUrl(),i=encodeURIComponent;return`${e}/flow/auth/${i(i(t))}/`}getAuthParams(){return this.$http.get("/flow/signature").then((e=>[e.data.timeStamp,e.data.signature]))}save(e=[]){const t=e.map((e=>e.id)),i={ids:t.join(",")},a=e=>this.fire("itemSaveCompletion",e),r=this.$http.post("/flow/save",i);return r.then((e=>(s.each(t,(e=>{if(!s.contains(this.items,e))return this.items.push(e)})),this.bucket.set("items",this.items),this.savedItems.items.length&&this.savedItems.clear(),a(e.data))),(function(e){const t={errorMessage:e.data.error,ids:i.ids.split(",")};return a(t)})),r}contains(e){return!!e&&s(this.items).some((t=>e.id===t))}getCurrentUrl(){return this.getCurrentUrlPrefix()+location.hash.substring(2)}getCurrentUrlPrefix(){const{href:e}=location;return e.substring(0,e.indexOf("/",8))}getCallBackUrlFor(){const e=this.getCurrentUrlPrefix(),t=this.getCurrentUrl(),i=encodeURIComponent;return`${e}/flow/auth/${i(i(t))}/`}setAuthenticated(e){return this.auth.user=new r({name:e.name,email:e.email}),this.savedItems.items.length&&this.save(this.savedItems.items),this.fire("authChange")}setGuest(){return this.auth.user=new a,this.items.length=0,this.fire("authChange")}}n.$inject=["$http","$q","configService","storeService","translationService","savedItemsService","hooksService"],angular.module("summonApp.services").service("flowService",n)},5187:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o){this.init=this.init.bind(this),this.initDriveCode=this.initDriveCode.bind(this),this.loginSuccessHandler=this.loginSuccessHandler.bind(this),this.logoutSuccessHandler=this.logoutSuccessHandler.bind(this),this.getFileId=this.getFileId.bind(this),this.getFileContents=this.getFileContents.bind(this),this.writeToFile=this.writeToFile.bind(this),this.createFileAndReturnId=this.createFileAndReturnId.bind(this),this.handleApiError=this.handleApiError.bind(this),this.i18n=i,this.$q=a,this.$log=r,this.authService=n,this.$timeout=o,this.savedSearchConfigs=e.data.savedSearchAndItems,this.retryLogin=!1,this.scope={name:"Google",userId:"",userDisplay:"",provider:"google",initialized:!1,accessToken:null},s.setHooks(this,"GoogleApiService",["initSuccess","initFailed","signOut"])}init(){if(this.savedSearchConfigs.providers.includes("google")&&this.authService.providerSupportsFeature("google","cloudStorage"))return this.scope.providerDisplayName=this.scope.name}initDriveCode(){const e=this.$q.defer();return this.$timeout((()=>gapi.client.load("https://www.googleapis.com/discovery/v1/apis/drive/v3/rest").then((()=>(gapi.client.setToken({access_token:this.scope.accessToken}),this.scope.initialized=!0,e.resolve(),this.fire("initSuccess")))).catch((t=>(console.log(t),this.scope.initialized=!1,this.fire("initFailed"),e.reject(t))))),500),e.promise}loginSuccessHandler(e,t){if(this.savedSearchConfigs.providers.includes("google")&&this.authService.providerSupportsFeature(t.provider,"cloudStorage")&&t.provider===this.scope.provider){if(this.scope.userId=this.authService.scope.auth[this.scope.provider].user,this.scope.accessToken=this.authService.scope.auth[this.scope.provider].accessToken,this.scope.userDisplay=this.authService.scope.auth[this.scope.provider].username,!this.scope.userId||!this.scope.accessToken)return this.$log.error("No userId or accessToken, cannot initialize google API"),this.scope.initialized=!1,this.fire("initFailed");this.initDriveCode()}}logoutSuccessHandler(e,t){if(t.provider===this.scope.provider){if(this.scope.userId="",this.scope.userDisplay="",this.scope.searches=[],this.retryLogin){this.retryLogin=!1;const e="cloudStorage",t="google";this.authService.openRetryDialog(e,t)}return this.fire("signOut")}}getFileId(e){const t=this.$q.defer();return gapi.client.drive.files.list({q:`name='${e}'`,spaces:"appDataFolder"}).then((i=>{const{files:s}=i.result;return 1===s.length?t.resolve(s[0].id):this.createFileAndReturnId(e)})).catch((e=>t.reject(this.handleApiError(e)))),t.promise}getFileContents(e){const t=this.$q.defer();return gapi.client.drive.files.get({fileId:e,alt:"media"}).then((e=>t.resolve(e.result))).catch((e=>t.reject(this.handleApiError(e)))),t.promise}writeToFile(e,t){const i="-------314159265358979323846",s="\r\n--"+i+"\r\n",a="\r\n--"+i+"--",r="text/json",n={mimeType:r},o=s+"Content-Type: application/json\r\n\r\n"+JSON.stringify(n)+s+"Content-Type: "+r+"\r\n\r\n"+JSON.stringify(e)+a,l=this.$q.defer(),c={path:"/upload/drive/v3/files/appDataFolder",method:"PATCH",params:{fileId:t,uploadType:"multipart"},headers:{"Content-Type":`multipart/mixed; boundary='${i}'`},body:o};return gapi.client.request(c).then((e=>l.resolve(e))).catch((e=>l.reject(this.handleApiError(e)))),l.promise}createFileAndReturnId(e){const t=this.$q.defer(),i={name:e,mimeType:"application/json",parents:["appDataFolder"]};return gapi.client.drive.files.create({resource:i}).then((e=>t.resolve(e.id))).catch((e=>t.reject(this.handleApiError(e)))),t.promise}handleApiError(e){const t=new Error;switch(t.name="googleApiService",e.status){case 403:const e="cloudStorage",i="google",s=null,a=!1,r=!1;this.authService.logout(e,i,s,a,r),this.retryLogin=!0,t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_ERROR;break;case 401:t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_ERROR;break;case 500:t.message=this.i18n.translations.CLOUD_STORAGE_API_ERROR}return e.result&&(t.message+=": "+e.result.error.message),this.$log.error("Google API Error",e),this.$q.reject(t)}}e.$inject=["configService","storeService","translationService","hooksService","$q","$log","authenticationService","$timeout"],angular.module("summonApp.services").service("googleApiService",e)},5036:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(){this.hooks={},this.hooksOnce={}}setHooks(e,t,i,s=!1){return this.populateHooksHandlers(t,i),s?this.applyIdHooksToService(e,t):this.applyHooksToService(e,t)}populateHooksHandlers(e,t){if(t.indexOf("__nonIDable")>-1)throw new Error("Can't set hooks to '__nonIDable' handler");if(!this.hooks.hasOwnProperty(e)){this.hooks[e]={__nonIDable:{}},this.hooksOnce[e]={__nonIDable:{}};for(const i of t)this.hooks[e][i]={},this.hooks[e].__nonIDable[i]=[],this.hooksOnce[e][i]={},this.hooksOnce[e].__nonIDable[i]=[]}}applyHooksToService(e,t){e.on=(e,i)=>{if(null==this.hooks[t][e])throw new Error(`Can't subscribe to '${e}': event does not exist`);if(-1===this.hooks[t].__nonIDable[e].indexOf(i))return this.hooks[t].__nonIDable[e].push(i)},e.once=(e,i)=>{if(null==this.hooksOnce[t][e])throw new Error(`Can't subscribe to '${e}': event does not exist`);return this.hooksOnce[t].__nonIDable[e].push(i)},e.off=(e,i)=>{let s;if((s=this.hooks[t].__nonIDable[e].indexOf(i))>-1)return this.hooks[t].__nonIDable[e].splice(s,1)},e.fire=(i,...s)=>{var a;let r;for(this.hooks[t].__nonIDable[i].forEach((t=>t.apply(e,s)));r=null===(a=this.hooksOnce[t].__nonIDable[i])||void 0===a?void 0:a.shift();)null==r||r.apply(e,s)}}applyIdHooksToService(e,t){e.on=(e,i,s)=>{if(null==this.hooks[t][e])throw new Error(`Can't subscribe to '${e}': event does not exist`);this.hooks[t][e][i]=s},e.once=(e,i)=>{if(null==this.hooksOnce[t][e])throw new Error(`Can't subscribe to '${e}': event does not exist`);this.hooksOnce[t][e][id]=i},e.off=(e,i)=>{if(null==this.hooks[t][e])throw new Error(`Can't unsubscribe from '${e}': event does not exist`);delete this.hooks[t][e][i]},e.fire=(i,...a)=>{s.each(this.hooks[t][i],(t=>t.apply(e,a))),s.each(this.hooksOnce[t][i],((s,r)=>{s.apply(e,a),delete this.hooksOnce[t][i][r]}))}}}a.$inject=[],angular.module("summonApp.services").service("hooksService",a)},8635:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t){this.getJournalCoverageSummary=this.getJournalCoverageSummary.bind(this),this.getJournalConverageDetailEJournalLink=this.getJournalConverageDetailEJournalLink.bind(this),this.getJournalConverageDetailEJournalLinkSOA=this.getJournalConverageDetailEJournalLinkSOA.bind(this),this.discoverTotalRangeAndItsGaps=this.discoverTotalRangeAndItsGaps.bind(this),this.isConsecutiveCoverage=this.isConsecutiveCoverage.bind(this),this.isJournalCoverageAvailable=this.isJournalCoverageAvailable.bind(this),this.$filter=e,this.$almaLanguages=t}getJournalCoverageSummary(e){var t;if(!(null===(t=e.journal_database_rights)||void 0===t?void 0:t.length))return null;e.journal_database_rights=e.journal_database_rights.filter((e=>"Library Specific Holdings"!==e.provider_name));const i=this.$filter("orderBy")(e.journal_database_rights,"date_start");return this.discoverTotalRangeAndItsGaps(i)}getJournalConverageDetailEJournalLink(e,t){return`http://${e}.search.serialssolutions.com/ejp/?libHash=${e}#/search/?searchControl=title&searchType=issn_equals&criteria=${t}&titleType=JOURNALS&filterBy=All&beginPage=0&language=en-US`}getJournalConverageDetailEJournalLinkSOA(e,t,i){if(!(e&&t&&i))return null;let s="";const a=window.__locale.substring(0,2).toUpperCase(),r=this.$almaLanguages[a];return s=r?`,language=${r}`:",language=en",`http://${e}/discovery/openurl?institution=${t}&rfr_id=info:sid/summon&rft_dat=ie=${i}${s}&svc_dat=CTO&u.ignore_date_coverage=true&vid=${t}:Services`}discoverTotalRangeAndItsGaps(e){if(!(null==e?void 0:e.length))return{};let t={start:99991231,end:0};const i=[];let a=0;const r=new RegExp("^(0|[1-9][0-9]*)$");let n=!1;return s.each(e,(e=>{var s,o;if(!(null===(s=e.date_start)||void 0===s?void 0:s.match(r))||!(null===(o=e.date_end)||void 0===o?void 0:o.match(r)))return;const l={start:+e.date_start,end:+e.date_end};return t={start:Math.min(l.start,t.start),end:Math.max(l.end,t.end)},l.start>a&&n&&!this.isConsecutiveCoverage(l.start,a)?(i.push({start:a,end:l.start}),a=l.end):a=Math.max(l.end,a),n=!0})),n?{range:t,gaps:i}:{}}isConsecutiveCoverage(e,t){if(e<=t||null==e||null==t)return!1;const i=e.toString(),s=t.toString(),a=new Date(i.substring(0,4),i.substring(4,6)-1,i.substring(6,8)),r=new Date(s.substring(0,4),s.substring(4,6)-1,s.substring(6,8)),n=a.getTime()-r.getTime();return Math.floor(n/1e3/60/60/24)<=1}isJournalCoverageAvailable(e){var t;return!!s.includes(["Journal","eJournal"],e.content_type)&&(null===(t=e.journal_database_rights)||void 0===t?void 0:t.length)}}a.$inject=["documentService","$filter","$almaLanguages"],angular.module("summonApp.services").service("journalCoverageDetailsService",["$filter","$almaLanguages",a])},9397:()=>{"use strict";angular.module("summonApp.services").service("journalTitleService",["dataService","$timeout",class{constructor(e,t){this.update=this.update.bind(this),this.clearJournalTitle=this.clearJournalTitle.bind(this),this.results=e,this.$timeout=t,this.jt={journalTitle:null,hidden:!0},this.results.on("new",this.update)}update(){const e=this.results.data.search.recommendations.journal_title||{};if(this.clearJournalTitle(),e&&e.count)return this.$timeout((()=>(this.jt.journalTitle=e.title.replace(/[:,]/g,""),this.jt.hidden=!1)),200)}clearJournalTitle(){return this.jt.journalTitle=null,this.jt.hidden=!0}}])},3234:()=>{"use strict";class e{constructor(e){this.mapDocumentToJsonld=this.mapDocumentToJsonld.bind(this),this.mapCommonProperties=this.mapCommonProperties.bind(this),this.mapSpecificProperties=this.mapSpecificProperties.bind(this),this.tryMapPropertyValue=this.tryMapPropertyValue.bind(this),this.mapIdentifier=this.mapIdentifier.bind(this),this.isArticleRelatedType=this.isArticleRelatedType.bind(this),this.mapIsPartOf=this.mapIsPartOf.bind(this),this.mapAbout=this.mapAbout.bind(this),this.mapPublisher=this.mapPublisher.bind(this),this.mapSameAs=this.mapSameAs.bind(this),this.mapIssn=this.mapIssn.bind(this),this.mapIsbn=this.mapIsbn.bind(this),this.mapCreators=this.mapCreators.bind(this),this.mapContributors=this.mapContributors.bind(this),this.mapOrganization=this.mapOrganization.bind(this),this.mapPerson=this.mapPerson.bind(this),this.mapType=this.mapType.bind(this),this.mapId=this.mapId.bind(this),this.utilitiesService=e}mapDocumentToJsonld(e){return angular.extend({},this.mapCommonProperties(e),this.mapSpecificProperties(e))}mapCommonProperties(e){var t,i,s;return{"@context":"http://schema.org","@type":this.mapType(e),"@id":this.mapId(e),creator:this.mapCreators(e),contributor:this.mapContributors(e),description:null===(i=null===(t=e.abstracts)||void 0===t?void 0:t[0])||void 0===i?void 0:i.abstract,workExample:null===(s=e.editions)||void 0===s?void 0:s[0],issn:this.mapIssn(e),isbn:this.mapIsbn(e),sameAs:this.mapSameAs(e),publisher:this.mapPublisher(e),datePublished:e.publication_date,about:this.mapAbout(e),identifier:this.mapIdentifier(e),lccallnum:this.tryMapPropertyValue(e.lc_call_numbers,"lccallnum")}}mapSpecificProperties(e){return this.isArticleRelatedType(e)?{isPartOf:this.mapIsPartOf(e)}:{name:this.utilitiesService.removeHithighlightTags(e.title)}}tryMapPropertyValue(e,t,i){if(e)return e.map((e=>(this.result={"@type":"PropertyValue",propertyID:t,value:e},i&&(this.result.sameAs=`${i}${this.result.value}`),this.result)))}mapIdentifier(e){return this.results=[],this.id=this.tryMapPropertyValue(e.oclcs,"oclc","http://www.worldcat.org/oclc/"),this.id&&(this.results=this.results.concat(this.id)),this.id=this.tryMapPropertyValue(e.pmids,"pmid","https://www.ncbi.nlm.nih.gov/pubmed/"),this.id&&(this.results=this.results.concat(this.id)),this.id=this.tryMapPropertyValue(e.lccns,"lccn","https://lccn.loc.gov/"),this.id&&(this.results=this.results.concat(this.id)),this.results}isArticleRelatedType(e){return this.type=this.mapType(e),"Article"===this.type||"NewsArticle"===this.type||"ScholarlyArticle"===this.type||"Chapter"===this.type}mapIsPartOf(e){var t,i;return{"@id":"_id",name:this.utilitiesService.removeHithighlightTags(e.title),pageStart:null===(t=e.startPages)||void 0===t?void 0:t[0],pageEnd:null===(i=e.endPages)||void 0===i?void 0:i[0],pagination:e.pages}}mapAbout(e){if(e.subject_terms)return e.subject_terms.map((e=>({"@type":"Thing",name:e})))}mapPublisher(e){if(e.publisher)return{"@type":"Organization",name:e.publisher}}mapSameAs(e){if(e.dois)return e.dois.map((e=>`http://dx.doi.org/${e}`))}mapIssn(e){return e.issns&&(this.issns=e.issns),e.eissns&&(this.issns=this.issns.concat(e.eissns)),this.issns}mapIsbn(e){return e.isbns&&(this.isbns=e.isbns),e.eisbns&&(this.isbns=this.isbns.concat(e.eisbns)),this.isbns}mapCreators(e){var t;if(null===(t=e.authors)||void 0===t?void 0:t.length)return this.mapPerson(e.authors[0])}mapContributors(e){return this.contributors=[],e.authors&&e.authors.length>1&&(this.contributors=e.authors.slice(1).map((e=>this.mapOrganization(e)))),e.corporate_authors&&(this.contributors=this.contributors.concat(e.corporate_authors.map((e=>this.mapOrganization(e))))),this.contributors}mapOrganization(e){return{"@type":"Organization",name:e.fullname}}mapPerson(e){return{"@type":"Person",name:e.fullname}}mapType(e){switch(e.content_type){case"Book Chapter":return"Chapter";case"Journal Article":case"Magazine Article":return e.is_peer_reviewed?"ScholarlyArticle":"Article";case"Photograph":return"Photograph";case"Journal":case"eJournal":case"Magazine":case"Newspaper":return"Periodical";case"Book":case"eBook":return"Book";case"Map":return"Map";case"Data Set":return"Dataset";case"Book Review":case"Magazine Article":case"Newspaper Article":return"Article";case"Music Manuscript":case"Music Score":return"MusicComposition";case"Report":return"Report";case"Film":case"Video Recording":case"DVD":return"Movie";case"Web Resource":return"WebSite";case"Dissertation":case"Student Thesis":return"Thesis";case"Drawing":return"Drawing";case"Manuscript":return"Manuscript";case"Painting":return"Painting";case"Poster":return"Poster";case"Play":return"Play";default:return"CreativeWork"}}mapId(e){return`/document?id=${e.id}`}}e.$inject=["utilitiesService"],angular.module("summonApp.services").service("jsonldService",e)},4436:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.getSources=this.getSources.bind(this),this.$http=e,this.$timeout=t,i.setHooks(this,"LinkService",["update"],!0)}getSources(e){const t={},i=e.issns&&e.issns.length;return i&&(t.issn=e.issns[0]),!i&&e.isbns&&e.isbns.length&&(t.isbn=e.isbns[0]),s.isEmpty(t)?this.$timeout((()=>this.fire("update")),100):this.$http.get(`/ext/360link?${$.param(t)}`).then((e=>this.fire("update",e.data)),(()=>this.fire("update")))}}a.$inject=["$http","$timeout","hooksService"],angular.module("summonApp.services").service("linkService",a)},3095:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o){this.getStandardLocale=this.getStandardLocale.bind(this),this.setLocalization=this.setLocalization.bind(this),this.setLocale=this.setLocale.bind(this),this.reload=this.reload.bind(this),this.createNewPath=this.createNewPath.bind(this),this.appState=e,this.urlService=t,this.configService=i,this.events=s,this.$window=a,this.$timeout=r,this.$location=n,this.translationService=o,this.localization=this.setLocalization(),this.mappings=this.$window.__localeMap}getStandardLocale(e=this.$window.__summonLocale){return null!=this.mappings[e]?this.mappings[e]:e}setLocalization(){const e=this.$window.__summonLocale,t=this.configService.data.localization,i=angular.copy(t.languages);i.forEach((e=>(e.text=this.translationService.translate(e.name),e.click=`localization.setLocale('${e.locale}')`)));let a=s(i).find((t=>t.locale===e));a||(a=s(i).find((e=>e.locale===t.defaultLanguage))),a||(a=i[0]),a||(a={locale:"en",text:"English"});const r=s.contains(["ar-AR","he-HE","fa-FA"],a.locale)?"rtl":"ltr";return{current:a,languages:i,setLocale:this.setLocale,dir:r,isRTL:"rtl"===r}}setLocale(e){const t=this.$location.search();t.l&&delete t.l;let i=$.param(t);return i.length&&(i=`?${i}`),this.events.publish("actions","language:switch",{locale:e}),this.reload(this.createNewPath(e,i))}reload(e){return this.$window.location.assign(e)}createNewPath(e,t){let i=this.$location.path(),s="";return"/library_card"===i.substring(0,13)&&(i=i.substr(13),s="#!/library_card"+t),`/${e}`+i+t+s}}a.$inject=["appStateService","urlService","configService","eventService","$window","$timeout","$location","translationService"],angular.module("summonApp.services").service("localizationService",a)},5072:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.createHelperObject=this.createHelperObject.bind(this),this.$window=t,this.$timeout=i,this.media={"(min-width: 1401px)":{size:"xl"},"(max-width: 1400px) and (min-width: 1025px)":{size:"lg"},"(max-width: 1024px) and (min-width: 701px)":{size:"md"},"(max-width: 1024px)":{size:"sm"},"(max-width: 700px)":{size:"xs"}},this._currentSize=[],this.availableSizes=["xs","sm","md","lg","xl"],this.availableSizesReversed=["xs","sm","md","lg","xl"].reverse(),this.current={},this.previous={},this.isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,e.setHooks(this,"MediaQueryService",["change"]),this.initMediaQueries()}diffSize(e,t){return this.availableSizes.indexOf(e.size)-this.availableSizes.indexOf(t.size)}createHelperObject(e){const t={hasTouch:this.isTouchDevice};let i="xs",a="xl";return s.map(this.availableSizes,(function(s){if(t[s]=e.includes(s),t[s])return i=s})),s.map(this.availableSizesReversed,(function(e){if(t[e])return a=e})),t.size=i,t.sizeSmallest=a,t}mediaChangeHandler(e){if(this._currentSize=[],s.mapObject(this.media,((e,t)=>{if(this.media[t].matchMedia=this.$window.matchMedia(t),this.media[t].matchMedia.matches)return this._currentSize.push(this.media[t].size)})),this.current=this.createHelperObject(this._currentSize),!s.isMatch(this.current,this.previous))return this.fire("change",this.current,this.diffSize(this.current,this.previous)),this.previous=angular.merge({},this.current)}initMediaQueries(){const e=this;return s.mapObject(this.media,((t,i)=>(this.media[i].matchMedia=this.$window.matchMedia(i),this.media[i].matchMedia.matches&&this._currentSize.push(this.media[i].size),this.media[i].matchMedia.onchange=e.mediaChangeHandler.bind(e)))),this.current=this.previous=this.createHelperObject(this._currentSize),this.fire("change",this.current,0)}}a.$inject=["hooksService","$window","$timeout"],angular.module("summonApp.services").service("mediaQueryService",a)},1978:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(){this.registerMenu=this.registerMenu.bind(this),this.menu={},this.subMenu={}}registerMenu(e){if(e.open=!1,e.openMenu=this.openMenu,e.closeMenu=this.closeMenu,e.pin=this.pin,e.unpin=this.unpin,e.hasContent=!0,e.updateContent=this.updateContent,e.content={},e.content={},"panel"!==e.type&&"menu"!==e.type&&"section"!==e.type||(this.menu[e.name]=e),"subMenu"===e.type||"dropdown"===e.type)return this.subMenu[e.name]=e}openMenu(e=null){return this.open=!0}updateContent(e,t){this.content[e]=t;let i=!1;if(s.mapObject(this.content,((e,t)=>{if(e)return i=!0,this.hasContent=!0})),!i)return this.hasContent=!1}closeMenu(e=null){if(null!==e&&(this.open=!1,this.pinned=!1),null===e&&!this.pinned)return this.open=!1,this.pinned=!1}pin(){return this.pinned=!0}unpin(){return this.pinned=!1}closeAllMenuTypeSubMenu(e=!1){return s.mapObject(this.subMenu,((t,i)=>t.closeMenu(e)))}closeAllMenuTypeMenu(e=!1){return s.mapObject(this.menu,((t,i)=>t.closeMenu(e)))}closeAllMenus(e=!1){return this.closeAllMenuTypeSubMenu(e),this.closeAllMenuTypeMenu(e)}areAllMenuTypeMenuClosed(){const e=s.values(this.menu);return this.allClosed=s.every(e,(e=>!e.open))}areAllMenuTypeSubMenuClosed(){const e=s.values(this.subMenu);return this.allClosed=s.every(e,(e=>!e.open))}areAllMenusClosed(){return this.areAllMenuTypeMenuClosed()&&this.areAllMenuTypeSubMenuClosed()}}a.$inject=[],angular.module("summonApp.services").service("menuManagerService",a)},3831:()=>{"use strict";class e{static initClass(){this.prototype.metrics={"searchbox:query"(t){return this.createMetric("search","query",{terms:t.terms,keepRefineMents:!0,page:e.pageFor(t.source)})},"advanced_search:query"(e){return this.createMetric("search","query",{terms:e.params.q,keepRefineMents:!0,page:"advanced"})},"filters:add"(e){return this.createMetric("refine","facet",{facet:e.facet,value:e.value,enabled:!0})},"filters:remove"(e){return this.createMetric("refine","facet",{facet:e.facet,value:e.value,enabled:!1})},"filters:more"(e){return this.createMetric("refine","moreFacets",{facet:e.facet})},"document:save"(e){if(e.document&&e.document.id)switch(e.source){case"search":return this.createMetric("results","save",{id:e.document.id});case"detail":return this.createMetric("detail","save",{id:e.document.id})}},"document:detail"(e){return this.createMetric("results","detail",{id:e.document.id})},"advanced_search:open"(t){return this.createMetric("advancedSearch","toggle",{enabled:!0,page:e.pageFor(t.source)})},"advanced_search:close"(t){return this.createMetric("advancedSearch","toggle",{enabled:!1,page:e.pageFor(t.source)})},"results:more"(e){return this.createMetric("results","page",{recordIndex:e.page})},"query_suggestion:query"(e){return this.createMetric("results","relatedQuery",{originalQuery:e.originalQuery,relatedQuery:e.query})},"language:switch"(e){return this.createMetric("language","language",{locale:e.locale})},"saved_items:open"(){return this.createMetric("savedItems","toggle",{enabled:!0})},"saved_items:close"(){return this.createMetric("savedItems","toggle",{enabled:!1})},"autocomplete:select"(e){return this.createMetric("search","autocomplete",{recordIndex:e.index,terms:e.terms})},"dialog:help"(){return this.createMetric("misc","help",{})}}}static pageFor(e){switch(e){case"home":return"front";case"search":return"results"}}constructor(e,t,i,s,a){this.handle=this.handle.bind(this),this.createMetric=this.createMetric.bind(this),this.getSessionId=this.getSessionId.bind(this),this.events=e,this.$log=i,this.api=s,this.$http=a,this.config=t.data.metrics,this.endpoint=this.config.url,this.enabled=this.config.enabled,this.events.subscribe("actions","*",this.handle)}handle(e,t,i){let s;if(this.enabled)return(s=this.metrics[t])?this.log(s.call(this,i)):void 0}log(e){return $.ajax({type:"POST",url:this.endpoint,contentType:"application/x-www-form-urlencoded",async:!0,timeout:1500,data:{eventData:JSON.stringify(e)}}),this.$log.info("[METRICS]",e)}bagNameFor(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}createMetric(e,t,i){const s=this.bagNameFor(e,t),a={action:"ui",sessionId:this.getSessionId(),client:this.config.client,authenticated:this.config.authenticated,component:e,method:t};return a[s]=i,a}getSessionId(){return this.api.session_id}}e.initClass(),e.$inject=["eventService","configService","$log","apiService","$http"],angular.module("summonApp.services").service("metricsService",e)},7496:()=>{"use strict";class e{constructor(e,t,i,s,a,r,n,o,l){this.init=this.init.bind(this),this.loginSuccessHandler=this.loginSuccessHandler.bind(this),this.logoutSuccessHandler=this.logoutSuccessHandler.bind(this),this.getFileId=this.getFileId.bind(this),this.getFileContents=this.getFileContents.bind(this),this.writeToFile=this.writeToFile.bind(this),this.createGraphRequest=this.createGraphRequest.bind(this),this.createFileAndReturnId=this.createFileAndReturnId.bind(this),this.handleApiError=this.handleApiError.bind(this),this.i18n=i,this.$q=a,this.$http=r,this.$log=n,this.authService=o,this.$timeout=l,this.savedSearchConfigs=e.data.savedSearchAndItems,this.scope={name:"Microsoft",userId:"",userDisplay:"",provider:"microsoft",initialized:!1,accessToken:null},s.setHooks(this,"MicrosoftApiService",["initSuccess","initFailed","signOut"])}init(){if(this.savedSearchConfigs.providers.includes("microsoft")&&this.authService.providerSupportsFeature("microsoft","cloudStorage"))return this.scope.providerDisplayName=this.scope.name}loginSuccessHandler(e,t){if(this.savedSearchConfigs.providers.includes("microsoft")&&this.authService.providerSupportsFeature(t.provider,"cloudStorage")&&t.provider===this.scope.provider)return this.scope.userId=this.authService.scope.auth[this.scope.provider].user,this.scope.accessToken=this.authService.scope.auth[this.scope.provider].accessToken,this.scope.userDisplay=this.authService.scope.auth[this.scope.provider].username,this.scope.accessToken&&this.scope.userId?(this.scope.initialized=!0,this.fire("initSuccess")):(this.$log.error("no accesstoken or userId found in response, cannot continue microsoft API integration"),this.scope.initialized=!1,this.fire("initFailed"))}logoutSuccessHandler(e,t){if(t.provider===this.scope.provider)return this.scope.userId="",this.scope.userDisplay="",this.scope.searches=[],this.fire("signOut")}getFileId(e){return this.createGraphRequest("me/drive/special/approot:/"+e).then((t=>200===t.status?t.data.id:404===t.status?this.createFileAndReturnId(e):this.handleApiError(err))).catch((e=>this.handleApiError(e)))}getFileContents(e){return this.createGraphRequest("me/drive/items/"+e,"GET").then((e=>{const t=e.data["@microsoft.graph.downloadUrl"];return this.$http({url:t}).then((e=>e.data)).catch((e=>{throw e}))})).catch(this.handleApiError)}writeToFile(e,t){return this.createGraphRequest("me/drive/items/"+t+"/content","PUT",e).catch(this.handleApiError)}createGraphRequest(e,t,i){const s={method:null!=t?t:"GET",url:"https://graph.microsoft.com/v1.0/"+e,headers:{Authorization:"Bearer "+this.scope.accessToken,"Content-Type":"application/json"}};return i&&(s.data=i),this.$http(s)}createFileAndReturnId(e){return this.createGraphRequest("me/drive/special/approot:/"+e+":/content?name.conflictBehavior=fail","PUT").then((e=>e.data.id)).catch(this.handleApiError)}handleApiError(e){const t=new Error;if(t.name="microsoftApiService",null==(null==e?void 0:e.error))return t.message=-1===(null==e?void 0:e.status)?this.i18n.translations.CLOUD_STORAGE_API_ERROR_NETWORK_ERROR:"Unknown",this.$q.reject(t);switch(e.error.code){case"cancelled":t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_CANCELED;break;case"invalid_session":t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_ERROR;break;default:t.message=e.error.message+" ("+e.error.code+")"}return this.$log.error(t),this.$q.reject(t)}}e.$inject=["configService","storeService","translationService","hooksService","$q","$http","$log","authenticationService","$timeout"],angular.module("summonApp.services").service("microsoftApiService",e)},3899:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l){this.getMoreFacets=this.getMoreFacets.bind(this),this.update=this.update.bind(this),this.updateFacet=this.updateFacet.bind(this),this.results=e,this.appState=t,this.facets=i,this.api=a,this.events=r,this.$filter=n,this.alerts=o,this.$q=l,this.config=s.data}getMoreFacets(e){return e.moreLoaded?this.$.reject("already loaded more for this facet"):this.api.facetValues(e.name,this.appState.params).then((e=>this.update(e))).catch((e=>console.error("more facets error",e)))}update(e){const t=e.data.facet_values;if(null!=t){let e;return e=this.updateFacet(t[0])}}updateFacet(e){if(!e)return void console.error("No data received from more facet request");const t=s(this.facets.scope.facets).find((t=>t.name===e.display_name));return s.each(e.counts,(function(e){if(!s.find(t.counts,(t=>t.value===e.value)))return t.counts.push(e)})),t.showmore=!1,t.moreLoaded=!0,this.facets.updateAppliedState(t),t}}a.$inject=["dataService","appStateService","facetsService","configService","apiService","eventService","$filter","alertService","$q"],angular.module("summonApp.services").service("moreFacetsService",a)},8915:()=>{"use strict";class e{constructor(e){this.getNotes=this.getNotes.bind(this),this.$http=e,this.endpoint="/public_notes"}getNotes(e,t){return this.$http.get(this.endpoint,{params:{databases:e,titles:t}})}}e.$inject=["$http"],angular.module("summonApp.services").service("publicNoteService",e)},5674:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r){this.isPhysicalOrEbook=this.isPhysicalOrEbook.bind(this),this.handlePhysicalAndEbook=this.handlePhysicalAndEbook.bind(this),this.disableFacet=this.disableFacet.bind(this),this.enableFacet=this.enableFacet.bind(this),this.update=this.update.bind(this),this.isApplied=this.isApplied.bind(this),this.remove=this.remove.bind(this),this.add=this.add.bind(this),this.toggle=this.toggle.bind(this),this.getFilterClasses=this.getFilterClasses.bind(this),this.createFilter=this.createFilter.bind(this),this.filters=this.filters.bind(this),this.appState=t,this.utils=i,this.events=s,this.i18n=a,this.config=e.data,this.scope={filters:[],combinedFilters:[],applied:!1,activeFilters:[],enabled:this.config.quickFilters.enabled},this.inclusiveFilters=[],this.institutionFacet="Institution",this.printBooksFacet="print.books.only",this.eBooksFacet="ebooks.only",this.beyondHoldings="ho",this.includeMatchesInFullText="include.ft.matches",this.appState.on("apply",(()=>this.update())),this.searchScopeService=r}isPhysicalOrEbook(e){return e.facet===this.printBooksFacet||e.facet===this.eBooksFacet}handlePhysicalAndEbook(){const e=s.find(this.scope.filters,(e=>e.facet===this.printBooksFacet)),t=s.find(this.scope.filters,(e=>e.facet===this.eBooksFacet));if(e&&t)return e&&e.applied&&t&&t.applied?(t.applied=!1,t.disabled=!0,delete this.appState.params[this.eBooksFacet]):t&&t.applied&&e?(e.disabled=!0,t.disabled=!1,e.applied=!1):e&&e.applied&&t?(t.disabled=!0,e.disabled=!1,t.applied=!1):(t.disabled=!1,e.disabled=!1),e&&t?(e.tooltip=this.i18n.translate(this.i18n.translations.QUICKFILTER_REMOVE_OTHER_X,{facet:this.i18n.translations.EBOOK_FULL_TEXT_ONLINE}),t.tooltip=this.i18n.translate(this.i18n.translations.QUICKFILTER_REMOVE_OTHER_X,{facet:this.i18n.translations.PHYSICAL_BOOKS_LIBRARY_CATALOG})):void 0}disableFacet(e){const t=s(this.scope.filters).find((t=>t.facet===e));if(t)return t.disabled=!0}enableFacet(e){const t=s(this.scope.filters).find((t=>t.facet===e));if(t)return t.disabled=!1}update(){return this.scope.filters=this.filters(!1),this.scope.combinedFilters=this.filters(!0),this.handlePhysicalAndEbook(),this.scope.applied=s(this.scope.combinedFilters).any((e=>e.applied)),this.scope.activeFilters=s(this.scope.combinedFilters).filter((e=>e.applied))}facetValue(e){return`${e.facet},${this.utils.summonEscape(e.value)},f`}isApplied(e){return this.isAppliedBy(e,this.appState.params)||this.isAppliedBy(e,this.appState.searchScopeParams)}isAppliedBy(e,t){return!!t&&(this.inclusiveFilters.includes(e.facet)?s(t.fvfi).contains(this.facetValue(e)):e.facet===this.institutionFacet?t.myinst===e.value:e.facet===this.printBooksFacet?t[this.printBooksFacet]===e.value:e.facet===this.eBooksFacet?t[this.eBooksFacet]===e.value:e.facet===this.beyondHoldings?t[this.beyondHoldings]===e.value||!1===t[this.beyondHoldings]:e.facet===this.includeMatchesInFullText?!0===t[this.includeMatchesInFullText]&&!e.defaultInclusion:s(t.fvf).contains(this.facetValue(e)))}remove(e){return this.inclusiveFilters.includes(e.facet)?this.appState.params.fvfi=s(this.appState.params.fvfi).reject((t=>t===this.facetValue(e))):e.facet===this.includeMatchesInFullText?this.appState.params[this.includeMatchesInFullText]="f":e.facet===this.institutionFacet?this.appState.params.myinst="":e.facet===this.beyondHoldings?this.appState.params[this.beyondHoldings]="t":e.facet===this.printBooksFacet?(delete this.appState.params[this.printBooksFacet],this.enableFacet(this.printBooksFacet),this.enableFacet(this.eBooksFacet)):e.facet===this.eBooksFacet?(delete this.appState.params[this.eBooksFacet],this.enableFacet(this.eBooksFacet),this.enableFacet(this.printBooksFacet)):this.appState.params.fvf=s(this.appState.params.fvf).reject((t=>t===this.facetValue(e)))}add(e){return this.remove(e),this.inclusiveFilters.includes(e.facet)?this.appState.params.fvfi.push(this.facetValue(e)):e.facet===this.includeMatchesInFullText?this.appState.params[this.includeMatchesInFullText]="t":e.facet===this.institutionFacet?this.appState.params.myinst=e.value:e.facet===this.beyondHoldings?this.appState.params[this.beyondHoldings]=e.value:e.facet===this.printBooksFacet?(this.appState.params[this.printBooksFacet]=e.value,delete this.appState.params[this.eBooksFacet],this.disableFacet(this.eBooksFacet)):e.facet===this.eBooksFacet?(this.appState.params[this.eBooksFacet]=e.value,delete this.appState.params[this.printBooksFacet],this.disableFacet(this.printBooksFacet)):this.appState.params.fvf.push(this.facetValue(e))}toggle(e){if(!(null==e?void 0:e.disabled))return e.applied=!e.applied,e.facet===this.includeMatchesInFullText&&(e.value=!e.value),e.fromSearchScope?(e.applied=!0,void this.searchScopeService.clearScopeAsSideEffect()):this.appState.applyStateWithSnapShot((()=>(this.appState.params.pn=1,this.isApplied(e)?(this.remove(e),this.events.gaPush("refinements","remove",e.label)):(this.add(e),this.events.gaPush("refinements","add",e.label)))))}getFilterClasses(e){return{applied:e.applied,disabledFacet:e.disabled}}createFilter(e){const t=s.clone(e);return t.applied=this.isApplied(t),t.fromSearchScope=this.isAppliedBy(t,this.appState.searchScopeParams),t}filters(e=!1){const t=e?this.scope.combinedFilters:this.scope.filters;return 0===t.length?(e?this.combineFilters(this.config.quickFilters.filters,this.config.quickFilters.advancedFilters):this.config.quickFilters.filters).map((e=>this.createFilter(e))):(t.forEach((e=>{e.applied=this.isApplied(e),e.fromSearchScope=this.isAppliedBy(e,this.appState.searchScopeParams)})),t)}combineFilters(e,t){const i=[...e];return t.map((e=>{i.some((t=>t.facet==e.facet))||i.push(e)})),i}}a.$inject=["configService","appStateService","utilitiesService","eventService","translationService","searchScopeService"],angular.module("summonApp.services").service("quickFiltersService",a)},2488:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e){this.showCallNums=this.showCallNums.bind(this),this.showDeweys=this.showDeweys.bind(this),this.syndeticsClient=this.syndeticsClient.bind(this),this.showSyndeticsContent=this.showSyndeticsContent.bind(this),this.showPublicNotes=this.showPublicNotes.bind(this),this.displayLibraryNotes=this.displayLibraryNotes.bind(this),this.configService=e,this.quickLookConfig=this.configService.data.quickLook}showCallNums(){return this.quickLookConfig.showCallNums}showDeweys(){return this.quickLookConfig.showDeweys}syndeticsClient(){return this.quickLookConfig.syndeticsClient}displayLibraryNotes(){return this.quickLookConfig.displayLibraryNotes}showSyndeticsContent(e){return this.quickLookConfig.enableSyndeticsPlus&&e.isbns&&e.isbns.length}showPublicNotes(e){var t;return(this.quickLookConfig.showPublicNotes||this.quickLookConfig.showLocationNotes)&&(null===(t=e.iedl_dbids)||void 0===t?void 0:t.length)>0}setDatabases(e){const t=s.compact([e].concat(e.peer_documents)),i=s.chain(t).pluck("databases").compact().flatten().uniq((e=>e.dbid)).value();let a=[];return e.in_holdings&&(a=s.uniq(i,(e=>e.url+e.name))),e.is_a_i&&(a=s.chain(i).filter((e=>s.contains(e.source_types,"Index Database"))).uniq((e=>e.url+e.name)).value()),a}getAllDocumentsSummary(e){return e.filter((e=>"documentSummary"===e.type))}getTotalResults(e){return e.length?e[0].recordCount:0}}a.$inject=["configService"],angular.module("summonApp.services").service("quickLookService",a)},9171:()=>{"use strict";class e{constructor(e,t,i,s){this.initRecaptcha=this.initRecaptcha.bind(this),this.renderCaptcha=this.renderCaptcha.bind(this),this.lang=this.lang.bind(this),this.get=this.get.bind(this),this.reset=this.reset.bind(this),this.$window=e,this.$timeout=t,this.langsMap=s,this.initialized=!1,this.pendingCaptchas={},this.captchas={},this.siteKey=i.data.recaptcha.siteKey,this.initRecaptcha}initRecaptcha(){return this.$window.grecaptcha&&this.$window.grecaptcha.render&&(this.initialized=!0),this.renderCaptcha()}renderCaptcha(e=!1){if(e&&(this.pendingCaptchas[e]=1),!this.initialized)return this.retrying&&this.$timeout.cancel(this.retrying),this.retrying=this.$timeout(this.initRecaptcha,50);for(e in this.retrying&&(this.$timeout.cancel(this.retrying),delete this.retrying),this.pendingCaptchas)angular.element(`#${e}`).length?(this.captchas[e]=grecaptcha.render(e,{sitekey:this.siteKey,hl:this.lang(),callback:function(){angular.element(`#${e}`).trigger("recaptchaValidated",[!0])}}),delete this.pendingCaptchas[e]):4==this.pendingCaptchas[e]++&&delete this.pendingCaptchas[e],Object.keys(this.pendingCaptchas).length&&(this.retrying=this.$timeout(this.renderCaptcha,100))}lang(){return this._lang||(this._lang=this.$window.__summonLocale in this.langsMap?this.langsMap[this.$window.__summonLocale]:"en")}get(e){return grecaptcha.getResponse(this.captchas[e])}reset(e){return grecaptcha.reset(this.captchas[e])}}e.$inject=["$window","$timeout","configService","$reCAPTCHALangs"],angular.module("summonApp.services").service("recaptchaService",e)},4119:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l,c){this.reset=this.reset.bind(this),this.processNew=this.processNew.bind(this),this.getResultsFeedIndicators=this.getResultsFeedIndicators.bind(this),this.getIndicators=this.getIndicators.bind(this),this.getLookup=this.getLookup.bind(this),this.isActive=this.isActive.bind(this),this.selectType=this.selectType.bind(this),this.toggleRelatedItems=this.toggleRelatedItems.bind(this),this.getMore=this.getMore.bind(this),this.getRelatedItems=this.getRelatedItems.bind(this),this.callApi=this.callApi.bind(this),this.query=this.query.bind(this),this.responseProcessor=this.responseProcessor.bind(this),this.responseErrorProcessor=this.responseErrorProcessor.bind(this),this.servicesErrorProcessor=this.servicesErrorProcessor.bind(this),this.retry=this.retry.bind(this),this.api=e,this.types=t,this.availability=i,this.$timeout=s,this.$http=a,this.data=n,this.alerts=l,this.utils=c,this.relatedItemsConfig=o.data.relatedItems,this.scope={},this.pageSize=10,this.apiTimeout=1e4,this.reset(!0),this.relatedItemsConfig.enabled&&(this.data.on("new",this.processNew),this.data.on("update",this.getResultsFeedIndicators))}reset(e=!1){return e&&(this.indicators={},this.startIndex=0),s.extend(this.scope,{reviews:{docs:[],count:1/0,pn:1,endOfResults:!1,summonIds:[],exists:!1},chapters:{docs:[],count:1/0,pn:1,endOfResults:!1,summonIds:[],exists:!1},loading:!1,loadingError:!1,gotLookup:!1,currentDoc:null,type:null})}processNew(){return this.reset(!0),this.getResultsFeedIndicators()}getResultsFeedIndicators(){let e=this.data.data.search.documents;const t=e?e.length:0;return e=e?e.slice(this.startIndex):[],e=s.filter(e,(e=>e.content_type.match(/(book|ebook)/i))),this.startIndex=t,this.$timeout((()=>this.getIndicators(e)),50)}getIndicators(e){var t,i,s;let a;const r={docs:[]};for(a of e){var n={id:a.id};if(null===(t=a.participant_ids)||void 0===t?void 0:t.length){const e=(null!==(i=a.isbns)&&void 0!==i?i:[]).concat(null!==(s=a.eisbns)&&void 0!==s?s:[]);(null==e?void 0:e.length)&&(n.isbns=e,r.docs.push(n))}}if(r.docs.length)return this.$http.post(`/2.0.0/services/relateditems/indicators/${this.relatedItemsConfig.libHash}`,r,{cache:!0,timeout:this.apiTimeout}).then((e=>(()=>{var t;const i=[];for(a of null===(t=null==e?void 0:e.data)||void 0===t?void 0:t["doc.info"])if(a.BookChapter||a.BookReview){var s=this.indicators[a.docid]={};a.BookChapter&&(s.hasChapters=a.BookChapter),a.BookReview?i.push(s.hasReviews=a.BookReview):i.push(void 0)}else i.push(void 0);return i})())).catch(this.servicesErrorProcessor)}getLookup(){var e,t;let i=`/2.0.0/services/relateditems/lookup?isbns=${(null!==(e=this.scope.currentDoc.isbns)&&void 0!==e?e:[]).concat(null!==(t=this.scope.currentDoc.eisbns)&&void 0!==t?t:[]).join(",")}`;return this.$http.get(i,{timeout:this.apiTimeout}).then((e=>{if(this.scope.gotLookup=!0,null!=e.data)return this.scope.reviews.summonIds=e.data.BookReview||[],this.scope.chapters.summonIds=e.data.BookChapter||[]})).catch(this.servicesErrorProcessor)}isActive(e){var t;return(null===(t=this.scope.currentDoc)||void 0===t?void 0:t.id)===e}selectType(e){if(this.scope.type!==e)return this.scope.type=e,this.scope.loadingError=!1,this.alerts.resetAlert("relatedItemsError"),this.scope[e].docs.length?void 0:this.getRelatedItems(this.scope.currentDoc,e)}toggleRelatedItems(e){const t=this.isActive(e.id);if(this.reset(),t)return;const i=this.indicators[e.id];this.scope[this.types.REVIEWS].exists=i.hasReviews,this.scope[this.types.CHAPTERS].exists=i.hasChapters;const s=i.hasReviews?this.types.REVIEWS:this.types.CHAPTERS;return this.getRelatedItems(e,s)}getMore(){return this.getRelatedItems(this.scope.currentDoc,this.scope.type)}getRelatedItems(e,t){return this.alerts.resetAlert("relatedItemsError"),this.scope.currentDoc!==e&&(this.scope.currentDoc=e),this.scope.type!==t&&(this.scope.type=t),this.scope.loading=!0,this.scope.gotLookup?this.callApi():this.getLookup().then(this.callApi).catch(this.responseErrorProcessor).finally((()=>this.scope.loading=!1))}callApi(){const e=this.scope.currentDoc,{type:t}=this.scope;return this.api.relatedItems(this.query()).then(this.responseProcessor(e,t)).catch(this.responseErrorProcessor).finally((()=>this.scope.loading=!1))}query(){const{type:e}=this.scope;if(!this.scope[e].summonIds.length)throw this.responseErrorProcessor(),this.scope.gotLookup=!1,this.scope.loading=!1,new Error("Empty Summon IDs");return{ri:this.scope[e].summonIds,pn:this.scope[e].pn,ps:this.pageSize,ho:!1}}responseProcessor(e,t){return i=>{var a;if(null===this.scope.currentDoc||this.scope.currentDoc.id!==e.id)return;const r=this.scope[t];if(null!=(null===(a=i.data)||void 0===a?void 0:a.documents)){const e=i.data.documents;return this.availability.getRTA(e),s.each(e,(e=>{if(s.pluck(r.docs,"id").indexOf(e.id)<=-1)return r.docs.push(e)})),r.count=i.data.record_count,r.count<=r.docs.length||!e.length?r.endOfResults=!0:r.pn++}return r.count===1/0?r.count=0:void 0}}responseErrorProcessor(){return this.scope.loadingError=!0,this.alerts.setAlert("relatedItemsError",`${this.utils.titleCase(this.scope.type)} failed to load.`)}servicesErrorProcessor(e){e.status<0?console.error(`Call to ${e.config.url} timed out!`):e.status?console.error(`${e.status}: ${e.statusText}`):console.error(e.message)}retry(){return this.scope.loadingError=!1,this.getMore()}}a.$inject=["apiService","$relatedItemTypes","availabilityService","$timeout","$http","translationService","dataService","configService","alertService","utilitiesService"],angular.module("summonApp.services").service("relatedItemsService",a)},4201:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.configService=e,this.authenticationService=t,this.cloudStorageService=i,this.authConfig=this.configService.data.authentication,this.registerProviders=this.registerProviders.bind(this),this.cloudStorageProviders=this.cloudStorageService.getProviders(),this.configProviders=this.configService.data.savedSearchAndItems.providers,this.isResearchAssistantEnabled=this.configService.data.researchAssistant.enabled&&(this.authenticationService.isAuthenticationEnabled||this.authenticationService.isVpnAuthenticated),this.authFeature=this.authenticationService.registerFeature("research_assistant","RESEARCH_ASSISTANT_FEATURE"),this.authFeature.showInLoginMenu=!1,s.includes(["CAS","Both"],this.authConfig.sierraAuthProtocol)&&this.authFeature.setProvider("cas",{}),s.includes(["SAML","Both"],this.authConfig.sierraAuthProtocol)&&this.authFeature.setProvider("saml",{}),this.registerProviders()}registerProviders(){for(var e of this.cloudStorageProviders){if(s.contains(this.configProviders,e.name)){const t="summon"===e.name?e.display.toLowerCase():e.name;this.authFeature.setProvider(t,e.loginParams)}e.service.init()}}}a.$inject=["configService","authenticationService","cloudStorageService"],angular.module("summonApp.services").service("researchAssistantService",a)},9373:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}invoke(e,t){const i=e.search.recommendations.best_bets;if(i&&i.length){const e={bet:i[0],type:"bestBet",hidden:!1};return t.addPositionalItem(e,1)}}}e.initClass(),angular.module("summonApp.resultsFeedPlugins").service("bestBetsPlugin",e)},7082:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}constructor(e){this.invoke=this.invoke.bind(this),this.config=e.data.results}invoke(e,t){const i=e.search.recommendations.databases;if(i&&i.length){const e={databases:i,type:"databaseRecommendations",show:this.config.showDBRecommenderResults,minDbLimit:2,dbLimit:2,showMore:this.showMore,showLess:this.showLess};return t.addPositionalItem(e,1)}}showMore(){return this.dbLimit=this.databases.length}showLess(){return this.dbLimit=this.minDbLimit}}e.initClass(),e.$inject=["configService"],angular.module("summonApp.resultsFeedPlugins").service("databaseRecommendationsPlugin",e)},7858:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}invoke(e,t){var i,s,a;const r=e.search.recommendations.did_you_mean;let n=null;if(r&&r.length)return null!=(null===(i=r[0].suggestion)||void 0===i?void 0:i.original_query)?n={dym:r[0].suggestion,type:"didYouMeanSuggestion"}:null!=(null===(s=r[0].correction)||void 0===s?void 0:s.original_query)?n={dym:r[0].correction,type:"didYouMeanCorrection"}:null!=(null===(a=r[0].expansion)||void 0===a?void 0:a.original_query)&&(n={dym:r[0].expansion,type:"didYouMeanExpansion"}),t.addPositionalItem(n,1)}}e.initClass(),angular.module("summonApp.resultsFeedPlugins").service("didYouMeanPlugin",e)},5234:()=>{"use strict";class e{static initClass(){this.prototype.states=["new","update"]}constructor(e){this.invoke=this.invoke.bind(this),this.resultsConfig=e.data.results}invoke(e,t){var i,s;const a=e.search.documents||[],r=t.position-1;if("documents"===e.updateType&&a.length>0&&r===a.length)return void t.setEndOfResults();const n=(e.search.query.page_number-1)*this.resultsConfig.pageSize+1;return t.items().find((e=>{var t;return(null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.index)&&e.document.index===n}))||a.forEach(((e,i)=>{if("object"==typeof e){e.index=r+i+1;const s={document:e,type:"documentSummary"};return t.addItem(s)}})),(null===(s=null===(i=null==e?void 0:e.search)||void 0===i?void 0:i.query)||void 0===s?void 0:s.page_number)&&e.search.query.page_number>=t.maxPages?t.setEndOfResults({maxLimit:!0}):void 0}}e.initClass(),e.$inject=["configService"],angular.module("summonApp.resultsFeedPlugins").service("documentSummariesPlugin",e)},7255:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}invoke(e,t){const i=e.search.rollups.image;if(i&&null!=i.documents&&i.documents.length>4){const s={documents:i.documents,type:"imagesRollup",query:e.search.query.original_query,filters:i.filters};return t.addPositionalItem(s,i.position)}}}e.initClass(),angular.module("summonApp.resultsFeedPlugins").service("imagesRollupPlugin",e)},5654:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}invoke(e,t){const i=e.search.rollups.newspaper;if(i&&null!=i.documents){const s={documents:i.documents,type:"newsRollup",query:e.search.query.original_query,filters:i.filters};return t.addPositionalItem(s,i.position)}}}e.initClass(),angular.module("summonApp.resultsFeedPlugins").service("newsRollupPlugin",e)},3850:(e,t,i)=>{"use strict";var s=i(4125);class a{static initClass(){this.prototype.states=["new"]}constructor(e,t){this.invoke=this.invoke.bind(this),this.appState=e,this.config=t.data.results}invoke(e,t){if(0===e.search.record_count){t.noResults=!0;const i={query:e.search.query.original_query,filtersApplied:s(this.appState.params.fvf).some()||s(this.appState.params.rf).some(),holdingsOnly:this.appState.params.ho&&this.config.addResultsBeyondCatalog,canIncludeFtMatches:!this.appState.params["include.ft.matches"]&&this.config.includeMatchesFulltextOverride,contactUrl:this.config.librarianContactUrl||!1,type:"noResults",searchScopeApplied:!!this.appState.params.searchscope&&"All"!==this.appState.params.searchscope};return t.addPositionalItem(i,1)}}}a.initClass(),a.$inject=["appStateService","configService"],angular.module("summonApp.resultsFeedPlugins").service("noResultsPlugin",a)},7394:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}constructor(e,t){this.invoke=this.invoke.bind(this),this.appState=e,this.config=t.data.results}invoke(e,t){const i=e.search.recommendations.query_suggestions;if(i&&i.length&&this.config.enableQuerySuggestions){const e={queries:i.map((e=>e.query)),holdingsOnly:this.appState.params.ho&&this.config.addResultsBeyondCatalog,type:"querySuggestions"};return t.addPositionalItem(e,11)}}}e.initClass(),e.$inject=["appStateService","configService"],angular.module("summonApp.resultsFeedPlugins").service("querySuggestionsPlugin",e)},8823:()=>{"use strict";class e{static initClass(){this.prototype.states=["new"]}invoke(e,t){const i=e.search.rollups.reference;if(i&&null!=i.documents){const s={documents:i.documents,type:"referencesRollup",query:e.search.query.original_query,filters:i.filters};return t.addPositionalItem(s,i.position)}}}e.initClass(),angular.module("summonApp.resultsFeedPlugins").service("referencesRollupPlugin",e)},4703:(e,t,i)=>{"use strict";var s=i(4125);class a{static initClass(){this.prototype.states=["new"]}constructor(e){this.quickFilters=e}invoke(e,t){const i=e.search,{query:a}=i,r=s.first(a.sort),n=a.query_expansion;var o={query:a.original_query,recordCount:i.record_count,type:"searchInfo",terms:n.search_terms,sortOrder:r?`${r.field_name}|${r.sort_order}`:"relevance",sortType:e=>e===o.sortOrder,inLibraryCatalog:!this.quickFilters.isApplied({label:"Library Catalog",facet:"SourceType",value:"Library Catalog"})};return t.addPositionalItem(o,1)}}a.initClass(),a.$inject=["quickFiltersService"],angular.module("summonApp.resultsFeedPlugins").service("searchInfoPlugin",a)},3010:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n,o,l){this.items=this.items.bind(this),this.clear=this.clear.bind(this),this.processNew=this.processNew.bind(this),this.processUpdate=this.processUpdate.bind(this),this.update=this.update.bind(this),this.addPositionalItem=this.addPositionalItem.bind(this),this.addItem=this.addItem.bind(this),this.toggleItem=this.toggleItem.bind(this),this.extractAvailabilityId=this.extractAvailabilityId.bind(this),this.showItems=this.showItems.bind(this),this.setEndOfResults=this.setEndOfResults.bind(this),this.data=e,this.appState=i,this.events=s,this.alertService=a,this.availability=r,this.$timeout=o,this.$q=l,this.clear(),this.scope.loading=!1,this.maxPages=200,this.noResults=!0,this.resultsConfig=n.data.results,this.plugins=t.plugins,this.data.on("new",this.processNew),this.data.on("update",this.processUpdate)}items(){return this.scope.items}clear(){this.scope||(this.scope={});const e={items:[],removedHeight:0,heightStack:[],hiddenItems:!1};for(var t in e){var i=e[t];this.scope[t]=i}this.noResults=!1,this.endOfResults=!1,this.positionalItems={},this.state="new",this.position=1}processNew(e){var t;1===(null===(t=null==e?void 0:e.query)||void 0===t?void 0:t.page_number)&&this.clear(),this.update()}processUpdate(){return this.state="update",this.update()}update(){if(!this.showTop)return this.plugins.forEach((e=>{if(s(e.states).contains(this.state))return e.invoke(this.data.data,this)}));this.showTop=!1}addPositionalItem(e,t){if(this.positionalItems[t]||(this.positionalItems[t]=[]),this.positionalItems[t].push(e),1===this.position&&1===t)return this.scope.items.push(e)}addItem(e){let t;if(this.scope.items.push(e),this.position+=1,t=this.positionalItems[this.position])return t.forEach((e=>this.scope.items.push(e)))}toggleItem(e,t={hiddenVal:!0}){const i=this.scope.items[e];if(i)return i.hidden=t.hiddenVal}extractAvailabilityId(e,t){var i;const s=null===(i=this.scope.items[e].document)||void 0===i?void 0:i.availability_id;if(null!=s)return t.push(s)}showItems(e,t){let i,s,a,r,n;for(i=e,a=t,s=e<=a;s?i<a:i>a;s?i++:i--)this.toggleItem(i,{hiddenVal:!1});const o=[];for(i=e,n=t,r=e<=n;r?i<n:i>n;r?i++:i--)this.extractAvailabilityId(i,o);if(o.length)return this.$timeout((()=>this.availability.updateAvailabilityFromCache(o)),250)}goToTop(){window.scrollTo(0,0)}loadPrev(){return this.loadPage(+this.appState.params.pn-1)}loadNext(){return this.loadPage(+this.appState.params.pn+1)}loadPage(e){let t;return this.hidePage(!0),this.position=(e-1)*this.resultsConfig.pageSize+1,this.isPageLoaded(e)?(this.loadPageFromCache(e),t=this.$q.resolve(!0)):t=this.loadPageFromApi(e),this.goToTop(),t}isPageLoaded(e){const{pageSize:t}=this.resultsConfig;return this.scope.items.find((i=>{var s;return(null===(s=i.document)||void 0===s?void 0:s.index)===(e-1)*t+1}))}loadPageFromCache(e){this.appState.updatePageInUrl(e);let t=e*this.resultsConfig.pageSize;this.scope.items[0].recordCount<t&&(t=this.scope.items[0].recordCount);const i=this.scope.items.findIndex((t=>{var i;return(null===(i=t.document)||void 0===i?void 0:i.index)===(e-1)*this.resultsConfig.pageSize+1})),s=this.scope.items.findIndex((e=>{var i;return(null===(i=e.document)||void 0===i?void 0:i.index)===t}));this.showItems(i,s+1)}loadPageFromApi(e){return this.scope.loading=!0,this.appState.params.pn=e,this.events.publish("actions","results:more",{page:e}),this.appState.applyState({isPageRequest:!0})}hidePage(e=!1){const t=this.scope.items.length;for(let e=0;e<t;e++)this.toggleItem(e,{hiddenVal:!0});e&&this.toggleItem(0,{hiddenVal:!1})}setEndOfResults(e={maxLimit:!1}){if(!this.endOfResults)return e.maxLimit?this.appState.params.pn+=1:this.appState.params.pn-=1,this.endOfResults=!0,this.addItem({endOfResults:!0,type:"noResults"})}}a.$inject=["dataService","resultsFeedServicePlugins","appStateService","eventService","alertService","availabilityService","configService","$timeout","$q"],angular.module("summonApp.services").service("resultsFeedService",a)},624:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e){this.plugins=s(arguments).toArray()}}a.$inject=["searchInfoPlugin","didYouMeanPlugin","bestBetsPlugin","databaseRecommendationsPlugin","noResultsPlugin","imagesRollupPlugin","newsRollupPlugin","referencesRollupPlugin","querySuggestionsPlugin","documentSummariesPlugin"],angular.module("summonApp.services").service("resultsFeedServicePlugins",a)},7902:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i){this.availableStatusCode="-",this.getAvailabilityStatus=this.getAvailabilityStatus.bind(this),this.getAvailableStatusMap=this.getAvailableStatusMap.bind(this),this.getRequestableStatusMap=this.getRequestableStatusMap.bind(this),this.unionStatusMap=this.unionStatusMap.bind(this),this.formatProperty=this.formatProperty.bind(this),this.statusSort=this.statusSort.bind(this),this.hasVolume=this.hasVolume.bind(this),this.hasYear=this.hasYear.bind(this),this.hasCallNumber=this.hasCallNumber.bind(this),this.hasLocation=this.hasLocation.bind(this),this.getVolumes=this.getVolumes.bind(this),this.getStatusMessage=this.getStatusMessage.bind(this),this.isRequestableForAvailabilities=this.isRequestableForAvailabilities.bind(this),this.isRequestable=this.isRequestable.bind(this),this.getStatusForAvailabilities=this.getStatusForAvailabilities.bind(this),this.getStatusForAvailability=this.getStatusForAvailability.bind(this),this.prepareRtaDoc=this.prepareRtaDoc.bind(this),this.translationService=e,this.$filter=i,this.config=t,this.availableStatusMap=this.getAvailableStatusMap(),this.availableStatusMapMsgs=s.map(t.data.rtaAvailability.rtaAvailableStatusMap,(e=>e.name.toLowerCase())),this.requestableStatusMap=this.getRequestableStatusMap(),this.notRequestableTypeMap=t.data.rtaAvailability.rtaNotRequestableTypeMap,this.denyRequestIfNoDueDate=this.config.data.rtaAvailability.denyRequestIfNoDueDate,this.isSierraClient=t.data.rtaAvailability.isSierraClient,this.provider="cas",this.localizeDate=this.$filter("summonISODate")}sanitizeAvailabilities(e,t=!1){const i=e=>{if(e){const t=this.localizeDate(e.trim());return t&&"Invalid Date"!==t.toString()?t:e}return e},a=function(e){if(t&&null!=e&&0!==e.displayString.length){if(e.displayString.indexOf("Due")>-1&&-1==e.displayString.split(",")[0].split(" ")[1].indexOf("-"))return e.displayString;if(e.statusMessage.indexOf("Due")>-1&&(e.statusMessage="Due "+i(e.statusMessage.substr(4))),e.displayString.indexOf("Due")>-1){const t=e.displayString.split(",");return e.displayString="Due "+i(t[0].substr(4))+", "+t.splice(1).join()}}},r=function(e){if(null==e.status&&(e.status="unknown"),null==e.statusMessage&&(e.statusMessage=""),null==e.location&&(e.location=""),null==e.callNumber&&(e.callNumber=""),null==e.displayString&&(e.displayString=e.statusMessage),e.holdCount&&"0"!==e.holdCount){const t=e.displayString.split(",");e.statusMessage=e.holdCount+" Holds",e.status="unknown",e.statusCode="",e.displayString=e.statusMessage+", "+t.splice(1).join()}return e};return this.isGrouped(e)?s.forEach(e,(e=>a(r(e)))):a(r(e))}getAvailabilityStatus(e){return this.isGrouped(e)?this.getStatusForAvailability(e[0]):this.getStatusForAvailability(e)}getAvailableStatusMap(){return this.unionStatusMap(this.config.data.rtaAvailability.rtaAvailableStatusMap,this.config.data.rtaAvailability.customAvailableCodes)}getRequestableStatusMap(){return this.unionStatusMap(this.config.data.rtaAvailability.rtaRequestableStatusMap,this.config.data.rtaAvailability.customRequestableCodes)}unionStatusMap(e,t){const i=s.map(e,(e=>e.code)),a=t?t.split(","):void 0;return(null==i?void 0:i.length)&&(null==a?void 0:a.length)?s.union(i,a):i}hasProperty(e,t){var i;return null!=e&&!!(null===(i=e[t])||void 0===i?void 0:i.length)}formatProperty(e,t){return this.hasProperty(e,t)?e[t]:this.isGrouped(e)&&this.hasProperty(e[0],t)?e[0][t]:"-"}statusSort(e){const t=this.getAvailabilityStatus(e);return"available"===t.code?1:"not available"===t.code?2:"unknown"===t.code?3:void 0}isGrouped(e){return Array.isArray(e)}hasVolume(e){return s.some(e,(e=>this.hasProperty(e,"volume")))}hasYear(e){return s.some(e,(e=>this.hasProperty(e,"year")))}hasCallNumber(e){return s.some(e,(e=>this.hasProperty(e,"callNumber")))}hasLocation(e){return s.some(e,(e=>this.hasProperty(e,"location")))}getVolumes(e){return s.filter(e,(e=>this.hasProperty(e,"volume")))}getStatusMessage(e){if(this.isGrouped(e)){const t=null!=e[0].statusMessage?e[0].statusMessage:this.getStatusForAvailability(e[0]).translation;return e.length>1?`${t} (${e.length}`:`${t}`}return null!=e.statusMessage?e.statusMessage:this.getStatusForAvailability(e).translation}isRequestableForAvailabilities(e){return s.some(e,(e=>e&&(s.contains(this.requestableStatusMap,e.statusCode)||this.isRequestableWithDueDate(e))&&!(""!=e.type&&s.contains(this.notRequestableTypeMap,e.type))))}isRequestable(e){return s.some(e,(e=>e&&s.contains(this.requestableStatusMap,e.statusCode)))}isRequestableWithDueDate(e){return e.statusCode==this.availableStatusCode&&1==this.denyRequestIfNoDueDate&&e.statusMessage.includes("Due")}getStatusForAvailabilities(e){return s.every(e,(e=>null===e||(null==e?void 0:e.contingencyInfo)))?{code:"unknown",translation:this.translationService.translations.CHECK_AVAILABILITY}:s.every(e,(e=>"not available"===e.status&&!(null!=e.statusMessage&&s.contains(this.availableStatusMapMsgs,e.statusMessage.toLowerCase()))))?{code:"not available",translation:this.translationService.translations.AVAILABLE_RTA_STATUS_NOT_AVAILABLE}:s.some(e,(e=>"available"===e.status||null!=e.statusMessage&&s.contains(this.availableStatusMapMsgs,e.statusMessage.toLowerCase())||s.contains(this.availableStatusMap,e.statusCode)))?{code:"available",translation:this.translationService.translations.AVAILABLE_RTA_STATUS_AVAILABLE}:{code:"unknown",translation:this.translationService.translations.CHECK_AVAILABILITY}}getStatusForAvailability(e){return e?"not available"!==e.status||null!=e.statusMessage&&s.contains(this.availableStatusMapMsgs,e.statusMessage.toLowerCase())?null!=e.statusMessage&&s.contains(this.availableStatusMapMsgs,e.statusMessage.toLowerCase())||"available"===e.status||s.contains(this.availableStatusMap,e.statusCode)?{code:"available",translation:this.translationService.translations.AVAILABLE_RTA_STATUS_AVAILABLE}:{code:"unknown",translation:this.translationService.translations.CHECK_AVAILABILITY}:{code:"not available",translation:this.translationService.translations.AVAILABLE_RTA_STATUS_NOT_AVAILABLE}:{code:"unknown",translation:this.translationService.translations.CHECK_AVAILABILITY}}prepareRtaDoc(e,t){var i;if(!(null===(i=e.availabilities)||void 0===i?void 0:i.length)){const t=e.callNumDeweyText||e.callNumDeweyTextOnFail;e.availabilities=[{location:e.provider,callNumber:t,libraries:e.libraries,statusMessage:e.displayText,displayString:e.linkInfo,status:"unknown",type:e.type,contingencyInfo:!0}]}return s.each(e.availabilities,(i=>{if(t&&(i.bibId=e.doc.external_document_id),i.libraries=e.doc.libraries,i.type=i.type||e.type,"ai"!==i.type)return i.link=e.doc.link}))}}a.$inject=["translationService","configService","$filter"],angular.module("summonApp.services").service("rtaAvailabilityService",a)},6243:(e,t,i)=>{"use strict";i.r(t);var s=i(7025),a=i.n(s),r=i(4125),n=i.n(r);class o{constructor(e,t,i,s,a,r,n,o,l,c){var h;this.signInHandler=this.signInHandler.bind(this),this.signOutHandler=this.signOutHandler.bind(this),this.getSavedItems=this.getSavedItems.bind(this),this.hadSavedItems=this.hadSavedItems.bind(this),this.save=this.save.bind(this),this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.clear=this.clear.bind(this),this.showIdleMessage=this.showIdleMessage.bind(this),this.displayDialog=this.displayDialog.bind(this),this.contains=this.contains.bind(this),this.store=e,this.availability=t,this.cookies=i,this.config=s,this.dialogService=a,this.$rootScope=r,this.translationService=n,this.bucket=this.store.bucket("savedItems"),this.retrieving=!1,this.cloudStorage=o,this.hooksService=l,this.filename="savedSummonItems.json",this.fileId=null,this.alerts=c,this.firstSave=!0,this.user={authenticated:!1};const{savedItemsTimeout:d}=this.config.data.savedSearchAndItems;this.loginEnabled=this.config.data.savedSearchAndItems.itemsEnabled&&(null===(h=this.config.data.savedSearchAndItems.providers)||void 0===h?void 0:h.length),(this.bucket.age()>60*d||!this.hadSavedItems())&&this.bucket.clear(),this.items=this.bucket.get("items")||[],this.items.length&&this.availability.getRTA(this.items,!0),l.setHooks(this,"SavedItemsService",["getSavedItems"],!0),this.cloudStorage.on("signIn","savedItemsService",this.signInHandler),this.cloudStorage.on("signOut","savedItemsService",this.signOutHandler)}reset(){this.fileId=null,this.items.splice(0,this.items.length),this.items.push(...this.bucket.get("items")||[])}signInHandler(){this.getSavedItems(),this.user.authenticated=!0,this.cloudStoreFn=this.cloudStoreList}signOutHandler(){this.reset(),this.user.authenticated=!1,this.cloudStoreFn=null}hadSavedItems(){const e=!!this.cookies.getObject("hasSavedItems");return this.cookies.putObject("hasSavedItems",1),e}save(e=null){if(this.cloudStoreFn)return this.cloudStoreFn(this.items,e);{this.bucket.set("items",this.items);const e=this.translationService.translations.ITEM_HAS_BEEN_SAVED;this.alerts.pulseAlert("savedItemSuccess",e)}}cloudStoreList(e,t=null){return this.cloudStorage.writeToFile(e,this.fileId,"items",t).then((e=>{e.newSavedItemsList&&(this.items.splice(0,this.items.length),this.items.push(...e.newSavedItemsList))}))}add(e,t,i){this.firstSave&&(this.firstSave=!1,!this.cloudStoreFn&&this.loginEnabled&&t&&t("savedItem",i));const s=this.formatItemForSave(e);if(this.items.length<50){this.items.push(s),this.save();const e=this.availability.getAvailability(s.availability_id);return e.availabilities||e.error?this.availability.saveRTA(s):this.availability.getSingleDocRTA(s,!0)}return alert("The maximum number of saved results is 50.")}remove(e){const t=n().filter(this.items,(t=>t.bookmark===e.bookmark)),i=n().indexOf(this.items,t[0]);this.items.splice(i,1),this.availability.unsaveRTA(e),this.save(t[0])}clear(){return n().each(this.items,(e=>this.availability.unsaveRTA(e))),this.items.length=0,this.bucket.clear()}showIdleMessage(){if(this.items.length&&!this.idleMessageDisplayed){this.idleMessageDisplayed=!0;const e=this.$rootScope.$new(!0);return e.i18n=this.translationService,e.closeCallback=()=>this.idleMessageDisplayed=!1,e.timeToClear=new Date(Date.now()+3e5).toLocaleTimeString(),e.message="Your saved items will be cleared at %{timeToClear}. Close this dialog before the specified time to retain your saved items.",e.params={timeToClear:new Date(Date.now()+3e5).toLocaleTimeString()},this.displayDialog("alert",e)}}displayDialog(e,t=this.$rootScope.$new(!0)){return this.dialogService.displayDialog(e,t)}contains(e){return!!e&&n()(this.items).some((t=>e.id===t.id))}getSavedItems(){this.retrieving=!0;const e=()=>this.cloudStorage.getFileContents(this.fileId,"items").then((e=>{this.retrieving=!1;const t=n().isEmpty(e)?[]:e;if(this.items.push(...t),this.items.length>t.length)return this.cloudStorage.writeToFile(this.items,this.fileId,"items").then((e=>this.bucket.clear()))})).catch((e=>(this.reset(),this.fire("getSavedItems",e),this.retrieving=!1)));return this.fileId?e():this.cloudStorage.getFileId(this.filename).then((t=>(this.fileId=t,e()))).catch((e=>(this.reset(),this.fire("getSavedItems",e),this.retrieving=!1)))}formatItemForSave(e){var t,i;return{$$hashKey:e.$$hashKey,_hasAltmetric:e._hasAltmetric,authors:e.authors,availability_id:e.availability_id,bookmark:e.bookmark,content_type:e.content_type,course_reserves:e.course_reserves,deweys:e.deweys,display_thumbnail:e.display_thumbnail,editions:e.editions,editors:e.editors,full_title:e.full_title,hasDetailPage:e.hasDetailPage,has_fulltext:e.has_fulltext,id:e.id,index:e.index,is_open_access:e.is_open_access,is_peer_reviewed:e.is_peer_reviewed,issues:e.issues,journalCoverageSummary:{gaps:null===(t=e.journalCoverageSummary)||void 0===t?void 0:t.gaps,range:null===(i=e.journalCoverageSummary)||void 0===i?void 0:i.range},lc_call_numbers:e.lc_call_numbers,libguides:e.libguides,library:e.library,libraries:e.libraries,link:e.link,link_to_pdf:e.link_to_pdf,meeting_names:e.meeting_names,page_count:e.page_count,open_access_link:e.open_access_link,open_url:e.open_url,publication_date:e.publication_date,publication_series_title:e.publication_series_title,publication_title:e.publication_title,publication_years:e.publication_years,scopus_cited_references_url:e.scopus_cited_references_url,scopus_references_count:e.scopus_references_count,secondary_resource_type:e.secondary_resource_type,simple_title:e.simple_title,snippet:e.snippet,summon_additional_links:e.summon_additional_links,thumbnail_small:e.thumbnail_small,volumes:e.volumes,web_of_science:e.web_of_science}}}o.$inject=["storeService","availabilityService","$cookies","configService","dialogService","$rootScope","translationService","cloudStorageService","hooksService","alertService"],a().module("summonApp.services").service("savedItemsService",o)},5473:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,s,a,r,n){this.signInHandler=this.signInHandler.bind(this),this.signOutHandler=this.signOutHandler.bind(this),this.reset=this.reset.bind(this),this.resetCurrentSearch=this.resetCurrentSearch.bind(this),this.setCurrentSearch=this.setCurrentSearch.bind(this),this.saveSearch=this.saveSearch.bind(this),this.removeSearch=this.removeSearch.bind(this),this.removeAllSearches=this.removeAllSearches.bind(this),this.storeList=this.storeList.bind(this),this.cloudStoreList=this.cloudStoreList.bind(this),this.updateScope=this.updateScope.bind(this),this.getSavedSearches=this.getSavedSearches.bind(this),this.getFilterText=this.getFilterText.bind(this),this.config=e,this.appState=t,this.cloudStorage=i,this.i18n=s,this.$q=a,this.store=r,this.filename="savedSummonSearches.json",this.fileId=null,this.savedSearchBucket=this.store.bucket("savedSearches",!0),this.scope={savedSearches:this.savedSearchBucket.get("searches")||[],retrieving:!1},this.resetCurrentSearch(),n.setHooks(this,"SavedSearchService",["getSearches"],!0),this.cloudStorage.on("signIn","savedSearchService",this.signInHandler),this.cloudStorage.on("signOut","savedSearchService",this.signOutHandler)}signInHandler(){return this.getSavedSearches(),this.cloudStoreFn=this.cloudStoreList}signOutHandler(){return this.reset(),this.cloudStoreFn=null}reset(){return this.fileId=null,this.scope.savedSearches=this.savedSearchBucket.get("searches")||[]}resetCurrentSearch(){return this.scope.currentSearch={name:"",filterText:"",activeIdx:-1,saved:!1}}setCurrentSearch(e,t=-1){let i,s;return this.resetCurrentSearch(),e&&(i=e.name||e.params.q,({params:s}=e)),this.scope.currentSearch={name:i||this.appState.params.q,filterText:this.getFilterText(s||this.appState.params),activeIdx:t,saved:!1}}saveSearch(){const e=angular.copy(this.scope.savedSearches),{currentSearch:t}=this.scope;return t.activeIdx<0?e.unshift({name:t.name,params:angular.copy(this.appState.params)}):e[t.activeIdx].name=t.name,this.storeList(e)}removeSearch(e){const t=angular.copy(this.scope.savedSearches),i=t.splice(e,1);return this.storeList(t,i[0])}removeAllSearches(){return this.storeList([],!0)}storeList(e,t=!1){return this.cloudStoreFn?this.cloudStoreFn(e,t):(this.savedSearchBucket.set("searches",e),this.updateScope(e,t),this.$q(((e,t)=>e({}))))}cloudStoreList(e,t=!1){return this.cloudStorage.writeToFile(e,this.fileId,"searches",t).then((i=>(i.newSavedSearchesList?this.updateScope(i.newSavedSearchesList,t):this.updateScope(e,t),i)))}updateScope(e,t=!1){if(this.scope.savedSearches=e,!t){const{currentSearch:e}=this.scope;if(e.saved=!0,e.activeIdx>=0)return this.resetCurrentSearch()}}getSavedSearches(){this.scope.retrieving=!0;const e=()=>this.cloudStorage.getFileContents(this.fileId,"searches").then((e=>{this.scope.retrieving=!1;const t=s.isEmpty(e)?[]:e;return this.scope.savedSearches.length?(this.scope.savedSearches=this.scope.savedSearches.concat(t),this.cloudStorage.writeToFile(this.scope.savedSearches,this.fileId,"searches").then((e=>this.savedSearchBucket.clear()))):this.scope.savedSearches=t})).catch((e=>(this.reset(),this.fire("getSearches",e),this.scope.retrieving=!1)));return this.fileId?e():this.cloudStorage.getFileId(this.filename).then((t=>(this.fileId=t,e()))).catch((e=>(this.reset(),this.fire("getSearches",e),this.scope.retrieving=!1)))}getFilterText(e){const t=[];e.ho||t.push(this.i18n.translations.EXPANDED_RESULTS),null!=e.myinst&&""!==e.myinst&&t.push(this.i18n.translations.ITEMS_AT_MY_INSTITUTION),null!=e.jt&&""!==e.jt&&t.push(this.i18n.translations.JOURNAL_TITLE),e.oaf&&t.push(this.i18n.translations.OPEN_ACCESS_ITEMS_ONLY),null!=e.rf&&""!==e.rf&&t.push(this.i18n.translations.PUB_DATE_RANGE);const i=this.config.data.facets.concat(this.config.data.quickFilters.filters);return s.each(e.fvf,(e=>{const a=e.split(",")[0],r=s.find(i,(e=>e.name===a||e.facet===a));if(null!=r)return t.push(r.label)})),t.length?this.i18n.translations.BY+" "+s.uniq(t).join(", "):""}}a.$inject=["configService","appStateService","cloudStorageService","translationService","$q","storeService","hooksService"],angular.module("summonApp.services").service("savedSearchService",a)},7384:()=>{"use strict";const e="All",t="(Search scope) ";class i{constructor(e,t,i,s,a,r){this.$log=e,this.i18n=a,this.urlService=i,this.hooksService=r,this.appState=s,this.searchScopes=t.data.search.searchScopes,this.getSearchScopeByName=this.getSearchScopeByName.bind(this),this.getDefaultScope=this.getDefaultScope.bind(this),this.getSearchScopeTranslation=this.getSearchScopeTranslation.bind(this),this.searchScopes.forEach((e=>{e.translation||(e.translation=this.getSearchScopeTranslation(e.label))})),this.hasSearchScopes=t.data.search.hasSearchScopes,this.currentSearchScope=this.getDefaultScope(),r.setHooks(this,"SearchScopeService",["clearScopeAsSideEffect"]),this.appState.on("apply",(()=>{var e,t;this.currentSearchScope=this.getSearchScopeByName(null===(t=null===(e=this.appState)||void 0===e?void 0:e.params)||void 0===t?void 0:t.searchscope),this.currentSearchScope&&this.appState.parseSearchScopeFromUrlParams(this.currentSearchScope.query)})),this.warningMetaData={fromAdvanced:!1,scopeLabel:""}}getSearchScopeByName(t){return t&&(this.searchScopes.find((e=>e.label===t))||this.searchScopes.find((t=>t.label===e)))||this.searchScopes[0]}getSearchScopeTranslation(e){let i=this.i18n.translate(t+e);return i.includes(t)&&(i=e),i}getDefaultScope(){return this.getSearchScopeByName("All")}updateState(e,t=!0){t&&e&&(this.appState.params=angular.extend(this.appState.params,{searchscope:e.label}))}getDefaultScopeName(){return e}updateStateByScopeName(e){const t=this.getSearchScopeByName(e);this.updateState(t)}clearScopeAsSideEffect(t="",i,s){var a;const r=t||(null===(a=this.currentSearchScope)||void 0===a?void 0:a.label);r&&r!==e&&this.fire("clearScopeAsSideEffect",t,i,s)}setDefaultScope(){this.appState.params=angular.extend(this.appState.params,{searchscope:e})}isDefaultScope(t){return t===e}}i.$inject=["$log","configService","urlService","appStateService","translationService","hooksService"],angular.module("summonApp.services").service("searchScopeService",i)},3964:()=>{"use strict";class e{constructor(e,t){this.appState=e,this.events=t}runSearch(e,t){const{query:i}=e;return this.appState.applyStateWithSnapShot((()=>{const{params:e}=this.appState;return delete e.sort,delete e.exp,delete e.ru,delete e.edym,""!==i&&delete e.bookMark,e.q=i,e.pn=1,e})),this.events.publish("actions","searchbox:query",{source:t,terms:i}),this.events.gaPush("search","new",i)}}e.$inject=["appStateService","eventService"],angular.module("summonApp.services").service("searchService",e)},6934:()=>{"use strict";class e{static initClass(){this.prototype.shortenedRegexTest=/(^https?:\/\/(www\.)?tinyurl\.com)|(^https:\/\/exlibris\.link)/}constructor(e,t){this.getShorten=this.getShorten.bind(this),this.$http=e,this.$q=t,this.shortenedUrls={}}getShorten(e,t){return this.shortenedRegexTest.test(e)?this.$q((t=>t(e))):this.shortenedUrls.hasOwnProperty(e)?this.$q((t=>t(this.shortenedUrls[e]))):this.$http.post("/short_url",e).then((i=>200==i.status?this.shortenedUrls[e]=i.data:t)).catch((e=>{this.$log.error(e)}))}}e.initClass(),e.$inject=["$http","$q"],angular.module("summonApp.services").service("shortenUrlService",e)},4718:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e,t,i,a,r,n,o,l,c){this.logoutHandler=this.logoutHandler.bind(this),this.loginHandler=this.loginHandler.bind(this),this.mapSierraBibIdToSummonParticipantId=this.mapSierraBibIdToSummonParticipantId.bind(this),this.transformBibId=this.transformBibId.bind(this),this.createAlwaysSuccessPromise=this.createAlwaysSuccessPromise.bind(this),this.handleError=this.handleError.bind(this),this.$http=t,this.configService=a,this.$log=o,this.$q=l,this.$timeout=c,this.auth=i,this.baseUrl="/sierra_api",this.userInfo=null,this.alerts=r,this.previousHoldRequestId=null,this.activationStatusIsEditable=!0,this.alerts.resetAlert("sierraApiError"),this.locations={},this.branches=[],this.newRequestMade=!1,this.provider="",this.patronInfoLoadedPromise=this.$q.defer(),this.configService.data.libraryCard.enableSierra&&(this.authConfig=this.configService.data.authentication,this.authFeature=i.registerFeature("sierra","LIBRARY_CARD_FEATURE"),s.includes(["CAS","Both"],this.authConfig.sierraAuthProtocol)&&this.authFeature.setProvider("cas",{}),s.includes(["SAML","Both"],this.authConfig.sierraAuthProtocol)&&this.authFeature.setProvider("saml",{}),e.$on(n.LOGINSUCCESS,((e,t)=>{if(this.auth.providerSupportsFeature(t.provider,"sierra"))return this.provider=t.provider,this.loginHandler(t.provider)})),e.$on(n.LOGOUTSUCCESS,((e,t)=>{if(this.auth.providerSupportsFeature(t.provider,"sierra"))return this.provider="",this.logoutHandler(t.provider)})))}logoutHandler(e){return this.userInfo=null,this.auth.setUserNameForProvider("",e),this.auth.setEmailForProvider("",e),this.auth.setUserNameForBanner(""),this.auth.setSierraPatronIdForProvider("",e),this.patronInfoLoadedPromise=this.$q.defer()}loginHandler(e){return this.getInitialSessionData().then((t=>{if(this.userInfo=t.data,this.auth.setUserNameForProvider(this.userInfo.username,e),this.auth.setEmailForProvider(this.userInfo.email,e),this.auth.setUserNameForBanner(this.userInfo.username),this.auth.setSierraPatronIdForProvider(this.userInfo.id,e),this.userInfo.auth){const t=!0;this.auth.afterLogIn(e,this.userInfo.auth,t)}return this.patronInfoLoadedPromise.resolve()})).catch((e=>(this.$log.error("Could not get user data via Sierra service",e.data),this.patronInfoLoadedPromise.reject(e))))}getInitialSessionData(){return this.$http.get(`${this.baseUrl}/patrons/${this.getLoggedInUser()}/init/${this.provider}`)}isUserInfoNull(){return null===this.userInfo}getLoadedUserInfo(){return this.userInfo}isNewRequestMade(){return this.newRequestMade}resetNewRequestTracker(){return this.newRequestMade=!1}getHoldRequestByBibId(e){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/holds/requests/form?recordNumber=${e}`,{cache:!0})}getItemsInfo(e){return angular.isArray(e)&&(e=e.join(",")),this.$http.get(`${this.baseUrl}/items?fields=varFields&id=${e}`)}getItemByItemId(e){return this.$http.get(`${this.baseUrl}/items?id=${e}`)}getItemByBibId(e){return this.$http.get(`${this.baseUrl}/bibs/${e}`)}getHolds(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/holds?expand=record`)}deleteHold(e){return this.$http.delete(`${this.baseUrl}/patrons/${this.getPatronId()}/holds/${encodeURIComponent(e)}`)}getCheckouts(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts?expand=item`)}renewCheckout(e){return this.$http.post(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/${encodeURIComponent(e)}`)}getRedirectLinkToSierraFinePage(){var e,t;const i=null===(t=null===(e=this.configService.data.rtaAvailability.dbs[0])||void 0===e?void 0:e.availabilityLink)||void 0===t?void 0:t.url,s=new URL(i);return`${s.protocol}//${s.host}/patroninfo~S01/${this.getPatronId()}/overdues`}updateUserDetails(e){return this.$http.put(`${this.baseUrl}/patrons/${this.getPatronId()}`,e)}getReadingHistoryIfActivatedOrInferrable(){return this.getReadingHistoryActivationStatus().then((e=>e.data.readingHistoryActivation?(e.data.inferred&&(this.activationStatusIsEditable=!1),this.getReadingHistory()):this.$q.resolve(e)))}getReadingHistory(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/history`)}getReadingHistoryActivationStatus(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/history/activationStatus`)}optInToReadingHistory(){return this.updateReadingHistoryActivation({readingHistoryActivation:!0})}optOutFromReadingHistory(){return this.updateReadingHistoryActivation({readingHistoryActivation:!1})}getWebPacReadingHistoryOptInLink(){return this.configService.data.libraryCard.webpacPatronInfoUrl.length?`${this.configService.data.libraryCard.webpacPatronInfoUrl}/${this.getPatronId()}/readinghistory/OptIn`:""}deleteReadingHistoryAndOptOut(){return this.deleteAllReadingHistoryEntries().then((()=>this.optOutFromReadingHistory()))}updateReadingHistoryActivation(e){return this.$http.post(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/history/activationStatus`,e)}deleteReadingHistoryEntry(e){return this.$http.delete(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/history/${encodeURIComponent(e)}`)}deleteAllReadingHistoryEntries(){return this.$http.delete(`${this.baseUrl}/patrons/${this.getPatronId()}/checkouts/history`)}getFines(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}/fines?expand=item`)}getExternalMessages(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}?fields=message`)}getMessages(){return this.userInfo.message.accountMessages||[]}getLoggedInUser(){return this.auth.getUserForProvider(this.provider)}userIdentifierIsMail(){return/@/g.test(this.getLoggedInUser())}getPatronId(){return this.auth.getSierraPatronIdForProvider(this.provider)}getOrRenewPatronInfo(){return this.userInfo?this.renewPatronInfo():this.loginHandler()}renewPatronInfo(){return this.$http.get(`${this.baseUrl}/patrons/${this.getPatronId()}?fields=emails,phones,addresses`).then((e=>{var t;const i=e.data,s=(null===(t=i.emails)||void 0===t?void 0:t.length)?i.emails[0]:"";return this.auth.setEmailForProvider(s,this.provider),this.userInfo.email=s,this.userInfo.emails=i.emails,this.userInfo.phones=i.phones,this.userInfo.addresses=i.addresses}))}createHoldRequest(e,t){return this.previousHoldRequestId=null,this.$http.post(`${this.baseUrl}/patrons/${this.getPatronId()}/holds/requests`,e).then((()=>(this.previousHoldRequestId=t,this.newRequestMade=!0)))}updateHold(e,t){return this.$http.put(`${this.baseUrl}/patrons/${this.getPatronId()}/holds/${e}`,t)}getIdFromUrlString(e){const t=e.lastIndexOf("/");return e.substring(t+1)}getCatalogIdPrefix(){const e=s(this.configService.data.rtaAvailability.dbs).filter((e=>{var t;return-1!==(null===(t=e.availabilityLink)||void 0===t?void 0:t.ilsType.indexOf("SierraApiHttpConnector"))}))[0];return e&&null!=e.idPrefix?e.idPrefix:`${this.configService.data.rtaAvailability.client}_catalog_`}getBibIdCheckDigit(e){return this.multiplier=1,this.multiplied=s.map(e.split("").reverse(),(e=>(this.multiplier++,parseInt(e)*this.multiplier))),this.checkDigit=this.multiplied.reduce(((e,t)=>e+t))%11,10!==this.checkDigit?this.checkDigit:"x"}mapSierraBibIdToSummonParticipantId(e){return`${this.getCatalogIdPrefix()}b${e}${this.getBibIdCheckDigit(e)}`}createApiQuery(e,t=!1){t&&(e=s.filter(e,(e=>e.bibId)));const i=s.map(e,(e=>e.bibId));return i.length>0&&{solrPassThroughQuery:s.map(i,(e=>`(sys_participant_id:(${this.mapSierraBibIdToSummonParticipantId(e)}))`)).join(" OR "),ho:!1,pn:0,ps:i.length}}findDocIfExists(e,t){const i=s.flatten(e.concat(e.map((e=>e.peer_documents))));return s.find(i,(e=>!!e&&(!!s.any(e.participant_ids,(e=>e===this.mapSierraBibIdToSummonParticipantId(t)))||`b${t}${this.getBibIdCheckDigit(t)}`===e.external_document_id||`b${t}`===e.external_document_id||void 0)))}createDummyDoc(e){return{content_type:"",display_thumbnail:"",missingDocDisplay:e}}transformBibId(e){const t=s(this.configService.data.rtaAvailability.dbs).filter((e=>{var t;return-1!==(null===(t=e.availabilityLink)||void 0===t?void 0:t.ilsType.indexOf("SierraApiHttpConnector"))}))[0];if(null!=t.availabilityLink.idPattern&&null!=t.availabilityLink.idReplacement){const i=new RegExp(t.availabilityLink.idPattern);return e.replace(i,t.availabilityLink.idReplacement)}return e}createAlwaysSuccessPromise(e,t){const i=this.$q.defer();return e.then((e=>{const s={original:e,status:"success",holdId:t};return i.resolve(s)})).catch((e=>{const s={original:e,status:"error",holdId:t};return i.resolve(s)})),i.promise}handleError(e){return this.$log.error(e),this.alerts.setAlert("sierraApiError","Error performing API request.")}}a.$inject=["$rootScope","$http","authenticationService","configService","alertService","$authEvents","$log","$q","$timeout"],angular.module("summonApp.services").service("sierraService",a)},1403:()=>{"use strict";class e{constructor(e){this.set=this.set.bind(this),this.get=this.get.bind(this),this.clear=this.clear.bind(this),this.save=this.save.bind(this),this.timestamp=this.timestamp.bind(this),this.age=this.age.bind(this),this.data=e,this.data||(this.data={values:{}},this.save())}set(e,t){return this.data.values[e]=t,this.save()}get(e){return this.data.values[e]}clear(){return this.data.values={},this.save()}save(){return this.timestamp(),this.persist(this.data)}timestamp(){return this.data.touched=(new Date).getTime()}age(){return((new Date).getTime()-this.data.touched)/1e3}persist(e){}}let t;class i{static initClass(){t=angular.noop}constructor(){return this.bucket=this.bucket.bind(this),this.restore=this.restore.bind(this),t.apply(this,arguments)}bucket(e,t=!1){return this.restore(e,t)}persist(e,t,i){const s=JSON.stringify(t);let a=!0;if(i)try{sessionStorage.setItem(e,s)}catch(e){a=!1}else try{localStorage.setItem(e,s)}catch(e){a=!1}return a}restore(t,i){let s;const a=i?(()=>{try{return sessionStorage.getItem(t)}catch(e){}})():(()=>{try{return localStorage.getItem(t)}catch(e){}})();return s=a?new e(JSON.parse(a)):new e,s.persist=e=>this.persist(t,e,i),s}}i.initClass(),angular.module("summonApp.services").service("storeService",i)},4296:(e,t,i)=>{"use strict";i.r(t);var s=i(7025),a=i.n(s),r=i(4125),n=i.n(r);class o{constructor(e,t,i,s,a,r,n,o,l){this.init=this.init.bind(this),this.loginSuccessHandler=this.loginSuccessHandler.bind(this),this.logoutSuccessHandler=this.logoutSuccessHandler.bind(this),this.getFileId=this.getFileId.bind(this),this.getAllSearches=this.getAllSearches.bind(this),this.getFileContents=this.getFileContents.bind(this),this.writeToFile=this.writeToFile.bind(this),this.createRequestsForData=this.createRequestsForData.bind(this),this.handleApiError=this.handleApiError.bind(this),this.createRequest=this.createRequest.bind(this),this.createAlwaysSuccessPromise=this.createAlwaysSuccessPromise.bind(this),this.waitOnAllPromises=this.waitOnAllPromises.bind(this),this.searchesResultCallback=this.searchesResultCallback.bind(this),this.itemsResultCallback=this.itemsResultCallback.bind(this),this.i18n=i,this.$q=a,this.$http=r,this.$log=n,this.authService=o,this.$timeout=l,this.savedSearchConfigs=e.data.savedSearchAndItems,this.saveSearchEndpoint="/save-search/",this.saveItemEndpoint="/save-item/",this.scope={name:"Summon",fileId:"dummy",providerDisplayName:"",userId:"test_user",initialized:!1,userDisplay:"",provider:"",tryAgainPromise:null,currentWriteId:0,searches:[],items:[]},s.setHooks(this,"SummonUserService",["initSuccess","initFailed","signOut"])}init(){this.savedSearchConfigs.providers.includes("summon")&&(this.savedSearchConfigs.searchEnabled||this.savedSearchConfigs.itemsEnabled)&&(this.scope.provider=this.authService.getProviderForFeature("cloudStorage"),this.scope.providerDisplayName=this.authService.scope.auth[this.scope.provider].displayName,this.scope.canLoginManually=this.authService.scope.auth[this.scope.provider].canLoginManually)}loginSuccessHandler(e,t){let i;if(this.savedSearchConfigs.providers.includes("summon")&&this.authService.providerSupportsFeature(t.provider,"cloudStorage"))return this.scope.provider=t.provider,this.scope.userId=this.authService.scope.auth[this.scope.provider].user,this.scope.userId.includes("@")&&(i=this.scope.userId),this.scope.userDisplay=this.authService.scope.auth[this.scope.provider].username||i,this.scope.userId?(this.scope.initialized=!0,this.fire("initSuccess")):(this.$log.error("No userId, cannot initialize Summon Cloud API"),this.fire("initFailed"))}logoutSuccessHandler(e,t){if(t.provider===this.scope.provider)return this.scope.userId="",this.scope.userDisplay="",this.scope.searches=[],this.fire("signOut")}getFileId(e){return this.$q.resolve(this.scope.fileId)}getAllSearches(){return this.createRequest(this.saveSearchEndpoint).then((e=>(this.scope.tryAgainPromise=null,this.scope.searches=e.reverse(),{newSavedSearchesList:this.scope.searches}))).catch((e=>(500===e.status&&(this.scope.tryAgainPromise&&this.$timeout.cancel(this.scope.tryAgainPromise),this.scope.tryAgainPromise=this.$timeout((()=>this.getAllSearches()),1e4),this.$log.debug("Error retrieving all searches, started a timer to retry in 10 seconds",e)),404===e.status&&"GET"===e.config.method&&(this.scope.searches=[]),[])))}getAllItems(e){return this.createRequest(this.saveItemEndpoint).then((t=>(this.scope.tryAgainPromise=null,e===this.scope.currentWriteId?(this.scope.items=t,{newSavedItemsList:[...this.scope.items]}):{writeInProgress:!0}))).catch((t=>(500===t.status&&(this.scope.tryAgainPromise&&this.$timeout.cancel(this.scope.tryAgainPromise),this.scope.tryAgainPromise=this.$timeout((()=>this.getAllItems(e)),1e4),this.$log.debug("Error retrieving all items, started a timer to retry in 10 seconds",t)),404===t.status&&"GET"===t.config.method&&(this.scope.items=[]),[])))}getFileContents(e,t){if("searches"===t)return this.getAllSearches().then((e=>e.newSavedSearchesList||[]));if("items"===t){const e=this.scope.currentWriteId;return this.getAllItems(e).then((e=>e.newSavedItemsList||[]))}}writeToFile(e,t,i,s){this.scope.currentWriteId++;const a=this.scope.currentWriteId;return this.createRequestsForData(e,i,s).then((e=>"searches"===i?this.getAllSearches():"items"===i?this.getAllItems(a):void 0)).catch((e=>("searches"===i?this.getAllSearches():"items"===i&&this.getAllItems(a),this.handleApiError(e.failed[0].original))))}createRequestsForData(e,t,i){const s=[],a="searches"===t?this.saveSearchEndpoint:this.saveItemEndpoint;return"searches"===t?this.createRequestsForSearchData(e,i,s,a):"items"===t&&this.createRequestsForItemData(e,i,s,a),this.waitOnAllPromises(s)}createRequestsForSearchData(e,t,i,s){if(t)if(t.id)i.push(this.createRequest(s,"DELETE",{id:t.id}));else{const e=n().find(this.scope.searches,(e=>e.name===t.name&&n().isEqual(e.params,t.params)));i.push(this.createRequest(s,"DELETE",{id:e.id}))}else for(var a of e||[]){var r={name:a.name,params:a.params?JSON.stringify(a.params):""},o=n().find(this.scope.searches,(e=>e.id===a.id));o&&a.name!==o.name?i.push(this.createRequest(s,"PUT",{id:o.id,search:r})):o||i.push(this.createRequest(s,"POST",{search:r}))}}createRequestsForItemData(e,t,i,s){var a,r,o,l;if(t&&t.bookmark)i.push(this.createRequest(s,"DELETE",{bookmark:t.bookmark}));else for(var c of e||[]){var h={hashKey:c.$$hashKey,_hasAltmetric:c._hasAltmetric,availabilityId:c.availability_id,authors:(null===(a=c.authors)||void 0===a?void 0:a.length)?c.authors.map((e=>({fullname:e.fullname,givenname:e.givenname,surname:e.surname,hashKey:e.$$hashKey}))):[],bookmark:c.bookmark,contentType:c.content_type,courseReserves:c.course_reserves,deweys:c.deweys,displayThumbnail:c.display_thumbnail,editions:c.editions,editors:c.editors,fullTitle:c.full_title,hasDetailPage:c.hasDetailPage,hasFullText:c.has_fulltext,id:c.id,index:c.index,isOpenAccess:c.is_open_access,isPeerReviewed:c.is_peer_reviewed,issues:c.issues,journalCoverageSummary:c.journalCoverageSummary,lcCallNumbers:c.lc_call_numbers,libguides:c.libguides,library:c.library,libraries:c.libraries,link:c.link,linkToPdf:c.link_to_pdf,meetingNames:c.meeting_names,pageCount:c.page_count,openAccessLink:c.open_access_link,openUrl:c.open_url,publicationDate:c.publication_date,publicationSeriesTitle:c.publication_series_title,publicationTitle:c.publication_title,publicationYears:c.publication_years,scopusCitedReferencesUrl:c.scopus_cited_references_url,scopusReferencesCount:c.scopus_references_count,secondaryResourceType:c.secondary_resource_type,summonAdditionalLinks:(null===(r=c.summon_additional_links)||void 0===r?void 0:r.length)?c.summon_additional_links.map((e=>({databaseName:e.database_name,dbid:e.dbid,link:e.link,priority:e.priority,providerName:e.provider_name}))):[],simpleTitle:c.simple_title,snippet:c.snippet,thumbnailSmall:c.thumbnail_small,volumes:c.volumes,webOfScience:{referencesUrl:(null===(o=c.web_of_science)||void 0===o?void 0:o.references_url)||"",referencesCount:(null===(l=c.web_of_science)||void 0===l?void 0:l.references_count)||0}};n().find(this.scope.items,(e=>e.bookmark===c.bookmark))||i.push(this.createRequest(s,"POST",h))}}handleApiError(e){const t=new Error;if(t.name="Summon storage error",null==(null==e?void 0:e.statusText)&&null==(null==e?void 0:e.error))return t.message=-1===(null==e?void 0:e.status)?this.i18n.translations.CLOUD_STORAGE_API_ERROR_NETWORK_ERROR:"Unknown",this.$q.reject(t);if("The search already exists"==e.data.description)return t.message="duplicate",this.$log.error(t),this.$q.reject(t);switch(e.data.description){case"cancelled":t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_CANCELED;break;case"invalid_session":t.message=this.i18n.translations.CLOUD_STORAGE_AUTH_ERROR;break;default:t.message=e.data.error+" ("+e.data.description+")"}return this.$log.error(t),this.$q.reject(t)}searchesResultCallback(e){return 200===e.status?"GET"===e.config.method&&e.data&&a().isArray(e.data)?n().map(e.data,(e=>{const t={};if(t.id=e.id,t.name=e.search.searchName,t.params={},e.search.parameters)try{t.params=JSON.parse(e.search.parameters)}catch(t){this.$log.debug("Could not parse search param as json, ignoring: ",e.search.parameters,t)}return t})):"POST"===e.config.method||"PUT"===e.config.method?{updated:e.data.id}:(this.$log.debug("We got a non-error response, but cannot parse it... returning empty object Â¯_(ãƒ„)_/Â¯",e),{}):404===e.status&&"GET"===e.config.method?(this.$log.debug("User has no saved searches yet, returning empty object"),{}):(404===e.status&&e.config.method,this.handleApiError(e))}itemsResultCallback(e){return 200===e.status?"GET"===e.config.method&&e.data&&a().isArray(e.data)?n().map(e.data,(e=>({$$hashKey:e.hashKey,_hasAltmetric:e._hasAltmetric,authors:e.authors.map((e=>({fullname:e.fullname,givenname:e.givenname,surname:e.surname,$$hashKey:e.hashKey}))),availability_id:e.availabilityId,bookmark:e.bookmark,content_type:e.contentType,course_reserves:e.courseReserves,deweys:e.deweys,display_thumbnail:e.displayThumbnail,editions:e.editions,editors:e.editors,full_title:e.fullTitle,hasDetailPage:e.hasDetailPage,has_fulltext:e.hasFullText,id:e.id,index:e.index,is_open_access:e.isOpenAccess,is_peer_reviewed:e.isPeerReviewed,issues:e.issues,journalCoverageSummary:e.journalCoverageSummary,lc_call_numbers:e.lcCallNumbers,libguides:e.libguides,library:e.library,libraries:e.libraries,link:e.link,link_to_pdf:e.linkToPdf,meeting_names:e.meetingNames,open_access_link:e.openAccessLink,open_url:e.openUrl,page_count:e.pageCount,publication_date:e.publicationDate,publication_series_title:e.publicationSeriesTitle,publication_title:e.publicationTitle,publication_years:e.publicationYears,scopus_cited_references_url:e.scopusCitedReferencesUrl,scopus_references_count:e.scopusReferencesCount,secondary_resource_type:e.secondaryResourceType,summon_additional_links:e.summonAdditionalLinks.map((e=>({database_name:e.databaseName,dbid:e.dbid,link:e.link,priority:e.priority,provider_name:e.providerName}))),simple_title:e.simpleTitle,snippet:e.snippet,thumbnail_small:e.thumbnailSmall,volumes:e.volumes,web_of_science:{references_url:e.webOfScience.referencesUrl||void 0,references_count:e.webOfScience.referencesCount||void 0}}))):"POST"===e.config.method||"PUT"===e.config.method?{updated:e.data.id}:(this.$log.debug("We got a non-error response, but cannot parse it... returning empty object Â¯_(ãƒ„)_/Â¯",e),{}):404===e.status&&"GET"===e.config.method?(this.$log.debug("User has no saved items yet, returning empty object"),{}):(404===e.status&&e.config.method,this.handleApiError(e))}createRequest(e,t="GET",i,s){if(!this.scope.userId)throw new Error(`cannot perform ${e} request, no user available, please log in`);const a={method:t,url:e+this.scope.userId,headers:{"Content-Type":"application/json"}};i&&(a.data=i),s&&(a.params=s);const r=e===this.saveSearchEndpoint?this.searchesResultCallback:this.itemsResultCallback;return this.$http(a).then(r)}createAlwaysSuccessPromise(e,t){const i=this.$q.defer();return e.then((function(e){const s={original:e,status:"success",id:t};return i.resolve(s)})).catch((function(e){const s={original:e,status:"error",id:t};return i.resolve(s)})),i.promise}waitOnAllPromises(e){const t=n().map(e,(e=>this.createAlwaysSuccessPromise(e))),i=this.$q.defer();return this.$q.all(t).then((e=>{const t=n().filter(e,(e=>"success"!==e.status));return 0===t.length?i.resolve({results:e}):i.reject({results:e,failed:t})})),i.promise}}o.$inject=["configService","storeService","translationService","hooksService","$q","$http","$log","authenticationService","$timeout"],a().module("summonApp.services").service("summonUserService",o)},5341:()=>{"use strict";class e{constructor(e){this.icons={error:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",hand:"M21,6.58V18.67A3.33,3.33 0 0,1 17.67,22H11.58C10.68,22 9.83,21.64 9.21,21L2.67,14.36C2.67,14.36 3.72,13.33 3.75,13.32C3.93,13.16 4.16,13.07 4.41,13.07C4.59,13.07 4.76,13.12 4.91,13.21C4.94,13.22 8.5,15.26 8.5,15.26V5.33A1.25,1.25 0 0,1 9.75,4.08A1.25,1.25 0 0,1 11,5.33V11.17H11.83V3.25A1.25,1.25 0 0,1 13.08,2C13.78,2 14.33,2.56 14.33,3.25V11.17H15.17V4.08C15.17,3.39 15.72,2.83 16.42,2.83A1.25,1.25 0 0,1 17.67,4.08V11.17H18.5V6.58A1.25,1.25 0 0,1 19.75,5.33A1.25,1.25 0 0,1 21,6.58Z",accountCheckOutline:"M21.1,12.5L22.5,13.91L15.97,20.5L12.5,17L13.9,15.59L15.97,17.67L21.1,12.5M11,4A4,4 0 0,1 15,8A4,4 0 0,1 11,12A4,4 0 0,1 7,8A4,4 0 0,1 11,4M11,6A2,2 0 0,0 9,8A2,2 0 0,0 11,10A2,2 0 0,0 13,8A2,2 0 0,0 11,6M11,13C11.68,13 12.5,13.09 13.41,13.26L11.74,14.93L11,14.9C8.03,14.9 4.9,16.36 4.9,17V18.1H11.1L13,20H3V17C3,14.34 8.33,13 11,13Z",quote:"M14,17H17L19,13V7H13V13H16M6,17H9L11,13V7H5V13H8L6,17Z",folderPlusOutline:"M12 12H14V10H16V12H18V14H16V16H14V14H12V12M22 8V18C22 19.11 21.11 20 20 20H4C2.89 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.11 6 22 6.89 22 8M20 8H4V18H20V8Z",shareVariant:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z",emailOutline:"M22 6C22 4.9 21.1 4 20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6M20 6L12 11L4 6H20M20 18H4V8L12 13L20 8V18Z",library:"M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z",facebook:"M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 21.96V14.96H7.9V12.06H10.44V9.85C10.44 7.34 11.93 5.96 14.22 5.96C15.31 5.96 16.45 6.15 16.45 6.15V8.62H15.19C13.95 8.62 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.96H13.56V21.96A10 10 0 0 0 22 12.06C22 6.53 17.5 2.04 12 2.04Z",twitter:"M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z",pinterest:"M9.04,21.54C10,21.83 10.97,22 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2A10,10 0 0,0 2,12C2,16.25 4.67,19.9 8.44,21.34C8.35,20.56 8.26,19.27 8.44,18.38L9.59,13.44C9.59,13.44 9.3,12.86 9.3,11.94C9.3,10.56 10.16,9.53 11.14,9.53C12,9.53 12.4,10.16 12.4,10.97C12.4,11.83 11.83,13.06 11.54,14.24C11.37,15.22 12.06,16.08 13.06,16.08C14.84,16.08 16.22,14.18 16.22,11.5C16.22,9.1 14.5,7.46 12.03,7.46C9.21,7.46 7.55,9.56 7.55,11.77C7.55,12.63 7.83,13.5 8.29,14.07C8.38,14.13 8.38,14.21 8.35,14.36L8.06,15.45C8.06,15.62 7.95,15.68 7.78,15.56C6.5,15 5.76,13.18 5.76,11.71C5.76,8.55 8,5.68 12.32,5.68C15.76,5.68 18.44,8.15 18.44,11.43C18.44,14.87 16.31,17.63 13.26,17.63C12.29,17.63 11.34,17.11 11,16.5L10.33,18.87C10.1,19.73 9.47,20.88 9.04,21.57V21.54Z",whatsapp:"M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.05 22L7.3 20.62C8.75 21.41 10.38 21.83 12.04 21.83C17.5 21.83 21.95 17.38 21.95 11.92C21.95 9.27 20.92 6.78 19.05 4.91C17.18 3.03 14.69 2 12.04 2M12.05 3.67C14.25 3.67 16.31 4.53 17.87 6.09C19.42 7.65 20.28 9.72 20.28 11.92C20.28 16.46 16.58 20.15 12.04 20.15C10.56 20.15 9.11 19.76 7.85 19L7.55 18.83L4.43 19.65L5.26 16.61L5.06 16.29C4.24 15 3.8 13.47 3.8 11.91C3.81 7.37 7.5 3.67 12.05 3.67M8.53 7.33C8.37 7.33 8.1 7.39 7.87 7.64C7.65 7.89 7 8.5 7 9.71C7 10.93 7.89 12.1 8 12.27C8.14 12.44 9.76 14.94 12.25 16C12.84 16.27 13.3 16.42 13.66 16.53C14.25 16.72 14.79 16.69 15.22 16.63C15.7 16.56 16.68 16.03 16.89 15.45C17.1 14.87 17.1 14.38 17.04 14.27C16.97 14.17 16.81 14.11 16.56 14C16.31 13.86 15.09 13.26 14.87 13.18C14.64 13.1 14.5 13.06 14.31 13.3C14.15 13.55 13.67 14.11 13.53 14.27C13.38 14.44 13.24 14.46 13 14.34C12.74 14.21 11.94 13.95 11 13.11C10.26 12.45 9.77 11.64 9.62 11.39C9.5 11.15 9.61 11 9.73 10.89C9.84 10.78 10 10.6 10.1 10.45C10.23 10.31 10.27 10.2 10.35 10.04C10.43 9.87 10.39 9.73 10.33 9.61C10.27 9.5 9.77 8.26 9.56 7.77C9.36 7.29 9.16 7.35 9 7.34C8.86 7.34 8.7 7.33 8.53 7.33Z",telegram:"M9.78,18.65L10.06,14.42L17.74,7.5C18.08,7.19 17.67,7.04 17.22,7.31L7.74,13.3L3.64,12C2.76,11.75 2.75,11.14 3.84,10.7L19.81,4.54C20.54,4.21 21.24,4.72 20.96,5.84L18.24,18.65C18.05,19.56 17.5,19.78 16.74,19.36L12.6,16.3L10.61,18.23C10.38,18.46 10.19,18.65 9.78,18.65Z",evernote:"M15.09,11.63C15.09,11.63 15.28,10.35 16,10.35C16.76,10.35 17.78,12.06 17.78,12.06C17.78,12.06 15.46,11.63 15.09,11.63M19,4.69C18.64,4.09 16.83,3.41 15.89,3.41C14.96,3.41 13.5,3.41 13.5,3.41C13.5,3.41 12.7,2 10.88,2C9.05,2 9.17,2.81 9.17,3.5V6.32L8.34,7.19H4.5C4.5,7.19 3.44,7.91 3.44,9.44C3.44,11 3.92,16.35 7.13,16.85C10.93,17.43 11.58,15.67 11.58,15.46C11.58,14.56 11.6,13.21 11.6,13.21C11.6,13.21 12.71,15.33 14.39,15.33C16.07,15.33 17.04,16.3 17.04,17.29C17.04,18.28 17.04,19.13 17.04,19.13C17.04,19.13 17,20.28 16,20.28C15,20.28 13.89,20.28 13.89,20.28C13.89,20.28 13.2,19.74 13.2,19C13.2,18.25 13.53,18.05 13.93,18.05C14.32,18.05 14.65,18.09 14.65,18.09V16.53C14.65,16.53 11.47,16.5 11.47,18.94C11.47,21.37 13.13,22 14.46,22C15.8,22 16.63,22 16.63,22C16.63,22 20.56,21.5 20.56,13.75C20.56,6 19.33,5.28 19,4.69M7.5,6.31H4.26L8.32,2.22V5.5L7.5,6.31Z",linkedin:"M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z",files:"M13 0H6a2 2 0 0 0-2 2 2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2 2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 13V4a2 2 0 0 0-2-2H5a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1zM3 4a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4z",search:"M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5l-1.5 1.5l-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16A6.5 6.5 0 0 1 3 9.5A6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14S14 12 14 9.5S12 5 9.5 5z"},this.custom={peerReviewed:{viewBox:"0 0 37 46",xml:'<g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="image" fill="#767676" fill-rule="nonzero"> <path d="M15.048,0.404 C12.32,1.003 9.77,2.231 7.864,3.864 C6.122,5.357 4.1,8.027 4.1,8.834 C4.1,9.496 6.263,12.444 7.681,13.716 C9.708,15.533 13.826,17.306 16.541,17.532 C22.322,18.01 27.954,15.429 31.032,10.89 C31.729,9.862 32.3,8.916 32.3,8.79 C32.3,8.286 29.809,5.1 28.521,3.955 C26.653,2.295 23.171,0.672 20.638,0.281 C18.05,-0.119 17.362,-0.104 15.048,0.404 M18.129,2.706 C21.466,2.706 24.172,5.432 24.172,8.794 C24.172,12.157 21.466,14.882 18.128,14.882 L18.128,14.8810294 L17.9024143,14.8778019 C14.7446281,14.7605974 12.2065114,12.2037079 12.0901673,9.02228232 L12.086,8.794 C12.086,5.432 14.791,2.706 18.129,2.706 Z M18.2,5.412 C16.346,5.412 14.843,6.926 14.843,8.794 C14.843,10.662 16.346,12.176 18.2,12.176 C20.054,12.176 21.557,10.662 21.557,8.794 C21.557,6.926 20.054,5.412 18.2,5.412 Z M0.07,28.106 L0.07,39.076 L2.723,39.286 C7.23,39.643 15.239,42.978 17.358,45.381 C18.153,46.283 18.234,46.267 19.848,44.882 C23.205,42.004 29.044,39.672 33.938,39.252 L36.822,39.006 L36.911,27.959 L37,16.912 L33.891,17.321 C29.688,17.874 29.04,18.041 26.014,19.338 C23.307,20.5 20.009,22.509 19.23,23.472 C18.636,24.207 18.128,24.167 17.158,23.307 C13.308,19.895 5.932,17.135 0.668,17.135 C0.108,17.135 0.071,17.825 0.071,28.105 M0,28.073 C0,34.401 0.045,36.99 0.1,33.826 C0.156,30.662 0.156,25.485 0.1,22.321 C0.045,19.157 0,21.746 0,28.073" id="Shape"></path> </g> </g>'},openAccess:{viewBox:"0 0 640 1000",xml:'<rect width="640" height="1000" fill="#ffffff"/> <g stroke="#767676" stroke-width="104.764" fill="none"> <path d="M111.387,308.135V272.408A209.21,209.214 0 0,1 529.807,272.408V530.834"/> <circle cx="320.004" cy="680.729" r="256.083"/> </g> <circle id="inner-circle" fill="#767676" cx="321.01" cy="681.659" r="86.4287"/>'},originalResearch:{viewBox:"0 0 17 24",xml:'<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M11.5546875,19.2597656 C11.5846354,19.0201823 11.6070964,18.7880859 11.6220703,18.5634766 C11.6370443,18.3388672 11.6744792,18.1142578 11.734375,17.8896484 C11.7942708,17.6650391 11.8466797,17.4479167 11.8916016,17.2382812 C11.9365234,17.0286458 12.0188802,16.8190104 12.1386719,16.609375 C12.1985677,16.3997396 12.2884115,16.1975911 12.4082031,16.0029297 C12.5279948,15.8082682 12.6402995,15.6136068 12.7451172,15.4189453 C12.8499349,15.2242839 12.9697266,15.0445964 13.1044922,14.8798828 C13.2392578,14.7151693 13.3515625,14.5579427 13.4414062,14.4082031 C13.5911458,14.2285156 13.7184245,14.0638021 13.8232422,13.9140625 C13.9280599,13.7643229 14.0553385,13.6070964 14.2050781,13.4423828 C14.3548177,13.2776693 14.4820964,13.1129557 14.5869141,12.9482422 C14.6917318,12.7835286 14.8190104,12.6263021 14.96875,12.4765625 C15.0585937,12.296875 15.1708984,12.1171875 15.3056641,11.9375 C15.4404297,11.7578125 15.5452474,11.578125 15.6201172,11.3984375 C15.694987,11.21875 15.7848307,11.0240885 15.8896484,10.8144531 C15.9944661,10.6048177 16.061849,10.4101563 16.0917969,10.2304688 C16.2115885,10.0208333 16.2864583,9.81119792 16.3164062,9.6015625 C16.3463542,9.39192708 16.391276,9.18229167 16.4511719,8.97265625 C16.5110677,8.76302083 16.5335286,8.54589844 16.5185547,8.32128906 C16.5035807,8.09667969 16.5110677,7.87955729 16.5410156,7.66992188 C16.4811198,7.19075521 16.398763,6.73404948 16.2939453,6.29980469 C16.1891276,5.8655599 16.046875,5.45377604 15.8671875,5.06445312 C15.6875,4.67513021 15.4703776,4.30078125 15.2158203,3.94140625 C14.961263,3.58203125 14.6692708,3.23763021 14.3398437,2.90820312 C14.0104167,2.57877604 13.6435547,2.28678385 13.2392578,2.03222656 C12.8349609,1.77766927 12.3857422,1.56803385 11.8916016,1.40332031 C11.3974609,1.23860677 10.8658854,1.1188151 10.296875,1.04394531 C9.72786458,0.969075521 9.11393229,0.931640625 8.45507812,0.931640625 C7.82617187,0.931640625 7.22721354,0.969075521 6.65820312,1.04394531 C6.08919271,1.1188151 5.56510417,1.23860677 5.0859375,1.40332031 C4.60677083,1.56803385 4.15755208,1.77766927 3.73828125,2.03222656 C3.31901042,2.28678385 2.94466146,2.57877604 2.61523437,2.90820312 C2.28580729,3.23763021 1.9938151,3.58203125 1.73925781,3.94140625 C1.48470052,4.30078125 1.26757812,4.67513021 1.08789062,5.06445312 C0.908203125,5.45377604 0.765950521,5.8655599 0.661132812,6.29980469 C0.556315104,6.73404948 0.488932292,7.19075521 0.458984375,7.66992188 C0.429036458,7.93945312 0.421549479,8.20898438 0.436523437,8.47851562 C0.451497396,8.74804688 0.488932292,9.01009115 0.548828125,9.26464844 C0.608723958,9.51920573 0.68359375,9.78125 0.7734375,10.0507812 C0.86328125,10.3203125 0.968098958,10.5898438 1.08789062,10.859375 C1.20768229,11.0989583 1.33496094,11.3385417 1.46972656,11.578125 C1.60449219,11.8177083 1.73925781,12.0423177 1.87402344,12.2519531 C2.00878906,12.4615885 2.15104167,12.663737 2.30078125,12.8583984 C2.45052083,13.0530599 2.60026042,13.2402344 2.75,13.4199219 C2.9296875,13.5696615 3.09440104,13.741862 3.24414062,13.9365234 C3.39388021,14.1311849 3.54361979,14.3408203 3.69335937,14.5654297 C3.84309896,14.7900391 3.99283854,15.0221354 4.14257812,15.2617188 C4.29231771,15.5013021 4.42708333,15.7558594 4.546875,16.0253906 C4.69661458,16.264974 4.82389323,16.5195312 4.92871094,16.7890625 C5.03352865,17.0585938 5.1233724,17.328125 5.19824219,17.5976562 C5.27311198,17.8671875 5.32552083,18.1367188 5.35546875,18.40625 C5.38541667,18.6757812 5.40039062,18.9602865 5.40039062,19.2597656 L5.40039062,19.2597656 L11.5546875,19.2597656 Z M9.26367187,17.1933594 L7.51171875,17.1933594 C7.33203125,16.8339844 7.18977865,16.4746094 7.08496094,16.1152344 C6.98014323,15.7558594 6.80045573,15.3740234 6.54589844,14.9697266 C6.29134115,14.5654297 6.04427083,14.1386719 5.8046875,13.6894531 C5.56510417,13.2402344 5.23567708,12.7910156 4.81640625,12.3417969 C4.87630208,12.311849 4.87630208,12.281901 4.81640625,12.2519531 C4.75651042,12.2220052 4.73404948,12.1845703 4.74902344,12.1396484 C4.7639974,12.0947266 4.7265625,12.0423177 4.63671875,11.9824219 C4.546875,11.922526 4.51692708,11.8626302 4.546875,11.8027344 C4.42708333,11.7128906 4.3671875,11.6455078 4.3671875,11.6005859 C4.3671875,11.5556641 4.34472656,11.5107422 4.29980469,11.4658203 C4.25488281,11.4208984 4.23242187,11.3834635 4.23242187,11.3535156 C4.23242187,11.3235677 4.20247396,11.3085938 4.14257812,11.3085938 C4.20247396,11.2786458 4.20247396,11.2561849 4.14257812,11.2412109 C4.08268229,11.226237 4.05273437,11.203776 4.05273437,11.1738281 C4.05273437,11.1438802 4.02278646,11.1064453 3.96289062,11.0615234 C3.90299479,11.0166016 3.88802083,10.9641927 3.91796875,10.9042969 C3.828125,10.844401 3.77571615,10.7845052 3.76074219,10.7246094 C3.74576823,10.6647135 3.72330729,10.6197917 3.69335937,10.5898438 C3.66341146,10.5598958 3.64095052,10.5299479 3.62597656,10.5 C3.6110026,10.4700521 3.58854167,10.4550781 3.55859375,10.4550781 C3.58854167,10.4251302 3.58854167,10.3951823 3.55859375,10.3652344 C3.52864583,10.3352865 3.5061849,10.3053385 3.49121094,10.2753906 C3.47623698,10.2454427 3.45377604,10.2080078 3.42382812,10.1630859 C3.39388021,10.1181641 3.36393229,10.0657552 3.33398437,10.0058594 C3.30403646,9.94596354 3.27408854,9.89355469 3.24414062,9.84863281 C3.21419271,9.80371094 3.19173177,9.76627604 3.17675781,9.73632812 C3.16178385,9.70638021 3.15429687,9.67643229 3.15429687,9.64648438 L3.15429687,9.64648438 L3.15429687,9.46679688 C3.15429687,9.43684896 3.13932292,9.39941406 3.109375,9.35449219 C3.07942708,9.30957031 3.04947917,9.25716146 3.01953125,9.19726562 C2.98958333,9.13736979 2.9671224,9.07747396 2.95214844,9.01757812 C2.93717448,8.95768229 2.9296875,8.91276042 2.9296875,8.8828125 L2.9296875,8.8828125 L2.9296875,8.56835938 C2.9296875,8.53841146 2.92220052,8.50097656 2.90722656,8.45605469 C2.8922526,8.41113281 2.88476562,8.35872396 2.88476562,8.29882812 C2.85481771,8.20898438 2.83984375,8.14160156 2.83984375,8.09667969 L2.83984375,8.09667969 L2.83984375,7.89453125 C2.83984375,7.86458333 2.86979167,7.84960938 2.9296875,7.84960938 L2.9296875,7.84960938 L2.83984375,7.84960938 C2.83984375,7.10091146 2.98209635,6.44205729 3.26660156,5.87304688 C3.55110677,5.30403646 3.91048177,4.82486979 4.34472656,4.43554688 C4.77897135,4.04622396 5.34049479,3.76171875 6.02929687,3.58203125 C6.71809896,3.40234375 7.46679687,3.3125 8.27539062,3.3125 C9.20377604,3.3125 9.98990885,3.40234375 10.6337891,3.58203125 C11.2776693,3.76171875 11.8541667,4.04622396 12.3632812,4.43554688 C12.8723958,4.82486979 13.2392578,5.30403646 13.4638672,5.87304688 C13.6884766,6.44205729 13.8606771,7.10091146 13.9804687,7.84960938 C13.9205729,7.90950521 13.9130859,7.96940104 13.9580078,8.02929688 C14.0029297,8.08919271 14.0104167,8.15657552 13.9804687,8.23144531 C13.9505208,8.3063151 13.9430339,8.37369792 13.9580078,8.43359375 C13.9729818,8.49348958 13.9505208,8.56835938 13.890625,8.65820312 C13.9505208,8.71809896 13.9580078,8.77050781 13.9130859,8.81542969 C13.8681641,8.86035156 13.8531901,8.91276042 13.8681641,8.97265625 C13.883138,9.03255208 13.8681641,9.08496094 13.8232422,9.12988281 C13.7783203,9.17480469 13.7858073,9.22721354 13.8457031,9.28710938 C13.7858073,9.31705729 13.7558594,9.36197917 13.7558594,9.421875 C13.7558594,9.48177083 13.7259115,9.54166667 13.6660156,9.6015625 C13.6061198,9.66145833 13.5761719,9.72884115 13.5761719,9.80371094 C13.5761719,9.87858073 13.516276,9.9609375 13.3964844,10.0507812 C13.4264323,10.1106771 13.3964844,10.1780599 13.3066406,10.2529297 C13.2167969,10.3277995 13.179362,10.3951823 13.1943359,10.4550781 C13.2093099,10.514974 13.179362,10.5673828 13.1044922,10.6123047 C13.0296224,10.6572266 13.0371094,10.6946615 13.1269531,10.7246094 C13.0371094,10.7246094 12.9921875,10.7470703 12.9921875,10.7919922 C12.9921875,10.8369141 12.9472656,10.8968099 12.8574219,10.9716797 C12.7675781,11.0465495 12.7151693,11.1289062 12.7001953,11.21875 C12.6852214,11.3085938 12.5878906,11.4134115 12.4082031,11.5332031 C12.4082031,11.6230469 12.3557943,11.7128906 12.2509766,11.8027344 C12.1461589,11.8925781 12.09375,11.9749349 12.09375,12.0498047 C12.09375,12.1246745 12.0563151,12.1845703 11.9814453,12.2294922 C11.9065755,12.2744141 11.8990885,12.311849 11.9589844,12.3417969 C11.5397135,12.7910156 11.2102865,13.2252604 10.9707031,13.6445312 C10.7311198,14.0638021 10.4840495,14.4755859 10.2294922,14.8798828 C9.9749349,15.2841797 9.7952474,15.6809896 9.69042969,16.0703125 C9.58561198,16.4596354 9.44335937,16.8339844 9.26367187,17.1933594 L9.26367187,17.1933594 Z M8.45507812,23.9316406 C8.72460937,23.9316406 9.0016276,23.9166667 9.28613281,23.8867188 C9.57063802,23.8567708 9.84765625,23.804362 10.1171875,23.7294922 C10.3867187,23.6546224 10.65625,23.5572917 10.9257812,23.4375 C11.1953125,23.3177083 11.4648437,23.1829427 11.734375,23.0332031 L11.734375,23.0332031 L11.734375,20.6074219 L11.734375,20.6074219 L5.265625,20.6074219 L5.265625,20.6074219 L5.265625,23.0332031 C5.53515625,23.1829427 5.8046875,23.3177083 6.07421875,23.4375 C6.34375,23.5572917 6.61328125,23.6546224 6.8828125,23.7294922 C7.15234375,23.804362 7.41438802,23.8567708 7.66894531,23.8867188 C7.9235026,23.9166667 8.18554687,23.9316406 8.45507812,23.9316406 Z" id="î€“" fill="#767676" fill-rule="nonzero"></path> </g>'},pdf:{viewBox:"0 0 16 16",xml:'<path d="M5.523 12.424c.14-.082.293-.162.459-.238a7.878 7.878 0 0 1-.45.606c-.28.337-.498.516-.635.572a.266.266 0 0 1-.035.012.282.282 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548zm2.455-1.647c-.119.025-.237.05-.356.078a21.148 21.148 0 0 0 .5-1.05 12.045 12.045 0 0 0 .51.858c-.217.032-.436.07-.654.114zm2.525.939a3.881 3.881 0 0 1-.435-.41c.228.005.434.022.612.054.317.057.466.147.518.209a.095.095 0 0 1 .026.064.436.436 0 0 1-.06.2.307.307 0 0 1-.094.124.107.107 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256zM8.278 6.97c-.04.244-.108.524-.2.829a4.86 4.86 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.517.517 0 0 1 .145-.04c.013.03.028.092.032.198.005.122-.007.277-.038.465z"/> <path fill="#639add" d="M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3zM4.165 13.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.651 11.651 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.856.856 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.844.844 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.76 5.76 0 0 0-1.335-.05 10.954 10.954 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.238 1.238 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a19.697 19.697 0 0 1-1.062 2.227 7.662 7.662 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103z"/>'},language:{viewBox:"0 0 48 48",xml:'<path d="M0 0h48v48h-48z" fill="none"/><path d="M23.99 4c-11.05 0-19.99 8.95-19.99 20s8.94 20 19.99 20c11.05 0 20.01-8.95 20.01-20s-8.96-20-20.01-20zm13.85 12h-5.9c-.65-2.5-1.56-4.9-2.76-7.12 3.68 1.26 6.74 3.81 8.66 7.12zm-13.84-7.93c1.67 2.4 2.97 5.07 3.82 7.93h-7.64c.85-2.86 2.15-5.53 3.82-7.93zm-15.48 19.93c-.33-1.28-.52-2.62-.52-4s.19-2.72.52-4h6.75c-.16 1.31-.27 2.64-.27 4 0 1.36.11 2.69.28 4h-6.76zm1.63 4h5.9c.65 2.5 1.56 4.9 2.76 7.13-3.68-1.26-6.74-3.82-8.66-7.13zm5.9-16h-5.9c1.92-3.31 4.98-5.87 8.66-7.13-1.2 2.23-2.11 4.63-2.76 7.13zm7.95 23.93c-1.66-2.4-2.96-5.07-3.82-7.93h7.64c-.86 2.86-2.16 5.53-3.82 7.93zm4.68-11.93h-9.36c-.19-1.31-.32-2.64-.32-4 0-1.36.13-2.69.32-4h9.36c.19 1.31.32 2.64.32 4 0 1.36-.13 2.69-.32 4zm.51 11.12c1.2-2.23 2.11-4.62 2.76-7.12h5.9c-1.93 3.31-4.99 5.86-8.66 7.12zm3.53-11.12c.16-1.31.28-2.64.28-4 0-1.36-.11-2.69-.28-4h6.75c.33 1.28.53 2.62.53 4s-.19 2.72-.53 4h-6.75z"/>'},globe:{viewBox:"0 0 16 16",xml:'<path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z"/>'},pencilEmpty:{viewBox:"0 0 16 16",xml:'<g fill="currentColor"> <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/> </g>'},calendarPicker:{viewBox:"0 0 16 16",xml:'<path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/> <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>'},pageCount:{viewBox:"0 0 16 16",xml:'<g fill="#767676"> <path d="M13 0H6a2 2 0 0 0-2 2 2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2 2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 13V4a2 2 0 0 0-2-2H5a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1zM3 4a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4z"/> </g>'},bookmarkFill:{viewBox:"0 0 16 16",xml:'<path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z"/>'},bookmark:{viewBox:"0 0 16 16",xml:'<path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>'},logout:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0z"/>\n                  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708z"/>'},login:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0z"/>\n                  <path fill-rule="evenodd" d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>'},menuExpand:{viewBox:"0 0 24 20",xml:'<g transform="matrix(1 0 0 1 -36 -14 )">                   <path d="M 5.75 10.25  C 5.335786437626904 10.25  5 10.585786437626904  5 11  C 5 11.414213562373096  5.335786437626904 11.75  5.75 11.75  L 14.439499999999999 11.75  L 11.218999999999998 14.969000000000001  C 11.078170043895202 15.109829956104797  10.999052598379887 15.300836366088193  10.999052598379887 15.5  C 10.999052598379887 15.91473679783985  11.335263202160153 16.250947401620117  11.75 16.250947401620117  C 11.949163633911812 16.250947401620117  12.1401700438952 16.171829956104798  12.280999999999999 16.031000000000002  L 16.781 11.531000000000002  C 16.922062551031452 11.390293605484748  17.001340675528127 11.199240891287364  17.001340675528127 11  C 17.001340675528127 10.800759108712636  16.922062551031452 10.609706394515252  16.781 10.469000000000001  L 12.280999999999999 5.969  C 12.140170043895203 5.828170043895203  11.949163633911812 5.749052598379887  11.75 5.749052598379887  C 11.335263202160153 5.749052598379887  10.999052598379887 6.085263202160153  10.999052598379887 6.500000000000002  C 10.999052598379887 6.699163633911814  11.078170043895202 6.8901700438952025  11.218999999999998 7.031000000000002  L 14.439499999999999 10.25  L 5.75 10.25  Z M 2 20.75  C 2 21.164213562373096  1.664213562373095 21.5  1.25 21.5  C 0.8357864376269051 21.5  0.5 21.164213562373096  0.5 20.75  L 0.5 1.25  C 0.5 0.8357864376269052  0.8357864376269051 0.5  1.25 0.5  C 1.664213562373095 0.5  2 0.8357864376269052  2 1.25  L 2 20.75  Z " fill-rule="nonzero" stroke="none" transform="matrix(1 0 0 1 36 14 )" />                   </g>'},plus:{viewBox:"0 0 16 16",xml:'<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>                   <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>'},trash:{viewBox:"0 0 16 16",xml:'<path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5m-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5M4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06m6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528M8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5"/>'},arrowRightShort:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z"/>'},externalLink:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>                   <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>'},reviewArticle:{viewBox:"0 0 16 16",xml:'<path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>'},primarySource:{viewBox:"0 0 16 16",xml:'<path d="M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"/>\n<path d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>'},prePrint:{viewBox:"0 0 16 16",xml:'<path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>\n<path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>'},exclamationTriangle:{viewBox:"0 0 16 16",xml:'<path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"/>\n<path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"/>'},exclamationCircle:{viewBox:"0 0 50 50",xml:'<path d="M25 42c-9.4 0-17-7.6-17-17S15.6 8 25 8s17 7.6 17 17-7.6 17-17 17zm0-32c-8.3 0-15 6.7-15 15s6.7 15 15 15 15-6.7 15-15-6.7-15-15-15z"></path><path d="M24 32h2v2h-2z"></path><path d="M25.6 30h-1.2l-.4-8v-6h2v6z"></path>'},sort:{viewBox:"0 0 16 16",xml:'<path d="M3.5 2.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 11.293V2.5zm3.5 1a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z"/>'},download:{viewBox:"0 0 16 16",xml:'<path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>\n<path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>'},chevronRight:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>'},chevronLeft:{viewBox:"0 0 16 16",xml:'<path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"/>'},stars:{viewBox:"0 0 16 16",xml:'<path d="M7.657 6.247c.11-.33.576-.33.686 0l.645 1.937a2.89 2.89 0 0 0 1.829 1.828l1.936.645c.33.11.33.576 0 .686l-1.937.645a2.89 2.89 0 0 0-1.828 1.829l-.645 1.936a.361.361 0 0 1-.686 0l-.645-1.937a2.89 2.89 0 0 0-1.828-1.828l-1.937-.645a.361.361 0 0 1 0-.686l1.937-.645a2.89 2.89 0 0 0 1.828-1.828zM3.794 1.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387A1.73 1.73 0 0 0 4.593 5.69l-.387 1.162a.217.217 0 0 1-.412 0L3.407 5.69A1.73 1.73 0 0 0 2.31 4.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387A1.73 1.73 0 0 0 3.407 2.31zM10.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732L9.1 2.137a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"/>'}},this.add=function(e,t){return this.icons[e]=t},this.get=function(e){return this.icons[e]?`<path d="${this.icons[e]}"></path>`:this.custom[e]?this.custom[e].xml:console.error(`SVG Icon ${e} could not be found`)},this.determineViewBox=function(e){return this.icons[e]?"0 0 24 24":this.custom[e]?this.custom[e].viewBox:void 0}}}e.$inject=["$http"],angular.module("summonApp.services").service("svgIconService",e)},6585:()=>{"use strict";class e{constructor(e,t,i,s,a){this.update=this.update.bind(this),this.toCamelCase=this.toCamelCase.bind(this),this.$filter=e,this.results=t,this.bxService=i,this.config=s,this.menuManager=a,this.scope={topic:{},visible:!1},this.results.on("new",(()=>this.update())),this.bxService.on("togglingRecommendations",(()=>this.update()))}update(){const e=this.results.data.search.topics||[],t=this.scope.topic=e[0]||{};t.displayTopicsInOrder=this.config.data.topics.topics.map((e=>e.name.substring(0,e.name.lastIndexOf("_label"))));for(let e=0;e<t.displayTopicsInOrder.length;e++){var i=t.displayTopicsInOrder[e];t.displayTopicsInOrder[e]=this.toCamelCase(i)}return t.database_name||(t.database_name=this.$filter("textMapping")(t.source_name,"topic")),t.sourceDisplay=t.publication_title||t.database_name,this.scope.visible=!!t.title&&!this.bxService.showRecommendations&&this.config.data.topics.topics.length>0,t.hasRelatedTopics=!!(t.related_topics&&t.related_topics.length&&t.displayTopicsInOrder.indexOf("relatedTopics")>-1),t.hasResearchGuides=!!(t.research_guides&&t.research_guides.length&&t.displayTopicsInOrder.indexOf("recommendedResearchGuides")>-1),t.hasRelevantAuthors=!(!t.relevant_authors||!t.relevant_authors.length),t.hasLibrarianContactInfo=!!(t.librarian_contact_info&&t.librarian_contact_info.name&&t.displayTopicsInOrder.indexOf("suggestedLibrarian")>-1),(null==t?void 0:t.snippet)&&(t.snippet=t.snippet.replace(/\\/g,"")),this.menuManager.menu.thirdPanel.updateContent("topics",this.scope.visible)}toCamelCase(e){return e.replace(/(\_\w)/g,(e=>e[1].toUpperCase()))}}e.$inject=["$filter","dataService","bxRecommenderService","configService","menuManagerService"],angular.module("summonApp.services").service("topicService",e)},7137:()=>{"use strict";class e{constructor(e){this.$translationKeys=e,this.translatedCache=[],this.translations=this.$translationKeys,this.lookup=window.__translations||{},angular.forEach(this.translations,((e,t)=>angular.forEach(this.lookup,((i,s)=>{if(e===s&&null!==i)return this.translations[t]=i}))))}translate(e,t={}){let i;const s=e+JSON.stringify(t);if(void 0!==this.translatedCache[s])return this.translatedCache[s];const a=RegExp("%{.*?}");if(angular.isArray(e)){for(let i=0;i<e.length;i++){var r=e[i];e[i]=this.translate(r,t)}i=e}else{try{i=this.lookup[e]||e}catch(t){i=e}a.test(i)&&(i=this.template(i,t))}return this.translatedCache[s]=i,i}template(e,t){for(var i in t){var s=t[i];e=e.replace(new RegExp(`%{${i}}`,"g"),s)}return e}}e.$inject=["$translationKeys"],angular.module("summonApp.services").service("translationService",e)},4587:(e,t,i)=>{"use strict";var s=i(4125);const a={fvf:!0,fvfi:!0,rf:!0};class r{constructor(e){this.applyParams=this.applyParams.bind(this),this.applyDocumentPath=this.applyDocumentPath.bind(this),this.removeDocumentPath=this.removeDocumentPath.bind(this),this.$location=e}paramsToObject(e){const t={};for(const[i,s]of e)t[i]=s;return t}urlParamsFromString(e){const t=new URLSearchParams(e).entries();return this.paramsToObject(t)}urlParamsFor(e){const t=$.extend({},e);for(var i in t){var a=t[i];if(!angular.isNumber(a)&&(null==a?void 0:a.length)<=0&&"boolean"!=typeof a&&"q"!==i)delete t[i];else{if(angular.isArray(a)){var r=s.findIndex(a,(e=>0===e.indexOf("PublicationDate")));if(r>=0){var[n,o]=a[r].split(",")[1].split(":").map((function(e){return"*"!==e?new Date(Date.parse(e)).toISOString().split("T")[0]:e}));a[r]="PublicationDate,"+n+":"+o}t[i]=a.join("|")}!0===a&&(t[i]="t"),!1===a&&(t[i]="f")}}return t}urlParamsStringFor(e){const t=this.urlParamsFor(e),i=Object.getOwnPropertyNames(t);let s="";return i.forEach((e=>{const i=`${e}=${encodeURIComponent(t[e])}`;s=s?`${s}&${i}`:`${i}`})),s}applyParams(e){const t=this.urlParamsFor(e);return this.$location.search(t)}applyDocumentPath(e){const t=this.$location.search();return t.id=e,this.$location.search(t),this.$location.path("/search/document")}removeDocumentPath(){const e=this.$location.search();return delete e.id,this.$location.search(e),this.$location.path("/search")}toParams(e){const t={};for(var i in e){var s=e[i];t[i]=a[i]?s.split(/(?! )[|](?! )/):"t"===s||"f"!==s&&s}return null==t.pn&&(t.pn=1),t}}r.$inject=["$location"],angular.module("summonApp.services").service("urlService",r)},7640:()=>{"use strict";angular.module("summonApp.services").service("utilitiesService",class{constructor(){this.summonUnEscape=this.summonUnEscape.bind(this)}dateToFilterDate(e){if(e&&"function"==typeof e.getFullYear){const t=e.getFullYear().toString();let i=(e.getMonth()+1).toString(),s=e.getDate().toString();return i.length<2&&(i="0"+i),s.length<2&&(s="0"+s),t+"-"+i+"-"+s}return"*"}summonEscape(e){return null==e&&(e=""),e.replace(/(\,|\(|\)|\{|\}|\$|\:)/g,"\\$1")}summonEscapeWithParentesis(e){return null==e&&(e=""),e.replace(/(\,|\{|\}|\$|\:)/g,"\\$1")}summonUnEscape(e){return null==e&&(e=""),e.replace(/\\([\(\)\,\{\}\$\:])/g,"$1")}splitOnEscaped(e,t){if(null==e)return[""];if(null==t)return[e];if(""===t&&(t=e.split("")),t.length>1)throw new Error("Only supports splitting on a single character or nothing");const i=[];let s=0;for(let a=0;a<e.length;a++)e[a]===t&&"\\"!==e[a-1]&&(i.push(e.substring(s,a)),s=a+1);return i.push(e.substring(s)),i}titleCase(e){return null==e&&(e=""),e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substring(1)))}lowerCaseFirstChar(e){return null==e&&(e=""),e.replace(/\w\S*/g,(e=>e.charAt(0).toLowerCase()+e.substring(1)))}removeBoldTags(e){return null==e&&(e=""),e.replace(/<\/?b(\sclass=".*?")?>/gi,"")}removeHithighlightTags(e){return null==e&&(e=""),e.replace(/<\/?mark(\sclass=".*?")?>/gi,"")}getIIIUrlDetails(e,t){let i;const s=new RegExp("https?://([^/?]*)(.*)");let[a,r,n]=e.match(s);return[a,i]=t.match(s),[r,n,i]}proxify(e,t,i=!1){let s,a,r;if(!t||!t.url||!t.type)return e;const n=t.url;if(!0===i&&"ezproxy"===t.type.toLowerCase()){let t,i,a,r;const o=new RegExp("(https?\\://)([^/?]*)(.+?(?=#!)#!)(/.*)");return[t,a,s,i,r]=e.match(o),`${n}${a}${s}${r}`}switch(t.type.toLowerCase()){case"iii":return[s,r,a]=this.getIIIUrlDetails(e,n),`//0-${s}.${a}${r}`;case"iii - wam ssl host replace":return[s,r,a]=this.getIIIUrlDetails(e,n),-1!==e.indexOf("https")&&(s=s.split(".").join("-")),`//0-${s}.${a}${r}`;case"ezproxy":case"custom":case"acs":return`${n}${e}`;case"redirector":return`${n}${encodeURIComponent(e).replace(/!/g,"%21")}`;case"openathensredirector":return`${n}?url=${encodeURIComponent(e).replace(/!/g,"%21")}`;case"han":case"obvia":return`${n}?title=Summon&url=${encodeURIComponent(e)}`;default:return e}}})},4234:()=>{"use strict";angular.module("summonApp.services").service("viewStateService",class{constructor(){this.currentView="search",this.subView="",this.resultsScrollY=0,this.scopeBuilderMode=!1}})},669:(e,t,i)=>{"use strict";var s=i(4125);class a{constructor(e){let t;this.isLegacy=this.isLegacy.bind(this),this.extractParams=this.extractParams.bind(this),this.addCommandParams=this.addCommandParams.bind(this),this.getConvertedParams=this.getConvertedParams.bind(this),this.convert=this.convert.bind(this),this.search=e.replace(/\+/g," "),this.legacyParamRx=/s\.\w+(%5B%5D|\[\])?=([^&]*)/g,this.maverickParamRx=/\w+=([^&]*)/g,this.cleanParamRx=/s\.(\w+)(%5B%5D|\[\])?/,this.idParamRx=/id\=([^\&]*)/g,this.params={},t=this.isLegacy()?this.legacyParamRx:this.maverickParamRx,this.search&&this.extractParams(t)}isLegacy(){return this.legacyParamRx.test(this.search)}extractParams(e){let t;const i=this.search.match(e);i&&(i.forEach((e=>{const t=e.split("=",1)[0],i=t.replace(this.cleanParamRx,"$1"),s=decodeURIComponent(e.substring(t.length+1));this.params[i]||(this.params[i]=[]),this.params[i].push(encodeURIComponent(s))})),(t=this.search.match(this.idParamRx))&&(this.params.id=[t[0].split("=")[1]]))}addCommandParams(){if(this.params.cmd)return this.params.cmd.forEach((e=>{const t=e.substring(0,e.indexOf("("));let i=decodeURIComponent(e.substring(t.length+1,e.length-1));switch(t){case"addFacetValueFilters":i=i.split(",");var a=i.shift(),r=i.join(",");return this.params.fvf||(this.params.fvf=[]),this.params.fvf.push(`${a},${encodeURIComponent(r.replace(/\:(t|f)$/,",$1"))}`);case"removeFacetValueFilter":if(this.params.fvf)return this.params.fvf=s(this.params.fvf).reject((e=>new RegExp(`^${i}`).test(decodeURIComponent(e))));break;case"setRangeFilter":return this.params.rf=[i];case"removeRangeFilter":if(this.params.rf)return this.params.rf=s(this.params.rff).reject((e=>new RegExp(`^${i}`).test(e)));break;case"setHoldingsOnly":if("false"===i)return this.params.ho=["f"];break;case"setSortByRelevancy":if(this.params.sort)return delete this.params.sort;break;case"setSort":return this.params.sort=[i];case"setTextQuery":return this.params.q=[i]}})),delete this.params.cmd}getConvertedParams(){if(this.params.ff&&delete this.params.ff,this.params.rff&&delete this.params.rff,this.params.keep_r&&delete this.params.keep_r,this.params.spellcheck&&delete this.params.spellcheck,this.params.fvgf&&delete this.params.fvgf,this.params.ps&&delete this.params.ps,this.params.role&&delete this.params.role,this.params.max&&delete this.params.max,this.params.light&&delete this.params.light,this.params.fq&&(s(this.params.fq).any((e=>/SourceType.*Library\ Catalog/.test(decodeURIComponent(e))))&&(this.params.fvf||(this.params.fvf=[]),this.params.fvf.push("SourceType,Library Catalog,f")),delete this.params.fq),this.addCommandParams(),this.params.fvf)return this.params.fvf=this.params.fvf.map((function(e){return/,(t|f)$/.test(decodeURIComponent(e))?e:e+",f"}))}convert(){const e=[];this.getConvertedParams();const t=encodeURIComponent("|");for(var i in this.params){var s=this.params[i];0!==s.length&&e.push(`${i}=${s.join(t)}`)}return e.join("&")}}class r{constructor(e,t,i){this.urlHasHashBang=this.urlHasHashBang.bind(this),this.rewrite=this.rewrite.bind(this),this.$timeout=i,this.$window=e,this.$location=t,this.location=this.$window.location}urlHasHashBang(){return!!this.location.hash.length}rewriteLegacyUrl(e){return new a(e).convert()}rewrite(){if(this.urlHasHashBang())return;const e=this.location.pathname,t=this.rewriteLegacyUrl(this.location.search);this.$timeout((()=>{this.$location.path(e).search(t).replace()}),0)}}r.$inject=["$window","$location","$timeout"],angular.module("summonApp.urlRewriter").service("urlRewriter",r),e.exports=a},3794:()=>{"use strict";angular.module("summonApp.values").value("embeddedWidgetValues",{activeTab:"widget-type",activeWidget:"",showEmbeddedWidgetsBox:!1}).value("citationValues",{options:{}})},4125:function(e,t){var i;(function(){var s=this,a=s._,r=Array.prototype,n=Object.prototype,o=Function.prototype,l=r.push,c=r.slice,h=n.toString,d=n.hasOwnProperty,u=Array.isArray,p=Object.keys,m=o.bind,g=Object.create,v=function(){},S=function(e){return e instanceof S?e:this instanceof S?void(this._wrapped=e):new S(e)};e.exports&&(t=e.exports=S),t._=S,S.VERSION="1.8.3";var f=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,s){return e.call(t,i,s)};case 3:return function(i,s,a){return e.call(t,i,s,a)};case 4:return function(i,s,a,r){return e.call(t,i,s,a,r)}}return function(){return e.apply(t,arguments)}},b=function(e,t,i){return null==e?S.identity:S.isFunction(e)?f(e,t,i):S.isObject(e)?S.matcher(e):S.property(e)};S.iteratee=function(e,t){return b(e,t,1/0)};var y=function(e,t){return function(i){var s=arguments.length;if(s<2||null==i)return i;for(var a=1;a<s;a++)for(var r=arguments[a],n=e(r),o=n.length,l=0;l<o;l++){var c=n[l];t&&void 0!==i[c]||(i[c]=r[c])}return i}},_=function(e){if(!S.isObject(e))return{};if(g)return g(e);v.prototype=e;var t=new v;return v.prototype=null,t},E=function(e){return function(t){return null==t?void 0:t[e]}},A=Math.pow(2,53)-1,C=E("length"),$=function(e){var t=C(e);return"number"==typeof t&&t>=0&&t<=A};function T(e){return function(t,i,s,a){i=f(i,a,4);var r=!$(t)&&S.keys(t),n=(r||t).length,o=e>0?0:n-1;return arguments.length<3&&(s=t[r?r[o]:o],o+=e),function(t,i,s,a,r,n){for(;r>=0&&r<n;r+=e){var o=a?a[r]:r;s=i(s,t[o],o,t)}return s}(t,i,s,r,o,n)}}S.each=S.forEach=function(e,t,i){var s,a;if(t=f(t,i),$(e))for(s=0,a=e.length;s<a;s++)t(e[s],s,e);else{var r=S.keys(e);for(s=0,a=r.length;s<a;s++)t(e[r[s]],r[s],e)}return e},S.map=S.collect=function(e,t,i){t=b(t,i);for(var s=!$(e)&&S.keys(e),a=(s||e).length,r=Array(a),n=0;n<a;n++){var o=s?s[n]:n;r[n]=t(e[o],o,e)}return r},S.reduce=S.foldl=S.inject=T(1),S.reduceRight=S.foldr=T(-1),S.find=S.detect=function(e,t,i){var s;if(void 0!==(s=$(e)?S.findIndex(e,t,i):S.findKey(e,t,i))&&-1!==s)return e[s]},S.filter=S.select=function(e,t,i){var s=[];return t=b(t,i),S.each(e,(function(e,i,a){t(e,i,a)&&s.push(e)})),s},S.reject=function(e,t,i){return S.filter(e,S.negate(b(t)),i)},S.every=S.all=function(e,t,i){t=b(t,i);for(var s=!$(e)&&S.keys(e),a=(s||e).length,r=0;r<a;r++){var n=s?s[r]:r;if(!t(e[n],n,e))return!1}return!0},S.some=S.any=function(e,t,i){t=b(t,i);for(var s=!$(e)&&S.keys(e),a=(s||e).length,r=0;r<a;r++){var n=s?s[r]:r;if(t(e[n],n,e))return!0}return!1},S.contains=S.includes=S.include=function(e,t,i,s){return $(e)||(e=S.values(e)),("number"!=typeof i||s)&&(i=0),S.indexOf(e,t,i)>=0},S.invoke=function(e,t){var i=c.call(arguments,2),s=S.isFunction(t);return S.map(e,(function(e){var a=s?t:e[t];return null==a?a:a.apply(e,i)}))},S.pluck=function(e,t){return S.map(e,S.property(t))},S.where=function(e,t){return S.filter(e,S.matcher(t))},S.findWhere=function(e,t){return S.find(e,S.matcher(t))},S.max=function(e,t,i){var s,a,r=-1/0,n=-1/0;if(null==t&&null!=e)for(var o=0,l=(e=$(e)?e:S.values(e)).length;o<l;o++)(s=e[o])>r&&(r=s);else t=b(t,i),S.each(e,(function(e,i,s){((a=t(e,i,s))>n||a===-1/0&&r===-1/0)&&(r=e,n=a)}));return r},S.min=function(e,t,i){var s,a,r=1/0,n=1/0;if(null==t&&null!=e)for(var o=0,l=(e=$(e)?e:S.values(e)).length;o<l;o++)(s=e[o])<r&&(r=s);else t=b(t,i),S.each(e,(function(e,i,s){((a=t(e,i,s))<n||a===1/0&&r===1/0)&&(r=e,n=a)}));return r},S.shuffle=function(e){for(var t,i=$(e)?e:S.values(e),s=i.length,a=Array(s),r=0;r<s;r++)(t=S.random(0,r))!==r&&(a[r]=a[t]),a[t]=i[r];return a},S.sample=function(e,t,i){return null==t||i?($(e)||(e=S.values(e)),e[S.random(e.length-1)]):S.shuffle(e).slice(0,Math.max(0,t))},S.sortBy=function(e,t,i){return t=b(t,i),S.pluck(S.map(e,(function(e,i,s){return{value:e,index:i,criteria:t(e,i,s)}})).sort((function(e,t){var i=e.criteria,s=t.criteria;if(i!==s){if(i>s||void 0===i)return 1;if(i<s||void 0===s)return-1}return e.index-t.index})),"value")};var I=function(e){return function(t,i,s){var a={};return i=b(i,s),S.each(t,(function(s,r){var n=i(s,r,t);e(a,s,n)})),a}};S.groupBy=I((function(e,t,i){S.has(e,i)?e[i].push(t):e[i]=[t]})),S.indexBy=I((function(e,t,i){e[i]=t})),S.countBy=I((function(e,t,i){S.has(e,i)?e[i]++:e[i]=1})),S.toArray=function(e){return e?S.isArray(e)?c.call(e):$(e)?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:$(e)?e.length:S.keys(e).length},S.partition=function(e,t,i){t=b(t,i);var s=[],a=[];return S.each(e,(function(e,i,r){(t(e,i,r)?s:a).push(e)})),[s,a]},S.first=S.head=S.take=function(e,t,i){if(null!=e)return null==t||i?e[0]:S.initial(e,e.length-t)},S.initial=function(e,t,i){return c.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},S.last=function(e,t,i){if(null!=e)return null==t||i?e[e.length-1]:S.rest(e,Math.max(0,e.length-t))},S.rest=S.tail=S.drop=function(e,t,i){return c.call(e,null==t||i?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var R=function(e,t,i,s){for(var a=[],r=0,n=s||0,o=C(e);n<o;n++){var l=e[n];if($(l)&&(S.isArray(l)||S.isArguments(l))){t||(l=R(l,t,i));var c=0,h=l.length;for(a.length+=h;c<h;)a[r++]=l[c++]}else i||(a[r++]=l)}return a};function w(e){return function(t,i,s){i=b(i,s);for(var a=C(t),r=e>0?0:a-1;r>=0&&r<a;r+=e)if(i(t[r],r,t))return r;return-1}}function L(e,t,i){return function(s,a,r){var n=0,o=C(s);if("number"==typeof r)e>0?n=r>=0?r:Math.max(r+o,n):o=r>=0?Math.min(r+1,o):r+o+1;else if(i&&r&&o)return s[r=i(s,a)]===a?r:-1;if(a!=a)return(r=t(c.call(s,n,o),S.isNaN))>=0?r+n:-1;for(r=e>0?n:o-1;r>=0&&r<o;r+=e)if(s[r]===a)return r;return-1}}S.flatten=function(e,t){return R(e,t,!1)},S.without=function(e){return S.difference(e,c.call(arguments,1))},S.uniq=S.unique=function(e,t,i,s){S.isBoolean(t)||(s=i,i=t,t=!1),null!=i&&(i=b(i,s));for(var a=[],r=[],n=0,o=C(e);n<o;n++){var l=e[n],c=i?i(l,n,e):l;t?(n&&r===c||a.push(l),r=c):i?S.contains(r,c)||(r.push(c),a.push(l)):S.contains(a,l)||a.push(l)}return a},S.union=function(){return S.uniq(R(arguments,!0,!0))},S.intersection=function(e){for(var t=[],i=arguments.length,s=0,a=C(e);s<a;s++){var r=e[s];if(!S.contains(t,r)){for(var n=1;n<i&&S.contains(arguments[n],r);n++);n===i&&t.push(r)}}return t},S.difference=function(e){var t=R(arguments,!0,!0,1);return S.filter(e,(function(e){return!S.contains(t,e)}))},S.zip=function(){return S.unzip(arguments)},S.unzip=function(e){for(var t=e&&S.max(e,C).length||0,i=Array(t),s=0;s<t;s++)i[s]=S.pluck(e,s);return i},S.object=function(e,t){for(var i={},s=0,a=C(e);s<a;s++)t?i[e[s]]=t[s]:i[e[s][0]]=e[s][1];return i},S.findIndex=w(1),S.findLastIndex=w(-1),S.sortedIndex=function(e,t,i,s){for(var a=(i=b(i,s,1))(t),r=0,n=C(e);r<n;){var o=Math.floor((r+n)/2);i(e[o])<a?r=o+1:n=o}return r},S.indexOf=L(1,S.findIndex,S.sortedIndex),S.lastIndexOf=L(-1,S.findLastIndex),S.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var s=Math.max(Math.ceil((t-e)/i),0),a=Array(s),r=0;r<s;r++,e+=i)a[r]=e;return a};var k=function(e,t,i,s,a){if(!(s instanceof t))return e.apply(i,a);var r=_(e.prototype),n=e.apply(r,a);return S.isObject(n)?n:r};S.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,c.call(arguments,1));if(!S.isFunction(e))throw new TypeError("Bind must be called on a function");var i=c.call(arguments,2),s=function(){return k(e,s,t,this,i.concat(c.call(arguments)))};return s},S.partial=function(e){var t=c.call(arguments,1),i=function(){for(var s=0,a=t.length,r=Array(a),n=0;n<a;n++)r[n]=t[n]===S?arguments[s++]:t[n];for(;s<arguments.length;)r.push(arguments[s++]);return k(e,i,this,this,r)};return i},S.bindAll=function(e){var t,i,s=arguments.length;if(s<=1)throw new Error("bindAll must be passed function names");for(t=1;t<s;t++)e[i=arguments[t]]=S.bind(e[i],e);return e},S.memoize=function(e,t){var i=function(s){var a=i.cache,r=""+(t?t.apply(this,arguments):s);return S.has(a,r)||(a[r]=e.apply(this,arguments)),a[r]};return i.cache={},i},S.delay=function(e,t){var i=c.call(arguments,2);return setTimeout((function(){return e.apply(null,i)}),t)},S.defer=S.partial(S.delay,S,1),S.throttle=function(e,t,i){var s,a,r,n=null,o=0;i||(i={});var l=function(){o=!1===i.leading?0:S.now(),n=null,r=e.apply(s,a),n||(s=a=null)};return function(){var c=S.now();o||!1!==i.leading||(o=c);var h=t-(c-o);return s=this,a=arguments,h<=0||h>t?(n&&(clearTimeout(n),n=null),o=c,r=e.apply(s,a),n||(s=a=null)):n||!1===i.trailing||(n=setTimeout(l,h)),r}},S.debounce=function(e,t,i){var s,a,r,n,o,l=function(){var c=S.now()-n;c<t&&c>=0?s=setTimeout(l,t-c):(s=null,i||(o=e.apply(r,a),s||(r=a=null)))};return function(){r=this,a=arguments,n=S.now();var c=i&&!s;return s||(s=setTimeout(l,t)),c&&(o=e.apply(r,a),r=a=null),o}},S.wrap=function(e,t){return S.partial(t,e)},S.negate=function(e){return function(){return!e.apply(this,arguments)}},S.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,s=e[t].apply(this,arguments);i--;)s=e[i].call(this,s);return s}},S.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},S.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}},S.once=S.partial(S.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),P=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function O(e,t){var i=P.length,s=e.constructor,a=S.isFunction(s)&&s.prototype||n,r="constructor";for(S.has(e,r)&&!S.contains(t,r)&&t.push(r);i--;)(r=P[i])in e&&e[r]!==a[r]&&!S.contains(t,r)&&t.push(r)}S.keys=function(e){if(!S.isObject(e))return[];if(p)return p(e);var t=[];for(var i in e)S.has(e,i)&&t.push(i);return D&&O(e,t),t},S.allKeys=function(e){if(!S.isObject(e))return[];var t=[];for(var i in e)t.push(i);return D&&O(e,t),t},S.values=function(e){for(var t=S.keys(e),i=t.length,s=Array(i),a=0;a<i;a++)s[a]=e[t[a]];return s},S.mapObject=function(e,t,i){t=b(t,i);for(var s,a=S.keys(e),r=a.length,n={},o=0;o<r;o++)n[s=a[o]]=t(e[s],s,e);return n},S.pairs=function(e){for(var t=S.keys(e),i=t.length,s=Array(i),a=0;a<i;a++)s[a]=[t[a],e[t[a]]];return s},S.invert=function(e){for(var t={},i=S.keys(e),s=0,a=i.length;s<a;s++)t[e[i[s]]]=i[s];return t},S.functions=S.methods=function(e){var t=[];for(var i in e)S.isFunction(e[i])&&t.push(i);return t.sort()},S.extend=y(S.allKeys),S.extendOwn=S.assign=y(S.keys),S.findKey=function(e,t,i){t=b(t,i);for(var s,a=S.keys(e),r=0,n=a.length;r<n;r++)if(t(e[s=a[r]],s,e))return s},S.pick=function(e,t,i){var s,a,r={},n=e;if(null==n)return r;S.isFunction(t)?(a=S.allKeys(n),s=f(t,i)):(a=R(arguments,!1,!1,1),s=function(e,t,i){return t in i},n=Object(n));for(var o=0,l=a.length;o<l;o++){var c=a[o],h=n[c];s(h,c,n)&&(r[c]=h)}return r},S.omit=function(e,t,i){if(S.isFunction(t))t=S.negate(t);else{var s=S.map(R(arguments,!1,!1,1),String);t=function(e,t){return!S.contains(s,t)}}return S.pick(e,t,i)},S.defaults=y(S.allKeys,!0),S.create=function(e,t){var i=_(e);return t&&S.extendOwn(i,t),i},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e},S.isMatch=function(e,t){var i=S.keys(t),s=i.length;if(null==e)return!s;for(var a=Object(e),r=0;r<s;r++){var n=i[r];if(t[n]!==a[n]||!(n in a))return!1}return!0};var F=function(e,t,i,s){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var a=h.call(e);if(a!==h.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var r="[object Array]"===a;if(!r){if("object"!=typeof e||"object"!=typeof t)return!1;var n=e.constructor,o=t.constructor;if(n!==o&&!(S.isFunction(n)&&n instanceof n&&S.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}s=s||[];for(var l=(i=i||[]).length;l--;)if(i[l]===e)return s[l]===t;if(i.push(e),s.push(t),r){if((l=e.length)!==t.length)return!1;for(;l--;)if(!F(e[l],t[l],i,s))return!1}else{var c,d=S.keys(e);if(l=d.length,S.keys(t).length!==l)return!1;for(;l--;)if(c=d[l],!S.has(t,c)||!F(e[c],t[c],i,s))return!1}return i.pop(),s.pop(),!0};S.isEqual=function(e,t){return F(e,t)},S.isEmpty=function(e){return null==e||($(e)&&(S.isArray(e)||S.isString(e)||S.isArguments(e))?0===e.length:0===S.keys(e).length)},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=u||function(e){return"[object Array]"===h.call(e)},S.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},S.each(["Arguments","Function","String","Number","Date","RegExp","Error"],(function(e){S["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}})),S.isArguments(arguments)||(S.isArguments=function(e){return S.has(e,"callee")}),"object"!=typeof Int8Array&&(S.isFunction=function(e){return"function"==typeof e||!1}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!==+e},S.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===h.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return null!=e&&d.call(e,t)},S.noConflict=function(){return s._=a,this},S.identity=function(e){return e},S.constant=function(e){return function(){return e}},S.noop=function(){},S.property=E,S.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},S.matcher=S.matches=function(e){return e=S.extendOwn({},e),function(t){return S.isMatch(t,e)}},S.times=function(e,t,i){var s=Array(Math.max(0,e));t=f(t,i,1);for(var a=0;a<e;a++)s[a]=t(a);return s},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},S.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},x=S.invert(N),M=function(e){var t=function(t){return e[t]},i="(?:"+S.keys(e).join("|")+")",s=RegExp(i),a=RegExp(i,"g");return function(e){return e=null==e?"":""+e,s.test(e)?e.replace(a,t):e}};S.escape=M(N),S.unescape=M(x),S.result=function(e,t,i){var s=null==e?void 0:e[t];return void 0===s&&(s=i),S.isFunction(s)?s.call(e):s};var U=0;S.uniqueId=function(e){var t=++U+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\u2028|\u2029/g,V=function(e){return"\\"+H[e]};S.template=function(e,t,i){!t&&i&&(t=i),t=S.defaults({},t,S.templateSettings);var s=RegExp([(t.escape||B).source,(t.interpolate||B).source,(t.evaluate||B).source].join("|")+"|$","g"),a=0,r="__p+='";e.replace(s,(function(t,i,s,n,o){return r+=e.slice(a,o).replace(q,V),a=o+t.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":s?r+="'+\n((__t=("+s+"))==null?'':__t)+\n'":n&&(r+="';\n"+n+"\n__p+='"),t})),r+="';\n",t.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var n=new Function(t.variable||"obj","_",r)}catch(e){throw e.source=r,e}var o=function(e){return n.call(this,e,S)},l=t.variable||"obj";return o.source="function("+l+"){\n"+r+"}",o},S.chain=function(e){var t=S(e);return t._chain=!0,t};var j=function(e,t){return e._chain?S(t).chain():t};S.mixin=function(e){S.each(S.functions(e),(function(t){var i=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),j(this,i.apply(S,e))}}))},S.mixin(S),S.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=r[e];S.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],j(this,i)}})),S.each(["concat","join","slice"],(function(e){var t=r[e];S.prototype[e]=function(){return j(this,t.apply(this._wrapped,arguments))}})),S.prototype.value=function(){return this._wrapped},S.prototype.valueOf=S.prototype.toJSON=S.prototype.value,S.prototype.toString=function(){return""+this._wrapped},void 0===(i=function(){return S}.apply(t,[]))||(e.exports=i)}).call(this)}},e=>{e.O(0,[965,881,699],(()=>(7138,e(e.s=7138)))),e.O()}]);
//# sourceMappingURL=application.eb63ed99673759813dc8.js.map